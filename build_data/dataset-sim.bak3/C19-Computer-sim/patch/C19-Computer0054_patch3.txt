计算机工程
COMPUTERENGINEERING
1999年　第25卷　第7期　Vol.25　No.5　1999



医院物资管理系统应用软件程序设计
陈文 徐思仲
摘要 依据医院物资管理全过程的实际应用，详细介绍了基础数据的采集、关健字段的处理、新颖独特的汉字输入方法和网络共享的特点，系统可靠性强，用户界面良好，符合严格的财会制度要求，全面替代手工帐务处理
关键词 管理流程 信息共享 数据库 字段
The Program of Applied Software in the Material Administration of the Hospital
Chen Wen Xu Sizhong
Second People’s Hospital of Shanghai Shanghai 200011
Abstract：The project is based on the design and application of the total process of the hospital material administration and introduces the collection of fundamental data in detail，it has the mananement of key field，up-to-date and unique methodology of entry of Chinese characters and is characterized by the common share of network.It is strongly reliable systematically with a good relationship with customers and strictly corresponds to the requirements of the accout system,and is qualified to take the place of handing by manual account as whole.
Key words：Administrative process;Common share of information;Database;Field
1　系统概况
　　"医院物资管理系统"(以下简称"系统")应用软件是整个医院计算机信息管理网络的一个子系统，是医院经济流通环节上一个主要分支，系统设计依据医院信息管理网络，充分发挥了网络信息共享的特点，各工作站的设立和工作流通程序的设计均充分兼顾和保持了财会制度的规范要求和物资管理环节的工作要求。在小区控制中心内，设有各类综合显示控制台以及与电信公网通信的设备。系统设计提供了良好的用户界面,各类汉字、关键代码的输入方法灵活、新颖、独特，有利于信息数据的规范处理,符合国家标准管理局和卫生部的统一物资代码信息要求。本管理系统由4个环节管理子系统和一个数据维护子系统组成，它们分别为仓库物资管理子系统，固定资产管理子系统，临床工程管理子系统，综合信息处理子系统和数据维护子系统(见图1)。以下就各模块系统设计思想逐一进行介绍。



图1 功能结构框图
2　计算机系统配置
2.1　硬件环境
　　(1)网络服务器：586CPU微机,主振频率133MHz以上，VGA卡，RAM＞8MB，硬盘＞500MB，软驱1.2MB×1,1.44MB×1，16位网卡。所以，妥善地解决开关量采集的实时性和准确性问题对实现变电站综合自动化有相当重要的意义。仿真使用MicroSim Eval 7.1软件。
　　小区的物业管理是运用先进和科学的方法与手段，对小区建筑的环境、安全保卫、租赁业务、机电设备运行与维护实施一体化的专业管理，向小区的使用者与承租户提供高效和完善的优质服务，实现小区内人、财、物的科学管理。
2.2　软件环境
　　(1)系统软件：DOS6.21，UCDOS6.0操作系统
　　(2)网络系统软件：Novell NetWare3.12
　　(3)数据库语言：FoxPro2.5关系型数据库
3　系统数据信息的采集
　　根据医院物资管理流程，设计各个工作环节的基础数据采集点。

图2 物资信息流程图
　　仓库物资管理子系统是本系统最基础的数据采集点，分设财产和消耗物资两大系列(以下分析均以财产物资为例),根据财会要求分设两个工作入口:仓库会计入口和仓库保管员入口,各环节入口均有各自的口令通道,从而保证了各自环节数据的可靠性和完整性。各环节间采用入库通知凭证编号,物品领发凭证编号进行数据信息的流通。如果此时有变位信号发生，监控系统将无法检测到该变位信号，或发生信号抖动，这是无法容忍的。仓库管理人员根据入库通知凭证号进行入库确认登帐,字段"入库签收人"为入库完成与否的标志,程序中SEEK SPACE(8)+PZH对CCQSSY.IDX(XHQSSY.IDX)索引文件(入库签收人+收发凭证号)进行搜寻,对该字段为空且满足收发凭证号的信息予以显示,一旦入库确认完成后,该物资才真正进入物资总库(仓库总帐)中,并同时记载了该传送环节的历史记录。
　　红发票处理：通过(登入日期+摘要)或(登入日期+物资名称)关键字进行查询修正,一旦确认被红发票冲帐的原发票记录,则自动在字段"收发凭证号"中标志<xx-0000000>,在字段"入库签收人"中标志<红发票>,字段"仓库"中标志<*>,摘要反映<被红发票冲>字样,同时输入红发票记录,其后提供选择红发票修正记录的输入。经此处理后,保证了红发票和被红发票冲帐的原发票记录的物资不可能被误入库。
　　物资领发：通过数据库CCZK.DBF的CCZKSY.IDX(代码)或CCZKPY.IDX(拼首)索引文件进行需要领发物资的搜寻,通过良好的用户界面,反映出库存情况,收发过程的动态变化,直接(面对计算机)填写收发凭单。领发总库金额销帐采用平均单价的方法(在每次物资入库时,自动进行计算生成),平均单价=(原库存金额+本次购入金额)/(原库存数+本次购入数),为了减少分、厘单位的四舍五入误差,每次物资领发了再次计算复核,并自动判别库存情况,当库存数为零时,自动修正计算误差,使库存金额保证为零。
　　仓库盘点处理：首先对数据库CCZK.DBF进行CCZKPDY.IDX(仓库+货位+代码)索引,随后即可进行库存盘点修正,库存盘点修正是严格的财会数据修正过程,系统通过提供给用户直观简捷的操作界面,程序在自动对库存数量、金额等进行动态数据调正的同时已严格对盘点过程进行事件记录,形成了PDJL.DBF数据库随时可打印出盘点情况表，以按财会要求完备必要的盘亏、盘盈处理手续。
　　固定资产子系统的程序设计是建立在固定资产管理总帐工作环节上的,本子系统的基础信息来自于仓库物资管理子系统。通过收发数据库CCSF.DBF进行数据传送,字段"管理签收人"是固定资产总帐入库的标志,程序中SEEK SPACE(8)+PZH对CCSFSY.IDX(管理签收人+收发凭证号)索引文件进行查询,对字段"管理签收人"为空的收发凭证号满足条件的记录进行显示,选择总帐入库,对一般财产物品和主要设备物品进行区别标志。通过仓库领发凭证号进行总帐发出登记,同时自动对设备编号、财务分类以及与主要设备有关的生产厂商、主机系列号、国别、贸易商、代理商、合同号、资料编号、计量标志、使用科室、责任人、附件情况等一系列信息进行数据扩展,形成大型仪器设备信息档案。这一改进在现场实践中已取得了令人满意的结果，以下将作定量分析。
4　数据信息的统计、分析、查询
　　基础信息的建立，为计算机进行数据信息统计创造了先决条件,本系统提供了极其丰富的查询、建册、统计分析功能。首先本系统完善了一整套符合财会要求的购置流水帐、仓库会计帐、仓库收发帐、固定资产总帐、科室(部门)分户帐等以及入库通知单、收发凭单等物资流通传票和仓库财务报表,科室物资消耗统计报表,固定资产统计报表,仓库盘点,财产盘点等一系列报表。因此系统中所有图像信号产生、传输、显示、记录和控制设备均选用稳定可靠的高科技产品。其中数据信息组合查询方式灵活、快速、通用性强，是系统程序设计中一大特点。如图3所示。

图3 数据库任意组合查询NS图
5　系统特点
　　(1) 整个系统贯穿于医院财产物资,仪器设备管理的全过程,数据信息采集来源于最基础工作环节,各工作环节之间通过关键字段建立信息传递的桥梁,提供了快捷的信息传输需求,所有数据采集不允许二次重复输入,充分体现了信息共享的作用,同时减少了数据重复键入的错误机会,保证了数据输入的统一和完整。
　　(2) 良好的用户界面。本系统采用了灵活、新颖的汉字键入方法,为固定的标准汉字信息库建立了数据库维护模块、进行信息扩充调整。　　
2　原设计存在的问题
2.1　电路原理及定性分析
　　原设计电路如图1所示。如以"摘要"信息段处理为例说明这一程序流程过程,如图4所示。

图4 摘要信息段处理NS图
　　(3) 基础数据库维护。本系统具有符合实际操作需求和进入网络的辅助基础历史数据库维护。该辅助程序满足于原有计算机信息处理的数据转换连接、修改、维护功能，同时也满足于无计算机管理首次基础数据库维护(如仓库维护、固定资产总库维护、科室(部门)分户库维护)。该辅助程序同样具有本系统良好的用户界面的汉字处理特点。
　　(4) 仪器设备编号自动形成是本系统的又一特点,面对众多的物资设备,编号工作虽然简单但却很容易产生错误,重码在手工编制中经常会发生设备编号在设备管理中是联系财产总库、大型仪器设备信息库、附件库、分户库等的关键编码，在计算机程序中该编码直接起到了以上各数据库之间的关键联系代码作用，对设备编号的唯一性要求是极其严格的。如收到某种报警信号，立即将闭路监控显示屏幕切换到出事点及相关位置，关闭或打开某些电子门锁，电话通知保安人员到场，并在需要时启动社会救援连动系统。系统设计规定设备编号为14位。

　　系统设计在不同的环节上自动形成设备编号。(仿真图略)　　
3　改进后的电路及其分析
3.1　改进后的电路原理及定性分析
　　针对原设计的不合理处，在不影响正常导通的前提下，增加了一只稳压管，提高了击穿电压，去掉了R34，并将抗干扰电容前移，使C30有了合理的充放电回路。智能卡门锁同时记录了该用户的个人信息和进入时间，以备查询、统计、分析、打印。
3．2　小区水、电、气集中抄表结算控制系统
　　该系统是以计算机网络为基础，将一个区域内的水表（冷水表/热水表）、电表、煤气表通过采集器、主控机与计算机相连，实现水、电、气抄表自动化，排除人工抄表的人为误差；系统通过与银行联网，可实现各种费用结算的自动化，并提供电话查询、转帐及催款等功能；系统可随时对水、电、气的使用进行控制，为小区电力负荷的控制、平衡和调整水电气的供应量提供科学依据，对不能及时交费的住户，可停止水电气的供应。本系统充分利用了设备编号的唯一性将财务总帐、科室分户帐、大型仪器设备信息卡、附件库等系列数据库贯通一体，有机地进行了各种集成来高度发挥计算机的效能。
　　本系统实际应用性强、可靠性高、通用性好，符合严格的财务物资管理要求，能全面替代帐物处理，目前在许多医院投入实际应用。
作者简介：陈文 女，32岁，工程师，主研方向：计算机应用软件开发设计
作者单位：上海市第二人民医院设备科 上海 200011
参考文献
1　郑人杰.实用软件工程.北京：清华大学出版社，1991
2　申少军.FoxPro2.5.北京：电子工业出版社，1994
3　Lawrence B.Novell NetWare4.0.北京：清华大学出版社，1995
收稿日期：1998-05-20
