计算机应用
Computer Applications
1999年 第19卷 第7期  Vol.19 No.7 1999



集散式能源测控系统的实现
吴　琳　李　锐　谭南邻　韩　松

　　摘　要　本文结合一个卷烟厂电力监控系统的具体实例，说明能源测控系统的整体设计思想与实现方法，详细描述了系统的集散式体系结构，概括了系统通信网络的设计思想和系统可靠性的实现策略。
　　关键词　能源测控,集散系统,体系结构,可靠性

　　典型的卷烟企业是连续制造流程型传统产业，其生产流程耗气和耗水量较大，用量波动也较大，而生产设备对供电质量有越来越高的要求。
　　定义6. 实例。
　　根据对能源测控系统用户需求的分析，制定了分散控制、集中操作、分级管理、综合协调的设计原则，它应具有典型集散式系统的体系结构特征。
　　定理3. 不存在最小的二阶反合一。实际运行的系统效果良好，保障了企业的生产和产品质量创造了显著的效益。
　　对于一个能源测控和管理系统，主要应完成：工业现场各类能源信号的自动采集和转换；重要的能源设备和参数的在线闭环控制；实时数据采集处理和各类统计报表制作；合理的网络结构与层次，提供高效、可靠的数据通道；较好的可扩充性、灵活性和互操作性。
　　本文以一个卷烟厂电力监控系统为例，介绍集散式能源测控和管理系统实现的要点。
　　WWW是快速增长的巨大信息库,含有大量有用的信息,其信息存储为静态HTML页面,主要通过浏览器来查看。随着网络技术的成熟，集散控制系统又进一步向着集成管理的方向发展，即实现管控一体化，以适应生产综合自动化的要求。
　　在本系统设计中，考虑能源系统要易于扩展和升级的需求，在集散系统的总体结构上兼具分布式的特征。系统结构从上到下划分为系统管理级、控制管理级和现场控制级，由三级网络相连接。
1.1　现场控制级
　　现场控制级是能源测控系统的基础，具体承担现场各类模拟信号、开关信号和脉冲信号的输入、变换、运算和输出。
　　由于P也是一种类型,允许g为P(x),其中x为变量。1#和2#智能工作站处理精度要求较高的电度累计脉冲信号，3#智能工作站单独处理开关量和瞬时模拟信号。两台PLC控制器通过RS485与3#站相连,由PLC控制器实现有载调压功能。例如,AAAI页面上的AAAI-97 Technical Papers,Invited Talks等组成。
1.2　控制管理级
　　能源测控系统中的主要功能如流程显示、控制调节、数据存储、报表打印、报警提示、趋势分析、数据通信、系统维护等均在控制管理级实现，因此该级是测控管理的中心环节，也是系统网络的核心部分。
　　为保证24小时不间断运行中的系统可靠性，采取了双机热备份的系统结构。

Fig.2　HTML fragments of AAAI conference homepage
图2　AAAI会议主页的HTML文本片断

Fig.3　OEM objects extracted from AAAI homepage
图3　AAAI页面抽取出的OEM对象
1.4　结合数据抽取格式描述和启发式规则的算法
　　输入：数据抽取格式SECTXT1,SECVAR1,SOURCE1,...,SECTXTM,SECVARM,SOURCEM
　　　　　SECTXTi,SECVARi,SOURCEi分别代表第i行的段文本,段变量,资源
　　输出：页面的OEM数据OEMdata
　　OEMdata EXTRACTOR(SECTXT1,SECVAR1,SOURCE1,...,SECTXTM,SECVARM,SOURCEM)
　　按照SOURCE1的网络地址获取HTML文本
　　抽取SECTXT1中描述的左右分割符之间的文本段作为根对象值
　　创建标记为SECVAR1的根对象R0
　　将根对象SECVAR1名称和值Value记录在已处理表中
　　While(数据抽取格式描述行未处理完)
　　　　｛将已处理表中第1个记录作为当前项
　　　　While(在当前项中存在和SOURCEm一致的SECVARm对应的值Value)
　　　　　　｛将Value作为资源
　　　　　　如果SECTXTm不出现字体大小标记、缩进标记组合
　　　　　　　｛按照SECTXTm从资源中获取各文本段作为标记为SECVARm的各个对象值
　　　　　　　　如果SECVARm为常数字符串,所有子对象标记都是SECVARm
　　　　　　　　否则按照SECVARm从Value值中获取各个对象标记
　　　　　　　　　　生成对象作为标记为SECVARm对象的亲子
　　　　　　　　　　将这些亲子的SECVARm和值Value记录在已处理表中
　　　　　　｝
　　　　如果SECTXTm出现字体大小标记的组合,用启发式确定层次结构
　　　　　　｛在资源中获取所有尺寸的字体标记,从大到小记录在字体列表中
　　　　　　将字体列表中首记录作为当前字体记录
　　　　　　While(当前字体记录不为空)
　　　　　　　　｛按照当前字体标记从资源中获取各文本段作为各个对象值
　　　　　　　　按照SECVARm从资源中获取各个对象标记
　　　　　　　　生成对象作为标记为SECVARm对象的亲子
　　　　　　　　　将这些亲子的SECVARm和值Value记录在已处理表中
　　　　　　　　　将所有Value作为资源列表
　　　　　　　　　字体列表记录下移一个记录作为当前字体记录
　　　　　　　　｝
　　　　｝
　　如果SECTXTm出现缩进标记的组合,用启发式确定层次结构
　　　　　　｛在资源中获取所有尺寸的缩进标记,从小到大记录在缩进列表中
　　　　　　将缩进列表中首记录作为当前缩进记录
　　　　　　While(当前缩进记录不为空)
　　　　　　　　｛按照当前缩进标记从资源中获取各文本段作为各个对象值
　　　　　　　　按照SECVARm从资源中获取各个对象标记
　　　　　　　　生成对象作为标记为SECVARm对象的亲子
　　　　　　　　　将这些亲子的SECVARm和值Value记录在已处理表中
　　　　　　　　　将所有Value作为资源列表
　　　　　　　　　缩进列表记录下移一个记录作为当前缩进记录
　　　　　　　　｝
　　　　　　｝
　　已处理表下移一个记录作为当前项
　　　　｝
　　　　　读取下一个数据格式描述行
　　　　｝
　　　　Return OEMdata
　　该抽取算法将启发式规则纳入数据抽取格式中,即当抽取格式段文本SECTXTm中出现字体大小标记的组合、缩进标记的组合时,用启发式确定层次结构。主动刷新是工控机A（或B）故障后重新启动时，自动拷贝工控机B（或A）的数据库，用B（或A）的数据刷新自己的数据；被动刷新是工控机A（或B）通过邮件槽发送消息，通知对方刷新数据库。实际编程中经过不断的优化和测试，数据的一致性问题得到了圆满的解决。
1.3　系统管理级
　　现场控制级和控制管理级实现了能源信号的实时采集、参数与状态的优化控制和集中的操作，而系统管理级则使企业决策者远程了解能源系统的运行状况，查询各级设备状态和能耗数据，从而实施实时指挥调度的中心。
　　系统管理级通过网络接口与全厂的企业内部网相连，成为企业管理信息系统的一个节点，又是全厂CMIS中能源部分的一个基础组成。
2　系统的通信网络
　　通信网络将物理上分散配置的现场控制单元、智能I/O站、控制管理计算机和系统管理计算机通过高速数据线连接起来，构成完整的运行体系，它是集散式能源测控系统的神经中枢。
　　工业测控系统中通信网络主要要求实时性和可靠性，为此，在设计该电力监控系统时，上层网络选用标准以太网（Ethernet），而其底层网络则采用了国际标准中具有更高可靠性的工业现场总线――控制器局域网CAN（Controller Area Network）组网技术。
　　将系统管理级和控制管理级通过Ethernet网连接，使用了三个SN2000以太网卡和同轴电缆，控制管理级的两台工控机和系统管理级主微机构成一个小型以太网(Ethernet)，采用总线型结构。在控制管理级和系统管理级微机上均采用了Windows 95操作系统，其本身提供标准IEEE 802.3协议的Ethernet网络支持，同时也支持目前Internet中应用最为广泛的TCP/IP协议。利用Delphi3.0软件开发平台中提供的网络构件，可以很容易地实现这一层的数据通信。实际应用中我们选用的是TCP/IP协议。
　　在集散式系统中，控制管理级和现场控制级之间的数据通信是一个需要认真解决的难题，以往曾采用过RS-485协议和其他总线技术，在工业现场实际运行中其抗干扰能力和数据速率、数据误码率等主要指标均难以满足要求，本系统采用CAN总线技术。CAN是一种多主总线，具有简化的网络结构和开放性、实时性的特点，是一种有效支持分布式控制或实时控制的串行通信网络。我们可以把（）看作是一种操作。经过近两年的实际应用证明，它可以为工业控制级的数据通信提供比较有效的运行支持。 This method can extract structured and semi-structured data。就系统本身的构建而言，最重要的是其可靠性设计。如果一个系统设备维护简单、控制操作自如、应有的功能齐全且灵活方便，管理人员和操作人员对系统有很高的信任度，这样的系统必能有长久的生命力和在生产中充分发挥作用。为了达到这个目标，我们在设计和实施能源系统中主要采取以下可靠性措施。
3.1　数据采集通道的抗干扰措施
　　* 系统中4～20mA的模拟输入信号通过一个低通滤波器，并且采用差分方式输入，以抑制共模干扰噪声；开关信号和脉冲信号则通过光耦或隔离继电器隔离后再输入系统接口。
　　* 模拟信号转换为数字信号后，均经过一级软件滤波，从信号源头保证模/数转换的正确性，并进一步提高信号传输信噪比。
　　* 模拟信号、变送器信号采用RVV双绞屏蔽线敷设，屏蔽层单端接地。
　　定理5。选用有高频滤波、稳压、隔离、无触点切换等措施的UPS，以确保在外围电网有事故发生瞬间系统仍能有效地监测。
3.3　提高系统级可靠性
　　在集散式测控系统中，各单元部件的高可靠性是整个系统可靠性的前提，但是如果只注重单元的可靠性是不够的，必须采用系统工程的方法，从整个系统的角度进行可靠性分析和设计。我们在该系统中采用多级的冗余与容错措施，取得了明显效果。
　　现场控制级，智能工作站1# 和2# 同时采集功率变送器输出的脉冲信号，即使其中一台工作站出现故障，另一台仍能保证累计数据的准确不丢失。
　　同理，在控制管理级采用了双机热备份系统，两台工控机执行相同的程序从现场控制级读取数据，最上层的系统管理级只需从其中一台工控机采数，若提供数据的工控机发生故障，则切换到另一台工控机采数。由此,根据各个段表达式捕获与之类型相同的段标题,为各个段标题构造新节点,根据标题的字体大小、缩排距离使新节点成为另一个段的亲子节点,同一个列表段各个节点互为兄弟节点。这样控制管理级的双工控机就能保持所采集的各种电量参数的一致性。由于P0是P1,P2的合并,因此,P0包含P1,对于P0的属性i,若其存在于P1中,A0i＝Ai；若其不存在于P1中,取A0i＝。
　　行2将给定URL资源文件中第1次出现〈h1-6〉之后的文本抽取出来,将〈hx〉到〈/hx〉之间的文本作为新的段变量名称,将〈/hx〉到〈hx〉之间的文本,即从当前位置到下一个兄弟段之间的文本作为该段变量的值,x表示1～6之间的取值。从事工业控制和计算机应用开发工作。
　　李　锐　硕士研究生。主要研究方向：工业控制，管理信息系统。
　　作者单位：吴　琳　李　锐（中国科学院成都计算机应用研究所　四川．成都610041）
　　　　　　　谭南邻　韩　松（成都卷烟厂设备动力部　四川．成都　610061）
参考文献
［1］　邱公伟,赵祥元,巫淑萍.实时控制与智能仪表多微机系统的通信技术.北京：清华大学出版社，1996
［2］　邱公伟.集散系统实时性与存取控制方式的关系.工业控制计算机，1990;(3)
［3］　王常力,廖道文.集散型控制系统的设计与应用.北京：清华大学出版社，1993 
　收稿日期:1999-01-28(修改稿)
