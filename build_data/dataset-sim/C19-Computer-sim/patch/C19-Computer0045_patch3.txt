计算机工程
COMPUTER ENGINEERING
1999年  第25卷 第7期 Vol.25 No.5 1999



基于Intranet的综合信息服务系统
张勇　潘清
摘要　虽然传统的管理信息系统MIS已经获得了广泛的应用，但它仍存在许多问题。
三、处理消息的安全方法
　　为了安全检测和处理消息环中的消息，需注意以下几点：
　　首先，在消息环中可能有很多消息，所以检测消息时应一直检测下去直到没有消息为止。主要围绕其概念和关键技术进行了讨论，并介绍了一个应用实例。
关键词　客户/服务器模型Intranet综合信息服务系统管理信息系统
Intranet Based Integrated Information Service System
Zhang Yong Pan Qing
Institute of Command and Technology Beijing 101416
Abstract：Although the Managing Information System （MIS）has been widely used，it still has many serious problems.The Intranet based Integrated Information Servide System(IISS)can solve those problems in an effective way.This paper mainly discusses the principles and structures of the IISS and finally gives an application based on it.
Key words：Client/Server model；IISS；MIS
　　随着计算机技术的飞速发展，人们的生产、生活方式正在经历着前所未有的变革，计算机网络、多媒体、Internet等技术在使人眼花缭乱的同时，也使人们切实感受到它们所带来的巨大效果。而在这些基础之上产生的Intranet即内部网技术，虽然只是"小荷才露尖尖角"，但它所展示的魅力却已向人们证明，它是一项非常有前途的技术，必将得到广泛的应用。事实上，Intranet的思想和技术给我们带来的决不仅仅是一二个具体应用，它所代表的是一种新的计算模式，即"以用户为中心的计算(User Centric Computing)"。这种计算模式同以往的"以数据结构为中心的计算"、"以网络为中心的计算"相比，能更好地满足用户的需求，必将成为未来的一项关键技术。
　　与传统的管理信息系统相比，基于Intranet的综合信息服务系统的特点是：
　　(1)系统所管理的信息是复杂多样的，提供的服务也是多样的。传统的MIS系统是针对某一类特定信息而开发的，各种系统之间不能很好地集成。在综合信息服务系统中，可以方便地集成企业内部的各种信息，如职工考勤、通知消息、公文报表等都能够集成在一个系统中。同时，系统所提供的服务也不仅仅是管理或查询，而是集信息获取、信息处理、信息发布于一体，并且可以根据用户的需要随时提供定制的服务。
　　(2)系统具有良好的伸缩性，可以动态地适应企业的发展。传统的MIS一经完成便难以更改，企业的需求一发生变化，就必须重新设计安装。而综合信息服务系统由于采用了Intranet技术，容易适应这种变化，充分保护已有的投资。
　　(3)系统更加面向最终用户，方便了使用。传统的MIS系统大都是专门的系统，各个系统之间的操作、使用方法均不相同，给用户使用带来了不便，也增加了用于培训的投资。
　　2.发送消息
　　发送消息的函数有三个：PostMessage, SendMessage和DispatchMessage。要想使绘图方便快捷，最佳的解决途径就是使用“图层”。它将Internet技术应用在企业内部的信息系统，其服务对象主要是企业内部人员，其主要目的(作用)是加强内部各部门之间的联系，促进企业内部的沟通，提高工作效率。wRemoveMsg是一个标志，它可以是以下值的组合：PM_NOREMOVE(表示经处理后，消息保留在队列中)、PM_REMOVE(表示经处理后，消息不保留在队列中)、PM_NOYIELD(防止向别的任务转让系统资源，但在WIN32中，此参数无效)。特别是在photoshop5.0中更是增加“文字图层”这一功能，在“文字图层”中我们可以对文字做许多特殊效果的处理，利用文字图层中Effects(制造效果)功能，我们可以将在以往旧版的photoshop中需要许多步骤才能完成的文字特殊效果如文字阴影一步就“搞定”。发挥了两者的优势。一个典型的Intranet应用应当具有如图1所示的结构：

图1　Intranet应用结构
　　其中客户端采用通用的浏览器(Browser)软件，这是Intranet应用与用户的唯一界面。通过浏览器，用户可以得到它们所需要的全部信息。服务端安装HTTP服务软件，它监听并处理来自客户端的请求，将结果发送到客户端。少则上千个面，多则上万个面，还需要给它们贴上各种材料，才能做最后的渲染。
六、结束语
　　正是看到了图层具有如此强大而方便的功能，而且具有巨大的潜力，因而软件开发商对“图层”这一概念越来越青睐，而越来越多的绘图软件把“图层”当做一个必不可少功能，而已有的软件把“图层”这一功能越来越强化，新开发的绘图软件中，“图层”将扮演越来越重要的角色。
二、消息的检测与发送
　　1.消息的检测
　　检测消息环的函数有两个：GetMessage和PeekMessage,这两个函数的区别有两点：(1)如果消息环中没有消息，GetMessage一直等到有消息才返回，而PeekMessage则直接返回，且返回值为0；(2)PeekMessage检测到WM_QUIT没有什么特殊反应，而GetMessage检测到WM_QUIT则返回值为0。一个图形就像一张透明纸，您可以在不同的图层上绘制不同的实体。系统的概念结构如图3所示：

图3 综合信息服务系统概念结构
　　在综合信息服务系统中，最重要的技术应当是：
　　(1) 数据库技术 要管理企业的各种信息，就离不开数据库。数据库的设计与实现对于综合信息服务系统是至关重要的一环。
　　(2) TCP/IP网络技术 TCP/IP是Intranet的基础，整个系统是建立在网络互连之上的。
　　(3) 基于Web的计算 Web本身的计算能力不强，因为这不是它的主要目标。但是，实现综合信息服务系统的关键正在于将所有的计算都集成到Web中来。因此，必须找到一种方法，可以使基于Web的应用能够同其他服务(如数据库等)紧密结合起来，共同工作。例如，我们在图纸上画了一个正方形，如果不作任何文字说明的话，谁都无法知道这一方形代表的是什么。这里仅着重讨论基于Web的计算技术。■
作者单位：刘华蓥(大庆石油学院计算机系 安达 151400)
收稿日期：1999-07-12
。早期的Web功能比较简单，只提供超文本链接和简单输入。前两个函数是把消息放入消息环中，而DispatchMessage则直接将消息发送到应该处理此消息的窗口，并且等待将这个消息处理完才返回，所以应该用DispatchMessage来发送消息。消息环的结构是一个队列，即“先进先出”。可以看出，这种实现将分为客户端和服务器端两个部分，客户端主要完成用户数据的输入以及结果数据的显示，服务器端的工作则复杂得多，因此这里主要讨论服务端的实现。
　　目前服务端的实现主要有以下几种方法： 
　　(1) 通用网关界面(Common Gateway Interface)CGI CGI定义了Web与其它应用程序互相访问的接口。因为一旦我们将这一正方形画在一个叫做“柱子”的图层上，那么即使不作任何文字说明，我们也知道这个正方形就是一根柱子。采用CGI的系统结构如图4所示：

图4　CGI系统结构
　　图中：
　　①客户与HTTP服务器连接并提出请求；
　　②服务器对环境变量赋值并运行CGI程序，把从客户收到的请求数据及信息传送给CGI程序；
　　③CGI程序完成处理之后把结果返回HTTP服务器；
　　④HTTP服务器把应答传送给客户。
　　CGI标准虽然使得创建Intranet应用成为可能，但是它的缺点也是不容忽视的。最致命的一个缺点是性能很差，这也是由于对每个CGI请求都必须创建一个进程来响应，一旦出现多个并发请求，服务器就会陷入性能的低谷。另一个问题是CGI的安全性难有保障。由于CGI是在服务器方执行的应用程序，可以控制服务器上的资源，一旦CGI程序本身有漏洞或BUG，则整个系统立刻就变成了不安全的系统，随时可能受到攻击。另一方面，这种BUG又几乎是无法避免的。如果通过CAD的特有功能，如“属性”、“扩展数据”、“图层”等，尽管我们没有对这一正方形作任何的注释，我们都可以十分方便地了解这些功能赋予它特殊的物理意义。
　　(2) 嵌入式描述语言(Embedded Scripting Language)这是一种改进的方法，通过定义简单使用的描述语言并将其解释器集成到Web服务器中，可以较好地解决CGI方法中存在的主要问题。
　　“图层”是CAD中性质相近、相同或者逻辑意义上相关的图形对象的集合。同CGI相比，这种方法的优点是：
　　1) 性能有所提高：由于解释器是内建的，当处理客户请求时，不再需要创建单独的进程，仅需创建线程即可，这样大大减少了系统开销。
　　2) 可以有效地减少安全性隐患：因为解释器是经过仔细测试的，不易出现大的漏洞。例如，我们在图纸上画了一个正方形，如果不作任何文字说明的话，谁都无法知道这一方形代表的是什么。如果hWnd为NULL，则检测属于本应用程序的所有窗口的消息，如wMsgFilterMin和wMsgFilterMax都为0，则检测发送给指定窗口的所有消息。
　　消息映射机制是windows编程的基本机制之一，它的优点是编程的结构化；但它也有缺点，就是在处理一个消息的过程中不能检测是否有其它的消息。例如，可以用Netscape公司的Enterprise Server中提供的NSAPI写一个自己的嵌入式描述语言解释器或者扩充自己的HTML标准。
　　其次，如果在处理本消息过程中又做了关闭本程序窗口的操作，若不滤掉关闭窗口的消息直接发送出去，而DispatchMessage语句本身又不在函数的末尾，则会导致内存渗漏，窗口关闭了，但程序还在内存中，且无法再对它进行操作。Windows中的消息是以一定的规则排列起来，这就是消息环。
　　(4) JAVA语言 JAVA语言的意义早已超过了Web技术的范畴，不过它应用在Web中，能够极大地提高应用程序的功能。用JAVA几乎可以做任何事，同时又很便于编程。
　　第三，如果再次在消息环中检测到本消息，并且发送了出去，则会导致二次进入本程序体，从而导致混乱。但是随着Netscape公司的Livewire技术和Microsoft公司的Active Server Page技术的出现，越来越多的开发者将视线转向了这两种嵌入式
描述语言。例如，我们建立一个图层，将这个层设置好线型之后，再要画某种线型时，只要把线条画在相应那种线型的图层上，所有在这个图层上线条都被赋予了这种线型的属性，这样假如我们要画不同的线型，只要简单的把当前图层切换为具有此种线型的图层即可，这样绘图的速度即可大大的加快。而以往手上工绘图却需要分别画出这三幅图。值得指出的是，主流浏览器，如Navigator和Internet Explorer都提供了 "插件"接口，用户可以通过定制插件来控制客户端完成更复杂的工作。
3　应用实例
　　基于我们的综合信息服务系统的模型，我们研制开发了"运动会综合信息服务系统"、"办公综合信息服务系统"等应用系统。解决办法是设置一个布尔变量，若该布尔变量为真则表示正在处理本消息。因此，当进程检测到关闭窗口的消息时应先用goto语句到本函数的末尾，再发送关闭窗口的消息。
　　系统采用Windows NT 4.0作为服务器操作系统平台，Web服务器则采用Netscape的Enterprise Server 3.0 for NT，数据库服务器是SYBASE System 11。整个系统使用Netscape的Livewire技术，用嵌入式Javascript语言编写。系统功能结构如图6所示：

图6 运动会信息服务系统功能结构
　　与以往的同类系统相比，它的优点是：
　　(1)系统功能强大。不仅可以完成运动会赛程和成绩的管理，还可以及时处理、动态发布这些信息。
　　(2)使用方便。可以容纳许多人同时以各种灵活的方式进行查询和浏览。例如，我们建立一个图层，将这个层设置好线型之后，再要画某种线型时，只要把线条画在相应那种线型的图层上，所有在这个图层上线条都被赋予了这种线型的属性，这样假如我们要画不同的线型，只要简单的把当前图层切换为具有此种线型的图层即可，这样绘图的速度即可大大的加快。整个系统构建在安全可靠的软、硬件平台上，不易受到外界破坏。一个图形就像一张透明纸，您可以在不同的图层上绘制不同的实体