计算机工程
COMPUTERENGINEERING
1999年　第25卷　第7期　Vol.25　No.5　1999



医院物资管理系统应用软件程序设计
陈文 徐思仲
摘要 依据医院物资管理全过程的实际应用，详细介绍了基础数据的采集、关健字段的处理、新颖独特的汉字输入方法和网络共享的特点，系统可靠性强，用户界面良好，符合严格的财会制度要求，全面替代手工帐务处理
关键词 管理流程 信息共享 数据库 字段
The Program of Applied Software in the Material Administration of the Hospital
Chen Wen Xu Sizhong
Second People’s Hospital of Shanghai Shanghai 200011
Abstract：The project is based on the design and application of the total process of the hospital material administration and introduces the collection of fundamental data in detail，it has the mananement of key field，up-to-date and unique methodology of entry of Chinese characters and is characterized by the common share of network.It is strongly reliable systematically with a good relationship with customers and strictly corresponds to the requirements of the accout system,and is qualified to take the place of handing by manual account as whole.
Key words：Administrative process;Common share of information;Database;Field
1　系统概况
　　"医院物资管理系统"(以下简称"系统")应用软件是整个医院计算机信息管理网络的一个子系统，是医院经济流通环节上一个主要分支，系统设计依据医院信息管理网络，充分发挥了网络信息共享的特点，各工作站的设立和工作流通程序的设计均充分兼顾和保持了财会制度的规范要求和物资管理环节的工作要求。运行系统收到监控器发来的故障通知消息后即挂起本地进程,将其状态设为“ABNORMAL”。系统设计提供了良好的用户界面,各类汉字、关键代码的输入方法灵活、新颖、独特，有利于信息数据的规范处理,符合国家标准管理局和卫生部的统一物资代码信息要求。本管理系统由4个环节管理子系统和一个数据维护子系统组成，它们分别为仓库物资管理子系统，固定资产管理子系统，临床工程管理子系统，综合信息处理子系统和数据维护子系统(见图1)。以下就各模块系统设计思想逐一进行介绍。



图1 功能结构框图
2　计算机系统配置
2.1　硬件环境
　　(1)网络服务器：586CPU微机,主振频率133MHz以上，VGA卡，RAM＞8MB，硬盘＞500MB，软驱1.2MB×1,1.44MB×1，16位网卡。
　　设Pf为任一原故障进程,ef为其回卷点；Pn为某个FSG上的任一正常进程,en为其回卷点,enl为其最近事件；Pu为任一不在任何FSG上的正常进程。
　　管理员工作站加配硬盘＞500MB，软驱1.44MB×1(或1.2MB×1，1.44MB×1)，或其他外存设备，16位网卡，LQ-1600K打印机。
　　(3)非网络用户硬件配置：486CPU以上微机，主频＞25MHz，VGA卡(或CGA、MGA等彩色、单色卡)，硬盘＞500MB、软驱1.44MB×1，或其他外存设备，LQ-1600K打印机。
2.2　软件环境
　　(1)系统软件：DOS6.21，UCDOS6.0操作系统
　　(2)网络系统软件：Novell NetWare3.12
　　(3)数据库语言：FoxPro2.5关系型数据库
3　系统数据信息的采集
　　根据医院物资管理流程，设计各个工作环节的基础数据采集点。

图2 物资信息流程图
　　仓库物资管理子系统是本系统最基础的数据采集点，分设财产和消耗物资两大系列(以下分析均以财产物资为例),根据财会要求分设两个工作入口:仓库会计入口和仓库保管员入口,各环节入口均有各自的口令通道,从而保证了各自环节数据的可靠性和完整性。各环节间采用入库通知凭证编号,物品领发凭证编号进行数据信息的流通。数据库CCDR.DBF的"收发凭证号"字段为仓库会计进行入库与否的标志,程序中SEEK SPACE(10)+CKNAME对CCPCSY.IDX索引文件(收发凭证编号+仓库)进行搜寻,凡对数据库中该字段为空且满足仓库名的信息予以显示,以供选择进行入库通知,入库通知凭证号以每年为起始，自动生成编号(如1998年则起始生成No98-0000001)。仓库管理人员根据入库通知凭证号进行入库确认登帐,字段"入库签收人"为入库完成与否的标志,程序中SEEK SPACE(8)+PZH对CCQSSY.IDX(XHQSSY.IDX)索引文件(入库签收人+收发凭证号)进行搜寻,对该字段为空且满足收发凭证号的信息予以显示,一旦入库确认完成后,该物资才真正进入物资总库(仓库总帐)中,并同时记载了该传送环节的历史记录。假设它们的故障率为λk(k=1,2,...,i+j),ck(k=1,2,...,i)为第k个不导致“网络故障”的故障的可恢复因子,其恢复时间忽略不计。One problem in reconfiguration is how to recover the system to the consistent states that exist just before the occurrence of faults。
　　物资领发：通过数据库CCZK.DBF的CCZKSY.IDX(代码)或CCZKPY.IDX(拼首)索引文件进行需要领发物资的搜寻,通过良好的用户界面,反映出库存情况,收发过程的动态变化,直接(面对计算机)填写收发凭单。领发总库金额销帐采用平均单价的方法(在每次物资入库时,自动进行计算生成),平均单价=(原库存金额+本次购入金额)/(原库存数+本次购入数),为了减少分、厘单位的四舍五入误差,每次物资领发了再次计算复核,并自动判别库存情况,当库存数为零时,自动修正计算误差,使库存金额保证为零。假设第k(k=1,2,...,i+j)个故障的修复/替换时间服从任何一个概率分布,不妨设其分布函数为GRk(t),且GRk(0)=0,则它的第k个可恢复的故障的平均修复时间MTTRk（mean time to repair）为MTTRk=∫∞0(1-GRk(x))dx。
　　固定资产子系统的程序设计是建立在固定资产管理总帐工作环节上的,本子系统的基础信息来自于仓库物资管理子系统。目前,已有的网络管理模型［1,2］是一种消极的网络管理。通过仓库领发凭证号进行总帐发出登记,同时自动对设备编号、财务分类以及与主要设备有关的生产厂商、主机系列号、国别、贸易商、代理商、合同号、资料编号、计量标志、使用科室、责任人、附件情况等一系列信息进行数据扩展,形成大型仪器设备信息档案。我们定义一个全局的一致状态是这样的一个事件集合,每个进程在该集合中有一个事件相对应,任意两个事件ei与ej之间满足SENTi,j(ei)≥RECDj,i(ej)以及SENTj,i(ej) ≥RECDi,j(ei)。当一个故障发生之后,修复或替换工作就开始了。所发送的消息由本地运行系统保存在一个队列里,称为TEM-QUEUE。其次还具备了大型仪器设备单机分析,设备信息统计分析、PM计划实施、资料分析统计查询、仓库货位维护以及数据统计图形显示等强有力的功能。其中数据信息组合查询方式灵活、快速、通用性强，是系统程序设计中一大特点。如图3所示。
　　由文献［4］进一步得到基于第i（i∈U）个初始状态的性能可靠性和平均无故障性能的公式：
　　(4)
　　(5)
以及性能可用性的计算公式：
　　(6)
　　最后,考虑结构状态过程{Z(t),t≥0}是一个具有无穷小发生器矩阵Q=［qij］的一个连续时间齐次马氏链CTMC（continuous time homogeneous Markov chain）,其中qij（i≠j）表示从第i个状态转移到第j个状态的转移概率和是第i个对角元素。
　　(2) 良好的用户界面。本系统采用了灵活、新颖的汉字键入方法,为固定的标准汉字信息库建立了数据库维护模块、进行信息扩充调整。用户使用时采用代码或拼首的方式,由系统提供的查询模块自动灵活地为用户提示需求信息供用户选择,对非标准的汉字信息字段采用随机扩充,不断地自我完善所需的汉字信息库,一旦确定了随机建立的汉字信息库,在以后的使用中就同样仿效于固定标准汉字库方法,随时查询调用。概率pij=Pr{Z(T1)=j|Y0=i}由pij=Qij(∝)给出,并且在第i个状态的无条件逗留时间的平均值为,其中Qi(x)=Pr{T1≤x|。

图4 摘要信息段处理NS图
　　(3) 基础数据库维护。此后由运行系统负责维护动态执行图。该辅助程序满足于原有计算机信息处理的数据转换连接、修改、维护功能，同时也满足于无计算机管理首次基础数据库维护(如仓库维护、固定资产总库维护、科室(部门)分户库维护)。该辅助程序同样具有本系统良好的用户界面的汉字处理特点。
　　由于其不能同时成立,算法中的单方向的调整就可以保证最终所得为一个全局一致状态。本系统提供了强有力的设备编号自动生成功能，来解决这个棘手又极容易疏忽的问题。假设S到T之间的通信所要求的网络带宽是2γ,因此网络故障是指不能提供从S到T之间所要求的带宽。

　　系统设计在不同的环节上自动形成设备编号。在财产总帐中形成的物资代码＋规格型号的10位设备编号，反映了某规格型号的物资总帐代码。在分户帐中形成物资代码＋规格型号＋科室代码的12位设备编号，对于一般财产物资(如电动吸引器、家具等不需要建立一物一卡的设备、设置)该12位编号已能明确表示了它的内容。对于大型仪器设备则在12位编号的基础上再加上流水号，形成完整的大型仪器设备一物一卡信息的设备编号。
1　用于网络管理的性能及可信度分析模型
1.1　概 念
　　考虑一个由不同元素（例如,链路和节点）组成的可修复的网络。
作者单位：柳颖(南京大学计算机软件新技术国家重点实验室　南京　210093)
　　　　　陈道蓄(南京大学计算机软件新技术国家重点实验室　南京　210093)
　　　　　谢立(南京大学计算机软件新技术国家重点实验室　南京　210093)
　　　　　曹建农(香港理工大学计算系　香港)。
作者简介：陈文 女，32岁，工程师，主研方向：计算机应用软件开发设计
作者单位：上海市第二人民医院设备科 上海 200011
参考文献
1　郑人杰.实用软件工程.北京：清华大学出版社，1991
2　申少军.FoxPro2.5.北京：电子工业出版社，1994
3　Lawrence B.Novell NetWare4.0.北京：清华大学出版社，1995
收稿日期：1998-05-20
