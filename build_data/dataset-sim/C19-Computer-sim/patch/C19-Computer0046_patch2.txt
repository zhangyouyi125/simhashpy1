计算机应用
Computer Applications
1999年 第19卷 第7期  Vol.19 No.7 1999



VAX/VMS与Windows NT间实时文件传输的一种方法
刘鲁川

　　摘　要　作者结合工作实际，论述了FTP服务器的安装配置、客户端的具体操作、改交互的FTP命令为批处理命令和如何在应用系统中实现异种操作系统间的实时文件传输。
　　关键词　FTP，VAX/VMS，Windows NT，实时文件传输

1　问题的提出
　　TCP/IP是网际互连协议，其协议簇中的文件传输协议FTP，具有适用范围广、通用性强、操作简单的特点。但用FTP进行不同操作系统间的文件传输，必须人工干预，在交互状态下完成。这给许多有特殊要求的应用系统带来不便。济南铁路局计算中心有DEC VAX系列机6台，VMS操作系统，其上运行着铁路运输统计报告、精密统计、货运计划、货票传递等系统。Performance还支持第三方厂家的数据文件。本文中简称之为DECnet网。近年来，随着各级铁路机关办公自动化系统的开发应用，VAX/VMS下的主机／终端模式已难以满足办公自动化系统的要求。
3.4　创建索引
　　数据库中一个表可有一个或多个索引，也可没有索引。由此产生的问题是，由于各种生产信息均在DECnet网上，为满足局机关各级管理人员及时了解生产情况的需求，必须使办公自动化局域网与DECnet相连，并实时地无须人工干预地自VMS向NT server传输数据文件。　　
2　传输方案
　　通过TCP/IP协议可实现不同机种、不同操作系统的互联。但用TCP/IP协议簇中的文件传输协议FTP进行文件传输，必须人工干预，在交互状态下完成。虚拟环境的特征是交互性和浸入性。为此，需在VAX/VMS端安装配置TCP/IP for VMS, NT server 端安装配置FTP，系统配置如下图所示。
　　b) 预处理和阀值化(去噪音，改善图像质量并转化为二值图象)，将扫入的图像采用基于图像的边缘检测的“最近有效灰度阀值平均法”对图纸进行净化，尽量除去图中的噪音并且保持图形的原貌。
　　a） 在VMS系统下，很容易实现FTP服务。只要基于TCP/IP协议的网络功能已完整安装并能够正常运行，该机器就可以作FTP服务器使用了，无须任何额外设置。
　　b） 在Windows NT Server 4.0中实现FTP服务。在NT Server 中打开控制面板，作以下安装配置：
　　* 双击网络图标，查看已安装的网络软件，看是否有FTP服务器。
　　在DataBases之上还有两个DBEngine和WorkSpaces对象，即JET引擎，包含一个集合对象WorkSpaces；WorkSpaces对象包含一个数据库集合对象DataBases，Databases集合由Database对象组成。安装完FTP服务以后，要进行必要的配置。主要选项有：最大连接数、空闲超时时间，这两项选缺省值即可；宿主目录用以指定FTP客户连接后要进入的初始目录；不允许匿名连接，只允许用户使用Windows NT的注册帐号来登录。主要研究方向：远程监控网络、现场总线等。一旦有了虚拟现实环境，用户不但可以细看任何结构，甚至可以享有现实世界不可能有的能力，穿越墙壁任意游览。
Dim RecordSetObjVar As RecordSet
′定义记录集对象变量
SQLVar="Select（字段表）From（表格清单）Where（表达式）
′查询语句
Set RecordSetObjVar=DataBaseObjVar.OpenRecod et(SQLVar)
　　关于SQL请参考相应资料。　
4　 FTP客户端的具体操作
　　一旦启动安装、配置好的FTP服务器，在客户端就可以使用FTP命令存取FTP服务器上的文件了。FTP客户程序在以上两种操作系统下具有统一的操作界面，使用起来很象DOS下的命令解释程序COMMAMD.COM。启动后给出命令提示符“ftp>”，在此提示符下可执行FTP命令进行文件传输。


图1
　　ISAM(索引顺序访问方法Indexed Sequential Access Method)用以处理数据库、表、索引、数据类型，JET需要使用ISAM驱动程序。首先使用open命令与FTP服务器建立连接，若连接成功，系统则提示输入用户名、用户口令，口令验证通过后，FTP客户成功注册到FTP服务器上。
3　虚拟现实在水利系统中的应用前景
3.1　用于大型水利设施的设计中
　　由于大型水利设施的建造不同于一般的建筑，它往往投资大，周期长，不可能事先进行试验，比如已建成的二滩大坝，正在建的三峡大坝，坝高都在200米以上，耗资巨大。　　 
5　用FTP批处理命令实时传输文件
　　改交互命令为批处理命令　在VAX/VMS一端，FTP有使用脚本（script）即来自外部文件的命令清单的能力。设定本方案中NT server的Host name为JNOV3B ，以下脚本打开一个Host name为JNOV3B的连接，作为一个帐号、口令均为guest的客户登录到NT server上，卸载FILE1文件，然后退出。
　　Open JNOV3B
　　Guest
　　Guest
　　Put FILE 1
　　Quit
　　在VAX/VMS下必须使用-S选择项来读该文件。如果先前的脚本是在称为test.scr 的文件中，可以通过输入ftp -s：test.scr来启动该脚本。在NT server一端向VMS端卸载文件道理亦然。
　　使用RDC，也可在不用编制程序代码的情况下，使客户机能操作服务器中数据库。其设计思想为：TRF为一常驻后台进程，平时处于睡眠状态，当各前台应用系统，比如铁路统计报告系统中来自各基层单位的上报数据齐全，并汇总成表后，前台应用系统通过系统异步自陷AST例程完成事件标志置起, 激活TRF.EXE，由其提交前述FTP批处理命令脚本，并清除事件标志，以此完成在无须人工干预的条件下，当某一条件满足时，实时实现VAX/VMS与Windows NT Server之间的文件传输。
　　刘鲁川　硕士，工程师。从事MIS开发、Internet/Intranet系统集成、网络配置与管理等工作。
3.4　创建索引
　　数据库中一个表可有一个或多个索引，也可没有索引