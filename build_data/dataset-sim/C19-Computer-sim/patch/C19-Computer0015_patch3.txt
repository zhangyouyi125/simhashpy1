计算机应用
COMPUTER APPLICATIONS
1999年 第19卷 第6期 Vol.19 No.6 1999



Microsoft Access与Oracle的性能比较
刘广钟　刘晓飞
　　摘　要　Microsoft Access是深受微机用户喜爱的关系数据库管理系统，而Oracle主要使用在大中型计算机上，随着Oracle Developer/2000的推出，Oracle也开始在微机上流行起来。本文通过对二者在数据库体系结构、数据互操作能力、数据管理能力、数据安全性、前端用户界面、系统运行效率等方面的比较，阐述了这两种关系数据库管理系统在微机上运行的优缺点。
　　关键词　Access，Oracle，Developer/2000，RDBMS，SQL
1　概述
　　Access 是目前比较流行的一种关系数据库管理软件。
　　定义2：使BSP计算机的p个处理机达到相同任务完成时间的任务分配W，所对应的在处理机P1,P2,…,Pp上的本地性水平 {α1，α2，…αp}，称为 {Pi} 的临界本地性水平，记作
{αci}。而且，可以通过显示在屏幕上的表单来查看Access的数据，也能在打印出的报表中看到它们。作为Microsoft Office Professional家族的一部分，Access 以其方便快捷的特点与Word和Excel一起在微机上得到了广泛的应用。即数据从动态的、当前事件驱动的传统操作数据流向静态的、历史数据的数据仓库。作为一个开放型的分布式数据库产品，Oracle 提供局部自治和场地透明性的功能，并且能在各种形式的异构系统下正常工作，在相当程度上满足了硬件、操作系统和网络的独立性。
　　. 定义详细类别实体。使用每一个指标，同时确定是否存储经过计算的指标。超立方体（hypercube）用超出三维的表示来描述一个对象，显然具备多维特性，完全可以满足数据仓库的多维特性。
　　作为世界上著名的两大软件公司的产品，Oracle和Access都具有各自的优势和缺点，下面对二者作一个综合的比较。
2　数据库体系结构的比较
　　Oracle是一个典型的分布式数据库管理系统，这个系统采用客户/服务器体系结构。在处理机速度相同的情况下，即P*i=1(i=1…p)时，且各处理机上所分配的计算量与通信量完全均衡时，(1)和(3)式可转化为BSP的标准开销模型：
　　C(x)=max wi+max hi.g+L=w+h.g+L
　　Ti=Tcompi+Tcommi+Tsyni=(w+h.g+L)/S
　　其中：{pj的本地计算时间}，{pj的机间通信时间}，S为构成BSP计算机的单个处理器的执行速度。多个服务器上的数据库对用户来说，是一个逻辑上的单一数据库整体，数据一致性、完整性及安全性都是对这一逻辑上的单个数据库进行控制的。一般来说，星形图中的指标实体和详细类别实体通常转变为一个具体的物理数据库表，而维度实体则作为查询参考、过滤和聚合数据使用，因此通常并不直接转变为物理数据库表。Oracle分布式数据库系统结构如图1所示。
　　BSP模型指导下的并行程序设计[3]具有编程简单、独立于目标结构和执行性能可预测等特点。它的数据表（Tables）及存放在表中的完整性约束条件作为“后端”，由数据库管理员统一进行管理。“前端”开发工具构造的应用程序通过与数据库联接（Connect）来操纵“后端”的数据。用户利用维度实体来访问指标实体，其实质对应着逻辑数据实体，一个维度实体对应信息包图中的一个列。

图1　Oracle分布式数据库体系结构
　　Oracle提供了一个完整的客户/服务器体系结构的DBMS。利用SQL*NET软件层，与多种操作系统支持的通信协议相配合，为Oracle RDBMS提供分布式处理环境，可实现单点更新，多点查询。
　　与Oracle不同，Access的设计者决定将表格与用户接口组件和代码一起存储，完整的数据库和所有相关的对象都存储在磁盘上的一个文件中。这样，用户可以很自由地管理和使用所有属于自己的数据及相关的对象。然而，从开发易于别人使用的Access数据库的观点来看，这种明显的设计优点很可能实际上是一个不利条件。在需求分析阶段确定操作数据、数据源以及一些附加数据，设计容易理解的数据模型，有效地完成查询和数据之间的映射。一个维度实体对应指标实体中的多个指标。
3　数据互操作能力的比较
　　Access提供了两种方法来获取外部数据源：链接和导入。具体的编程方法、正确性检查、性能分析等方面仍然处于经验阶段，且易于出错。Access可以自动实现上述异种数据库向Access数据库的转换。如果以上文件类型仍不能满足用户需要，还可以通过ODBC数据源调入所需要的数据库文件。在Access中可以用VB实现对ODBC的编程。具体的编程方法、正确性检查、性能分析等方面仍然处于经验阶段，且易于出错。用户可以利用它提供的开放客户适配器（Open Client Adapter），通过对ODBC编程来实现上述功能。目前，Oracle支持Microsoft SQL Server、Microsoft Access和Rdb等几种ODBC数据源。Oracle在实现异种数据库的互操作方面还有一定的局限性。
4　数据管理能力的比较
　　任何关系数据库管理系统（RDBMS）的首要功能都是检索和显示所存储的信息。Oracle通过使用SQL的SELECT语句来实现这一功能。SQL的SELECT语句有6个子句，通过它们可以很简单地将一个表单中的数据显示出来，也可以实现涉及多个表并且要根据表中数据进行计算的复杂查询。除了查询以外，Oracle还可以通过SQL语句简单地实现数据的插入、更新、删除等操作。另外，Oracle 还提供了大量的函数。通过这些函数，可以实现一个或多个数据表（Table）之间的批量数据操作。
　　Oracle提供了两种语言对数据库进行存取：SQL和PL/SQL。SQL是一种标准的结构化查询语言，Oracle通过它实现了与诸多数据库的兼容性。利用Oracle提供的SQL*Plus工具执行SQL命令。在这里，用户既可以执行一条一条的SQL命令，也可以编写一段SQL程序来操纵数据。PL/SQL即模块式的过程化SQL，它具备了许多SQL中没有的过程化属性方面的优点，其中包括：模块化结构、允许使用定义标识符、用过程化语言控制结构进行程序设计、错误处理、高操作性能等。理论上LogP的超步不必像BSP那样受接收或发送消息数目的限制，且超步之间无需显式的同步操作，算法的设计似应更加方便和灵活。

图2　SQL语名的执行

图3　PL/SQL块的执行
　　与Oracle不同，Access一般不支持用户直接书写SQL语句来操纵数据。
2.1　概念模型设计――信息包图
　　概念模型设计也就是通常所说的需求分析，在与用户交流的过程中，确定数据仓库所需要访问的信息，这些信息包括当前、将来以及与历史相关的数据。[S]：检测两个一维数组A[n]和B[n]相乘的开销，其中n远远大于每个处理器的cache大小，大部分计算操作可在cache内完成，这样求出处理器速度的上限(可多次循环以减少误差)。在需求分析阶段确定操作数据、数据源以及一些附加数据，设计容易理解的数据模型，有效地完成查询和数据之间的映射。为了方便用户，Access还提供了建立数据表（Table）、查询、报表、用户界面设计等的创建向导（Wizard）。超立方体（hypercube）用超出三维的表示来描述一个对象，显然具备多维特性，完全可以满足数据仓库的多维特性。宏是指一个或多个操作的集合，其中每个操作实现特定的功能，例如打开某个窗体或打印某个报表。宏可以使某些普通的任务自动完成。例如，可设置某个宏，在用户单击某个命令按钮时运行该宏，以打印某个报表。Access已经提供了近50个宏供用户使用，用户还可以自己编写宏来实现所需的操作。在Database窗口的模块（Module）标签中，用户可以编制自己的VB 程序段。
2.3　数据库物理模型设计――星形图转换为数据模型
　　从逻辑模型――星形图转向物理模型设计，完全遵循传统的数据库设计方法。用户可以通过窗体上的VB控件调用这些程序段。
5　数据安全性的比较
　　数据库安全性是指保护数据库以防止不合法使用，其重要作用就是保护数据库中的数据，避免数据被有意或无意地泄露、丢失以及破坏性地改变。
　　Microsoft Access 提供了设置数据库安全的两种传统方法：为打开的数据库设置密码，或设置用户级安全，以限制允许用户访问或更改数据库的哪一部分。此外，还可将数据库保存为 MDE 文件以删除数据库中可编辑的 Visual Basic 代码以防止对窗体、报表和模块的设计进行修改。
　　为打开的数据库设置密码是一种最简单的方法。设置密码后，只有键入正确密码的用户才可以打开数据库。以下结合多种代表性计算模型，给出适合于异构网络计算环境的程序设计和开销计算方法。
　　为打开的数据库设置密码的缺点是系统只在打开数据库时检查密码，在数据库打开之后，数据库中的所有对象对用户都将是可用的。利用信息包图设计概念模型需要确定三大内容：
　　. 确定指标。当代码难以并行且并行进程产生处理器之间的大量不规则通信时，消息传递库函数的使用将变得很困难。BSP程序由于其超步的结构使消息传递操作不会出现死锁，同时在正确性、性能分析和编程方法上都简单易行，很适合异构环境下的消息传递编程。
　　. 确定类别。在工作组信息文件中，用户标识为组的成员。Microsoft Access 提供两种默认的组：管理员（称为管理员组）和用户（称为用户组），但也可定义其它的组。
　　Access的数据库管理员可以为组和用户授予权限，规定他们如何使用数据库中的对象。例如，用户组的成员可以查看、输入或修改“顾客”表中的数据，但不能更改表的设计。或者只允许查看包含定单数据的表，而不能访问“工资”表。管理员组的成员则对数据库中的所有对象都具有完全的权限。如果要设置更细致的控制，可以创建自己的组帐号，为其指定适当的权限，然后将用户添加到组中。一般来说，星形图中的指标实体和详细类别实体通常转变为一个具体的物理数据库表，而维度实体则作为查询参考、过滤和聚合数据使用，因此通常并不直接转变为物理数据库表。Oracle提供了与Access类似但比Access强得多的安全机制。Oracle前后端的独立性为它的安全性提供了良好的基础。该系统在实现安全性管理时采用了如下措施：①通过验证数据库用户名和口令，防止非Oracle用户注册到Oracle数据库，对数据库进行存取；②赋予不同用户不同的权限，限制用户操纵数据库中数据的权利；③赋予不同用户对数据库实体的存取权限；④提供数据库实体存取审计机制，使用户可以监视数据库中数据的存取和系统的使用情况；⑤使用视图实施安全性控制。
　　Oracle的数据库管理员（DBA）可以给数据库的访问和数据库实体的存取予以授权。
　　从图1和表1中可以看出，3种不同性能处理机间分别交换3种不同数据类型的消息，通信时间基本是通信消息大小的线性函数，各个不同处理机间的通信启动开销基本相同，当发送消息的类型变化时(从char,integer到double)，表示通信速度的斜率基本与消息大小保持一致。Oracle7完全支持ANSI/ISO标准所申明的完整性约束，可以将完整性约束条件写在数据表中，不用编程就可以实施所有实体完整性和引用完整性规则。
1 并行计算模型
　　并行计算模型是一个将高层次特点与低层次特性分离开来的界面，提供在其上进行编程的特定操作，对其下所有结构中每个操作的实现作出要求。Oracle可自动检测和解决所有故障，确保所有场地上一同提交或一同撤消。

图1 异构处理机系统中机间通信结果示意图
表1 异构系统机间通信不同类型消息的斜率

处理机斜率
发送消息类型：char发送消息类型：integer发送消息类型：double
Sun USparc-Sun Creator0.1143210.4054830.756228
Sun USparc-Sun USparc0.1124040.3995760.746370
Sun E450-Sun USparc0.1184140.4054830.756047

　　在一个超步中，设处理机Pi需要发送的消息集合为H={h1,h2,…,hk}，其中hi表示消息的长度，一般情况下消息数目k与问题规模相关，显然有k>>p。
6　前端用户界面的比较
　　作为Microsoft的一个拳头产品，Access提供了十分方便的用户界面。
1.5 并行计算模型小结
　　与BSP相比，LogP在三方面有所不同：(1)LogP采用基于pairwise同步的消息传递方式；(2)LogP增加参数o，以表示发送消息时所需额外开销，而BSP中除应用于单个消息通信外，这个参数一般可以忽略；(3)LogP模型中的g是从局部的角度来定义的。
2.1　概念模型设计――信息包图
　　概念模型设计也就是通常所说的需求分析，在与用户交流的过程中，确定数据仓库所需要访问的信息，这些信息包括当前、将来以及与历史相关的数据。Access支持各种VB控件，并且与Windows操作系统做了很好的衔接。Access还提供了大量的设计模板和智能设计功能，方便易用。
　　Developer/2000是Oracle提供的前端开发工具。通过这一工具，用户可以使用面向对象的方法来开发图形用户界面的应用程序。Oracle提供SQL*Forms使用户可以开发和执行基于表格（Form）界面的应用程序。Oracle的SQL*Reports是一个强有力的报表工具软件，可以用来生成各种报表。在每个超步中，每个处理器均执行局部计算，并通过网络接收和发送至多h条消息(称为h-relation)，然后作同步检查，以确定该超步是否完成。信息包图提供了一个多维空间建立用户信息模型的方法，它提供了超立方体的可视化表示。虽然可以通过加载VBX控件来扩充工具箱，但受限较大。并且，Oracle Developer/2000的智能性较差。从总体上来说，Oracle Developer/2000比Access要稍逊一筹。
7　运行效率的比较
　　Access对数据的操作是借助于SQL语言完成的，SQL具有较高的执行效率。两者相比，BSP模型更具有结构性，也更加简单。这就需要重新考虑通信与计算的重叠在异构网络环境中的实用性，重叠最多可以使并行计算的速度加倍，实际加速比远小于此，大部分并行算法的计算量比通信量增加得快，所以在设计程序和算法时应合并发往相同处理器的消息。Oracle从第7版开始采用了多线索服务器体系结构，能在所有硬件体系结构上为大量用户提供可扩充的高性能。Oracle还采用了自协调的多线索服务器体系结构，根据当前工作负荷，动态调整数据库服务器进程的个数。一个维度实体对应指标实体中的多个指标。若代码具有清晰的并行结构和较少且规则的通信，则易于实现。Oracle7提供基于成本的智能查询优化器，系统根据表中的行数、索引等统计信息，决定最有效的存取路径。BSP程序由于其超步的结构使消息传递操作不会出现死锁，同时在正确性、性能分析和编程方法上都简单易行，很适合异构环境下的消息传递编程。当多个维度实体相关并且存在共性时，可能需要将其合并为一个指标实体。其重点在于完成事务处理，在瞬间的时间里给予用户响应。从事网络技术及分布式数据库系统的研究。令Sj为处理机Pj的计算速度，bj为处理机忙闲度，s'j=sj・bj为实际计算速度。
作者单位：中国矿业大学计算机科学与技术系　江苏.徐州（221008）
收稿日期:1999-03-16(修改稿)
