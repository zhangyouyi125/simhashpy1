计算机应用
Computer Applications
1999年 第19卷 第7期  Vol.19 No.7 1999



集散式能源测控系统的实现
吴　琳　李　锐　谭南邻　韩　松

　　摘　要　本文结合一个卷烟厂电力监控系统的具体实例，说明能源测控系统的整体设计思想与实现方法，详细描述了系统的集散式体系结构，概括了系统通信网络的设计思想和系统可靠性的实现策略。
　　关键词　能源测控,集散系统,体系结构,可靠性

　　典型的卷烟企业是连续制造流程型传统产业，其生产流程耗气和耗水量较大，用量波动也较大，而生产设备对供电质量有越来越高的要求。能源测控系统针对企业的上述情况，从能源站、生产车间到主要设备进行能耗的多级管理，通过对能源的合理调度和主要指标的控制，达到稳定生产工艺、规范管理、节能降耗的效果。
　　根据对能源测控系统用户需求的分析，制定了分散控制、集中操作、分级管理、综合协调的设计原则，它应具有典型集散式系统的体系结构特征。在具体设计中，考虑在线实时检测与控制的可靠性和稳定性，我们运用了工控机与可编程控制器相结合的方式。实际运行的系统效果良好，保障了企业的生产和产品质量创造了显著的效益。■
作者单位：姜山(上海交通大学存储研究中心 200030)
参考文献：
［1］Dean J.Petrone, Michael D. Stackhouse PC-Based Control Goes Real-ti me Control Engineering.Apil 1998
［2］Martin Timmermon, Windows NT Real time extensions better or worse。
　　4.院团委信息查询
　　针对于院团委各项信息(第1项)的各种信息查询。
1　系统的体系结构


　　集散控制系统将计算机技术、控制技术、通讯技术和图形显示技术融为一体，其主要特性是集中管理和分散控制的统一。
四、系统特点
　　本系统有以下几方面的持点
　　1.系统已具备网络运行能力
　　由于本软件将投放到校园网中，所以在编制时按网上要求来设计，该软件将作用于前后台，完成后台服务和前台浏览修改工作。
　　在本系统设计中，考虑能源系统要易于扩展和升级的需求，在集散系统的总体结构上兼具分布式的特征。
二、Windows 9X下实时进钟的获得
　　在实时控制中中断技术应用得十分广泛，其中实时时钟的获得基本上都是通过中断来实现的。通过对源代码的分析说明了实时硬件中断VxD的实现过程。
五、结束语
　　由于本软件采用windows98系统平台，网络环境设计，所以非常适合于校园网中运行，同时该软件涉及面广，实用价值强，再加上强大的查询功能，友好的人机界面，具备一定的推广价值。
三、功能介绍
　　本软件为了使结构清晰，功能独立性强，模块化分比较详细，具体来说有以下平行的9大模块，现分别介绍如下：
　　1.院团委数据录入
　　该模块主要完成院团委有关的信息录入修改等工作，具体内容为：院团组织分工，院团校信息，文件目录，奖项，人才库，院学生会，院社会实践团体，志愿者服务队。两台PLC控制器通过RS485与3#站相连,由PLC控制器实现有载调压功能。该设计在实际应用中取得了非常好的效果，兼顾了系统的可扩展性和可维护性。
1.2　控制管理级
　　能源测控系统中的主要功能如流程显示、控制调节、数据存储、报表打印、报警提示、趋势分析、数据通信、系统维护等均在控制管理级实现，因此该级是测控管理的中心环节，也是系统网络的核心部分。
　　为保证24小时不间断运行中的系统可靠性，采取了双机热备份的系统结构。
　　2.简便的使用方法
　　由于我们面向不同层次的使用者，故界面清晰，图文并茂，语言描述详尽，一看就懂，一学就会，容错性能好，自动化程度高。主动刷新是工控机A（或B）故障后重新启动时，自动拷贝工控机B（或A）的数据库，用B（或A）的数据刷新自己的数据；被动刷新是工控机A（或B）通过邮件槽发送消息，通知对方刷新数据库。实际编程中经过不断的优化和测试，数据的一致性问题得到了圆满的解决。
　　9.报表功能
　　完成以上各模块中所需提供的各种报表。
　　系统管理级通过网络接口与全厂的企业内部网相连，成为企业管理信息系统的一个节点，又是全厂CMIS中能源部分的一个基础组成。
2　系统的通信网络
　　通信网络将物理上分散配置的现场控制单元、智能I/O站、控制管理计算机和系统管理计算机通过高速数据线连接起来，构成完整的运行体系，它是集散式能源测控系统的神经中枢。
　　工业测控系统中通信网络主要要求实时性和可靠性，为此，在设计该电力监控系统时，上层网络选用标准以太网（Ethernet），而其底层网络则采用了国际标准中具有更高可靠性的工业现场总线――控制器局域网CAN（Controller Area Network）组网技术。
　　将系统管理级和控制管理级通过Ethernet网连接，使用了三个SN2000以太网卡和同轴电缆，控制管理级的两台工控机和系统管理级主微机构成一个小型以太网(Ethernet)，采用总线型结构。而VxD是通过VtoolsD 2.04编写的。利用Delphi3.0软件开发平台中提供的网络构件，可以很容易地实现这一层的数据通信。
　　8.系统数据维护
　　包括用户帐号，密码的维护，数据库的备份及还原，毕业生处理。
　　在集散式系统中，控制管理级和现场控制级之间的数据通信是一个需要认真解决的难题，以往曾采用过RS-485协议和其他总线技术，在工业现场实际运行中其抗干扰能力和数据速率、数据误码率等主要指标均难以满足要求，本系统采用CAN总线技术。CAN是一种多主总线，具有简化的网络结构和开放性、实时性的特点，是一种有效支持分布式控制或实时控制的串行通信网络。
三、功能介绍
　　本软件为了使结构清晰，功能独立性强，模块化分比较详细，具体来说有以下平行的9大模块，现分别介绍如下：
　　1.院团委数据录入
　　该模块主要完成院团委有关的信息录入修改等工作，具体内容为：院团组织分工，院团校信息，文件目录，奖项，人才库，院学生会，院社会实践团体，志愿者服务队。经过近两年的实际应用证明，它可以为工业控制级的数据通信提供比较有效的运行支持。
二、Windows 9X下实时进钟的获得
　　在实时控制中中断技术应用得十分广泛，其中实时时钟的获得基本上都是通过中断来实现的。就系统本身的构建而言，最重要的是其可靠性设计。VMM和VxDs共同构成了Windows Ring 0层的系统内核。
　　6.团员青年基本信息查询
　　可按各种复杂条件查询团员青年个人及小团体的各种数据。通过对源代码的分析说明了实时硬件中断VxD的实现过程。
　　* 模拟信号转换为数字信号后，均经过一级软件滤波，从信号源头保证模/数转换的正确性，并进一步提高信号传输信噪比。
　　* 模拟信号、变送器信号采用RVV双绞屏蔽线敷设，屏蔽层单端接地。
　　开发虚拟设备驱动程序(VxD)的常规方法是使用Microsoft出品的设备驱动程序开发工具包DDK(Device Developer Kit)。选用有高频滤波、稳压、隔离、无触点切换等措施的UPS，以确保在外围电网有事故发生瞬间系统仍能有效地监测。
四、系统特点
　　本系统有以下几方面的持点
　　1.系统已具备网络运行能力
　　由于本软件将投放到校园网中，所以在编制时按网上要求来设计，该软件将作用于前后台，完成后台服务和前台浏览修改工作。我们在该系统中采用多级的冗余与容错措施，取得了明显效果。
　　现场控制级，智能工作站1# 和2# 同时采集功率变送器输出的脉冲信号，即使其中一台工作站出现故障，另一台仍能保证累计数据的准确不丢失。此外，在当今的计算机控制领域中，控制软件是否基于Windows平台已经成为产品是否有竞争力的重要标准之一［1］。双机在工作过程中，定时比较本地硬盘与网络硬盘上参数文件的时标，并以最新时标的文件覆盖本地硬盘上的文件。这样控制管理级的双工控机就能保持所采集的各种电量参数的一致性。
　　综上所述，将集散式体系结构具体应用在能源测控与管理系统的设计与构建，它使该系统在各层次上形成开放系统，实现了企业能源的集中管理、准确计量和合理调度，它将为保障企业生产运行，稳定产品质量产生显著的效益和长远的影响。
　　吴　琳　工程师。从事工业控制和计算机应用开发工作。
　　李　锐　硕士研究生。主要研究方向：工业控制，管理信息系统。在这里我们只用到了VPICD提供的五个不同的与IRQ相关的通知事件之一，即实际的硬件中断事件