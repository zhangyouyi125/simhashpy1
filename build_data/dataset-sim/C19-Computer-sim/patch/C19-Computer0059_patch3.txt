计算机工程
COMPUTER ENGINEERING
1999年  第25卷 第7期 Vol.25 No.5 1999



基于Browser/Server体系结构的XFMIS设计与实现
杨莹 刘献忠
摘要 介绍了一种基于Browser/Server结构，设计和开发全省消防综合信息管理（XFMIS）的方法。
　　关键词　住宅小区建设,智能化集成系统
　　
1　智能小区建设概况
　　在我国步入信息社会和强调知识经济的今天，随着社会进步、科技发展以及人类对生产、生活环境要求的提高，智能住宅小区建设必将在我国得到很快的发展。
关键词 企业网 浏览器/服务器结构 信息管理系统
The Design and Realization of XFMIS Based on Browser/Server Architecture
Yang Ying Liu Xianzhong
Information Engineering College，Changsha Railway University Changsha 410075
Abstract：In this paper，the methods of designing and developping XFMIS based on Browser/Server architecture are in toduced.The design,pivotal technology,and major functions are analysed emphatically.
Key words：Intranet；Browser/Server architecture；MIS
　　消防综合信息管理系统(以下简称XFMIS)的设计是综合了Intranet技术的最新发展以及传统Client/Server结构的优势，我们本着基于开放的硬件平台，开放的软件系统，以实现高性能、高可靠性、高可用性及高可维护性等系统集成原则，设计和实现了该系统。(仿真图略)　　
3　改进后的电路及其分析
3.1　改进后的电路原理及定性分析
　　针对原设计的不合理处，在不影响正常导通的前提下，增加了一只稳压管，提高了击穿电压，去掉了R34，并将抗干扰电容前移，使C30有了合理的充放电回路。从而使消防系统事务决策更加科学化，以适应消防工作的新形势。
1　系统主要功能及特点
　　XFMIS是一个以消防系统内部计算机网络为硬件平台的大型综合管理信息系统。
　　C) 信息服务
　　包括向住户发布小区信息、提供社区服务等。原始文件可以以任何工具形成(如支持WPS、微软OFFICE软件编辑、扫描输入、录音、录象等)。　
2　小区智能化建设方面的社会需求
　　我们设计并实施的世纪王朝建筑小区是一个面向二十一世纪的智能化建筑小区，小区内设综合写字楼与高档住宅公寓，文化娱乐设施齐全。可统计分析消防产品在全省的销售、使用状况。变电站均采用220V直流电源作为断路器操作电源及各装置工作电源。如果只顾及准确性，就要以较长的时间为代价，无法满足电力系统对开关量变位时间分辨率的要求。该子系统提供多种统计方式，可以任意图形(如饼图、柱图等)显示统计结果，为管理部门的辅助决策指挥提供科学依据。(4)建筑防火图纸审核信息管理子系统 用于管理建筑防火图纸、审核信息以及建筑自动消防设施设计、安装、装修单位的档案信息。
　　在进行XFMIS系统的设计时，引入软构件思想。该系统由一系列既可独立安装作用，也可有机集成的软构件所组成，用户可以根据需求组装其中的构件，以形成自己的综合信息服务系统与办公自动化。系统具有以下特点：
　　・先进开放的信息平台　基于开放式网络、分布式数据库管理系统和Client/Server与Browser/WEB Server相结合的计算机方式等90年代先进的Internet/Intranet模式，规模优化，为消防系统提供了跨世纪的平台解决方案。
　　・灵活可扩充的系统应用　在XFMIS中充分融入了面向对象、软构件组装的设计思想和开发技术。XFMIS中提供了一系列软构件，可任由用户选取以组装成满足自身需求的信息系统。
　　流过Idt=1.5mA电流时，光耦将可靠导通，此时脉冲电压为：
U10=((Idt*R34+UD45)/R30+Idt)*R23=197V 
　　可见，当干扰电压大于197V时，Dout导通，监控系统会误报遥信变位信号。
　　・友好易操作的人机交互方式　系统采用以Netscape Navigator或MS Internet Explorer为主体的浏览器界面，以文字、图形、图象、声频、视频等多媒体为信息的表现方式，尽量跟日常工作习惯一致，适合于消防系统中各层次、各专业的管理人员操作作用。
2　XFMIS系统设计
2.1　系统开发平台
　　(1)网络操作系统
　　考虑到网络技术的发展潮流、本系统的基本需求以及系统设计基本原则，在众多可选的网络操作系统中选择适合本系统的网络操作系统时，应遵循以下原则：1)符合国际和工业标准、支持基于浏览器的客户机／服务器结构；2)具有较好的硬件独立性、多服务器支持能力、多协议和网络互连功能；3)网络管理，可帮助网络管理员管理网络、查找网络和最佳地配置服务器；4)安全性及访问控制，通过对用户和资源的控制保证网络系统的安全，具有良好的网络安全功能是保证网络正常运行的重要前提；5)具有较强的容错能力、良好的应用支持、友好的用户界面。
　　选择网络操作系统的准则在许多情况下，仍要根据实际的情况决定。目前，这类产品的主要代表有：Microsoft公司的Windows　NT、Novell公司的NetWare以及Unix等。
　　以下波形是用MicroSim Eval 7.1软件仿真模拟原设计电路的结果。
　　(2)数据库服务器平台
　　数据库系统是XFMIS最主要的组成部分。因此，数据库平台的选取就变得非常重要。数据库平台必须具备以下特点：1)良好的客户／服务器体系结构；具有良好的Web Server功能；2)对异构数据源的访问能力；提供对分布式数据的控制；3)很高的可靠性和安全性；4)支持大量的联机用户；5)支持第三方的第四代GUI开发工具，包括CASE工具、数据库维护(或Client端开发)工具、查询开发工具等。
　　目前，SQL Server、Oracle,Sybase,Informix等数据库管理系统基本上能满足上述条件。
3．5　一卡通与物业管理系统
　　小区用户人手一卡，进出系统允许的各类门禁（小区门禁、楼道门禁、住户房门、停车场等），到小区各公共设施（保健所、康乐中心、商场、信息亭等）持卡消费。
　　Microsoft SQL Server 6.5在满足OLTP、大吞吐量、数据仓库的应用上略有不足，但它价格便宜、又可能通过数据网关与其它数据库互相访问，所以在各消防支队选用Microsoft SQL Server 6.5作为数据库服务器。
　　Sybase SQL Server是最先完全基于Client/Server结构而开发的大型数据库产品，具有智能事务处理能力和容错能力，并强化了服务器中数据的完整性和事务处理的灵活性，而SQL Server 11.5具备一整套分布式及Internet/Intranet解决方案，所以在消防总队选用SQL Server 11.5作为数据库服务器。
　　(3)客户(浏览器)端开发工具
　　客户端开发工具包括：PowerBuilder 6.0、InterDev 1.0、Visual B++5.0、FrontPage 1.1。
　　在XFMIS中，应用PowerBuilder 6.0开发综合查询统计、数据维护等应用：应用InterDev 1.0开发数据统计时的图形报表应用；Visual B++5.0用于开发ASP应用程序；而FrontPage 1.1主要用于制作Web页面。
2.2　系统网络拓扑结构
　　(1)网络设计原则
　　考虑到各种可能出现的情况和网络最新技术的发展，归纳如下网络设备选择原则：
　　・可靠性　即必须具有长期连续工作的能力和容错能力。小区业主对该建筑小区的智能化与信息化提出较高的要求，主要包括对小区用户实行人身财产安全及生活环境质量的管理，实现保安智能化；对小区公用设施设备实行自动监测，采用计算机进行集中监控，实现设备运行管理智能化；将市话局光纤电缆引入小区，为用户提供现代化的通信设施及通信手段，实现通信智能化；为综合写字楼区与小区物业管理中心配置计算机局域网，提供现代化的经营与办公环境，以实现经营、办公系统智能化；为高档住宅区住户提供家庭娱乐，证券投资，网上信息浏览及网上购物的现代化手段与相关信息服务；小区内实现一卡通，在物业管理中心进行综合信息集中管理、统一结算，实现综合信息管理智能化。
　　・可管理性　即对网络活动进行控制和管理，网络管理员能够在不改变布线系统的情况下，对网络进行修改。
3．2　小区水、电、气集中抄表结算控制系统
　　该系统是以计算机网络为基础，将一个区域内的水表（冷水表/热水表）、电表、煤气表通过采集器、主控机与计算机相连，实现水、电、气抄表自动化，排除人工抄表的人为误差；系统通过与银行联网，可实现各种费用结算的自动化，并提供电话查询、转帐及催款等功能；系统可随时对水、电、气的使用进行控制，为小区电力负荷的控制、平衡和调整水电气的供应量提供科学依据，对不能及时交费的住户，可停止水电气的供应。
　　・可预见性　在进行网络系统设计时应体现出超前性，使得网络在急骤扩张时亦不需要重新进行网络规划和设计，使现有网络结构与应用需求同步增长。　　
1　分析方法
　　用电路解析法和计算机仿真手段分析原设计及改进设计电路在正常状态，脉冲干扰，交流干扰条件下的工作性能。
　　(2)XFMIS网络结构
　　根据省、地、市消防系统基本情况，考虑以上所述网络设计原则，结合当前网络技术发展状况，我们选择以交换技术为中心、快速以太网为骨干的组网方式，并采用Cisco公司的网络产品作为省、地、市级网络系统的首选网络产品。它通过一个高度集成的通信和计算机网络，把小区的安防、物业、服务及公共设施连接起来，实现智能化和最优化，为住户营造一个自由、安全、舒适、温馨、方便的居家生活环境。　　


图2　干扰脉冲对原设计的影响

2.3　低电压状态时的可靠性分析
　　若变电站直流系统电压较低为200V，则电路分析如下：(I1+I2)*R23+1.7+R30*I2=UIN
((I1* R34+UD45+1.7)/R30+I1)*R23+1.7+I1*R34+UD45+1.7=200
((I1* 6.2+18+1.7)/30+I1)*82+1.7+I1*6.2+18+1.7=200
　　在此情况下，流过光电耦合器件的电流只有I1=1.32mA。采用1台Cisco远程访问路由器Cisco 2511,提供16个远程拨入端口,每个端口串连接一个V.34的28.8kbps的高速调制解调器，为各地、市支队以及远程移动用户等提供一个通过PSTN电话网访问总队网络的接口；Cisco 2511还用1条以太网线路与中心交换机Cisco Catalyst 1900相连。这一改进在现场实践中已取得了令人满意的结果，以下将作定量分析。但后半个周波中，稳压管截止，电容放电。在电信部门能够全面提供帧中继服务时，可考虑将广域网改为帧中继连接方式，速率均可达64kbps至2Mbps，原配置的网络设备均可支持，不需另购网络设备。网络系统如图1所示。

图1 XFMIS系统网络结构
3　系统实现中采用的关键技术
3.1　异构数据库访问技术
　　IIS(Internet Information Server)是Windows NT 4.0提供的与数据库有关的Server。
　　小区的物业管理是运用先进和科学的方法与手段，对小区建筑的环境、安全保卫、租赁业务、机电设备运行与维护实施一体化的专业管理，向小区的使用者与承租户提供高效和完善的优质服务，实现小区内人、财、物的科学管理。具体的集成策略如图2所示。

图2 NT Web Server与DBMC的集成策略
3.2　系统安全性策略
　　由于XFMIS是针对消防系统业务信息的综合信息管理系统，在系统中，包含各种重要业务数据，系统的安全性显得非常重要。安全的核心是人，必须以人为核心进行安全管理，采用各种先进的安全技术，使系统免受非法攻击，排除没有访问权限的使用者窃取系统机密信息，确保系统安全可靠地运行。小区各家庭装上一台多媒体计算机，通过智能小区的综合网络，即可与Internet以及其它话音、数据图像信息服务终端相连，享受各类信息服务。
　　(1)口令识别　它是一种低成本、易实现的用户识别技术。但软件延时的设定容易出现随意性，而电力系统对于开关量变位信号要求达毫秒级，不宜采取此类软件延时措施。(仿真图略)　　
3　改进后的电路及其分析
3.1　改进后的电路原理及定性分析
　　针对原设计的不合理处，在不影响正常导通的前提下，增加了一只稳压管，提高了击穿电压，去掉了R34，并将抗干扰电容前移，使C30有了合理的充放电回路。　　


图1　原设计电路图
　　从图中可见，在V10输入端有干扰脉冲时，抗干扰电容C50在初始时刻将与光电耦合器件Dout分担流过的电流，而光耦的导通电流仅需约1mA，即光电耦合器件Dout将立刻导通，C50被旁路，充电过程被终止。
　　(3)访问权限控制　访问控制技术是在保护资源安全的前提下实现资源共享，以访问控制表的形式来规定主体(如用户)对客体(如文件、数据为、设备)的访问权限(如可读、可写)。
3．3　计算机综合网络系统
　　小区的综合网络是指小区内各功能子系统的终端设备与监控中心及外部信息源相连接的线路网络，用于传递各系统的信息和控制信号，为用户提供电话、计算机信息、物业管理、日常生活等服务。
　　(4)防火墙　采用防火墙技术是为了确保内部网络能与外界通信的同时,减少来自外界的侵害。
　　智能小区是面向二十一世纪的住宅小区，是信息时代的产物。网络级防火墙简洁、速度快、费用低，并且对用户透明。但是它只检查地址和端口，不能理解网络更高层协议的信息，因而对网络的保护有限。
4　结束语
　　XFMIS系统于1998年5月开始在某省消防系统安装并投入运行,不仅解决了消防系统在实际工作中的各种难题,而且带来了可观的经济效益。写字楼用户与物业管理员工的IC卡还可作为考勤卡，方便公司对员工的管理。
作者简介：杨莹 女，28岁，硕士，主研方向；计算机应用与研究，Internet/intramet及MIS
作者单位：长沙铁道学院信息工程院 长沙 410075
参考文献
1　The White Paper of Internet/Intranet Strategy.Netscape Corpora-tion，1996
2　Nguyen T.Accessing Relational Databases from the World Wide Web.SIGMOD'96，ACM，1996-04
3　Microsoft SQL Server 6.5 Deployment Guide.Microsoft Corpora-tion，1997
收稿日期：1998-01-13
