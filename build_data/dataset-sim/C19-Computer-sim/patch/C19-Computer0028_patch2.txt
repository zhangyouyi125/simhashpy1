计算机应用
Computer Applications
1999年 第19卷 第7期  Vol.19 No.7 1999



电子商务及相关技术
程代杰　刘卫宁

　　摘　要　本文分析了电子商务的进展及其带来的深远影响，论述了它所涉及的主要技术及解决方案，以及我们应如何把握这次新的机遇。
　　关键词　电子商务，网络平台，系统安全，运作方式
　　
ELECTRONIC COMMERCE & ITS RELATED TECHNIQUES

Cheng Daijie　Liu Weining
Computer Science & Engineering College, Chongqing University, Chongqing 400044
　　Abstract　In this paper, the rapid development and importance of electronic commerce are analysed. The network platform、system security and application solution for electronic commerce are introduced. Finally, how to face the new opportunity is discussed.
　　Keywords　Electronic commerce, Network platform, System security, Application solutions

　　Internet的出现与发展已显示出其惊人的魔力。它的巨大潜力将会使人类生活得更加美好。最终，Internet会将全球的人联系起来，突破时间和空间的约束，使大家共同在这个网络上生活、学习、工作、娱乐、交易……从而导致人类经济、社会和文化的一次新的革命。
　　当前一个不容置疑的事实是电子商务正在向我们走来。hDevice=CreateFile("\\\\.\\irqtest.vsd",0,0,0,OPEN-ALWAYS,FILE-FLAG-DELETE-ON-CLOSE,0);
需要挂接中断时，调用DeviceIoControl()将主程序窗口的句柄传递给正运行的VxD。
　　美国政府早在1993年就在NII行动计划中确定了电子商务是重大信息建设项目。1996年发布了“全球电子商务框架”。1997年发布了“全国电子商务纲要”。在Windows 95 control messages选单中选中W32-DEVICEIOCONTROL消息、SYS-DYNAMIC-DEVICE-INIT消息及SYS-DYNAMIC-DEVICE-EXIT消息。IBM、HP、SUN等国际著名信息产业公司纷纷提出了电子商务的策略和解决方案、相应的平台技术以及电子商务的工具软件等，并称1998年是它们的“电子商务年”。圣诞节期间，美国更掀起了网上购物的热潮。
　　欧洲，1997年欧盟委员会发布了“欧盟电子商务倡议书”，强调欧洲必须加强合作，致力于发展电子商务。同年，欧盟和美国又发表了有关电子商务的联合宣言，就跨国电子商务有关原则达成一致。
二、Windows 9X下实时进钟的获得
　　在实时控制中中断技术应用得十分广泛，其中实时时钟的获得基本上都是通过中断来实现的。
　　亚洲，近年虽处于“金融风波”，但日本仍推出了大规模电子商务实验计划，新加坡也制定了详细的法律和技术框架推动电子商务的发展，中国江泽民主席最近在亚太经合组织领导人会议上也针对电子商务发表了重要讲话，认为电子商务代表着未来贸易方式的发展方向，应加强政府部门对电子商务的宏观规划和指导，创建良好的法律法规环境。在Windows 95 control messages选单中选中W32-DEVICEIOCONTROL消息、SYS-DYNAMIC-DEVICE-INIT消息及SYS-DYNAMIC-DEVICE-EXIT消息。
　　目前，上万的电子商务系统已在全球运行，它覆盖了金融、电信、政府、交通、旅游、媒体、工商等各个行业。中国代表性的电子商务示范工程“中国商务交易网”、“上海书城―Visoset网上书店”等也成功地投入运行。
　　电子商务正导致经济领域一次新的革命，它标志网络经济时代的到来。电子商务已不仅是一个理论概念，它已进入实用阶段，已成为今天的现实。　　
2　电子商务的网络平台
　　电子商务已有近20年的历史，只是目前进入了它的高级阶段。80年代是通过EDI专用网（或增值网）进行商务活动，例如欧洲各主要港口的航道信息交换系统、海关报关系统、民航订票系统等。
二、设计思路
　　由于Windows98的优良性能，特别是与internet的结合，我们采用它作为开发运行平台，以便本系统进入校园网和教育网，开发工具采用VFP5.0，该系统具有面向对象、可视化的编程思想，丰富的控件，可以缩短软件周期，程序用户界面友好，使用简单，维护方便。
　　7.团费管理
　　包括季度开户，收支处理，季团费查询，年团费查询。
　　4.院团委信息查询
　　针对于院团委各项信息(第1项)的各种信息查询。
　　* 突破了时间的约束，电子商业可以全天不中断地营业，随时满足全球不同时区客户的购货要求。
　　* 将传统的商品“间接”流通机制转变为商品“直接”流通机制，商家可不经过批发商直接把产品送到顾客手中，这不仅可免去多余的流通环节，还可节省相应的流通开销。
　　* 电子商店不同于传统的超市和百货公司，它不需气派的门面、华丽的装饰、大量的营业员以及琳琅满目的各种实实在在的商品，大大地减少了资金的压力。这对发展中国家的企业有很大的吸引力。
　　可见，电子商务只有进入了它的高级阶段，才能提供更好的商机和获得更大的回报。
关键词：团组织　管理系统　数据库
Abstract：This paper describes an Youth League Organizatio n IMS using VFP5.0, which is suitable for universities and colleges. This IMS sy stem proves useful, flexible and with a friendly interface, which has been put i nto practice.
Keywords：Youth League 　management system　database▲
一、前言
　　高校团的工作一直是工作量很大的工作，就普通高校来说，全体学生和青年教职工都属于团组织管理范畴，表现出人员众多，数据源复杂，统计管理工作困难等特点，一般要求一组很简单的统计数据，就得花费很大的工作量去人工统计，故在团组织的要求下，我们开发了这个管理系统，经试运行和不断完善，目前运行较好。
　　例如：组成分工查询，院团校查询，文件目录查询，获奖情况查询，人才库查询，院学生会查询，社会实践团体查询，志愿者服务队查询等。但是，这种开放式的信息交换方法使其网络安全具有脆弱性。这点不如过去的EDI专用网。而随着Internet的发展和电子商务时代的到来，人们在Internet安全上所进行的努力已经改变了这种情况。今天电子商务中采用的安全技术已成为一种成熟、实用的安全技术。
//通过VPICD-Virtualize-IRQ服务将已定义结构传入VPICD，VPICD分配IRQ并返回其句柄
RTCIRQHandle=VPICD-Virtualize-IRQ(&IRQdesc);
if(RTCIRQHandle==0)returnFALSE;//虚拟化失败
//保存初始RTC状态寄存器以便退出时恢复现场
SavedStatusRegisterA=ReadCMOS(STATREG-A);
SavedStatusRegisterB=ReadCMOS(STATREG-B);
RTClockFreqIndex=6;设置中断频率，见下文说明；
statreg=(SavedStatusRegisterA & ～0xF)｜(RTClockFreqIndex & 0xF);
WriteCMOS(STATREG-A,statreg);
//设置RTC状态寄存器使得status register flags to enable it to assert its IRQ
statreg=ReadCMOS(STATREG-B);
statreg｜=ENABLE-INTERRUPT;
WriteCMOS(STATREG-B,statreg);
ReadCMOS(STATREG-C);
TickCounter=0;//初始化中断计数器
//保证IRQ在PIC中未被屏蔽
VPICD-Physically-Unmask(RTCIRQHandle);
return TRUE;
｝
BOOL IrqtestDevice:OnSysDynamicDeviceFxit()｛
//恢复现场；
Cancel-Global-Event(hEvent);
WriteCMOS(STATREG-A,SavedStatusRegister A);
WriteCMOS(STATREG-B,SavedStatusRegister B);
VPICD-Physically-Mask(RTCIRQHandle);
VPICD-Force-Default-Behavior(RTCIRQHandle);
return TRUE;
｝
DWORD IrqtestDevice::OnW32DeviceIoControl
(PIOCTLPARAMS pDIOCParams)
｛
switch(pDIOCParams->dioc-IOCtICode)｛
case DIOC-OPEN;//CreateFile
｛hWnd =0;//Ring 3层应用程序主窗口句柄初始化
return 0;｝
case W32IF-PASS-EVENT:
PostMsghWnd=(DWORD*)pDIOCParams->dioc-InBuf;
hWnd=(HANDLE)*PostMsghWnd;//获得主窗口句柄
return 0;
default:return-1;｝
return 0;｝
BOOL -stdcall RTCInt-Handler(VMHANDLE hVM,IRQHANDLE hIRQ)｛
//在中断服务例程中，对中断计数器计数并向Ring 3层应用程序发送自定义消息；
if(hWnd&&(TickCounter%100==0))｛
SHELL-PostMessage(hWnd,WM-My-MESSAGE,0,0,NULL,NULL);｝
TickCounter++；
ReadCMOS(STATREG-C);//清除RTC状态标志
VPICD-Phys-EOI(hIRQ);//指定VPICD清除此中断
return TRUE;//thunk将清除进位
｝
//篇幅所限，针对COMS端口操作的两个函数ReadCMOS(BYTE reg)和WriteCMOS(BYTE reg,BYTE value)的源程序略，请参考VtoolsD连机帮助中的CHIME例子。例如除了网络中采用的防火墙技术，虚拟专用网（VPN）技术外，还综合了现在的加密技术、数字签名技术、电子认证技术。其中几个重要的高层安全协议是S-HTTP,S-MIME,PGP,SSL和SET等。
　　防火墙技术是通过IP过滤和代理服务器软件方法保护企业内部网(Intranet)中数据，只有授权用户才能获准进入企业内部网的系统。
二、设计思路
　　由于Windows98的优良性能，特别是与internet的结合，我们采用它作为开发运行平台，以便本系统进入校园网和教育网，开发工具采用VFP5.0，该系统具有面向对象、可视化的编程思想，丰富的控件，可以缩短软件周期，程序用户界面友好，使用简单，维护方便。S-HTTP(安全HTTP)和SSL（安全套接层）用于Web应用的安全。其中S-HTTP保证数据的安全，而SSL则用于客户和服务器间的安全连接。S-MIME（安全MIME）和PGP（极佳保密）用于电子邮件的安全。其中，S-MIME可通过数字签名来支持多点电子邮件，而PGP允许用户共享密钥而不需要证书机构。SET（安全电子交易）则用于在Internet上进行在线交易时保证卡支付的安全。它既定义了交易数据在卡用户、商家和银行之间的流通过程，也定义了支持交易的安全功能（数字签名，Hash算法和加密等）。
　　需要说明，目前企业界对如何实现安全协议还没有达成一致，安全技术还会不断向前发展。但是应该看到，电子商务的安全技术已经成熟，并经受了实际应用的考验。　　
4　电子商务的运作方式
　　商务活动的基本要求是保证交易的保密性、数据的完整性、安全的认证机制和可交互操作性。因此，电子商务相应的安全措施应是数据加密（保证数据安全传输）、认证（确保发送者的真实身份）、防抵赖性（确保发方不能否认曾向收方发过信息，同时收方也不能在收到信息后否认已收到信息）、授权（决定用户是否有权执行某项特殊的操作）。
　　进行在线交易时，持信用卡客户可以使用SSL技术和SET技术这两种流行的安全支付方式。
　　SSL协议是Netscape公司在网络传输层与应用层之间提供的一种基于RSA和保密密钥的用于浏览器与Web服务器之间的安全连接技术。SSL3.0通过数字签名和数字证书来实行身份验证，数字证书是从一个认证机构获得的。在用数字证书对双方的身份验证后，双方就可以用保密密钥进行安全的会话了。
　　3.团员青年基本信息录入
　　这项内容工程量大，包含的信息量大，几乎包含所有学生及青年教职工的方方面面。
　　早期的CyberCash信用卡支付系统就支持这种简单加密模式。IBM等公司也提供这种简单加密模式的支付系统。采用这种支付方式，用户在线购物时只需一个信用卡号，非常方便。但是，这种简单加密的信息只有业务提供商或第三方付费处理系统能够识别。
　　SET协议是Mastercard和Visa同IBM、Microsoft、Netscape等公司联合在网络应用层开发的安全电子交易协议。SET是一个开放的标准。它使用的技术包括，对称密钥加密、公共密钥加密、哈希算法、数字签名技术以及公共密钥授权机制等。
　　SET能达到以下在线交易目标：
　　* 信息在Internet上安全传输。
　　* 订单信息和信用卡信息的隔离。在将包括信用卡号码信息的订单送到商家时，商家只能看到订单信息，而看不到信用卡号码信息。
　　* 持卡人和商家相互认证，以确定通信双方身份。通常由认证中心为双方提供信用担保。
　　SET的结构包括四种成分：持卡人系统、商家系统、银行网关系统和认证管理系统。
　　交易各方之间的信息传送均通过SET协议以保证其安全性。“电子钱包”是SET在用户端的实现，“电子商家”是SET在商家的实现，“支付网关”是银行金融系统和Internet之间的接口，完成来往数据在SET协议和现存银行卡交易系统协议之间的转换是SET在金融方的实现。
　　IBM建立了世界上第一个SET支付系统――丹麦SET支付系统。新加坡花旗银行支付系统，上海书城的Visa卡支付系统等也采用IBM SET技术。　　
5　创建中国电子商务的环境
　　电子商务迅速发展，网络经济时代正在到来。谁不正视这种严峻的挑战并把握这新的机遇，谁就会失去竞争的优势而退出经济舞台。
　　目前，在这方面中国和发达国家之间的差距甚大。中国面临工业化和信息化的双重艰巨任务，由于工业化的任务尚未完成，信息化任务的难度更大；如信息基础结构建设还不完善，计算机普及应用率不高，国家骨干企业还没有完成转轨工作以及政策、法律等社会支持环境还不健全等。尽管问题很多，但是不容我们有任何的麻痹和松懈。因为我国的经济发展应该与国际经济发展同步，应该与国际经济接轨。
　　8.系统数据维护
　　包括用户帐号，密码的维护，数据库的备份及还原，毕业生处理。
　　面临网络经济时代这个大背景，企业向Internet迁移是必然的趋势。企业改革的目标是使自己成为面向全球的成功企业。可见，电子商务应是企业改革的目标和强大动力。
　　在Internet上进行电子商务活动将突破时间和空间的约束，给大家创造了机会相对均等的有利条件，使得竞争更为公平。显然，电子商务对发展中国家的企业更为重要，而不是可有可无或可早可晚。
　　为此，我们建议：1) 国家经济改革应适应网络经济时代的要求和推动电子商务的发展；2) 加大推进“三金”工程的力度，尽早搞好信息基础结构建设；3) 加速国民经济信息化的进程，创建电子商务的应用环境；4) 进行“全球电子商务”的国际对话，以便重大原则达成一致；5) 制订“中国电子商务纲要”，创建电子商务的政策、法律等社会支持环境；6) 制订电子商务的发展目标和搞好示范项目工程，为电子商务的大发展积累经验。
　　程代杰　教授。主要研究方向：计算机体系结构、信息网络、信息系统。
　　2.Ring 3级主应用程序设计
　　将生成的VxD放入主应用程序的工作目录中，用CreateFile()函数动态加载VxD。在Windows 9X下实时时钟的获得可以有不同的方法。利用QuickVxD生成的框架程序和经充分测试过的C运行库或C++类库可以绕过DDK用C或C++来编制驱动程序，这就大大地简化了开发的难度，提高了可靠性