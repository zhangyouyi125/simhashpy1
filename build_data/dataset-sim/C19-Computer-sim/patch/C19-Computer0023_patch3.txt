计算机应用
COMPUTER APPLICATIONS
1999年 第19卷 第6期 Vol.19 No.6 1999



PowerBuilder5.0 安装盘制作的关键技术
石建勋　杜戈　孙景琪
　　摘　要　本文在介绍利用Install Builder制作PowerBuilder安装盘过程的基础上，着重阐述了制作安装盘中配置ODBC、注册、生成可重复使用部件等关键技术。
　　关键词　安装盘，ODBC，注册，可重复使用部件
1　引言
　　PowerBuilder是PowerSoft公司推出的数据库应用系统的开发工具。利用Web实施远程教育，克服了传统教育在时间、空间上的限制，使得原先分散的教学资源能融为一体，Internet的用户可以使用浏览器随时获得课程信息，达到学习目的。
　　在国外已经开发出了专门解决数学表达式的应用软件，如EzMath，一元二次方程的求根公式用EzMath的语法，在HTML文本中表示为：
　　<EMBED TYPE="text/ezmath" ALIGN=absmiddle WIDTH= 171 HEIGHT=63
　　　　ALT="x = {-b plus or minus sqrt {b＾2 - 4ac}}/2a">
　　</EMBED>
它的ALT是自己定义的属性，该属性传递数学表达式给处理EzMath 的插件，EzMath 的插件根据宽度值、高度值和其它属性值，把数学表达式显示在浏览器窗口中。同时也谈一谈安装盘英文界面的汉化技术，帮您制作具有中文界面的安装盘。然而它的树状结构和完整标记的优点同时也是缺点，使得一个简单的数学表达式，显得冗长、复杂而难懂。首先是词类划分，其次是建立机器辞典，实质是基本词汇数据库。这只需要在PowerBuilder应用画笔中创建工程文件（.prj）即可。其具体步骤在很多PowerBuilder的工具书中都有详细介绍，这里就不再赘述，但要强调一点：为了减少程序代码长度，在“代码生成选项”（Code generation options）中，选择“机器码”（Machine Code）。问题中的关键词限定了问题的主要范围和内容。在这些理论基础上，按照词、句子、篇章来开展语言处理。
4.1　安装盘界面设置
　　点击主窗口工具栏中New按钮，建立一新的CFG文件。
3　3种解决途径的优劣比较分析
3.1 图片方式
　　利用图片方式来解决数学表达式的显示，是一种比较原始、笨拙的方法，它的缺点是显而易见的。也可以缺省不填这些项目或者稍后在主菜单中Options选项中补填。其部件共享WOSA (Windows Open Services Architecture)，易于集成在异机种计算环境中。一个部件包含了某一类型文件，如：应用程序文件、自定义INI文件、帮助文件、数据库文件、系统隐含文件等等。一个部件也可以细分为几个子部件。在各部件下的Files属性（标签页的第一项）中，利用工具栏中Select Files按钮，填加本部件所需的文件。
　　(2)开发这类插件是一件比较困难的任务，要费时费力地定义一套完整的无二义的数学表达式的表示语法。
　　其中有几个缺省路径，含义分别是：
　　@(base)――数据库文件所在路径
　　@(windows)――windows的路径
　　@(system)――windows\system的路径
　　@(componentname)――已定义过的部件所指的路径。对关键词的匹配是语义匹配的重要方面。在输入公式时使用插件方式；图表的输入利用图片方式完成。如果数据库使用的是通过ODBC(开放数据库接口)连接的数据源，则还需要在此配置ODBC信息（包括：数据源类型、ODBC数据源驱动程序、数据库名、启动程序等等）。安装盘制作工具Install Builder为此提供了非常简便快捷的方法：点击工具栏中InI Files按钮，从中选中你使用ODBC作为接口得数据源，则有关此数据源的ODBC配置信息将自动拷贝到部件的INI Setting属性中。
4.4　程序及数据库注册
　　作为一个标准的windows应用程序，需要将本应用程序的一些信息通知windows操作系统，以便系统管理和操作。这就涉及到windows注册（registry）问题。尤其对于数据库应用程序，注册程序和数据库关系到能否正确连接应用程序与数据库。关键词表的要求是覆盖面广，能完整地反映课件中的内容和概念。应用程序的注册信息可以手工配置，但大多数编程者对注册的项目、格式不是很熟悉，而且其过程也很繁琐。Install Builder工具包同样提供了简捷的注册方法：在工具栏中点击Registry按钮，从ODBC数据源中（ODBC Date Sources）选取HKEY―CURRENT―USER\ODBC\OD BC.INI中所需的数据源名，按确定后，有关所选数据源的数据库名、库文件、驱动文件、用户ID号、密码、启动程序等一系列信息会自动填加到包含数据库文件部件下的Registry Entries属性中。需要注意的是，仅仅注册自己配置的数据源是不够的，若使用的是非ODBC接口的数据库，则需注册此类型数据库的驱动信息。选取HKEY-―CURRENT―USER\ODBC\ODBC.INI中此类型数据库进行数据库驱动注册。若使用的是通过ODBC连接的数据库，除注册此类型数据库驱动之外，还需注册ODBC数据源（ODBC Data Sources）的驱动信息。下面举个例子：假设用户使用了PowerBuilder自带的本地数据库Sybas SQL Anywhere 5.0（这是一种通过ODBC连接的数据库），并创建了名为example的数据库。在注册时不仅要选择HKEY―CURRENT―USER\ODBC\ODBC.INI下的example数据库，还要选择Sybase SQL Anywhere 5.0 数据库驱动及ODBC Data Sources （ODBC数据源）驱动一同注册。但必须对自然语言加以规范，使得它明确、易懂、简洁，并且不产生歧义，有一定的语法规则，易于计算机程序的实现。
5　生成压缩文件及制作磁盘
　　从安装盘制作工具Install Builder的主窗口菜单上找到Actions选项，其下共有五个操作子选项，接下来按照这五个子选项依次操作。
5.1　定义可重复使用部件
　　可重复使用部件是一些经过压缩的功能独立的程序模块。这些程序模块通常包含PowerBuilder环境配置、接口驱动等动态链接库，可被所有安装盘配置文件(.cfg）共享。当定义并压缩可重复使用部件后，制作其他应用程序安装盘时，就无须重新定义和压缩这些可重复使用部件，而直接从中选取应用程序所需模块即可。而且由于图片作为一个文件存储在服务器上，就产生了安全问题。当点击Actions中Define Reusable Components选项时，Install Builder会自动按照instbldr.ini中的设置，将缺省的可重复使用的各部件及相关文件显示到新打开的定义可重复使用部件的窗口界面中。在此窗口下，可根据程序需要增减部件及相关文件。其操作类似于定义部件及子部件时的操作。有经验的编程人员还可直接对instbldr.ini配置文件进行编辑，效果是相同的。而且MathML的表达也可看成树状结构，每个节点表示了一个MathML的标记，每个树叶是数学表达式中的不可分的单元，如数字、标识符和如<mark_name/>类型的标记。目前对于公式符号输入问题没有一个令人满意的解决方案。而且，系统缺省配置instbldr.ini中有些部件中与数据库接口的动态链接库文件和帮助文件需要其相应的数据库来提供，若没有将这些与本应用程序无关的部件及文件剔除而又没有相应数据库来提供这些文件，则在压缩可重复使用部件时，会出现“无法找到指定的文件”的错误，从而导致压缩失败，无法继续制作安装盘。汉语词的处理是较为复杂的，先要经过分词阶段。当压缩成功后，系统回到原来的主窗口界面。
5.2　定义程序组
　　标准的windows应用程序都有自己的程序组，同一程序组下包含各个应用及图标。下面就为自己的应用程序定义程序组。
2.2 数学标记语言
　　为了解决数学符号在浏览器上的显示, W3C在1998年4月7日发布了数学标记语言MathML 1.0(Mathematical Mark Language)的规范说明书。此外，可以在Create Uninstall Icon选项旁打勾，即可自动生成反安装程序（或叫卸载程序）。
5.3　读取工程文件
　　首先选中一个部件（component）,然后点击主菜单Action中Read Project Object选项，在弹出的子窗口中的应用（Application）中选取先前已生成好的应用程序的工程文件(.prj)，则构成此工程文件的exe、pbd、dll文件会填加到所选部件的Files属性中。
5.4　生成磁盘映象
　　这一步将生成整个安装盘的压缩文件，并临时存放在本地硬盘中。此类压缩文件称为磁盘映象。点击Action中Create Diskette Images选项。
　　对关键词和语义词都进行了提取之后，一个问题的语义能大体确定，可以用其摘要和其他问题匹配。窗口中罗列出已压缩过的可重复使用部件，可根据需要，选取其中有用的部件。
1.1 答疑功能
　　大学课程中的内容和难点对不同背景的用户都具有普遍意义,因此Answer Web对每门课程都预先加入一些常见的问题及其解答。其中Unlimited选项是不限磁盘容量大小，这为制作光盘安装盘以及程序的网络安装提供了方便。最后按Create键开始生成安装盘的磁盘映象。
5.5　制作磁盘
　　磁盘映象生成后，可以随时将磁盘映象拷贝到磁盘中。有各种方法可以实现，比较简单的方法其操作过程简述如下：在Word中，利用Equation的输入模型完成数学式子的表示，把Word文档另存为HTML文件；然后再找到该图片，点击鼠标右键，把它存为图片即可。选择好拷贝份数及驱动器号（A:或B:）,确定后，Install Builder将磁盘映象拷贝到磁盘中。至此，我们成功的利用Install Builder工具包制作出了PowerBuilder应用程序的安装盘。
　　本文将给出这样一个自动答疑系统的模型设计和实现。对广大中国用户来说，英文界面不够友好，也不直观。
　　数学表达式具有递归性，即表达式是由子表达式构成。这就涉及到安装盘的汉化。目前常用的程序汉化技术有两种：一种是首先安装并运行一个汉化平台，提供动态的汉化环境，再运行需汉化的应用程序，此时可动态汉化英文界面。如四通利方、东方快车等软件；另一种汉化软件能从需汉化的应用程序中提取出英文词句并用汉字代替，汉化过程是永久的，汉化完毕再运行程序应用时，只要在中文windows平台上就可显示出中文界面。
7　结束语
　　随着PowerBuilder的强大功能不断被人们所认识，越来越多的软件开发人员使用PowerBuilder来完成各种数据库前台的开发工作。如果说Web的出现是远程教育的一个里程碑，恐怕也不过分。
作者简介：石建勋　硕士研究生。
　　(1) Web页面，用HTML语言编写，HTML是Internet上编写网页的通用语言，支持文本和图象显示，能定义超链接，可以通过表单(Form)向服务器发送信息调用处理程序。
杜戈　硕士研究生。它有以下主要属性值：
　　<EMBED SRC="location" TYPE="MIMEtype" HEIGHT="height" WIDTH="width" NAME="pluginName" >
　　　　</EMBED>
其中必须包含SRC或TYPE属性，SRC指明了要运行的文件，TYPE指明了MIME的数据类型，也可以是自己定义的类型。
　　在具体实现时，采用了下面的一套方案：

图2　设计实现采用的平台方案

图3　实现平台关系图
　　根据已有的平台方案，各部分的实现采用如下技术。因为HTML文件都是标准文本内容，对于图片只能引用。
作者单位：北京工业大学电子工程学系　北京（100022）
收稿日期:1998-12-29(修改稿)
