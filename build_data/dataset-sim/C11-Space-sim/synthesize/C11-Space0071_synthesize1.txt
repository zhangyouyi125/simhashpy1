
　　b.检波特性修正程序：根据20H和14H单元的数值采用曲线分段拟合法得到高频感应电压，数值存入21H,22H广义坐标共(3N+3)个航空计测技术
Aviation　Metrology　&　Measure公尺ent　Technology
1999年 第19卷 第3期 Vol.19 No.3 1999



多地下通道智能场强计的研制
朱传焕
　　摘　要　介绍87C51单片机在研制辐射计场强计中的应用情况以及和的研究。
　　3)八位液晶显示器：由6片具有锁存功能的BCD―7段液晶显示译码／驱动器4056和八位液晶片及RC振荡器组成。由图可见，在绳系系统状态保持阶段，塞伦丁省质心运动及子星姿态运动均显示出规律性。这里，精度所对应的指标不包括量化误差。
　　软件和硬件仿真成功后，脱机运行，功能按设计要求运行，这样软件和硬件的设计基本成功。其测量范围为1～999 V／m，频率可达18 GHz，测量不确定度为1.5dB，通道数可达90个。
　　b.转换精度反映了一个实际A／D转换器在量化值上与一个理想A／D转换器进行模拟转换的差值，可表示成绝对精度和相对精度。系统设计时，尽量用软件的办法解决，以减小硬件支出，降低成本。根据要求，将其设计为最小低功耗单片机应用系统。下面将硬件和软件部分设计分别进行论述。
1　硬件设计
　　硬件部分包括探头电阻、不转换电路、多路转换控制电路、放大电路、A／D转换电路以及87C51单片机。硬件设计框图如图1。
　　4　运动方程组
　　描述绳系系统运动的广义坐标可通过拉格朗日方程求解，该方程组由下列(3N+3)个方程组成：
　　　　　　　　　　
　　　　　　　　　　
　　　　　　　　　　
开放式中，L为拉格朗日函数：
L=E-(Vg+Ve)
上述方程组的求导、展开、求解是极为复杂的，符号运算软件Mathematica被用于辅助推导。
1.2　平衡―不平衡转换电路
　　由于探头输出是平衡的对称方式，必须将它转换为不平衡方式，所以加上平衡―不平衡转换电路，它提供高阻抗，由低噪声低漂移精密运算放大器组成，如图2所示。


图2　平衡―不平衡电路
1.3　多路转换控制电路
　　由六片AD7506多路模拟电子开关组成，实现可达90路通道转换，其控制线由单片机87C51的P3，经两片4～16线译码器译码后提供，如图3。


图3　多路转换控制电路
1.4　UL30K73Vt放大电路
　　程控放大电路将小讯号进行10两倍放大，以提高测量的灵敏度，将小于2 V的信号衰减10倍，由低噪声低漂移精密运算放大器和一个模拟电子开关组成，放大量由单片机87C51的P2口,P2.6和P2.7控制，如图4。


图4　程控放大电路
1.5　A／D转换电路
　　场强计的A／D转换对转换速度要求不高，只是要求精确度高，输入电压范围大，所以选择MC14433芯片。该动力学模型可用于微重力实验平台及空间容器返回等支撑物使命的分析与设计。
　　a.数字处理程序：将存储在10H,11H,12H,13H,14H(存储放大或衰减倍数)单元的BCD码计算为一个,并将此数值存于20H,14H。
　　1)87C51单片机由87C51 CPU、晶振、八位液晶显示器组成，如图5。。。。

图3　子星俯仰运动(初始俯仰角0.1弧度)

图4.1　子星俯仰运动(初始偏航角0.1弧度)

图4.2　子星滚转运动(初始滚转角0.1弧度)

图4.3　子星偏航运动(初始滚转角0.1弧度)
　　模拟计算显示出，当仅存在初始俯仰角偏差时，系绳与子星仅有轨道平面内的运动(参见图1.1与图1.2，以及图3)。P2口直接提供高8位地址A8～A15；
　　b.数据总线(DB)：宽度8位，由P0口提供；
　　c.控制总线(CB)：由部分P3口的第二功能状态和4根控制线PRST、EA、ALT、PSEN组成。
　　由于87C51是片内带EPROM的单片机，不带外部存储器扩展，将{EA}按高电平，P0、P1、P2、P3都可用并作用户I／O口。
　　关键词　单片机　场强计　硬件　
evelopment of Multi-Channel Intelligence Field Intensity Meter
Zhu Chuanhuan
　　Abstract　The application of 87C51 single chip computer in developing multichannel intelligence field intensity meter,the research and design of software and hardware are introduced in this paper.
　　ey words　Single chip computer,Field intensity meter,Hardware,Software
　　随着现代科技与工业的发展，电子、电气设备或控制系统得到了越来越广泛的应用，电气设备所产生的干扰电平在不断地提高，电磁干扰对电磁环境造成越来越严重的污染，它们对电子、电气设备或系统以及人们的身体健康、构成威协。显示通道数和场强值，如：“CH08：250.7”，即为第八通道，场强值为250.7 V／m。近区场强仪是一种测量高电平近区电磁场的测量设备，它可测量各种漏场、寄生辐射，还可用于电磁兼容性实验。
2　软件设计
　　结合硬件线路，用汇编语言编程，自动交叉反汇编的方法得到机器码目标程序。
1.7　A／D转换器与87C51单片机接口
　　虽然MC14433输出是动态分时BCD码输出，但由于87C51的P0口可作为用户I／O口，所以MC14433可直接接在87C51的P0口上。在编写软件时，需要借助于流程图，各功能模块的


图5　87C51单片机原理图
逐层分割，其实就是流程图由粗到细的过程。利用MC―51单片机进行在线仿真开发，把系统安置在实际环境中进行现场测试，分析测试中的问题及原因，根据问题，修改软件和硬件，直到设计符合需要。多通道智能场强仪监控程序原理框图如图6。


图6　监控程序原理图
　　根据总体结构，软件包括：
　　1)初始化准备程序：完成对87C51CPU的复位清零及初始化，进行P0、P1、P2、P3口状态设置。。
3)量程控制程序：根据输入信号大小，自动地选择合适增益或衰减，完成对程控放大器的控制。
　　4)A／D转换程序：完成数据的采集。考虑到主星的质量一般比子星的质量大得多，且有主动式姿态控制，我们将主星取为质点，且与系统质心相合，作圆轨道运动；子星被取为自由的三维刚体。
1.6　87C51单片机
　　为了减小功耗，采用低功耗的CHMOS器件，CPU选用87C51，液晶显示，最大静态电流控制在30 mA以内。。将检波曲线分成四段，每一段采用直线拟合，直线方程为：Y＝aP＋b，Y为感应的高频电压，X为检波的直流电压，根据检波曲线，各段直线拟合方程如下： 
X：1～10 mV：Y＝0.2X＋0.62
　　10～50 mV：Y＝0.11X＋1.25
　　50～2000 mV：Y＝0.071X＋3.41
　　2000～8000 mV：Y＝0.134X－151.40

　
　　根据直线方程，编写程序得到Y。
　　c.探头校准系数修正程序：将21H和22H单元数值,利用查表或直线拟合方法得到场强数值E。
6)显示程序：显示通道数和对应通道场强值。
　　以上程序由于占用篇辐较大，程序清单不再列出。多通道智能近区场强仪不仅具有这些功能，它还可以多种方位实时地监测各种变化的电磁干扰。
3　场强计测量分析
　　1)关于A／D转换精度和分辨率的问题
　　a.A／D转换器的分辨率习惯上是以输出二进制位数或BCD码位数表示，与一般测量仪表(指针式)表达方式不同。。A／D转换中，有一个量化误差的问题，它和分辨率是统一的，是由于有限数字对模拟数值进行离散取值(量化)而引起的误差。量化误差理论上为一个单位分辨率，提高分辨率可减少量化误差。
　　多通道智能近区场强仪将信息采集、处理、控制K43E342TK于一体，它包括硬件和软件两大部分，其核心为87C51单片机。采用自顶向下， 模块分割的设计方法， 同时考虑和硬件的配合问题， 作相应调整， 综合考虑， 权衡利弊， 调整到软、 硬件都能贯通为止。
　　c.MC14433实际转换精度为±0.05％\Ux\±1个字。。
　　d.由表1可以看出，A／D转换测量小电压误差大，为了保证测量精度，在设计时，对小于20 mV的信号进行10倍放大，A／D倍放大，A／D转换电压为20 mV～2 V电压，最大误差为5％。
表 1
A／D电压相对误差％
2 mV50
10 mV10
20 mV5
50 mV2
100 mV1.05
200 mV0.55
1 V0.15
2V0.1

　
2)平衡―不平衡转换和放大器的误差优于5％
3)软件设计中数据取舍误差为2％
4)检波特性数据修正误差为5％
5)探头校准系数修正误差为4％
6)频率附加误差为8％
7)其它因素影响测量误差3％
场强计总误差为：
((5％)2＋(5％)2＋(2％)2＋(5％)2＋(4％)2＋(8％)2＋(3％)2)1／2≈13％
作者简介：32岁　男　助理工程师
作者单位：朱传焕　(武汉船舶设计研究所，湖北省武汉市，4300064)
参考文献
　　1　陈伟人.单片微型计算机原理及其应用.北京:清华大学出版社,1987
　　2　何立民.MCS―51系列单片机应用系统设计系统配置与接口技术.北京:北京航空航天大学出版社,
　　3　陈汝全等.单片机实用技术.北京:电子工业出版社,
　　4　沈德金等.MCS―51系列单片机接口电路与应用程序实例.北京:北京航空航天大学出版社,1989
　　收稿日期：1998-04-10
修改日期：1998-05-04
