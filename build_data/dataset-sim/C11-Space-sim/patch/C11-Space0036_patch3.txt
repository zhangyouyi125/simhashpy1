航空工程与维修
AVIATION ENGINEERING & MAINTENANCE
1999年　第6期　No.6　1999



单元化制造系统中的有限能力调度
杨建军
Finite Capacity Scheduling in Cellular Manufacturing Systems
　　在敏捷制造环境中，产品的技术创新性、质量、交货周期和价格是构成企业核心竞争力的要素。特征矢量在通常意义下不正交,从而不能直接用模态分析方法求解刚、弹耦合多体系统的动力响应,难以对系统的动力响应进行精确分析。
　　单元化制造系统是构成敏捷制造企业的最基本组织元素和功能元素。是多品种小批量制造具有竞争力的组织方式，是一种后大规模生产方式和订单驱动的制造系统。
　　有限能力计划（FCS）通常被认为是企业更好地提供客户服务和效益的一种使能技术。特别是近十年，有关有限能力调度方面研究工作正在引起广泛兴趣。本文详细介绍了有限能力调度的技术概念、原理和基本方法。指出了在敏捷制造环境下的基于单元化制造系统（CMS）中采用有限能力调度技术的必要性。
6　仿真研究
6.1　登月舱软着陆控制系统中的神经元网络　　


图4　软着陆控制系统中的人工神经元网络
按图3所示的系统结构设计登月舱软着陆神经元控制系统。
　　有限能力调度在敏捷制造环境下，制造企业既要能够时刻关注自己企业的预留能力，以便准确地提供交货的预承诺。又要了解顾客的需求变化或实际生产出现问题时，会怎样影响当前对顾客的承诺。同时必须经济而有效地组织制造，满足发货的要求。生产调度的重要性日益显露出来。
　　生产调度问题具有复杂性、动态随机性和多目标性等特点。解决生产调度问题的方法也可分为基于运筹学的方法（如线性规划、动态规划、分枝定界等），基于知识的智能调度方法（如专家系统、神经元网络、遗传基因算法等），以及在实际应用常常用到的基于规则的方法（如离散事件仿真）等。上述几种方法以不同形式应用于制造系统中，尽管如此，通过纯理论的方法产生可接受的调度的前景仍相当暗淡。
　　在生产实际中，基于规则的方法常常用来解决调度和有限能力调度（FCS）问题。有限能力计划阐明了能力的度量和工作怎样被分配到到这个能力的问题。
　　最朴素的有限能力调度应该算是工厂调度员日常的工作方法，他凭借经验、心算和其他一些简单的方法来安排日常工作。则可求得用于训练ANN1的输出误差:
Δu(s)=ud(s)-u(s)　(s=1,2,…,N)(4-9)
　　利用ANN1输出误差(4-9)和BP算法(3-4)即可对ANN1进行离线训练。由于弹性体与刚体之间的动力耦合作用,使得多体系统的特征值问题非自共轭。当前，计算机工具已经被用来帮助进行这项复杂的能力分配工作。
　　能力作为制造资源计划（MRP）系统中的有效负荷模型，是基于工作中心的概念。则有:
Z(x)=UZ(-l)(3.1)
式中,系统的传递矩阵
U=U1U2(3.2)
U1和U2分别为梁和刚体的传递矩阵［5］,Z(-l)为刚体端点的状态矢量,l=a+b。
6　算例


图6.1　梁中点的响应
用上述方法求解某多体系统的响应,由电算得到梁中点前8秒时间的响应历程,如图6.1。但是不能提供详细的需求来满足车间调度、满足顾客交付要求。
　　有限能力调度是一种改善和克服上述问题的方法，现有的一些商业系统能够提供有限能力调度功能，即把具体的资源和任务联系起来管理能力的方式。
　　系统的边界条件为
Z(L)=［y(L),θ(L),0,0］T(3.3)
Z(-l)=［y(-l),θ(-l),0,0］T(3.4)
　　将式(3.3)、(3.4)代入式(3.1)得频率方程
U31U42-U32U41=0(3.5)
解式(3.5),即可求得耦合系统的各阶固有频率。设作用在刚体上的主矢和主矩分别为F0(t)j吆挺0(t)k,作用在梁上的分布力为f(x,t)j,(i,j,k)为直角坐标系的单位矢量。从而避免了MRP系统实际运行中的一些问题。
6　仿真研究
6.1　登月舱软着陆控制系统中的神经元网络　　


图4　软着陆控制系统中的人工神经元网络
按图3所示的系统结构设计登月舱软着陆神经元控制系统。
3　基于神经元网络的控制方案
3.1　神经元控制的理论基础
3.1.1　BP神经元网络模型
　　本文采用的神经元网络为如图2所示的多输入-单输出三层BP网络。
　　基于规则的调度方法通常被用来实现有限能力调度。基于规则的方法，通过理论的归纳和经验的提取，形成一个“规则集“，本质上代替了深刻和广泛的人类决策行为。
　　仿真的观点，预先的决策规则被应用，如“选择具有最少剩余松驰时间的任务”或“选择具有同样工装的任务”。
　　式中
7(5.13)
7(5.14)
(5.15)
系统中刚体的响应为
y(t)=y(0,t)-yx(0,t)b(5.16)θ(t)=yx(0,t)(5.17)
式中y(t)表示刚体质心的位移,θ(t)表示为刚体的转角。第一种情况目标是为了满足顾客的交货期，第二种情况目标则明显是为了改善效益。由于这些规则的作用是单调的，常常顾此失彼。虽然，在实践中可以通过使规则系统具有更多的适应性来应付系统这种两难的局面，如采用组合优先规则的方法。如果这样的话，就意味着每一种例外情况都需要更多的条件被加到规则中，从而使规则系统越来越复杂。即使这样，规则系统仍存在着一些不可避免的缺点，如维护的复杂性、规则作用的局部性、规则的不完整性和较差的交互性。
　　本文以某多体系统为例,建立满足自共轭条件的耦合多体系统特征值和边值问题的增广公式,进而求得了正交的增广特征矢量,并用增广特征矢量级数表示多体系统对任意激励的响应,为解决上述第2个问题提供了一种方法。这种方法具有比通过规则更直接获得调度计划的能力。
6　仿真研究
6.1　登月舱软着陆控制系统中的神经元网络　　


图4　软着陆控制系统中的人工神经元网络
按图3所示的系统结构设计登月舱软着陆神经元控制系统。
7　结论
　　由上述可见:多体系统传递矩阵法为解决诸如航天、兵器等工程问题中的多体系统固有振动特性问题提供了方法;通过构造增广算子和增广特征矢量,建立其正交条件,使多体系统传递矩阵法可以解决多体系统动力响应的精确分析问题。这种控制方法最终减少了重新安排调度计划，并改善了围绕调度这个术语常常谈到的调度稳定性或者叫做调度的鲁棒性。
　　将活动网络方法应用到解决有限能力调度的交互式决策支持，首先要解决制造任务及其任务间约束（关系）的表示方法。在制造系统中各种生产任务之间总会存在许多不同类型的约束关系(如表1)。这些约束直接影响了每个零件的各个工序操作的生产流程安排顺序，也同时影响了系统生产调度中的优化决策，因为生产调度的实质正是根据这些管理目标和约束条件寻求一个优化的作业安排结果。
表1　制造系统约束分类表

约束类型含义约束的性质说明/举例
结构约束产品订单的配套关系使各零件及其工装的生产和原材料的采购活动中有数量和先后顺序的约束要求强/弱约束只有部分配套关系是必须遵守的强约束；
配套约束是MRP倒排计算的前提条件之一
条件约束
工艺约束零件的制造过程是按照工艺路线进行的，因此工序任务间存在工艺规程方面的约束强约束如零件的工艺路线和组合加工；
必须严格遵守工艺安排，调度不能改变此约束
条件约束
资源使用约束每个操作都要使用一定的资源和设备，形成设备资源上的操作安排队列从而产生的约束弱约束　
调度操作能改变此约束，而调度的最终结果也正是资源使用队列约束
结果约束
辅助资源约束每个操作都要占用一定的辅助资源，形成辅助资源上操作占用安排队列从而产生的约束弱约束调度操作能改变此约束，而调度的最终结果也正是辅助资源使用队列约束
结果约束
计划时间约束由于任务计划安排的开始和结束时间要求而产生的约束强/弱约束部分任务有必须某天完成要求是强约束
结果约束
性能和管理
目标约束调度的最终系统要求和管理目标对任务安排产生的约束动态约束资源使用均衡、利润等
目标约束

　
　　活动网络方法，能够兼容产品配套表(BOM)和操作表(BOO)表示产品模型，前者是MRP计划系统的基础，后者则是FCS计划系统的重要特征。

(a)(b)
图2　BP神经元网络模型
3.1.2　BP神经元网络算法
　　(1)前向传递算法
　　令Nkj为第k层第j个神经元,Okj为Nkj的输出,θkj为Nkj的阈值,wkji为联结Nki与Nk+1j的权系数,Lk为网络第k层的节点数,则:
(3-1a)
(3-1b)
　　(2)往回传播算法(BP学习算法)
　　设BP网络有样本集合S={(R(s),O(s)d)｜s=1,2,…,N}。
　　例如，在一个Job－Shop型车间里有三个零件任务，分别为：A，B，C；车间内有三个工作中心设备，分别为：w1，w2，w3；三个零件的工艺路线和工序中使用的资源分别为：{A1[w1]，A2[w2]，A3[w3]}，{B1[w3]，B2[w2]，B3[w1]}，{C1[w1]，C2[w2]}；为了简化问题，假设所有的加工中没有使用辅助资源；各个零件任务的优先级是相等的（PA=PB=PC）。图1是任务安排的甘特图。
　　由引理3-1可知,最优状态反馈控制律(5-2)可用BP神经元网络实现,如图3所示的模块ANN2。
　　由引理3-1可知,最优状态反馈控制律(5-2)可用BP神经元网络实现,如图3所示的模块ANN2。这种方法通过允许调度员直接指派想要安排的工作避免了描述上的复杂规则的难点，它允许调度员能灵活的处理情况，可能提出最好的作业顺序。

图2　活动网络图
　　在实际生产中，调度员通过常规的网络分析方法，了解订单完成的关键路径、各项任务的最早与最晚开始时间;以及当一个关键的下游工作中设备突然出现故障时，可以了解哪些任务与下游工作中心相关，会引起什么情况。交互式决策支持允许调度人员当需要时可重新安排工作，从而避免了下游的问题。
　　系统的边界条件为
Z(L)=［y(L),θ(L),0,0］T(3.3)
Z(-l)=［y(-l),θ(-l),0,0］T(3.4)
　　将式(3.3)、(3.4)代入式(3.1)得频率方程
U31U42-U32U41=0(3.5)
解式(3.5),即可求得耦合系统的各阶固有频率。
　　另外，基于活动网络图的方法，可以方便地引入其他系统优化与分析方法，如涉动分析。交互式决策支持允许调度人员兼顾交货期和效益，立足于今天的条件和今天的顾客需求，并不简单地依照一些事先定义的规则。从而使得调度策略可以更好地适应调度环境和管理目标的变化。在软着陆过程中,假设登月舱相对于月球表面的运动是垂直的(如图1所示),并满足条件:
　　1)作用于登月舱的力只是其自身的重力和起制动作用的推力F,。则BP网络的输出误差为:
ΔO(s)=O(s)d-O(s)(3-2)
　　定义能量函数
E=∑Ni=1｛ΔO(s)｝2(3-3)
　　则按梯度下降原则,有BP学习算法:
(3-4)
3.1.3　BP神经元网络逼近映射的特性
　　引理3-1:(Hecht-Nielsen 1989［5］)
　　给定任意ε＞0和任意L2函数f:［0,1］nRn→Rm,存在一三层BP神经元网络,其输入输出映射h:［0,1］Rn→Rm可在任意ε平方误差积分精度内逼近f,即:
∫［0,1］n｜f(x)-h(x)｜2dx＜ε(3-5)
　　引理3-1意味着BP人工神经网络具有逼近任意非线性映射的能力。
7　结论
　　由上述可见:多体系统传递矩阵法为解决诸如航天、兵器等工程问题中的多体系统固有振动特性问题提供了方法;通过构造增广算子和增广特征矢量,建立其正交条件,使多体系统传递矩阵法可以解决多体系统动力响应的精确分析问题。
CMS中的FCS应用
　　值得指出的是，有限能力计划具有较好的实施性和较优化的性能，特别适合单件与小批量制造环境。同时也受到了问题规模的限制，当零件超过一定的数量时，将引起系统的性能将下降。因此，在实际的应用中，必须注意简化BOM层次结构。单元化制造通常是依据成组技术原理，将传统机群式生产组织按产品再工程，重新成综合生产组（制造单元），每一个生产组既是制造的中心，又是一个利润中心，有全部的管理职能，甚至包括财务在内。与这样的生产组组成的生产系统称为单元化制造系统。
　　神经元状态反馈控制器可依据系统实验的输入输出信息,通过学习逼近实际系统的最优状态反馈控制律,以避免数学模型误差以及ANN1模型误差对获取最优状态反馈控制律可能造成的影响。这时,采用人工神经元网络实现系统的逆模型就成为一种必要的和有意义的途径。近三十年来迅速发展的多体系统动力学的各种方法［7,8］,为多体系统动力响应的数值计算提供了强有力的工具,随着科学技术的发展,许多工程问题在机械系统设计中需要做到:1.解决含有刚体和弹性体耦合系统的固有振动特性的计算问题;2.希望能进行多体系统对任意激励动力响应的精确分析。它克服了传统工作方法和工厂的工艺布置造成的庞大的管理机构，以及发货不按时和交货时间过长等弊病。
　　单元化制造系统具有异构的控制结构，将传统的多层递阶结构转化为更趋于平面化的分布式异构层次结构（图3）。单元化制造系统是构成的分布式网络化的虚拟企业实践敏捷制造的基础。分布式网络化是实现企业多种柔性和敏捷性的一种新的制造系统概念和模式。
　

图3　分布式异构层次结构
　　因此，采用单元化的组织方式，使得传统的组织方式下的产品结构方式发生变化，BOM由原来一个深层的结构，变化为一个更简单的配套结构，这种结构的简单化有利于FCS技术的实施。
　　ANN2的设计步骤为:
　　1)依据泛函(2-2)和反馈律学习算法计算ANN2输出误差Δv
　　2)依据ANN2输出误差Δv,利用BP学习算法进行自组织,使ANN2逼近使泛函(2-2)趋于极小意义下的最优状态反馈控制律:v(*)=v(x,yd)。这里的MES就是制造执行系统，是MES国际联合会在90年代开始推广的技术概念和实施模型。
参考文献
  1　芮筱亭,隋文海,邵允中.刚体的场传递矩阵及其在多体动力学中的应用.宇航学报,1993,4:82-87
  2　芮筱亭,陆毓琪.多体系统振动的传递矩阵法.宇航学报,1995,3:41-47
  3　Stein E,Hang Y J,芮筱亭,陆毓琪,曾仕伦,刘正福.TraNSFER Matrix method of damping multibody systems vibration.宇航学报,1996,2:28-35
  4　芮筱亭等.多体系统发射动力学.国防工业出版社,1995
  5　芮筱亭,陆毓琪,付效山,俞占鸿.多体系统传递矩阵法.南京大学出版社,已付印
  6　Yang B.Linear vibration of a compled spring-rigrdbar system,Proceedings of the International Conference on Vibration Engineering,International Acadlmic Publishers,1994
  7　刘延柱等.多刚体系统动力学.高等教育出版社,1989
  8　Witlenburg J.Dynamics of Systems of Rigid Bodies,B.G.Teubner,Stuttgart,1977(中译本:谢传锋译,多刚体动力学,北京航空学院出版社,1986)
  9　И．М．Бабаков，Теория　копебаний，Гостехиздат,(中译本:振动理论,蔡承文等译,人民教育出版社,1963)
。则有:
Z(x)=UZ(-l)(3.1)
式中,系统的传递矩阵
U=U1U2(3.2)
U1和U2分别为梁和刚体的传递矩阵［5］,Z(-l)为刚体端点的状态矢量,l=a+b。
2　力学模型


图2.1　耦合多体系统
　　系统由平面运动的刚体A和与其固结的匀质梁B组成,以固结点O为坐标原点,建立静止直角坐标系,X轴沿未变形的梁的中心轴线指向梁的另一端。企业通过实施单元化制造再工程，增强了企业的竞争力。同时，单元化制造系统通过引入有限能力调度的技术概念，使企业在顾客服务和企业效益竞争的两个重要方面寻求到了平衡，改善了企业的生存条件。非线性动态逆控制技术是处理非线性控制问题的一种有效方法,而该方法对被控制对象数学模型的过分依赖,使其应用受到很大的限制。
6.2　登月舱软着陆过程的仿真
6.2.1　软着际过程
　　在系统的仿真运行过程中,按4、5两节提出的训练方法,对ANN1和ANN2进行仿真在线训练。□
作者单位：北京航空航天大学
