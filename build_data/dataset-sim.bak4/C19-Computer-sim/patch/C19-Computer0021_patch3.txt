计算机应用
COMPUTER APPLICATIONS
1999年 第19卷 第6期 Vol.19 No.6 1999



防火墙技术与防火墙系统设计
肖　捷
　　摘　要　本文通过对防火墙系统的两种基本技术的分析，提出了防火墙系统总体设计的基本思想，并设计了一种基于包过滤技术、代理技术和身份验证技术相结合的实用防火墙系统。
　　关键词　包过滤技术，代理技术，身份验证
1　防火墙
　　随着Internet 在世界范围内的普及，网络安全问题变得愈来愈重要。 为了防止侵入者盗窃、修改或破坏系统上的数据，维护私用网络和防止对计算机资源的非授权使用，获得对Internet比较安全的应用，防火墙系统是一种重要的应用模式。
2　防火墙技术分析
　　根据ISO/OSI参考模型，防火墙技术主要分为两大类：一类是建立在网络层上的基于包过滤技术的防火墙;另一类是建立在应用层上的基于代理技术的防火墙。
2.1　包过滤技术防火墙
　　包过滤技术防火墙，也称网络层防火墙，作用于IP层，通常由过滤路由器来构建，其实现原理是：对每一个到达过滤路由器的IP包，过滤路由器从IP包头中获得有关信息，如：IP包头中协议类型、源IP地址、目的IP地址、源端口号、目的端口号及各种标志位等信息，根据过滤路由器中预先制订好的过滤规则进行检查，决定IP包的通过或阻塞，从而实现对IP包的过滤，其核心就是过滤规则的制订。连接结构如图1。这种防火墙技术的优点是简单方便，透明性好，速度快，对网络性能影响不大，缺点是正确建立和管理包过滤规则比较困难，同时还缺乏审计、跟踪及身份验证功能。触发器能使数据库的设计变得简洁和高效。ASP与ADO技术相结合，建立和提供包含数据库信息的主页内容，通过执行SQL命令，让用户在浏览器中进行数据的查询、输入、修改、删除和更新等操作。一个代理服务器实际上是一个为特定网络应用而连接两个网络的网关，对于每一种不同的应用服务，都必须有一个相应的代理。外部网络和内部网络之间要建立连接，必须通过代理的中间转换，内部网络只接受代理服务提出的服务请求，拒绝外部网络的直接连接。连接结构如图2。这种防火墙技术的优点是它能完全控制通信双方的会话过程，具有用户级的身份验证、日志管理和帐号管理功能，提供了比过滤路由器更为严格的安全性，缺点是缺乏透明性，影响网络性能，必须针对每一项服务都建立对应的应用层网关，才能提供全面的安全保证，这势必严重限制新应用的采纳。能否开发一个包罗万象的代理服务器，将有利于新应用的挂接。

图2　代理服务器防火墙系统连接结构
　　综合上述两种防火墙技术的优缺点，在实际构建防火墙系统时，通常由过滤路由器和代理服务器组合在一起构成一个混合的多级防火墙系统，由过滤路由器提供第一级的安全防护，主要用于防止IP欺骗攻击，再由代理服务器提供更高级的安全防护机制。连接结构如图3。

图3　过滤路由器+代理服务器防火墙系统连接结构
3　防火墙系统总体设计基本思想
3.1　设计防火墙系统的拓扑结构
　　在确定防火墙系统的拓扑结构时，首先必须确定被保护网络的安全级别。从整个系统的成本、安全保护的实现、维护、升级、改造以及重要资源的保护等方面进行考虑，以决定防火墙系统的拓扑结构。通常有三种主要的拓扑结构。
作者单位：中国地质大学网络中心　湖北.武汉（430074)
参考文献
［1］　沈佩娟，汤荷美,编著. 数据库管理及应用开发(第1版).北京：清华大学出版社，1995,6
收稿日期:1999-03-15
。二、屏蔽主网关结构，即由过滤路由器和代理主机分别实现包过滤和代理服务两级安全防护，其中代理主机是这种结构防火墙系统的中心主机，通常称为堡垒主机。三、屏蔽子网网关结构，即由两台路由器和一台堡垒主机构成一个中间的过滤子网，由其实现外部网与内部网的分离，但内部网、外部网都可以访问中间的过滤子网，显然，这种结构的安全性较好。
3.2　制定网络安全策略
　　不同的组织有各自特定的安全要求，在实现的过程中，有两条基本的安全策略原则，也即没有授权认可的服务都被禁止，不受授权限制的服务都被允许。前一条策略拒绝一切未经认可的服务，防火墙封锁所有的信息流，逐一完成每项许可的服务。
　　关键词　IIS, ASP, ADO, ODBC, SQL
1　引言
　　在客户端使用普通浏览器，通过Internet或者Intranet，访问网络数据库中的数据，已有多种解决方案，如传统的CGI方式、现在较常见的ADC方式和IDC方式等。
作者单位：向坚持　湖南师范大学计算机教学部　湖南.长沙 (410081）
林亚平　湖南大学计算机系　湖南.长沙 （410082）
参考文献
［1］　周世雄. NT动态站点设计.大连：大连理工大学出版社，1997
［2］　刘艳梅，等.基于B/S结构的跨平台异构型数据库系统.计算机系统应用，1998;(8)
收稿日期:1999-06-28(修改稿)
。
3.4　规划代理服务器
　　代理服务器(PROXY)是防火墙系统中的一个服务器进程，安装运行在防火墙主机上，为内部网络与外部网络充当中继，阻止内部网络与外部网络的直接连接。（见图3）

图3　中间作为不同应用系统间的数据接口
　　要注意的一点是：图示应用系统间的数据是单向流动的（即数据传递）；如果数据需要双向流动（即数据交换），那么在触发器设计中应有退出机制，以避免发生触发器的递归。对于网络管理员来说，选择一个成熟且便于管理和配置的代理服务器程序非常重要，图4给出了代理服务器的逻辑结构。

FTP代理TELNET代理WWW代理……
用户身份验证模块
监控、记录模块

图4 代理服务器的逻辑结构
4　防火墙系统设计实例
　　按照防火墙系统总体设计基本思想，本文给出了一个基于包过滤技术、代理技术以及身份验证技术相结合的实用防火墙系统，拓扑结构如图5。该防火墙系统由一个内部路由器、一个代理服务器和一个边界路由器构成一个中间的过滤子网，以实施安全防护。

图5　实用防火墙系统拓扑结构
4.1　包过滤规则的设计
　　对于过滤路由器中过滤规则的设计，我们采用的安全策略是：不允许IP源路由，起于内部网络的服务允许给过滤子网中的代理服务器，允许外部网络到代理服务器的流量，允许过滤子网中代理服务器到内部网络的流量。-- 设计客户端的输入表单 -->
<html>
<head>
<meta http-equiv="Content-Type"
content="text/html; charset=gb―2312-80">
<meta name="GENERATOR" 
content="Microsoft FrontPage Express 2.0">
<title>网上报名系统</title>
<bgsound src="The―Microsoft―Sound.wav" loop="1">
</head>
<body background="file:///C:/WINDOWS/Backgrnd.gif"
bgcolor="#FFFFFF" topmargin="4" leftmargin="15">
<p align="center"><font color="#FF0000" size="7" face="隶书"><strong>网上报名系统</strong></font></p>
<p><font color="#008000" size="4" face="楷体―GB2312"><em><strong><u>
请输入以下信息：</u>　</strong>　</em>　</font>　</p>
<form action="bmxt.asp" method="post">
<p align="left"><font color="#FF00FF">
姓名：</font><input type="text" size="10" 
name="T1"><font color="#FF00FF">
报名专业：　<input type="text" size="17" name="T1">　</font>　</p>
<p align="left"><font color="#FF00FF">
性别：<select name="D1" size="1">
<option selected>男</option> 
<option>女</option>
</select>
毕业学校：　<input type="text" size="22" name="T1"></font></p>
<p align="left"><font color="#FF00FF">
年龄：<input type="text" size="5" name="T1"> 
通讯地址：</font><input type="text" size="22" name="T1"></p>
<p align="center"><font color="#FF00FF">
<input type="submit" name="B1" value="提交"> 
<　input type="reset" name="B2" value="复原"　>　<br　>
</font></p>
</form>
<。采用这种过滤机制，使得路由器中的规则库仅包含3条规则，既方便维护和管理，又易于验证过滤规则的完备性和正确性。
　　建立这类触发器的步骤是：建立数据表后，再建立对应的历史表（一般而言，历史表在字段组成上是数据表的超集，即在原数据表字段上再增加有关时间的字段），然后在两者之间设立触发器（见图2）。并对如何设计这些触发器进行了探讨。

图6　代理服务器逻辑结构
　　我们选用Netscape Proxy server3.5代理服务器软件，在安装好代理服务器后，再设计一个代理服务器的配置文件，代理服务器根据该配置文件的源IP地址、目的IP地址和身份验证控制内外网络的访问权限，利用监控、记录模块实现对所有数据流的监控和记录，以提供网管所需的各种数据。远程教育技术涉及到许多重要的技术如协同工作、交互式技术等。
5　结论
　　网络的安全性涉及许多方面，本文主要从防火墙的设计、实现方面进行探讨，给出了一种实用的防火墙构建模型，希望能给读者有所帮助。

图1　触发器应用于数据分散――集中式模型
　　在这种模型中，要注意设计好部门表相关字段的完整性约束，使各部门表内的数据是唯一的，以防止不同部门表出现相同的数据记录，从而导致在汇总表中出现混乱。研究方向：计算机网络及数据库系统。下面，以在线报名为例，简要介绍该设计方法