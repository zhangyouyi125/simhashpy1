航空计测技术
AVIATION METROLOGY & MEASUREMENT TECHNOLOGY
1999年 第1期 No.1 1999



一种用于热校准风洞的
数据采集系统集成及软件设计
张　强
摘　要　简要介绍了研华ADAM4000系列模块的性能及其特点，并详细阐述了利用该系列模块组成一种用于热校准风洞的数据采集系统以及LABTECH CONTROL组态软件包在整个系统中的应用。
关键词　模块　组态软件包　热校准风洞
A Data Aquisition System Integration and
Design of Software Used in Thermal-Tunnel
Zhang Qiang
　　Abstract　This article describes briefly the performance and the characteristics of ADVANTECH's modules of ADAM4000 series,and demonstrates in details how to construct a data acquisition system used in Thermal-Tunnel as well as the application of the LABTECH CONTROL configuration software package in the whole system.
　　Key words　Data acquisition system,Module,Configuration software package,Thermal-Tunnel

　　概述
　　热校准风洞的测试参数包含许多种，如温度、压力、电压、电流、电阻、流量等，整个试验过程比较烦琐，为了提高动态测试的精度以及减少信号在传输过程中的损失，在选择数据采集系统时要仔细考虑。目前，数据采集系统的种类多种多样，普通的数据采集系统采用板卡结构，传感器信号直接与板卡相联，通过计算机控制板卡的数据采集，这就存在一个问题：传感器信号在传输过程中很容易受到外界的干扰，引起测量数据的不准确。另外，还有一种数据采集系统，它采用的是模块化设计，根据不同的测试参数设计出不同的模块，这种模块便于现场采集数据，抗干扰能力比较强，传感器信号通过模块内部将模拟信号转换成数字信号再传给计算机，由于数字信号不受外界环境的干扰，被测数据的准确度大大增加。相应的软件系统也有多种开发途径。一是采用传统的软件开发工具如C++等开发自己的应用程序，但是开发周期长、困难多，且在今后的维护工作存在着问题;二是采用组态软件包开发，组态软件开发周期短、易维护、易扩展，因而值得推广。
1　数据采集系统――ADAM4000系列模块
　　台湾研华公司生产的ADAM4000系列数据采集模块是一种模块内内置微控制器，传感器到计算机接口的智能设备。该系列模块提供信号调理、隔离、调整量程、A/D和D/A转换、数据比较及数据通讯功能，某些模块还可以数字量I/O控制继电器及TTL器件。ADAM模块能连接到计算机并与之通讯。计算条件为：入射波长λ=1米，俯仰角为0°（即θ=90°），方位观察角Φ从0°至+90°变化；正轴线方向为x轴。RS―485 网络提供较低噪声传感器读入，主计算机通过ADAM RS―232/RS―485转换器,用一个COM通讯端口连到RS―485网络。
　　模拟量输入模块采用微处理器控制的集成A/D转换器，将传感器电压、电流、热电偶或RTD信号转换成数字量。然后根据模块的配置将数字量变换成工程单位、十六进制表示的二进制补码或满量程的百分数。当主计算机提出请求时，转换后的数据通过标准的RS―485接口送给主计算机。其外形及尺寸如图1示。通过提供A/D输入的光电耦隔离和变压器隔离，转换器的隔离电压达500 V DC，该系列模块能防止电源对地干扰和电源浪涌。RS―485网络仅需两根线：DATA+和DATA-，通过低廉的屏蔽双绞线连接。
　　在“热校准风洞”的数据采集系统中,主要用到的是模拟量输入模块和通讯模块，模拟量输入模块主要包括：ADAM―4011、ADAM―4012、ADAM―4013、ADAM―4017、ADAM―4018;通讯模块包括：ADAM―4510、ADAM―4520。从中可见：　　


图3.2　圆概率误差(CEP)和坡度
标准差关系曲线
(1)系统的圆概率误差(CEP)的大小虽然有些波动，但是它的总体趋势随坡度标准差(stdslp)增加而减小。
　　2)ADAM―4012接收
　　a.毫伏级电压输入：±150 mV，±500 mV
　　b.伏级电压输入：±1 V，±5 V，±10 V
　　c.电流输入：±20 mA
　　并提供一个模拟量输入通道。
　　3) ADAM―4013接收来自铂、镍RTD（电阻式温度探测器）的输入,并提供一个模拟量输入通道。
　　4)ADAM―4017接收同ADAM―4012,并提供八个模拟量输入通道。
　　5) ADAM―4018接收同ADAM―4011,并提供八个模拟量输入通道。
1.2　通讯模块
　　1)ADAM―4520
　　ADAM―4520是RS―232/RS―485转换器，当计算机有RS―485接口时，就可以直接连到网络上。当飞行器经过预定区域上空时，利用惯导提供的位置和速度信息，在数字地图上采用地形随机线性化技术对地形进行拟合来提取地形参数。
　　2)ADAM―4510
　　ADAM―4510是RS―485中继器，有两种情况需要使用中继器：
　　a.连接的模块数超过16个;
　　b.接到模块的连接线太长。扁棱柱体（点划线示）的散射在水平极化时角度平均最低，但在0°方向并未像高频区那样出现极低的RCS值。　　


1.1　地形辅助导航系统原理框图
由图1.1可见，地形是影响系统定位精度的因素之一。由于ADAM4000系列模块是通过RS―485协议进行通讯，数据是通过数字量进行传输，这样就避免了信号在传输过程中的干扰和损失。另外，还有一个好处是ADAM4000系列模块可以放在现场进行采集，安装也非常方便，灵活性、机动性非常好。
2　LABTECH CONTROL组态软件包
　　工业控制是计算机应用的一个重要领域，在这个领域内一般各用户自己开发各自专门的软件;因此，当应用对象发生变化时，往往需要重新开发软件，工作量很大。现在，为了方便开发计算机应用系统，有很多菜单驱动的具有通用性的组态软件问世。由于地形的多样性、复杂性和差异性，因此，如何选择适合辅助导航的地形是实际应用中碰到的难题。
2.1　LT的主要性能
　　.过程监督
　　.报警监督和控制
　　.实时数据显示
　　.数据记录和保存
　　.过程控制
　　.容错功能
2.2　LT的工作原理
　　在正常模式下，数据通过不同的I/O设备接口，从不同的模块中读入数据，还可以将收集到的数据存入磁盘和显示。而在高频区某些具有低散射性能的目标，由于其表面的不连续性，在低频区未必保持其低散射特性；在某些观测方向的散射强度甚至高于常规目标。如果有控制输出，则处理后的输出数据放于相应的内存，然后按照组态条件规定的采样频率向I/O设备送出。当处理器在两次从I/O采样之间有间隙时，LT出空RAM缓冲区将数据写入磁盘;当处理器在I/O采样和写盘之间有间隙时，LT刷新屏幕显示。
2.3　LT的菜单登录功能
　　LT的所有软件皆是菜单驱动软件，都有一套完整、灵活、容易掌握的菜单系统。扁棱柱体的外形与现代低散射特性飞机有些类似，其宽取为2λ，高取0.5λ；这种外形更能有效减缩高频散射。用户通过光标键和回车键选择命令，在任何一级菜单，一按ESC键就回到它的上级菜单。
3　数据采集系统的开发和应用
　　用ADAM4000系列模块组成热校准风洞的数据采集系统，软件利用LT软件包开发。

h(i-1,j-1)h(i,j-1)h(i+1,j-1)
h(i-1,j)h(i,j)h(i+1,j)
h(i-1,j+1)h(i,j+1)h(i+1,j+1)

　图2.1　格网位置(i,j)及其邻域的高程示意图


图2.2　坡度分布灰度图
3　仿真结果及其分析
　　仿真过程流程如图3.1所示。
3.1　硬件配置时容易出现的问题
3.1.1　关于ADAM4000系列模块的接口问题
　　ADAM4000系列模块在投入使用之前,必须通过一个初始化程序（ADAM）对其进行初始化配置，内容包括模块的地址、量程等。初始化之后，再在LT软件中对ADAM4000系列模块进行硬件安装，在安装时需要注意的是bass address一定要设置对，对于ADAM4000系列模块,其bass address 对应的是它与计算机连接的串口号码。如果ADAM4000系列模块与计算机的COM1相连，则bass address即为1;如果ADAM4000系列模块与计算机的COM2相连，则bass address即为2。另外,在Block菜单中，接口通道一定要写对，对于单通道模块如ADAM―4011、ADAM―4012、ADAM―4013等，接口通道号即是在初始化时设定的地址号码;对于多通道模块如ADAM―4017、ADAM―4018，其接口通道是一个四位数，前两位表示的是该模块初始化时设定的地址号码，后两位表示的是该模块选中的通道，例如:一块ADAM―4018，其初始化地址为03，如果此时选中第0号通道，则在Block菜单中接口通道号即为300;如果选中的是第3号通道，则为303;如果一块ADAM―4011，其初始化地址是02，因为它是单通道模块，所以它的接口通道号为2。
3.1.2　模块采样速度的设置
　　对于ADAM4000系列模块由于其硬件本身最高采样频率是10 Hz，所以尽管计算机的主频率很高，但对于ADAM4000系列模块只能在它所允许的范围内设置采样频率，也就是说,10 Hz是ADAM4000系列模块的采样极限，如果一个系统配置了n个该系列模块，则采样频率为10/n Hz。
　　LT软件包的组态功能较为强大，它的各个功能软件的开发应用，都能基于下拉式菜单或弹出式菜单以及填充方块、功能键的选择，组态功能使得监控管理对象的增加、修改、删除变得很简单，对今后非开发人员的维护工作提供了极大的便利。
3.2　使用LT软件包时容易遇到的问题
　　使用Replay块（重现块）时，所需重现点数不能超过数据文件长度。在使用某些计算块时，需要注意的是模块号码，如使用SUM（X…Y）计算块时，X…Y表示的是从X块到Y块所有模块的值相加，也就是说从X块到Y块必须是连续的。另外，在使用X…Y计算块时,要注意该菜单页X、Y的顺序;某些计算块需使用参数r，r值一定要设置对。组态功能使得在试验过程中，有时需要观察移测偶在核心区的曲线分布。
2.1　卡尔曼滤波模型
　　状态方程：
Xk+1=Φk+1,kXk+Wk(2.1-1)
　　测量方程
Zk+1=Hk+1Xk+1+Uk+1(2.1-2)
Xk=［δxk,δyk,δzk］T(2.1-3)
Φk+1,k=100
010
001(2.1-4)
Hk=(-αk,-βk,1)(2.1-5)
Zk=Ck-Ak(2.1-6)
Uk=Vk+V′k-εk(2.1-7)
式中　δxk,δyk,δzk分别为k时刻X，Y，Z方向上的位置误差；
　　　αk,βk分别为k时刻拟合平面在X，Y方向上的地形斜率；
　　　Ck为k时刻雷达高度表的测量值；
　　　Ak为k时刻飞行器的参考位置到拟合平面的距离；
　　　Vk，V′k分别为k时刻雷达高度表和气压高度表的测量噪声；
　　　εk为k时刻地形拟合误差(称之为拟合噪声)；
　　　Wk为k时刻动态噪声。在用矩量法求解上述方程时，首先用N个三角形平面面元模拟导体表面；选择适当的面元电流基函数，将表面电流写成的形式，并代入上述公式；然后用适当的检验函数（本文选基函数作为检验函数）对公式两边作内积运算，从而把矢量方程简化为矩阵方程：
　　TM：
［Z］［I］=［V］
（6）　　TE：
［B］［I］=［T］
（7）　　各已知矩阵的阵元表达式如下：zmn=Lmjω(8)
(9)

　　(10)
(11)
　　其中：m=1,2,3……N;　n=1,2,3……，N
　　式中式中是入射场，上标加、减号分别代表一对相邻面元的两侧；Lm是相邻面元的公共边长，c表示面元重心矢径，是公共边对应顶点至重心的矢径。软件的组态功能为工作人员的维护工作提供了便利。
27岁　男　助理工程师　读者服务卡索引号： 114
作者单位：长城计量测试技术研究所,北京市,100095
参考文献
　[1]　工业控制领域最流行的软件包LABTECH汇编
　[2]　LABTECH Hardware Interface Guide
　[3]　ADAM4000系列数据采集模块用户手册
1998-08-17收稿
