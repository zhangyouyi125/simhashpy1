宇航学报
JOURNAL OF ASTRONAUTICS 
1999年　第20卷　第4期　vol20　No.4　1999




一种新的最优地形跟随轨迹算法
闵昌万　丁滢颍　袁建平
　　摘　要　考虑地形因素和敌方威胁的潜在影响，研究了在安全保障前提下，飞行时间-地形庶蔽程度综合最优的地形跟随飞行轨迹问题，提出一种新的最优地形跟随飞行轨迹的算法。首先定义了最小危险曲面，通过坐标变换将飞行器的运动方程变换到该曲面上；再运用极小值原理，求出满足飞行时间-地形遮蔽最优的轨迹的微分方程组；最后用一维搜索算法，通过寻求微分方程的初值解出了最优轨迹。仿真结果表明该算法所产生的三维轨迹光滑连续，不仅能紧密跟踪地形，而且能自动回避威胁和障碍。
　　主题词　最优规迹　地形跟随　极小值原理　一维搜索
A NEW ALGORITHM FOR OPTIMAL TERRAIN 
FOLLOWING TRAJECTORY
Min Changwan
(China Academy of Launch Vehicle Technology . Beijing . 100076)
Ding Yingying　Yuan Jianping
(Northwesten Polytechnical University,College of Astronautics . Xi'an . 710072)
　　Abstract　A new algorithm for optimal terrain-following trajectory with respect to the constains of time,obstacle,threat,and final position is presented.First,the concept of SOMR(Surface of Minimum Risk) is introduced and the constrains of the terrain and the threat envelopes are incorporated into the vehicle equations of motion through a transformation.Second,Pontryagin' minimum value principle is employed together with a one-dimensional search scheme to generate the time-terrain masking optimal trajectory.The results of simulation show the approach works well.
　　Key words　Optimal trajectory Terrain-following Minimum value principle One dimentional search
1　引言
　　地形跟随主要是指飞行器以一定的间隙高度沿地表起伏飞行，利用地形杂波掩护，躲过敌方雷达的搜索，达到突防之目的。诸如此类的检测实验，关键问题是测、控温的问题。它与地形回避、威胁回避一起已成为突防的主要技术手段。综合考虑时间、地形障碍、可用过载等约束因素，设计出最优轨迹，是军用飞行器实施地形跟随飞行首先要解决的关键问题之一。
表2

α(°)R
P(cosα＋(P／100)sinα)△％P(cosα-(P／100)sinα)△％
0.51.00004＋0.0040.99987－0.01
11.00002＋0.0020.99967－0.03
1.50.99992－0.0080.99940－0.06
20.99974－0.030.99904－0.1
2.50.99948－0.050.99861－0.14
30.99915－0.080.99811－0.19


　　由表2知，要使传感器的测量重复性在±0.05％以内，须保证侧向力与轴线的夹角不大于1°，要使重复性在0.1％以内，必须保证其夹角不大于2°。文献［1］用奇异摄动理论研究了水平航迹优化问题。计量检定人员必须取得上级计量部门的考核合格证，方能独立从事检定测试工作。文献［2］用离散动态规划法研究了有约束的轨迹优化问题。在企业质量体系建设中，要认真学习国际标准ISO-10012――计量确认体系，进一步完善检测手段，提高检测人员素质，强化监督，优化服务，提高质量，为经济建设和发展做出贡献。文献［3］用最优控制理论研究了直升机的最优轨迹规划问题，但其考虑的模型过于简单。文献［4］用非线性规划法研究了巡航弹的航迹优化问题，这种方法需要事先选取一条合适的参考航线，而且离散误差的影响及结点的选取也是一个问题。


图1
2　表面温度传感器自动检定系统的组成及功能
　　自动检定系统的硬件部分由微机、Keithley-2000型数据采集器、扫描器、显示器、打印机组成。首先定义了最小危险曲面(Suface of Minimum Risk)，通过坐标变换将飞行器的运动方程变换到该曲面上，从而将地形和威胁因素引入飞行器运动方程；再运用极小原理，求出飞行时间-地形遮蔽最优的轨迹的微分方程组；最后利用初端和终端约束条件，通过一维搜索算法寻找出合适的方程初值，得出了最优轨迹。
　　m＝2j时，直流偏置do的变化对增益评价误差与线性度评价误差均无贡献。
　　③当噪声频率很低时，动态误差值很小；当频率很高时，由于滤波网络衰减作用动态误差值也会降到很低；但在过渡带附近相当宽广的频带范围内，都存在很强的动态误差，并且与振动噪声信号幅值成正比。显然，飞行器受地形掩护的效果与其离地高度有极大关系，离地越低越不容易被敌方雷达发现。利用两个差动变压器传感器A和B对移动中的板材在线测厚，被测物体在平移过程中上下颠簸，随机振动，其幅值远远超过工件尺寸变化量，有时甚至超过工件本身尺寸，而且频带很宽。因此存在一个最佳离地高度，称之为间隙高度，记为hc
　　威胁的影响区域可以用其包络线e(x,z)来表示，可以将之当成特殊的山，叠加到地形函数上去。由此得最小危险曲面(SOMR)的表达式为F(x,z)=hc+f(x,z)+e(x,z)这个式子是定义在地面坐标系上。假定F(x,z)≥0且连续并存在两阶导数。通过对数字地图进行三次样条曲面拟合，或用文献［5］的卷积插值法，满足上述假定并不困难。
2.2　飞行器数学模型
　　　　　　　　　　　　　　　(1)
　　　　　　　　　　　　　　　　　(2)
　　　　　　　　　　　　　　(3)
　　　　　　　　　　　　　　(4)
　　　　　　　　　　　　　　(5)
　　　　　　　　　　　　　　　(6)
上式中，x,y,z为地面坐标系上的三坐标，nx,ny,nz分别为弹道坐标系上的切向过载和法向过载，θ，ψ分别为弹道倾角和弹道偏角。其中不考虑切向过载的约束，法向过载所受约束为：
nymim≤ny≤nymax　　　　　　　　　　　　　　(7)
nzmin≤nz≤nzmax　　　　　　　　　　　　　　(8)
　　轨迹的端点约束为给定的飞行器初始位置和必须到达的目标点。该系统的特点是实现了计算机对数据的自动采集、整理、显示和记录，并可对采集到的数据在屏幕上以动态波形的方式显示，且能实时对采集数据进行判断及粗大误差的剔除。
3　最优轨迹生成算法
　　通过前面的分析知道，当飞行器在最小危险曲面上飞行时，其生存概率最大。轨迹优化的目的是要在该曲面上寻找一条使性能指标(9)式最小的曲线。
6　结束语
　　这种新研制的便携式飞机称重仪已在南昌飞机制造公司、深圳中海直公司、新乡陆航维修大队、珠海直升机公司、通县陆航飞行团等单位使用，均得到了较好的评价。主要机构有电子工程、制造工艺、化学科学和技术、材料科学和工程、物理学、建筑和防火研究、信息技术、行政管理和技术服务等。
0＜υmin≤υ≤υmax　　　　　　　　　　　　　(16)
构造哈密尔顿函数为：
　　(17)
因控制变量ψ自由，由极小值原理得，
　　　　　　　　　　　　　　　　(18)
展开化简(18)式得：
λx［sinψ-Fz(Fxcosψ-Fzsinψ)］=λz［-Fx(Fxcosψ-Fzsinψ)-cosψ］　　　(19)
终端时间tf自由，所以：H(t)≡0　　　　　0≤t≤tf　　　　　　　　　　　　　　　　　　　　　(20)
联解(19)、(20)式，得：
　　　　　　　(21)
　　　　　　(22)
对协态变量有，
　　　　　　　　　　　　　　(23)
　　　　　　　　　　　　　　　(24)
展开(23)、(24)两式，并将(21)、(22)式代入得：
　　　(25)
　　　(26)
在(19)式两边对时间求导数，并代入(21)、(22)、(25)、(26)式，消去协态变量：
　　　　　　　　　　　　　　(27)
上式中　A=1+F2x+F2z　B=Fxcosψ+Fzsinψ　C=1-k+kF
　　　
由(12)式得，　　　　　　　　　　　　　　　　　　　　　　　　　　　(28)
　　下面来分析第二个控制变量，即速度υ。由于速度受到式(16)式的约束，因此最优控制是一种梆―梆控制。其开关函数为：
　　　(29)
将λx、λz的表达式(21)和(22)式代入上式，得，　　　　　　　(30)
所以，υ=υmax是最优控制速度。
　　上述分析是针对不考虑动力学方程约束的情形。当考虑过载约束时，情况有所不同，将、的表达式分别代入(5)、(6)两式得：
　　　　　　　　　(31)
　　　　　　　　　　　(32)
可见速度受到过载的约束，其与过载成平方关系。设满足(31)式的最大速度为υmax1，满足(32)式的最大速度为υmax2，则最优控制速度为υopt=min(υmax1,υmax2,υmax)，即取三者中的最小值。大家都是在自觉地完成各项工作，并且工作的目的是保证质量、提高水平。
　　通过上述分析，最优轨迹规划问题简化为求解三个一次非线性微分方程，即式(14)、(15)和(27)。其中已知初端条件(x0、z0)和末端条件(xf、zf)。通过一个一维搜索索算法，选择初始弹道偏角ψ　(0)，可以求出最优轨迹。图1是该算法流程图。再结合K型热电偶的分度表，我们将会得到AD595的输出为10 mV／°C，可见它是线性输出，这使得硬件电路和软件编程都变得比较简单。为便于构造最小威胁曲面SOMA，地形轮廓用下式表示，其特征可用四个参数概括(h0,r0,x0,z0)。h　(x,z)=h0+h0cos(x-x0)2+(z-z0)2≤r20仿真时选取三座山，特征参数分别为(200m,300m,1000m,0m)，(250m,3000m,6000m,400m)，(150m,1500m,12000m,-400m)。离地间隙高度hc=50m，加权系数k=0.85，初始点(0m,-50m)，终点为(1800m,0m)。当初始弹道偏角为-3.5度时，能够得到满足各个约束的最优轨迹。
　　　　　　　　
图2　三维跟踪轨迹　　　　　　　　　　　　　　　图3　纵向航迹曲线
　　　　　　　　　
图4　航向轨迹曲线图　　　　　　　　　　　　　　　　图5　过载曲线
5　过载曲线
　　本文提出一种新的最优地形跟随轨迹算法，它首先通过引入最小危险曲面，在运动方程中考虑地形和威胁的影响来简化问题，再运用极小值原理求出最优轨迹的微分方程组，最后通过一个一维搜索算法求出最优轨迹。
　　由表4可见，A／D位数不同时，表1至表3的趋势及结论仍存在。
作者单位：闵昌万中国运载火箭技术研究院14所 . 北京 . 100076
　　　　　丁滢颍、袁建平：西北工业大学航天工程学院 . 西安 . 710072
参考文献
1　邱晓红，等.战术飞行任务的水平航迹快速生成算法.北京航空航天大学学报，1996，22(6)：775-779
2　袁卫东，等.一种新的综和最优航迹算法.南京航空航天大学学报，1996，28(4)：482-486
3　Menon P.et al.Optimal Trajectory Synthesis for Terrain-Following Flight.J.Guidance,1991,14(4):807-813
4　胡昱，高正源.战术飞行轨迹优化方法.飞行力学，1997，15(3)：7-12
5　李清，等.数字地图数据的二维三次卷积插值.南京航空航天大学学报，1997，29(4)：378-384
收稿日期:1998年4月3日
修回日期:1998年8月31日
