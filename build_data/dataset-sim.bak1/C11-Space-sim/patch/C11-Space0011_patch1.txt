宇航学报
JOURNAL OF ASTRONAUTICS 
1999年　第20卷　第4期　vol20　No.4　1999




一种新的最优地形跟随轨迹算法
闵昌万　丁滢颍　袁建平
　　摘　要　考虑地形因素和敌方威胁的潜在影响，研究了在安全保障前提下，飞行时间-地形庶蔽程度综合最优的地形跟随飞行轨迹问题，提出一种新的最优地形跟随飞行轨迹的算法。首先定义了最小危险曲面，通过坐标变换将飞行器的运动方程变换到该曲面上；再运用极小值原理，求出满足飞行时间-地形遮蔽最优的轨迹的微分方程组；最后用一维搜索算法，通过寻求微分方程的初值解出了最优轨迹。仿真结果表明该算法所产生的三维轨迹光滑连续，不仅能紧密跟踪地形，而且能自动回避威胁和障碍。
　　主题词　最优规迹　地形跟随　极小值原理　一维搜索
A NEW ALGORITHM FOR OPTIMAL TERRAIN 
FOLLOWING TRAJECTORY
Min Changwan
(China Academy of Launch Vehicle Technology . Beijing . 100076)
Ding Yingying　Yuan Jianping
(Northwesten Polytechnical University,College of Astronautics . Xi'an . 710072)
　　Abstract　A new algorithm for optimal terrain-following trajectory with respect to the constains of time,obstacle,threat,and final position is presented.First,the concept of SOMR(Surface of Minimum Risk) is introduced and the constrains of the terrain and the threat envelopes are incorporated into the vehicle equations of motion through a transformation.Second,Pontryagin' minimum value principle is employed together with a one-dimensional search scheme to generate the time-terrain masking optimal trajectory.The results of simulation show the approach works well.
　　Key words　Optimal trajectory Terrain-following Minimum value principle One dimentional search
1　引言
　　地形跟随主要是指飞行器以一定的间隙高度沿地表起伏飞行，利用地形杂波掩护，躲过敌方雷达的搜索，达到突防之目的。在直升机的贴地飞行(Nap-of-the Earth flight)以及巡航导弹和飞机对地攻击的突防飞行中，其有着重要应用［1-4］。大家都是在自觉地完成各项工作，并且工作的目的是保证质量、提高水平。综合考虑时间、地形障碍、可用过载等约束因素，设计出最优轨迹，是军用飞行器实施地形跟随飞行首先要解决的关键问题之一。我们自1970年以来一直在探索飞机称重中的有关问题，最近通过在千斤顶下面加装滑动底盘的方法解决了千斤顶式飞机称重系统的抗侧向能力差的难题。文献［1］用奇异摄动理论研究了水平航迹优化问题。这种方法的不足之处在于往往难以确定状态变量变化的时间尺度。文献［2］用离散动态规划法研究了有约束的轨迹优化问题。该方法的缺点在于计算量大，特别是对于不平坦的地形。如果利用微机自动测试系统从事检定过程的数据采集及处理，就可以将检定炉与测试人员分别隔离在两个房间，减小检定炉周围的环境变化，同时通过提高测量速度，可以起到提高检定质量，确保量值传递准确可靠的作用。文献［4］用非线性规划法研究了巡航弹的航迹优化问题，这种方法需要事先选取一条合适的参考航线，而且离散误差的影响及结点的选取也是一个问题。
　　本文考虑地形因素和敌方威胁的潜在影响，研究了在安全保障前提下，飞行时间-地形遮蔽程度综合最优的地形跟随飞行轨迹问题。首先定义了最小危险曲面(Suface of Minimum Risk)，通过坐标变换将飞行器的运动方程变换到该曲面上，从而将地形和威胁因素引入飞行器运动方程；再运用极小原理，求出飞行时间-地形遮蔽最优的轨迹的微分方程组；最后利用初端和终端约束条件，通过一维搜索算法寻找出合适的方程初值，得出了最优轨迹。目前我国大部分的飞机制造厂所使用的飞机称重方法是：大型的机械磅秤或电子台秤加千斤顶的方法。
　　上述几个前提下的评价方法的共同特点，是直接应用到数据采集系统的直流增益和线性度评价中，被评价指标结果波动性、离散性均较大，尚不能称其为精确评价方法。其相应的搜索规则分别为：

IFe1≤yr－y(KT) THEN S1
IFe2≤yr－y(KT)＜e1 THEN S2
IFe3≤yr－y(KT)＜e2 THEN S3
IF0≤yr－y(KT)＜e3 THEN S4
IF－e3≤yr－y(KT)＜0 THEN S5
IF－e4≤yr－y(KT)＜－e3THEN S6
IFyr－y(KT)＜－e4 THEN S7
IFy(KT)∈SiTHEN Ri


图6　控制局势划分
　　其中S1为大偏差情况，S2、S3为过渡情况，S4、C5为允许误差情况，S6为超调情况，S7为大超调报警情况。但离地太低了，飞行器撞地的概率也增加了。
　　该体系要求：供方应建立和保持一个包括计量标准在内的计量检测设备的管理、确认和使用有效的文件化的体系，以保证是否满足所规定的要求，这种体系的设计应保证所有计量检测设备的运行符合预计要求，并保证一旦出现问题就能迅速发现并能及时采取措施，保证计量检测设备产生不合格误差的风险控制在允许范围内。由此得最小危险曲面(SOMR)的表达式为F(x,z)=hc+f(x,z)+e(x,z)这个式子是定义在地面坐标系上。假定F(x,z)≥0且连续并存在两阶导数。用户利用标准物质可解决测量的溯源性问题，有了溯源性，量值便得到了保证。
2.2　飞行器数学模型
　　　　　　　　　　　　　　　(1)
　　　　　　　　　　　　　　　　　(2)
　　　　　　　　　　　　　　(3)
　　　　　　　　　　　　　　(4)
　　　　　　　　　　　　　　(5)
　　　　　　　　　　　　　　　(6)
上式中，x,y,z为地面坐标系上的三坐标，nx,ny,nz分别为弹道坐标系上的切向过载和法向过载，θ，ψ分别为弹道倾角和弹道偏角。并经常组织计量人员对新规程的学习和技术交流活动，提高计量水平和能力。轨迹优化指标取为
　　　　　　　　　(9)
由于该性能指标对飞行时间和飞行高度进行惩罚，而飞行高度与地形遮蔽效果紧密相关，因此所得的轨迹是飞行时间-地形遮蔽程度综合最优的。硬件主要由热电偶专用放大器、8031单片机及其数字调功电路组成，软件采用了智能产生式控制算法。轨迹优化的目的是要在该曲面上寻找一条使性能指标(9)式最小的曲线。因此有：
y=F(x,z)　　　　　　　　　　　　　　　　(10)
　　　　　　　　　　　　(11)
由(1)、(2)、(3)式和(11)式得：
tgθ=Fxcosψ-Fzsinψ　　　　　　　　　　　(12)
　　　　(13)
将(13)式代入(1)、(3)式，消去cosθ得：
　　　　　　　　　　　(14)
　　　　　　　　　　　(15)
　　通过上述变换，将地形和威胁的影响引入运动方程(14)和(15)式，从而使问题变得简单。暂不考虑动力学方程(4)、(5)、(6)式的约束，以(14)、(15)式为系统状态方程，以速度υ和弹道偏角ψ为控制变量，其中弹道偏角ψ自由，速度υ满足(16)式约束，对性能指标(9)式求极小值。
　　3)200～650 °C的接触式表面温度传感器在准绝热幅射屏式表面温度检定炉中检定，方法同2)。由于速度受到式(16)式的约束，因此最优控制是一种梆―梆控制。其开关函数为：
　　　(29)
将λx、λz的表达式(21)和(22)式代入上式，得，　　　　　　　(30)
所以，υ=υmax是最优控制速度。则测量系统的直流增益就是G。当考虑过载约束时，情况有所不同，将、的表达式分别代入(5)、(6)两式得：
　　　　　　　　　(31)
　　　　　　　　　　　(32)
可见速度受到过载的约束，其与过载成平方关系。设满足(31)式的最大速度为υmax1，满足(32)式的最大速度为υmax2，则最优控制速度为υopt=min(υmax1,υmax2,υmax)，即取三者中的最小值。
　　对于高阶网络，或更复杂的滤波网络，可等效成若干一阶与二阶网络的级联，电路自由度更多，参数失配的概率也更大。
　　通过上述分析，最优轨迹规划问题简化为求解三个一次非线性微分方程，即式(14)、(15)和(27)。其中已知初端条件(x0、z0)和末端条件(xf、zf)。通过一个一维搜索索算法，选择初始弹道偏角ψ　(0)，可以求出最优轨迹。图1是该算法流程图。

图1　算法流程框图
4　仿真结果
　　本文利用虚拟地形对上述算法进行仿真验证，结果如图2～5所示。
表1

ω／ω0r1r2r
0.20.190.040.19
0.40.320.130.34
0.60.380.230.44
0.80.380.300.48
1.00.350.350.50
1.20.310.380.49
1.40.270.380.47
1.60.240.380.45
1.80.210.370.42
2.00.180.360.40


图3
　　虽然高精度动态测量仪器滤波网络采用一阶环节的可能性不大，但如果在和差运算电路之前，两路信号通路各有一组独立的一阶环节，由前面的分析计算可知，其特征参数ω0的失配，对动态测量精度的影响也是相当可观的。h　(x,z)=h0+h0cos(x-x0)2+(z-z0)2≤r20仿真时选取三座山，特征参数分别为(200m,300m,1000m,0m)，(250m,3000m,6000m,400m)，(150m,1500m,12000m,-400m)。离地间隙高度hc=50m，加权系数k=0.85，初始点(0m,-50m)，终点为(1800m,0m)。当初始弹道偏角为-3.5度时，能够得到满足各个约束的最优轨迹。
　　　　　　　　
图2　三维跟踪轨迹　　　　　　　　　　　　　　　图3　纵向航迹曲线
　　　　　　　　　
图4　航向轨迹曲线图　　　　　　　　　　　　　　　　图5　过载曲线
5　过载曲线
　　本文提出一种新的最优地形跟随轨迹算法，它首先通过引入最小危险曲面，在运动方程中考虑地形和威胁的影响来简化问题，再运用极小值原理求出最优轨迹的微分方程组，最后通过一个一维搜索算法求出最优轨迹。仿真结果表明该算法所产生的三维轨迹光滑连续，不仅能紧密跟随地形，而且能自动回避威胁和障碍。
作者单位：闵昌万中国运载火箭技术研究院14所 . 北京 . 100076
　　　　　丁滢颍、袁建平：西北工业大学航天工程学院 . 西安 . 710072
参考文献
1　邱晓红，等.战术飞行任务的水平航迹快速生成算法.北京航空航天大学学报，1996，22(6)：775-779
2　袁卫东，等.一种新的综和最优航迹算法.南京航空航天大学学报，1996，28(4)：482-486
3　Menon P.et al.Optimal Trajectory Synthesis for Terrain-Following Flight.J.Guidance,1991,14(4):807-813
4　胡昱，高正源.战术飞行轨迹优化方法.飞行力学，1997，15(3)：7-12
5　李清，等.数字地图数据的二维三次卷积插值.南京航空航天大学学报，1997，29(4)：378-384
收稿日期:1998年4月3日
修回日期:1998年8月31日
