计算机应用
Computer Applications
1999年 第19卷 第7期  Vol.19 No.7 1999



电子商务中在线支付的安全保障
刘卫宁　宋　伟

　　摘　要　本文详细分析和比较了保障在线支付安全的主流协议： SSL协议和SET协议。
　　关键词　在线支付，安全， SSL，SET
　　
SECURE FACILITIES FOR ONLINE PAYMENT
IN ELECTRONIC COMMERCE

Liu Weining　Song Wei 
Computer Science & Engineering College, Chongqing University, Chonqging 400044
　　Abstract　This paper analyzes and compares the popular protocols which ensure the security of online payment system: SSL and SET.
　　Keywords　Online payment, Security, SSL, SET

　　实现电子商务的关键是要保证商务活动过程中系统的安全性，即应保证在向基于Internet的电子交易转变的过程中与传统交易的方式一样安全可靠。
　　虽然Internet以开放性著称，在安全方面具有脆弱性。但是，随着Internet的发展和电子商务时代的到来，人们在Internet安全上所进行的努力已改变了这种情况。今天电子商务中采用的安全技术已成为一种成熟的、实用的安全技术。■
作者单位：刘华蓥(大庆石油学院计算机系 安达 151400)
收稿日期：1999-07-12
。为了保证在线支付的安全，需要采用数据加密和身份认证技术，以便营造一种可信赖的电子交易环境。在线交易首先要验证或识别参与交易活动的各个主体，如持卡消费者、商家、受卡银行和支付网关的身份（身份用数字证书表示），以及保证持卡人的信用卡号不会被盗用，这样客户才可以放心地在网上购物。如果我们每个实体都逐个逐个地去贴材料，可想其工作量是十分巨大的。　　
1　SSL协议
　　SSL协议是Netscape公司在网络传输层之上提供的一种基于RSA和保密密钥的用于浏览器和Web服务器之间的安全连接技术。众所周知，Socket只是一个编程界面，并不提供任何安全措施。而工程制图试题库的信息主要是图形，信息量很大。SSL3.0通过数字签名和数字证书可实现浏览器和Web服务器双方的身份验证。在用数字证书对双方的身份验证后，双方就可以用保密密钥进行安全的会话了。
　　这种简单加密模式的特点是：
　　* 部分或全部信息加密；
　　* 采用对称的和非对称的加密技术；
　　* 通过数字证书验证身份；
　　* 采用防止伪造的数字签名。
　　SSL协议在应用层收发数据前，协商加密算法、连接密钥并认证通信双方，从而为应用层提供了安全的传输通道；在该通道上可透明加载任何高层应用协议（如HTTP、FTP、TELNET等）以保证应用层数据传输的安全性。SSL协议实现简单，并且独立于应用层协议，因此，在电子交易中被用来安全传送信用卡号码。
　　SSL协议握手流程由两个阶段组成：服务器认证和用户认证（可选）。
　　服务器认证阶段
　　* 客户端向服务器发送一个“Hello”信息，以便开始一个新的会话连接；
　　* 服务器根据客户的信息确定是否需要生成新的主密钥，如需要则服务器在响应客户的“Hello”信息时将包含生成主密钥所需的信息；
　　* 客户根据收到的服务器响应信息，产生一个主密钥，并用服务器的公开密钥加密后传给服务器；
　　* 服务器恢复该主密钥，并返回给客户一个用主密钥认证的信息，以此让客户认证服务器。
　　这样通过主密钥引出的密钥对一系列数据进行加密来认证服务器，从而建立安全的通信通道。
关键词：消息　消息环　消息映射机制　GetMessage PeekMessage DispatchMessage▲
一、消息、消息环和消息映射机制
　　Windows 中应用程序和应用程序之间、应用程序和用户之间的通信是靠消息来实现的。
　　经认证的服务器发送一个提问给客户，客户则返回（数字）签名后的提问和其公开密钥，从而向服务器提供认证。
　　SSL支持各种加密算法。在“握手”过程中，使用RSA公开密钥系统。建立一个完整的备份策略需要考虑很多因素，包括：
　　.备份周期。 DeviceIoControl(hDevice,W32IF-PASS-EVENT,inBut,sizeof(PVOID),RetInfo,sizeof
(RetInfo),&cbBytesRetumed,NULL))
AfxMessageBox("DeviceIoCtl Failed。
　　SSL协议实现简单，独立于应用层协议，且被大部分的浏览器和Web服务器所内置，便于在电子交易中应用，国际著名的CyberCash信用卡支付系统就支持这种简单加密模式，IBM等公司也提供这种简单加密模式的支付系统。
　　例如：按姓名、性别查人数，按性别、年龄、民族和指定入党入团时间查团党员人数，查推优人数及姓名，单位列表查询，按奖项查人数及姓名，按时间和单位查获奖人数及姓名。　　
2　SET协议
　　SET协议是针对开放网络上安全、有效的银行卡交易，由Visa和Mastercard联合研制的，为Internet上卡支付交易提供高层的安全和反欺诈保证。由此可见我们减少了许多重复的工作。
2.1　SET协议为电子交易提供的安全措施
　　SET协议保证了电子交易的机密性、数据完整性、身份的合法性和防抵赖性。
　　* 机密性（Confidentiality）
　　SET协议采用先进的公开密钥算法来保证传输信息的机密性，以避免Internet上任何无关方的窥探。目前基于Windows平台的相关产品已经占据了市场份额的90%。
　　SET协议也可通过双重签名的方法将信用卡信息直接从客户方透过商家发送到商家的开户行，而不容许商家访问客户的帐号信息，这样客户在消费时可以确信其信用卡号没有在传输过程中被窥探，而接收SET交易的商家因为没有访问信用卡信息，故免去了在其数据库中保存信用卡号的责任。
　　* 数据完整性（Data Integrity）
　　通过SET协议发送的所有报文加密后，将为之产生一个唯一的报文摘要值（message digest），一旦有人企图篡改报文中包含的数据，该数值就会改变，从而被检测到，这就保证了信息的完整性。
　　* 身份验证（Verification of Identity）
　　SET协议可使用数字证书来确认交易涉及的各方（包括商家、持卡客户、受卡行和支付网关）的身份，为在线交易提供一个完整的可信赖的环境。
　　* 防抵赖性（Non-repudiation of Disputed Charges）
　　SET交易中数字证书的发布过程也包含了商家和客户在交易中存在的信息。因此，如果客户用SET发出一个商品的订单，在收到货物后他（她）不能否认发出过这个订单；同样，商家以后也不能否认收到过这个订单。
2.2　电子交易的主体对象
　　电子交易涉及的主要主体对象有：
　　客户或持卡人（Cardholder）： 电子交易中的持卡消费者；
　　发卡机构（Issuer）： 信用卡的发卡金融机构，它将为客户建立帐号，发出信用卡，它必须保证该信用卡组织的有关规定（包括安全、支付授权等）；
　　商家（Merchant）： 服务提供者；
　　受卡行（Acquirer）： 商家的开户银行，处理信用卡的授权和支付；
　　支付网关（Payment gateway）： 是一个由受卡行（或指定的第三方机构）操作的设备，是金融网与Internet的接口，用来处理商家的支付信息（包括客户的支付命令等）。
2.3　基于SET的电子交易流程
　　基于SET的标准电子交易流程如图1所示。


图1　SET交易流程图

2.3.1　浏览
　　客户通过浏览器从商家的商品目录寻找所需商品。
2.3.2　发送购买请求
　　a） 客户（cardholder）初始化请求
　　客户发送初始化请求给商家（在发送SET报文之前，客户需拥有支付网关交换密钥的私人密钥）。
　　b） 商家发送证书
　　商家收到客户的初始化请求后，为请求报文分配一个唯一的交易标识号，并用商家的私人密钥进行数字签名，然后将初始化响应报文与商家和支付网关的证书一起传给客户。根据物体表面的复杂程度，可以分别采取轮廓拼接法和UNRBS曲面拟合法。
　　d） 商家处理请求报文
　　商家遍历信任链以确认客户证书；
　　商家用客户的公开密钥对订单信息上的双重签名解密，以确保订单在传输过程中未被篡改，其上的签名是客户的；
　　商家处理订单信息请求，同时将支付命令传给支付网关并请求授权；
　　商家产生一个购买响应报文（其中包括商家的签名证书，指明客户的订单已被接收），并对该报文数字签名后发给客户；
　　如果交易被授权，商家将执行订单上规定的送货等服务。所谓的轮廓拼接就是用多边形(一般是三角形)构造通过相邻层上对应轮廓的表面的过程。
2.3.3　支付认证
　　a） 商家请求授权
　　商家产生授权请求，并对它进行数字签名；
　　商家用随机产生的对称密钥对授权请求加密，然后再用支付网关交换密钥的私人密钥对该对称密钥加密；
　　商家将加密的授权请求和来自客户的加密支付命令一起送支付网关。
　　b） 支付网关处理授权请求
　　网关遍历信任链确认商家的证书；
　　网关用其交换密钥的私人密钥对对称密钥解密，然后用对称密钥对授权请求解密；
　　网关用商家的公开密钥验证授权请求上商家的签名；
　　网关遍历信任链确认客户的证书；
　　网关用其交换密钥的私人密钥对对称密钥和客户帐号解密，再用对称密钥对支付命令解密；
　　网关用客户的公开密钥确认支付命令上客户的签名；
　　网关确认商家授权请求中的交易号与客户支付命令中一致；
　　网关通过金融网络向客户的金融机构（发卡机构）发授权请求；
　　网关产生一个授权响应报文，并用网关的私人密钥签名；
　　网关用新产生的随机对称密钥对授权响应加密，然后再用商家交换密钥的公开密钥对对称密钥加密；
　　网关产生一个付款标志（capture token），并用网关的私人密钥签名；
　　网关将加密后的授权响应送商家。
　　例如：组成分工查询，院团校查询，文件目录查询，获奖情况查询，人才库查询，院学生会查询，社会实践团体查询，志愿者服务队查询等。
2.3.4　付款
　　a） 商家请求付款
　　商家产生付款请求；
　　商家将其证书嵌入付款请求中，并用商家的私人密钥对付款请求签名；
　　商家用对称密钥对请求加密，并用支付网关交换密钥的公开密钥对该密钥加密；
　　商家将加密后的付款请求和以前保存的来自授权响应的加密付款标志送给支付网关。
　　b） 支付网关处理付款请求
　　网关遍历信任链确认商家证书；
　　网关用网关交换密钥的私人密钥对对称密钥解密，然后用该对称密钥对付款请求解密；
　　网关用商家的公开密钥确认付款请求上商家的签名；
　　网关用网关交换密钥的私人密钥对对称密钥解密，然后再用对称密钥对付款标志解密；
　　网关确认商家的付款请求与付款标志一致；
　　网关通过金融网络向客户金融机构发付款请求；
　　网关产生付款响应报文（包括网关签名证书），并用网关的私人密钥加密；
　　网关用随机产生的对称密钥对付款响应加密，再用商家交换密钥的公开密钥对该对称密钥加密；
　　网关将加密后的付款响应送商家。
　　c） 商家接收付款响应
　　商家遍历信任链确认支付网关证书；
　　商家用商家交换密钥的私人密钥对对称密钥解密，然后再用该对称密钥对付款响应解密；
　　商家用支付网关的公开密钥确认付款响应上支付网关的签名；
　　商家保存付款响应，以便今后与来自受卡机构支付对帐。
2.4　小结
　　通过上面的分析可以看到，SET定义了一个完备的电子交易流程，它较好地解决了电子交易中各方间复杂的信任关系和安全连接，确保了电子交易中信息的真实性、保密性、防抵赖性和不可更改性。
　　自动组卷时，打开模型文件，用设置的指针变量读出某类试卷模型的个数，用VB提供的随机数发生器返回一个随机数，其值在0-1之间，为了用此数去取到模型，必须将此数变成一个合适的整数，为此将随机数乘以10000后对试卷模型个数取余，再加上这类模型的开始位置即为选到的试卷模型，将试卷模型取出放到预先定义好的数组内。但是，与SSL相比，SET协议具有许多优点：
　　* SET对商家提供了保护自己的手段，使商家免受欺诈的困扰，并使商家的运营成本降低；
　　* 对消费者而言，SET保证了商家的合法性，并且用户的信用卡号不会被窃取，SET替消费者保守了更多的秘密使其在线购物更加轻松；
　　* 银行和发卡机构以及各种信用卡组织非常喜爱SET协议，因为SET帮助它们将业务扩展到Internet这个广阔的空间中，从而使得信用卡网上支付具有更低的欺诈概率，这使得它比其它支付方式具有更大的竞争力；
　　* SET对于参与交易的各方定义了互操作接口，一个系统可以由不同厂商的产品构筑。
　　将来，由于SET交易的低风险性以及各信用卡组织的支持，SET将在基于Internet的卡支付交易中占据主导地位。　　
3　结束语
　　本文详细分析了目前电子交易中的主流协议SSL协议和SET协议。二者均是非常成熟和实用化的协议，能为电子商务提供有力的安全保障。只是两协议所处的网络层次不同，出发点不同，为电子交易提供的安全级别和手段也不同，在实际应用中可根据需求单独使用一个协议或组合使用两个协议。
　　刘卫宁　博士，副教授。
关键词：数据库　备份　恢复
Abstract：This paper discusses the back-up strategy of dif ferent computers, which is used to restore data efficiently in case of a crash o f the data server or MS SQL Server so as to guarantee the entirety and security of data in the MS SQL Server. 
Keywords：database　back-up　restore▲
一、引言
　　信息技术的发展离不开数据库技术的不断发展，从dbase、Foxbase、Foxpro、Access,到Microsoft SQL Server、Sybase SQL Server、Oracle，数据库的规模越来越大，其功能也越来越强大。
　　宋　伟　硕士，讲师。主要研究方向：电子商务、数据库技术、智能交通系统。
　　作者单位：刘卫宁　宋　伟（重庆大学计算机科学与工程学院　重庆 400044）
参考文献
［1］SET Secure Electronic Transaction Specification ，http://www.setco.org/set―specifications.html
［2］The SSL Protocol, http://www.netscape.com
［3］David Kosiur,著.电子贸易.陈曙辉,译.北京：清华大学出版社, 1998，8
［4］Peter Loshin,著.Extranet设计与实现.付　筱，乔一林,译.北京：电子工业出版社, 1998,2
　　收稿日期:1999-04-14
