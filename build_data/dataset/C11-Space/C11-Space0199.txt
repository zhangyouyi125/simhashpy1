宇航学报
JOURNAL OF ASTRONAUTICS
1999年　第1期　No.1　1999



　基于广义模糊熵的液体火箭发动机
故障检测研究*
谢涛　张育林
　　摘　要　定义了系统状态的广义模糊熵及其计算公式,即当前时刻滑动数据窗口上聚类结果的广义模糊度,给出了滑动数据窗口中采样数据矢量方向分布中心的离散度定义及其与广义模糊熵之间的负指数关系,并基于该离散度概念对自适应窗口滤波器进行了改进,提高了滤波器对噪声的敏感度,从而进一步提高了基于自适应窗口滤波器的故障检测算法对强干扰噪声的鲁棒性。本文基于受强噪声干扰的实际试车数据,采用模糊Kohonen聚类网络(FKCN)作为滑动数据窗口上的聚类算法,进行了数值仿真比较实验。仿真结果表明,基于广义模糊熵的故障检测算法具有对干扰噪声的强鲁棒性,是低信噪比环境下的一种有效的故障检测算法。
　　主题词　液体火箭发动机　故障检测　聚类分析　滑动数据窗　广义模糊熵　数据分布中心离散度
GENERAL FUZZY ENTROPY BASED-FAULT DETECTION
AND ITS APPLICATION IN LIQUID ROCKET ENGINE
Tao Xie Yu Linzhang
(Department of Aerospace Technology,National Univ of Defense Technology．Changsha．410073)
　　Abstract　This paper presents a definition of general fuzzy entropy for multivariate data distribution,based on this definition,a measure of the distribution center divergence of the multivariate data within a sliding window is also given in this paper for the first time.The divergence definition provides an objective measure of the geometrical distribution divergence for the data vectors in a data window,it can be used as an ideal and objective criterion whether there exist heavily noised data in the current sliding window for the adaptive windowing filter,which was specially designed for fault detection and diagnosis before.Thus the noises discrimination ability is much improved,compared with the crisp and hard criterion previously used.This greatly improves the robustness of the fault detection algorithm to the heavy noises and sensitivity to subtle fault transients.In addition,the practical testing data with heavy noises was used to verify its efficiency and objectivity in fault detection and noises discrimination.
　　Key words　Liquid rocket engine Fault detection Clustering analysis Sliding data window General fuzzy entropy Divergence of data distribution centers
1　引言
　　对诸如液体火箭发动机等复杂系统的故障监测,可以基于功能主义的“黑箱”理论,应用聚类、模式识别等方法,从表征系统行为的输入输出测量信号中提取系统的正常与故障特征信息,作为诊断系统的知识依据［1,2］。文［3,4］介绍了一种适用于离线或在线系统故障检测与诊断算法框架,并基于实际试车数据用GA-HCM混合聚类算法、FKCN、FCM及HCM硬聚类算法进行了故障检测的性能比较分析。该算法框架的内核是“自适应窗口滤波器”,故障检测的准确率取决于“自适应窗口滤波器”对噪声的敏感度,而“自适应窗口滤波器”对噪声的敏感度直接依赖于对滑动数据窗口中采样数据矢量方向分布的离散度定义的客观性。为了改进文［3,4］中硬边界的噪声识别方法,提高该故障检测算法对强噪声环境的鲁棒性,本文提出一种对滑动数据窗口中数据矢量几何分布中心离散度的广义模糊熵定义,该离散度定义基于广义信息熵的形式客观地反映滑动数据窗口中数据矢量分布中心的离散度,从而使“自适应窗口滤波器”建立在客观的离散度定义基础上。
2　数据矢量方向分布中心离散度的广义模糊熵定义及其计算公式
　　一般地,液体火箭发动机地面试车是一个强噪声环境,监测参数受到相互耦合的强噪声干扰。因此,滑动数据窗口中数据矢量方向分布具有随机性,但总体上呈现不同的分布中心。对实际试车数据的统计分析结果表明,相互耦合的强噪声在幅值上呈均值不为零的正态分布,而在时序上的随机性服从一阶或二阶Markov链。受这种噪声干扰的采样数据矢量的几何分布会明显地偏离未受噪声干扰的采样数据矢量,并呈正态分布。一般地,滑动数据窗口中受强噪声干扰的数据矢量少于未受干扰的数据矢量。数据矢量几何分布离散程度可以用欧氏距离或矢量方向的离散程度来描述,鉴于监控数据矢量方向在故障检测中的实用性,本文使用数据矢量方向的几何分布离散度。由于稳态工况下系统状态及测量参数的稳定性,未受噪声干扰的数据矢量在高维欧氏空间中呈均匀分布且高度集中,其矢量伸展方向高度一致,因此可以通过对滑动数据窗口上数据矢量进行二分组聚类(对于单向噪声环境)或三分组聚类(对于双向噪声环境)来识别当前数据窗口中受强噪声干扰的数据。文［3］中从统计分析的角度出发,假定滑动数据窗口上样本个数少于或等于10个的较小聚类组中的数据样本为受噪声干扰的异常数据。因为样本个数少于或等于10个的聚类组的中心矢量方向并不一定代表受噪声干扰的样本均值矢量方向,样本个数大于10个的聚类组中并非一定不包含受噪声干扰的样本数据,因此,这是一种硬边介的噪声识别方法,不适用于强噪声环境下的自适应窗口滤波器。同样地,根据连续滑动数据窗口上聚类结果的一致性及其在时间上的持续性的分析结果来判断系统是否已发生故障并区分间歇性故障及永久性故障的方法也是硬边界的,因为故障发生时相邻二滑动数据窗口经过聚类分析而形成的二部分数据矢量个数差异不可能保持绝对一致(如小故障发生时)而只能大体一致。仿真分析表明,正确识别当前数据窗口中是否存在异常数据的关键问题是,如何定义数据窗口中数据矢量方向分布中心的离散度。
　　对于单向分布的噪声环境,如果滑动数据窗口中不存在受强噪声干扰的数据矢量,则该窗口中的二模糊聚类组中的样本个数应基本相等,且数据矢量的模糊隶属度均接近0.5,即每一数据矢量对二互补模糊集合的隶属度极其模糊。相反,如果当前滑动数据窗口中存在受强噪声干扰的数据矢量,则该窗口中的二模糊聚类组中样本个数相差显著,且数据矢量的模糊隶属度接近0或1(不属于第一组就属于第二组),即每一数据矢量对二互补模糊集合的隶属性极其清晰。样本对模糊集合的隶属度的模糊性定义为模糊集合的模糊熵［6］,即:
对于论域V={v　1,v2,…,vT},模糊集合A(vi)的模糊熵可定义如下:

(1)
　　其中ui∈［0,1］,i=1,2,…T;ui=A(vi)为样本vi的隶属度。易知,0≤H(A)≤1。
　　一般情况下,可以定义具有三个以上互补模糊闭集的广义模糊熵,用来度量双向噪声环境下滑动数据窗口中采样数据矢量的几何分布离散度。
　　设:V={v1,v2,…,vT},其中vi为第i个d维采样数据矢量,1≤i≤T;
　　　O={c1,c2,…,cC},其中ci为第i个d维模糊聚类中心数据矢量,1≤i≤C;
　　　uij∈［0,1］,,1≤i≤C,1≤j≤T;uij为数据矢量vj对聚类中心矢量ci所代表的模糊集合的隶属度;
　　则模糊聚类结果的广义模糊熵可如下计算(为便于计算离散度,去掉分母lnc):

(2)
　　其中0*为最优聚类中心矢量组。
　　用Lagrange乘子法容易证明:当uij=u2j=u3j=…=ucj=,1≤j≤T时,也即聚类结果极其模糊时,广义模糊熵F(O*,V)取最大值lnc;相反,当uij={0,1}时,广义模糊熵F(O*,V)取最小值0。因此,聚类结果的广义模糊熵F(O*,V)可用来度量论域中样本分布中心的离散度。
　　滑动数据窗口中数据矢量方向分布中心的离散程度与滑动数据窗口上聚类结果的广义模糊熵F(O*,V)成反比,数据矢量方向分布中心离散程度越大,F(O*,V)就越小。进一步定义滑动数据窗口中数据矢量方向分布中心的离散度为广义模糊熵F(O*,V)的负指数,即:
,易知:,
　　根据离散度D(O*,V)值即可确定当前滑动数据窗口中是否存在受强噪声干扰的数据矢量。
　　取做为其判断准则,k1越小,自适应窗口滤波器对噪声的敏感度越高,滤波效果越好。同时,通过k2值可控制基于自适应窗口滤波器的故障检测算法对故障的敏感度,k2越小,算法对故障的敏感度越大。
　　其中,Dfil(O*,V)为滤波门限值,Dfau(O*,V)为故障门限值;0＜k1+k2＜1-;0＜k1＜k2＜1-
　　基于广义模糊熵定义的滑动窗口中数据矢量离散度不仅是对硬边界的软化,更重要的是以基于广义信息熵的形式来客观地描述数据窗中数据矢量分布中心的离散度,使自适应窗口滤波器建立在客观的离散度定义基础上。基于广义模糊熵改进的故障检测算法程序流程如图1所示。


图1　基于广义模糊熵的故障检测程序流程图
3　高维数据的FKCN(Fuzzy Kohonen Clustering Network)聚类算法
　　FKCN算法在迭代过程中不断地修改其学习因子及待学习的相邻样本数目,使聚类问题逐渐收敛到其全局最优解或局部最优解。实质上,FKCN是FCM聚类算法与KCN聚类算法的有机结合,每一次FKCN迭代过程即是一次相关参数变化了的FCM聚类算法。因此从“自适应性”角度来说,FKCN优于FCM聚类算法,从而聚类结果的全局性及收敛性也优于FCM聚类算法。文［5］在以欧氏距离定义数据样本之间的相似度及隶属度基础上给出了FKCN算法,本文基于样本数据矢量之间相似度的矢量夹角余弦值度量,给出了按数据矢量几何分布方向聚类的FKCN算法。
　　设:V={v　1,v　2,…,v　T},其中v　i为第i个d维采样数据矢量,1≤i≤T
　　　　O={c1,c2,…,cC},其中ci为第i个d维模糊聚类中心数据矢量,1≤i≤C;
　　数据矢量样本v　i与vj之间的相似度采用矢量夹角的余弦值度量,即:
即相应vi与vj的两个单位矢量之间的点积。
　　定义FKCN算法的学习因子为αij,t=(uij,t)mt,其中mt=m=m0-t．Δm,Δm=(m0-1)/tmax,m0＞1为常数;t为迭代次数,tmax为迭代次数极限;uij,t按模糊中心聚类(FCM)算法中计算模糊隶属度的公式计算,即

FKCN1:设定聚类类数C及迭代终止条件ε＞0(如0.001);
FKCN2:初始化O0={c1,0,c2,0,…cc,0}∈Rd×C,取常数m0=12.0,迭代次数极限tmax=50;
FKCN3:分别取t=0,1,2,3,…,tmax-1;
　　a. 计算αij,t=(uij,t)mt,1≤i≤C,1≤j≤T;
　　b. 用如下学习公式更新所有(C个)聚类中心矢量{ci,t}

　　可以证明该式等价于:
　　c. 计算Et=cos(ci,t,ci,t-1),或:Rt=J(Wt,Ot)-J(Wt-1,Ot-1)=(uij,t)mt.cos(vj,ci,t)-(uij,t-1)mt-1cos(vj,ci,t-1),Wt={uij,t;}
　　d. 如果Et≥C-ε或Rt≤ε,则终止迭代学习;否则t←t+1,继续迭代学习过程。
　　虽然一次FKCN迭代学习过程只是一次FCM评估过程,但每一次FKCN迭代学习过程中有关参数如mt及αij,t等都会发生相应的改变。
　　用于故障检测时取C=2或3,初值c1,0,c2,0,c3,0取当前滑动数据窗口中的首尾数据矢量及中间数据矢量。
4　数值仿真结果及分析
　　选取8个参数进行故障检测的数值仿真试验,其中包括受强噪声干扰最大的氢泵壳温度(T2)。氢泵壳温度受到的强噪声干扰在幅值上有时高达氢泵壳温度的3至4倍,而且是双向分布的叠加噪声。整个地面试验过程持续380.00秒,发动机起动段(start-up)持续2.70秒左右即进入稳定的主级段运行。为验证改进的故障检测算法性能,对25.00秒到25.82秒间的采样数据进行了某种定向的微小修改,如让8个参数测量值中某些参数持续减小,而让某些参数测量值持续增大,以模拟某些典型故障的过渡过程,部分参数的变化如图2所示。


　图2：受强过程噪声干扰的部分参数的传感器输出　
　　采用FKCN算法进行二分组和三分组聚类仿真结果表明:基于广义模糊熵离散度定义的二分组或三分组聚类分析都能准确地检测出故障,并对受噪声干扰的参数具有强鲁棒性;而基于硬边界噪声识别方法的故障检测算法有可能产生误报警(由强噪声干扰所引起)或漏报警(系统故障被强噪声所淹灭)。
　　图3说明基于硬边界噪声识别方法并用FKCN进行模糊二分组聚类时,基于广义模糊熵的离散度随采样时刻的变化趋势,容易看出当故障检测算法处理到21.10秒时产生故障误报警(由强噪声干扰所引起),虽然也能检测出25.00秒后人为所设置的轻度故障。

　　　　　　　　　　　图3：采用硬边界的噪声识别方法时，基于模糊　　　　　　　　　　　　　　　熵的数据分布中心离散度随时间的变化关系
　　图4(a)、图5(a)分别说明基于广义模糊熵的离散度定义并用FKCN进行模糊二分组、三分组聚类时的滤波结果。与基于二分组的自适应窗口滤波器比较,基于三分组聚类分析的自适应窗口滤波器对双向分布噪声的敏感度稍高。图4(b)与图5(b)分别说明基于广义模糊熵离散度定义并用FKCN进行模糊二分组和三分组来检测故障时,滑动数据窗口中数据矢量离散度随采样时刻的变化趋势。容易看出,当故障检测算法处理到试车数据中25.00秒时刻后,滑动窗口中数据矢量的离散度值持续超过(1/C+k1+k2)值,直到人为设置的故障过渡过程结束。故障检测算法即根据离散度超过(1/C+k1+k2)的持续次数,判断发动机系统是否发生故障,并区分间歇性故障与永久性故障。
　　　
图4（a）：基于模糊熵的自适应窗口滤波器的滤波器的滤
波输出，聚类分析采用模糊分组FKCN算法

　　　　　　　　　　　图4（b）：聚类分析采用模糊二分组FKCN算法时，　　　　　　　　　　　　　　　　　　基于模糊熵的离散度随时间的变关系

图5（a）：基于模糊熵的离散度定义的自适应窗口滤波器的滤
波输出，聚类分析采用模糊三分组FKCN算法

　　　　　　　　　　　图５（b）：聚类分析采用三分组FKCN算法时，基于　　　　　　　　　　　　　　　　　模糊熵的离散度随时间的变化关系
5　结论
　　聚类结果的广义模糊熵客观地反映了数据矢量分布中心的离散程度。用实际试车数据进行故障检测的仿真结果表明,数据矢量方向分布中心离散度的广义模糊熵定义可以成功地用于自适应窗口滤波器,提高了滤波器对噪声的识别能力,增强了基于自适应窗口滤波器的故障检测算法对强噪声的鲁棒性,提高了算法对故障的敏感度。此外,基于FKCN算法的模糊二分组和三分组故障检测结果还表明,模糊三分组聚类算法在对受双向分布噪声干扰的数据的滤波效果及对故障的检测结果上仅稍优于模糊二分组聚类算法,因此,模糊二分组的聚类分析不仅适用于单向叠加随机噪声的试车环境,而且也适用于双向叠加随机噪声的试车环境。
　　如果已知所有监控参数所受随机噪声的统计分布规律,就可以基于Shannon统计信息熵来度量当前时刻采样数据矢量方向偏离系统正常工况的程度,即可实时判断系统是否发生故障及故障的大小程度。随机干扰噪声在幅值上的统计分布可以根据现有试车数据通过统计分析得到,因此,基于Shannon统计信息熵的液体火箭发动机实时故障检测算法可以进行工程应用开发。
*国家自然科学基金资助项目，批准号：669785002
作者单位：谢涛　张育林　（国防科学技术学航天技术系.长沙.410073）
参考文献
　[1]Nemeth E,Norman A M.Development of a Health Monitoring Algorithm.AIAA 90-1991,July 16～18,1990/Orlando,FL
　[2]Tulpule S,Galinaitis W S.Health Monitoring System for the SSME-Fault Detection Algorithms.AIAA 90-1988,July 16～18,1990/Orlando,FL
　[3]谢涛,张育林.基于滑动数据窗聚类结果分析的复杂动力系统故障检测与诊断算法框架及其应用.第二界全球华人智能大会(CWCICIA’97,西安)
　[4]谢涛,张育林.GA-HCM混合聚类算法及其在液体火箭发动机故障检测中的应用.推进技术,1997,18(1):35-42
　[5]Eric Chen-Kuo Tsoa,Bezdek J C,Nikhil R Pal.Fuzzy Kohonen Clustering Networks.Pattern Recognition,1994,27(5):757-764
　[6]De Luca A and Termini S.A Definition of Nonprobabilistic Entropy in the Setting of Fuzzy Sets.Infor.Contr.,20(1972),201-312

收稿日期：1996年10月13日,修改日期：1998年9月25日
