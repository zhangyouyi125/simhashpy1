宇航学报
JOURNAL OF ASTRONAUTICS
1999年 第2期　No.2 1999



基于神经元的容错组合导航系统设计
马　昕　袁　信
　　摘　要　本文讨论了容错组合导航系统中的多传感器信息融合问题,提出了一种用于多传感器组合导航系统信息融合的神经元方法。通过仿真实验,验证了这种方法的可行性,并分析了该研究领域所存在的问题,提出了可能解决的技术途径,并预测了未来的发展趋势。
　　主题词　组合导航系统　神经元　容错性　信息融合
FAULT-TOLERANT INTEGRATED 
NAVIGATION SYSTEM BASED ON NEURONS
Ma Xin
(Department of Automation,SDUT.Jinan.250061)
Yuan Xin
(Department of Automatic Control,NUAA.Nanjing.210016)
　　Abstract　In this paper,multisensor data fusion of fault-tolerant integrated navigatin system is discussed.A neural approach to data fusion is proposed for multisensor integrated system.The simulation results show that this neural approach to data fusion is available.The paper analyzes the problems still existing,provides a few possibly available methods for these problems,and predicts the future tendency in this field.
　　Key words　Integrated navigation system Neuron Fault-tolerant Data fusion
1　引言
　　现代化的航行体对导航系统的精度和可靠性两方面都提出了越来越高的要求,单靠提高部件的设计和制造来达到要求的精度和可靠性是十分有限的。采用组合导航系统来提高导航精度、可靠性,已成为导航技术发展的方向。为了充分有效地利用多传感器提供的冗余信息,人们不断借鉴信息处理其他领域的很多新技术来研究信息融合的具体方法。目前,寻找一种简单、有效且实用的信息融合方法仍是这一研究领域的重要课题。
　　神经元网络由于其固有的并行结构和学习方式,提供了一种新的信息融合方法。本文提出了一种把神经元作为数据融合中心的容错组合导航系统,通过仿真,验证了该方法的有效性,并进一步分析了该研究领域所存在的问题,提出了可能解决的技术途径,预测了未来的发展趋势。
2　容错组合导航系统的基本思想
　　在多种导航设备综合的导航系统中,多传感器数据融合算法可以分为两类:第一类是用一个集中的滤波器来处理全部量测信息,这种方法的优点是信息丢失量最少,缺点是不仅滤波器的阶次太高,计算量太大,而且任一导航系统故障,就直接影响组合导航系统的性能,甚至使组合导航失效。第二类方法是每两种导航系统先用一个子滤波器来处理各传感器的量测信息以产生局部的状态估计,然后各局部状态信息传递给融合中心,以产生一个全局的状态估计,这种方法由于有一部分数据处理在局部滤波器中进行,因此融合中心的计算量大大减少,但是由于各局部的状态估计是局部最优解,因此在融合中心需要考虑各局部状态估计解的相关性。若不知道局部状态量的协方差的话,需要根据历史数据进行精确估计。文献［1］中总结了各种估计协方差的方法。然而,若要保证这些方法有效,必须要求航行体的状态方程非常精确。N.A.Carlson以信息分配原则为基础提出了联合滤波算法［2,3,4］,这种方法按照信息守恒原理在各子滤波器、主滤波器间分配整体系统信息,该算法计算简单、结构灵活、且具有很强的容错性。F.N.Chowdhury提出了一种用于状态估计的神经元数据融合方法［5］,这种方法不需要精确估计方差,但是不具备容错性。本文在各子滤波器中引入故障检测与隔离方法,提出了用多组神经元作为融合中心的容错组合导航系统。其原理框图如图1所示。其基本思想是:由各传感器得到的观测量分别经过子滤波器KFi,(i=1,2,3)的滤波得到的局部最优状态估计Xi,然后利用残差χ2检验法对各传感器进行故障检测,以判断传感器是否故障,从而根据传感器的工作情况,隔离故障传感器,并确定应选择哪组神经元作为数据融合中心,融合未发生故障传感器所产生的局部最优解而产生全局的最优估计解。

图1　基于神经元的容错组合导航系统结构框图
3　神经元数据融合中心
3.1　问题描述
　　考虑如下离散系统模型:
　　　　　　X(k)=φ(k,k-1)X(k-1)+Γ(k,k-1)W(k-1)　　　　　　　　(1)
其中X(k)∈Rn是系统状态,φ(k,k-1)∈Rn×n是状态的一步转移矩阵,Γ(k,k-1)∈Rn×r是系统噪声矩阵,W(k-1)∈Rr是白噪声序列,并有E{W(k)}=0,E{W(k)WT(j)}=Q(k)δkj,
设该系统有N组量测值,则相应地有N个局部滤波器,每个滤波器均可独自完成滤波计算。设第i个局部滤波器的模型为:
　　　　　　　　　　(2)
其中Zi(k)∈Rmi是第i组量测值,Xi(k)∈Rn是由第i组量测值观测到的系统状态,Vi(k)∈Rmi中独立于W(k)的白噪声序列,并有E{Vi(k)}=0,E{Vi(k)VTi(j)}=Ri(k)δkj,初始状态Xi(0)是独立于噪声的高斯随机向量,且E{Xi(0)}=Xi0,E{Xi(0)XTi(0)}=Pi(0),由卡尔曼滤波方程可得到局部状态估计
3.2　最优融合算法
　　最优全局状态估计是N个局部状态估计i及相应的协方差Pi所决定的条件均值,即
　　　　　　　　　　　　(3)
　　为了推导的简化,可以假设此后验概率密度函数是标准的正态分布:
　　　　　　　　　　　　　　　　　(4)
　　我们的目的就是用各局部状态估计i及相应的协方差Pi来表示最优全局状态估计F及其协方差PF=σ2F。在一致分布的情况下,后验概率密度函数f(X|i)正比于联合概率密度函数f(X-1,X-2,…,X-n)(为一似然函数)。
　　　(5)
记
则联合概率密度函数可表示为:
　　　　　　　　　　　　　(6)
矩阵的维数为:X=(n×1),u=(nN×1),e=(nN×n),S=(nN×nN),F=(n×1),PF=(n×n)
对上述似然函数求导,可得极大似然估计F:
　　　　由　l=(u-eX)TS-1(u-eX)　　　　　　　　　　　　(7)
　　　　令　　　　　　　 　　(8)
　得　　　　　　　　　　　　　(9)
　　由(9)式可见,为了得到最优全局状态估计解,在各局部估计量的协方差信息未知的情况下,需要精确估计矩阵S。然而由式(9)可知,实际上并不需要知道S,而只需要得到［eTS-1e］-1eTS-1的估计值。令D=［eTS-1e］-1eTS-1
　　则　　　F=Du　　　　　　　　　　　　　　　　　　(10)
　　若F是一标量,则有N个局部状态估计值,S是N×N维矩阵,而D是一个1×N的列矢量,这样待估计量大为减少。假定第i个局部状态估计的方差是σ2i,且各局部状态估计无关,则S是对角阵,且列矢量D的第i个元素为:
　　　　　　　　　　　　　　　　(11)
显然D有以下约束条件:
　　　　　　　　　　　　　　　　(12)
从而,为了得到最优全局状态估计解,只需要估计相对权重,而无须计算估计方差。
3.3　神经元作为融合中心
　　在对各局部状态估计量进行融合处理前,先利用残差χ2检验法对各传感器进行故障检测［6］。然后根据各传感器的工作情况,明确应选择哪组神经元作为数据融合中心。为了使系统具有容错能力,在不同传感器有故障时,应选择不同的神经元。假定本文所设计的组合导航系统的传感器的工作情况有五种:(1)全部正常工作;(2)子系统SINS/GPS故障,即GPS故障;(3)子系统SINS/TAN故障,即TAN故障;(4)子系统SINS/DNS故障,即DNS故障;(5)子系统SINS/GPS、SINS/DNS、SINS/TAN、SINS/DNS都故障,即SINS故障。从而应有五组神经元。对于每组神经元,应有n个单独工作的神经元,也就是说一个神经元处理一个状态标量的估计融合(各状态融合单独进行)。因此,容错组合导航系统数据融合中心需要5×n个神经元。
　　每个神经元都有N个输入、一个输出,如图2所示。通过融合来自N个传感器观测到的第j个系统状态,i=1,2,…,N,而得到第j个系统状态的全局估计解。该神经元是最简单的线性神经元,0为其阈值。

图2　作为数据融合中心的神经元
　　事先应用大量样本训练各神经元以确定其权重值,样本的局部状态估计量为,相应的真实状态为XTm,m为样本数。Xm为N×m维矩阵。为了使系统超定,应使m＞N。训练的目的就是使融合方程:
　　　　　　D(opt)Xm=XTm　　　　　　　　　　(13)
成立。D　(opt)是最优权重矢量。神经网络学习方法为求解D提供了一个迭代算法,权重初值为一个随机小量,在后面的迭代中,权重由下面公式进行修正:
　　　　　　Dk+1=Dk+ηεkXm　　　　　　　　　(14)
其中η为学习步长,0＜η＜1,εk为第k步的误差。
　　　　　　εk=XTm-Dk/Xm　　　　　　　　　　(15)
　　另外,在每一步的运算中,还应考虑D的约束条件(12)式。训练结束后,权重D收敛到一固定量,此时该神经元就可以作为一个融合中心来处理某一种传感器工作情况下,来自各传感器的局部状态估计量了。训练过程是离线进行的。
4　仿真
4.1　数学模型
　　本文设计的容错组合导航系统如图1所示。各子滤波器的状态方程为惯导系统的误差方程,即采用间接法直接估计惯导系统的误差,利用输出校正来校正惯导系统的参数,得到局部状态估计。设惯导系统为指北方位系统,采用东北天坐标系,取平台误角φE,φN,φU,位置误差δL,δλ,δh,陀螺漂移εbx，εby，εbz，εrx，εry，εrz,加速度计漂移x,y,z作为状态量,系统状态方程的离散形式为:
　　　　　　X(k)=φ(k,k-1)X(k-1)+Γ(k,k-1)W(k-1)　　　　　　　　(16)
　　SINS/GPS采用位置、速度综合,其量测值有两组:一组为两系统的位置差值;另一组为两系统的速度差值。GPS只考虑了SA误差。SINS/GPS系统观测方程为:
　　　　　　ZG(k)=HG(k)X(k)+VG(k)+γGρ(k,φG)　　　　　　　　　 (17)
　　SINS/TAN采用SITAN算法,其量测值是根据惯导系统和数字地图信息估计的相对高度和无线电高度表测量的相对高度之差,是一维的,其量测方程为:
　　　　　　ZT(k)=HT(k)X(k)+VT(k)+γTρ(k,φT)　　　　　　　　　 (18)
　　由于惯导系统垂直通道是不稳定的,而多普勒雷达提供的垂直速度精度又很低,因此子系统SINS/DNS不考虑垂直通道。该系统状态不包括垂直速度误差和垂直位置误差,而考虑了DNS的刻度系数误差δK及Doppler速度误差,状态方程仍为18阶。取惯导系统计算出的速度与多普勒雷达测出的速度的差值作为量测值,其量测方程为:
　　　　　　ZD(k)=HD(k)XD(k)+VD(k)+γDρ(k,φD)　　　　　　　　　(19)
　　以上各式中矩阵F(t),G(t),HG(k),VG(k),HT(k),VT(k),HD(k),VD(k)详见文献［6］;γG,γT,γD为随机向量,表示故障大小;ρ(k,φ)是分段函数,其中φ是故障发生的时间。
　　飞机的飞行轨迹由专门的仿真程序产生,提供包括时间、即时位置、速度、姿态、航向、姿态角速度及加速度等信息。整个航迹有滑跑、起飞、爬高、转弯、平飞等过程,总飞行时间为1000s。仿真的初始数据及参数见表1。
表1　仿真初始数据及参数

参　　　数　数　　　值
初始位置(纬度,经度,高度)L0,λ0,h0N32°,E118°,5m
初始位置误差δL0,δλ0,δh030″,30″,5m
初始速度误差δVE,δVN,δVU0.6m/s,0.6m/s,0.6m/s
初始姿态误差角φx,φy,φz300″,300″,600″
陀螺白噪声漂移ωgx,ωgy,ωgz0.01°/h,0.01°/h,0.01°/h
陀螺常值漂移εbx,εby,εbz0.1°/h,0.1°/h,0.1°/h
陀螺一阶马尔可夫漂移εrx,εry,εrz
Trx,Try,Trz0.1°/h,0.1°/h,0.1°/h
7200s,7200s,7200s
加速度计一阶马尔可夫零偏σax,σay,σaz
Tax,Tay,Taz10-4×g,10-4×g,10-4×g
1800s,1800s,1800s
GPS接收机(C/A码)
(位置测量误差)σPE,σPN,σPh
TPE,TPN,TPh25m,25m,25m
100s,100s,100s
GPS接收机(C/A码)
(速度误差)σVE,σVN,σVU
TVE,TVN,TVU0.05m/s,0.05m/s,0.05m/s
100s,100s,100s
数字地图制作误差γm5m
无线电高度表测量误差γr5m
DNS刻度系数漂移σδK0.25%
Doppler速度误差
一阶马尔可夫零偏
σδVD,TδVD
1000m/h,300s


　　为了对五种传感器工作情况下的神经元进行训练,需要产生五组训练数据,即分别假定(1)全部正常工作;(2)GPS故障;(3)TAN故障;(4)DNS故障;(5)SINS故障产生五组训练数据。我们只对位置L,λ,h进行融合,因此,需要单独训练15个神经元。
4.2　训练
　　对于每组神经元中的三个神经元(分别用于L,λ,h的融合),输入为4个子系统的状态估计,理想输出应为真实位置(L,λ,h)。每个神经元单独训练,训练方法采用Widrow-Hoff误差修正规则(14式和15式)。各权重初值为(1)/(4)。训练过程中应考虑约束条件(12)式,并且为了缩短训练时间,每一步校正后,检查W是否为负,若为负,则定为0。
4.3　仿真结果
　　训练结束后,神经元的权重就确定了,此时就可以用此神经元作为融合中心。为了进行比较,仿真了利用N.A.Carlson的联和滤波方法而得到的融合估计量(采用在初始时刻分配一次信息的无反馈模式)。图4为真实轨迹与训练用轨迹相同时各局部估计量及融合估计量的纬度误差比较曲线。当真实轨迹与训练用轨迹很不相同时,如真实飞行轨迹如图3(a)、3(b)中虚线所示,融合估计效果仍很好,图5为当DNS在t=100s发生故障、且真实轨迹与训练用轨迹不同时的各状态估计量的经度误差比较曲线。
　　
图3(a)　飞行轨迹(经度纬度)　　图3(b)　飞行轨迹(经度高度)
　　　　　　
图4　真实轨迹与训练用轨迹相同时　　图5　真实轨迹与训练用轨迹不同、且DNS在
各状态估计量的纬度误差比较曲线　　100秒故障时各状态估计量的经度误差曲线
5　分析
　　从上面的仿真情况可以看出,基于神经元的容错组合导航系统的导航精度较好,且具有容错性,可以替代传统的需要估计协方差的数据融合方法。但是这种方法离线学习时间较长,且不具备自适应性。如果可事先知道协方差数据的话,也许可以进一步完善这种基于神经元的数据融合算法,这是今后的一个研究方向。如何减少训练时间也是一个重要问题。另外,如果专家系统与神经网络相结合,也许可以进一步改善融合算法的性能。因为神经元信息融合不是基于严格的协方差估计,而是基于实际的经验积累,所以专家系统也许可以提高神经元数据融合的性能。另一个研究方向是权重的在线自适应学习,如何根据各传感器的工作情况,自动快速地修正其权重值。总之,神值元用于数据融合方面的研究刚刚起步,还有许多工作等待人们去解决。
6　结论
　　本文提出了一种基于神经元的容错组合导航系统,用神经元作为各子系统产生的局部状态估计量的信息融合中心,不需要知道其协方差信息,可以替代传统的要求精确估计协方差信息的数据融合方法。仿真实验表明,这种导航系统具有容错性,且导航精度很好。
　　作者单位：马昕(山东工业大学自动化系.济南.250061)；袁信(南京航空航天大学自动控制.南京.210016)
参考文献
　1　Kim KH.Development of Track To Track Fusion Algorithm.Proc.American Control Conf.,June 1994:1037-1041
　2　Carlson NA.Federated Filter for Fault-Tolerant Integrated Navigation Systems.Proc.of PLANS 1988:110-119
　3　Carlson NA.Berarducci M.P.,Federated Kalman Filter Simulation Results.Navigation,1994,41(3):297-321
　4　Carlson NA.Federated Square Root Filter for Decentralized Parallel Processes.IEEE Trans.on Aerospace and Electronic Systems,1990,26(3):517-525
　5　Chowdhury FN.A Neural Approach to Data Fusion.Proc.American Control Conf.1995,1693-1697
　6　袁信,俞济祥,陈哲编著.导航系统.北京:航空工业出版社,1993
　　本文为国防科技预研基金资助项目
收稿日期:1997年4月18日,修回日期:1998年3月23日
