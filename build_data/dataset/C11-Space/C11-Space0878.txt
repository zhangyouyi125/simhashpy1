航空动力学报
JOURNAL OF AEROSPACE POWER
1999年　第14卷　第2期　Vol.14　No.2　1999



航空发动机多变量三层神经网络控制
黄金泉**　蔡红武　孙健国
　　【摘要】　提出了一种发动机多变量神经网络控制方法。采用三层前向神经网络对非线性项进行补偿，神经网络权重自适应律采用在线学习算法。控制系统的设计不需要知道精确模型，适应于全飞行包线。仿真研究表明发动机多变量神经网络控制具有良好的动、静态性能。
　　主题词：　航空发动机　神经网络　多变量控制
　　分类号：　V233.751
1　前言
　　先进的多变量控制方法是数控系统的关键技术，现有的现代控制理论的方法如LQG/LTR、自适应控制等对模型的依赖性很大［1，2］，而发动机全包线数学模型又很难准确建立。神经网络用于模型未知的非线性系统的控制是十分有效的方法［3，4］。
　　本文提出一种发动机多变量神经网络控制方法，用三层神经网络对非线性部分进行在线学习和补偿，不需要精确的数学模型，对发动机非线性和建模的不确定性具有很好的自适应性和鲁棒性。
2　神经网络
　　三层神经网络可表示成矩阵形式为［4］：
z＝WTσ(VTy)
(1)
其中：y=［y1，y2，…，yn］T∈Rn为神经网络输入，z=［z1，z2，…，zn］T∈Rm为神经网络输出，σ(.)∈R(h+1)为驱动函数向量，h为隐含层节点数，V∈R(n+1)×h为第一层到隐含层的连接权重矩阵，W∈R(n+1)×h为隐含层到输出层的连接权重矩阵。
　　设f(y)∈Rm为光滑的非线性函数，y∈SRn，S为紧集。根据Stone-Weierstrass定理［5］，对充分大的隐节点数h，存在权重和阈值，即W和V，使：
f(y)＝WTσ(VTy)+ε(y)
(2)
其中：ε(y)称为神经网络函数逼近误差或重构误差。对任何εN＞0，总存在一个神经网络，即理想的神经网络重权存在，当y∈S时有‖ε(y)‖≤εN。设W和V的界为‖W‖F≤WM，‖V‖F≤VM，‖Z‖F＝‖diag｛W，V｝‖F≤ZM，其中：‖.‖F为矩阵的Frobenius范数，即‖A‖F＝｛tr(ATA)｝1/2。f(y)估值记为：。和为理想权重的估计值。
3　控制器设计
　　考虑被控对象：＝Ax+B［g(x)+u+Kd(t)］
(3)
其中：x∈Rn为状态向量，u∈Rp为控制输入，A∈Rn×n，B∈Rn×p为未知常数矩阵，g∈Rp为未知的光滑函数，d∈Rp为未知有界扰动，K∈Rp×p为未知的增益矩阵，设‖Kd(t)‖≤bd。
参考模型为：　　　　　　　　　　　　　
(4)
其中：xm∈Rn为参考模型状态向量，r∈Rp为参考输入，Am∈Rn×n，Bm∈Rn×m为常数矩阵。设参考模型稳定，则由李雅普诺夫定理知，对任意给定的正定矩阵Q＞0，存在唯一的正定矩阵P＞0，使ATmP+PAm=-Q。设被控对象和参考模型满足匹配条件，即存在K*和K*0和正定对角矩阵K*1，使A-Am=BK*，Bm=BK*0，B=K*1Bm。定义误差向量为：e=x-xm，y=［xT，rT］T，则存在C1和C2，使‖y‖≤C1+C2‖e‖。选择控制规律为：

(5)
其中：ν为鲁棒控制项。令。则误差方程为：
　　定理1　考虑被控对象(3)，参考模型(4)，控制规律(5)，神经网络权重自适应律为：

(6)
其中F＞0，G＞0，κ＞0。鲁棒控制项为：

(7)
如果　 ， 则（e，，）一致最终有界［6］。
　　注释1　权重自适应律为Hebbian算法的形式，利用每层输入输出信号的乘积来调整各权重。在标准算法基础上加上e修正项，鲁棒控制项中增加第二项，以保证系统稳定。
　　注释2　误差e的界随神经网络重构误差和扰动的增大而增大。通过提高鲁棒项系数kν可以使误差充分小［6］。
　　注释3　权重的调整不需要预先离线学习，在参考输入施加的初始阶段，神经网络还在学习，控制系统主要通过鲁棒控制项(相当于PD控制器)起作用。神经网络权重的初值＝0，可选取为为随机数。
4　发动机神经网络控制
　　考虑某喷扇发动机多变量控制，中间状态以上要求用转速控制指令（参考输入）N1r控制风扇转速N1，用压比控制指令P36r控制燃烧室出口静压与低压涡轮出口总压之比P36。发动机非线性模型可表示为：

(8)
其中：Wf为供油量，A8为尾喷口面积，H为飞行高度，Ma为飞行马赫数，gi(.)为未知的非线性函数，aij，ki，，i，j=1，2为未知的常数。参考模型为：

(9)
定义，神经网络权重自适应律为(6)，鲁棒控制项(7)，由定理1知跟踪误差一致最终有界。控制系统结构如图1所示。


图1　神经网络控制系统
5　仿真结果
　　发动机模型为某涡扇发动机简化部件级非线性模型，能进行飞行包线内各点的稳态和瞬态的模拟计算。发动机控制器参数选为F=0.2，G=0.1，K=0.01，kν＝［2，0.01］T，kz=0.01，h=60。图2(a)和(b)为高度H＝0，马赫数Ma＝0.2时压比回路参考输入不变，转速回路方波输入（幅值5％）的仿真曲线，图2(c)和(d)为转速回路参考输入不变，压比回路幅值为5％的方波输入响应曲线。


图2　闭环阶跃响应 (H=0.0，Ma=0.2)
　　图3(a)为高度H＝10 km，马赫数Ma＝1.0时压比回路参考输入不变，转速回路方波输入（幅值5％）的仿真曲线，图3(b)为转速回路参考输入不变，压比回路幅值为5％的方波输入响应曲线。图4为H=0，Ma=0.2时两回路同时方波输入时的响应曲线。


图3　闭环阶跃响应 (H=10 km，Ma=1.0)


图4　两回路同时方波输入响应(H=0，Ma=0.2）
　　由以上仿真结果可以看出，在飞行包线内，发动机神经网络控制系统均有满意的动、静态性能，能适应发动机非线性和模型的不确定性，多变量控制具有良好的解耦效果。
　　结论　发动机多变量神经网络控制采用模型参考方法，在线调整三层前向神经网络的权重，对未知非线性系统进行补偿，适应于全飞行包线。仿真研究表明发动机多变量神经网络控制具有良好的动、静态性能和多变量解耦效果。控制结构和算法简单，能在微机上实时实现，为解决航空发动机的非线性和建模不确定性提供了一种新型控制方法。
作者简介:**男　36岁　博士　副教授　南京航空航天大学203教研室　210016
作者单位:南京航空航天大学
参考文献
　　1　樊军,黄金泉,孙健国,冯正平.Multivariable Model Reference Adaptive Control for a Turbofan Engine. 航空学报(英文版),1996,9(4)
　　2　Athans M,et al. Linear-Quadratic-Gaussian with Loop-Transfer-Recovery Methodology for the F-100 Engine. AIAA J.of Guidance,Control, and Dynamics,1986,9(4):45-52
　　3　Narendra K S and Parthasarathy K. Identification and Control of Dynamical Systems Using Neural Networks.IEEE Trans.Neural Networks,1990,1(1):4-27
　　4　Lewis F L,et al,Multilayer Neural-Net Robot Controller with Guaranteed Tracking Performance.IEEE Trans.Neural Networks,1996,7(2):388-398
　　5　Hornik H et al.Multilayer Feedforward Networks are Universal Approximators. Neural Networks,1989,2:359-366
　　6　黄金泉．航空发动机神经网络自适应控制：［博士论文］．南京航空航天大学，1998
（责任编辑　王震华）
1998年6月收稿；1998年12月收到修改稿。
