计算机应用
COMPUTER APPLICATIONS
1999年 第19卷 第6期 Vol.19 No.6 1999



一种软件结构复杂度度量模型及其自动实现
王小明
　　摘　要　本文对软件结构中扇入/扇出对软件复杂度的影响进行分析,研究探讨了一种基于扇入/扇出的软件结构复杂度度量模型，给出了自动实现算法。该模型在结构化、软构件和基于组件的系统设计分析中具有较高的应用价值。
　　关键词　扇入，扇出，软件复杂度，模型
A MODEL OF MEASURING SOFTWARE STRUCTURE
COMPLEXITY AND ITS AUTO-REALIZATION
Wang Xiaoming
Computer Center,Gansu College of Economic Management， Gansu.Lanzhou，730070
　　Abstract　This paper analyzes the influence of fan-in and fan-out to software complexity in a software structure, and makes a study of some software structure complexity model, based on fan-in and fan-out，gives an automatic algorithm. the models have higher application value.
　　Keywords　Fan-in，Fan-out，Software complexity，Model
1　软件结构复杂度度量
　　在设计计算机大型软件的时候，无论是采用结构化方法还是面向对象技术，为了降低研究与设计的复杂度，总是采取“分而治之”的策略，即将要研究的大系统划分为多个规模适中的子系统，再通过对各子系统的研究设计、子系统集成，从而构成一个大型的软件系统。各子系统之间通过控制流与数据流相关联。在一定程度上，软件系统的复杂度取决于各子系统之间的控制流与数据流的复杂程度。而实现视频帧到缓存的捕获则需要应用回调函数和相应的数据块结构 VIDEOHDR 。软件结构复杂度是指模块结构的复杂度和整个软件系统结构的复杂度。结构复杂度度量主要是对软件中的控制流和数据流以及模块间的接口复杂程度等进行度量。经典的结构复杂度度量方法常用模块的扇入/扇出数量来度量模块的复杂度。一个模块的扇入指进入该模块的控制流与数据流之和，一个模块的扇出指该模块输出的控制流与数据流之和。其不同点在于后者所能够达到的采集速率比前者要高，但需要用 capCaptureSequenceNoFile 加以激活。则表面点 P 反射到观测位置的能量 I 可采用如下简化模型计算： 

图6 表示反射光强度的计算
I = 255[kd ( L middot; N) +ks ( S middot; V) ]　　(7) 
　　其中 kd 、ks 为反映表面反射特性和漫反射特性的常数，当给定光照角、观测方位角以及观测距离时，则 I 是表面点法向量 N 的单值函数。结构复杂度度量力求反映模块内部结构的复杂度以及模块间接口的复杂度，进而反映整个软件系统的结构复杂度。 
　　(3) 阴影值 I 的计算 
　　明亮度反映了彩色光照射到物体表面后反射到观察位置的能量的大小，明亮度与物体表面方向、观察者位置及材质等因素有关，在制作彩色晕渲图时我们忽略表面材质因素，假定光照和观察位置如图 6 所示， S 为入射光向量， N 为点 P 处表面法向量， R 为反射光向量， A 为观测向量。本文在研究结构化系统设计与程序设计的基础上，将扇入/扇出对模块的复杂度影响分别讨论，给出了基于扇入/扇出的模块和系统结构复杂度定量度量的数学模型。使用这些模型可以在软件系统模块结构设计完成之后，对系统结构与模块的复杂程度作出定量度量，以便在祥细设计开始之前对复杂度过高的模块重新划分；对复杂度不合理的系统结构进行重新构建；对不同的系统结构方案进行复杂度比较，从中选择最优方案。通过 capOverlay 宏完成。
　　准则2：任一程序中，分枝结构比序列结构复杂；循环结构比分枝结构复杂。
　　准则3：任一程序中，隔层调用比逐层调用复杂；模块间自底向上调用(构成循环结构)比自顶向下调用复杂。具体映射关系如下： 
s = 10.0*(90-α) / 9.0　　(1) 
　　其中： α 为地面角度坡度 ; 
　　(2)
　　其中 : Z 为地面点高程值， Zmax 、 Zmin 为区域最大和最小高程。其相应的回调函数的接口及内容可以完全一致。
2.2　若干概念
　　为了将扇入/扇出对模块(系统)结构复杂度的影响分开来讨论，以建立新的结构复杂度度量模型，引入如下几个概念。
　　扇出：指一个模块直接控制(调用)的模块数目。 
3 结论
　　ARC/INF°手册中给出了基于地形高程和坡度参数的等范围赋值映射方法，用该方法制作的图具有软表面 (Soft Surface) 的感觉。
　　模块总数(m)：系统中模块总个数。
　　深度层号：指软件结构从入口到出口各层次的顺序编号。
　　对称层号：当系统模块总层数n为奇数时，自顶(入口)向下(出口)各层对称层号依次为1，2，…，,…,2，1；当n为偶数时，自顶(入口)向下(出口)各层对称层号依次为1,2,…,,,…,2,1。 AVIcap 为应用提供了一个访问视频采集硬件简便的、基于消息的界面，并且能够控制视频流数据存储到磁盘的过程。一个模块的扇入影响其本身的结构复杂度，并使其本身的结构复杂度按e(e=2.71828)的指数增长。模块的结构复杂度函数依赖于系统总模块数、系统深度、模块在系统中所处位置、扇入/扇出来源与去向等。文中重点讨论了基于 HSV 组合视觉模型的晕渲建模和色彩分量计算方法，并给出了在 ARC/INF°环境下实现这一过程的 AML 语言程序。
　　定义1:　由m个子模块构成的软件系统P,其子模块的结构复杂度定义为：
　　模块j的扇入复杂度:
Rj=m×hj×e｜j 模块深度层号-扇入i起点深度层号-1｜　　　　　　　　　　　(1)　
　　（q为j模块扇入总数, 1≤j≤m，m为模块总数，以下同）
　　模块j的扇出复杂度：
Cj=m×hj×2｜j 模块深度层号-扇入i终点深度层号+1｜　　　　　　　　　　　(2)　
　　（p为j模块扇出总数）
　　模块j的总复杂度:
　　　　　　　　　　　　　　(3)　
　　系统模块的平均复杂度：
　　　　　　　　　　　　　　(4)　
　　模块j的总复杂度相对于系统模块的平均复杂度的偏差：
　　　　　　　　　　　　　　　(5)　
　　依据软件工程理论，一个软件系统最优，不是某几个模块最优，而应该是所有模块优度均衡，从而使系统最优。所以，可根据系统乘法原理［7］定义软件系统的结构复杂度。
　　定义2:　由m个子模块构成的软件系统P,各模块的结构复杂度为Fj,则软件系统的结构复杂度为:
Z=Fj　　　　　　　　　　　　　　　　　(6)　
　　实践表明，当Kj≤-1时，该模块可能规模偏小，需同其它模块合并;当Kj≥1时，该模块可能规模偏大，需要进行再分解或调整控制流，使各结点复杂度达到基本的均衡，从而使整个系统结构复杂度达到较低水平。
3　结构复杂度度量的自动实现
　　定义3： 系统中模块所在层深度编号构成的行向量定义为：X=［x1,x2,x3,…,xm］。
　　定义4： 系统中模块集合S=(p1,p2,p3,…,pm),扇入矩阵Am×m定义为:
　　
　　事实上，扇入矩阵和扇出矩阵互为转置矩阵，即扇出矩阵Bm×m=Am×mT令矩阵Nm×m为：
　　
　　令矩阵Wm×m为：
　　
　　其中，e=2.71828
　　定义5： 系统中模块的对称层权值(y1,y2,y3,…,ym)构成的对角矩阵Hm×m定义为:
　　hij=yi；当j≠i时，hij=0
　　令对角矩阵Wm×m为：
　　dii=m×nij
　　当j≠i时，dij=0
　　则，模块的扇入复杂度对角矩阵
　　Rm×m为：R=D×H同理，令对角矩阵Gm×m为：
　　gii=m×wij；当j≠i时，gij=0
　　模块的扇出复杂度对角矩阵Cm×m为：C=G×H
　　系统模块的总复杂度对角矩阵Fm×m为：
　　
当j≠i时，fij=0
　　系统模块的平均复杂度：
　　系统模块的平均复杂度偏差对角矩阵Km×m为：;当j≠i时，kij=0
　　软件系统的结构复杂度：Z=Fii
4　结束语
　　(1)基于扇入/扇出的软件结构复杂度定量度量方法使用简单方便，在繁杂的程序设计开始之前就能对系统各模块以及整个系统的结构复杂度进行有效的度量分析，从而对不同的系统设计方案进行比较，评价，选优;对不合理的模块和控制流进行重新划分和调整，使系统复杂度达到整体上的优化。
　　(2)基于上述数学模型的自动实现使用了矩阵方法，只要给出系统模块的扇入矩阵或扇出矩阵,模块深度层编号，对称层权值，使用任一种计算机语言即可实现软件系统和模块的结构复杂度自动计算。笔者构造了100多种不同规模的软件系统结构模型，并对实际使用中的10种大型管理信息系统使用C语言实现该算法，对系统模块和系统结构复杂度进行了自动度量分析；对同一系统的不同系统结构方案进行了度量分析比较,其结果比较理想。
注：本项目受正林集团技术创新基金资助(No.980530)。 
　　(2) 宏 
　　在 AVIcap 窗口类中，宏的使用完全类似于普通的函数，其功能等同于发送相应的窗口消息。本文采用 HSV 彩色显示模型，建立地面点高程、坡度和表面法线方向到 HSV 色彩分量之间的映射关系，根据人眼的视觉特点，对地表方向和坡度采用线性映射，而对于高程采用了指数函数变换，这便于突出地表参数的动态范围，增强立体效果。
作者单位：甘肃省经济管理学院计算机中心　甘肃.兰州(730070)
参考文献
［1］　Tom DeMarco.Structured Analysis and System Specification.Yourdon inc,1979
［2］　Roger S. Pressman, Software Engineering:A practitioner′s Approach,McGraw-HillBook Company,1982
［3］　Elism B. & Susan U. Object-Oriented Methodologies and Systems, 1994
［4］　Hausi A.M.&Rounald J.N.,The 17th IWCASE,1995
［5］　张海藩.软件工程导论.北京:清华大学出版社,1998
［6］　汤　庸.软件工程方法学及应用.北京:中国三峡出版社,1998
［7］　孙　凌.计算机信息系统分析与设计.武汉:武汉大学出版社,1994
［8］　杨士尧.系统科学导论.北京:农业出版社,1986
收稿日期:1999-03-09(修改稿)
