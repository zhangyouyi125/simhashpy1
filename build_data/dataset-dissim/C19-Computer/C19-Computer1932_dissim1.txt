微型机与应用
MICROCOMPUTER & ITS APPLICATIONS
2000　Vol.19　No.6　P.43-44




基于PC的多媒体协同编辑系统的研究与实现
倪强　朱光喜
摘要：对基于PC平台的多媒体协同编辑系统的模型及其具体实现方法进行了详细介绍。
关键词：CSCW协同工作模型 网络服务子层 传输子层 管理子层 白板设计
　　计算机支持的协同工作CSCW（Computer Supported Cooperative Work）作为一个新兴的研究方向，自1984年IrenGrief和Paul Cashman提出至今，随着计算机性能和网络通信技术的发展得到了迅速的发展。多媒体协同编辑系统是目前CSCW应用领域中最受欢迎的应用系统之一，因此受到人们的广泛重视。
　　本文主要介绍由华中理工大学电信系数字图象教研室开发的基于PC的鸿象多媒体协同编辑系统模型及其具体实现。
1  协同工作模型
　　鸿象多媒体协同编辑系统是在CERNET环境下开发并实现的计算机协同工作系统（CSCW），能为各种级别需求的园区网（包括企业网、校园网和利用Modem上网的用户）提供协同编辑的工具。
　　鸿象多媒体协同编辑系统的协同工作模型由如图1所示的3层结构组成。其中最下面的是网络层，最上面的是应用层，中间是协作层。其中协作层是关键，其功能模块详见图2。在开发声卡的Windows程序时，最简单的方法是利用媒体控制高层调用接口。由于是基于TCP／IP协议来开发，所以它的适应性好，既能适用于局域网内，也能适用于广域网和Internet，能够对服务质量进行控制，能够监视网络的性能和状态，能够对流量进行调整，并向上级报告服务的状况，这对于要求实时性的视频和音频服务尤为重要。
　　测试漏电流波形的硬件电路连接方法如图1所示。由于TCP适合于可靠而慢速的连接，而UDP适合于快速和不太可靠的连接，故而对于对实时性要求高而数据量不太大的应用，采用TCP连接；而对于数据量大的视频，可以采用UDP连接。
1.2 传输子层
　　它利用网络服务子层封装的网络层的功能，为管理子层和应用层提供基本的传输服务。它包括同步消息传递、异步消息传递、多媒体数据传递等，分别适用于不同的场合。
　　在启动示波器输入的响应函数中，首先在内存中开辟1个长度为MAXSIZEOFDATA的采集数据缓冲区，并清除其中内容，分配和建立信息格式块，打开声卡设备，分配和传递1个数据块(长度为VIEWBLOCK)给设备，启动数据采集，同时分配和传递第2个数据块给设备，使其在第1个数据块之后等待，当第1个采集数据块填满时，设备会发送消息给窗口，同时第2个数据块进入接收数据的工作。

图3   不合格的传真机高压试验漏电流波形（判定电流：10mA）
　　该微机存储示波器不仅适合于电器安全试验各项目的波形测试，而且适合于多数需要测量电压、电流波形的情况，其采样间隙可达到22μs，采样精度可达到双字节（即65536个分级精度），微机硬件普及，软件操作简单，在电子电器（或其它专业的商品）检验的许多项目上都可以得到很好的应用。它针对多媒体数据的特点，通过调整质量因子（QOS）和采用多点广播等方式来实现。
1.3 管理子层
　　管理子层是协作层和应用层的接口，利用传输子层的服务向应用层提供多种管理功能，其中包括：
　　(1)协作过程管理：协作过程的发起和结束，包括加入、退出、召集、申请、解散等操作，用户可以动态地加入和退出。
　　(2)应用信息管理：收集网络上各种应用的运行状态、参加者等信息，供用户查询；在每个站点上保存本地运行的各种应用的状态信息，便于应用之间信息的交换。

图2  合格的电视机高压试验漏电流波形
　　(2)不合格样品的漏电流波形
　　对于不合格的测试样品，其漏电流波形不是恒定的周期信号，而是开始部分出现一段冲击波形，在仪器对电流作出判定并切断高压后，出现放电波形。本系统对锁的种类和粒度进行了相应的规定。
　　(4)功能管理：包括版本控制、服务状态自适应调整、著作库管理等。
　　如果从代理的角度来看待客户端和服务器方的结构，整个鸿象多媒体协同编辑系统的网络结构如图3所示。

图3  鸿象多媒体协同编辑系统的层次结构
　　(1)网络接口控制：网络接口基于TCP／IP协议，提供了对INTERNET的支持。
　　据此，笔者在计算机Windows环境下，用多媒体声卡及Borland C＋＋编程，设计了一微机模拟信号采集系统，方便了上述问题的分析和解决。
　　(3)协同代理：是分布式协作平台的核心，是项目组成员之间进行协作的接口。包括用户管理、共享资源的请求和释放等功能。
　　(4)编辑代理：是项目组成员与共享编辑窗口交互的接口。一方面从协同代理获得共享编辑信息并执行用户权限和优先级判决、并完成相应的操作；另一方面管理私有编辑窗口的结果向项目组的其他成员发布事宜。
　　(5)版本控制代理：是生成客户机本地版本和服务器全局版本，并且维护本地版本与全局版本一致性的接口。
　　(6)作品及素材数据库管理：控制对共享编辑数据库的读、写、增、删等操作，数据库用于存储共享编辑的素材和作品。
　　应用程序处理的数据量很大，它是以数据块为单位，把分配好的空内存块交给声卡设备，内存块的地址、大小、信息格式必须由应用程序指定。
2  实现方法
　　(1)白板设计。WhiteBoard采用对等传输方式，服务器和客户程序采用同一个程序，可自由地设置成SERVER或CLTENT。界面和功能仿效NetMeeting的WhiteBoard功能，但增加了1项OLE编辑。当漏电流取100mA时，电阻R应承受的功率为P＝I2R＝0.1×0.1×10＝0.1W，选取功率为5W的电阻，以保证其承受能力。当漏电流取100mA时，电阻R应承受的功率为P＝I2R＝0.1×0.1×10＝0.1W，选取功率为5W的电阻，以保证其承受能力。
　　(2)多媒体协同编辑器设计。用普通示波器无法观察、保留波形，而存储示波器价格昂贵，也难以保存长时间的波形数据。我们采用Borland Delphi 3.0作为程序开发的主要工具，调用Winsock进行网络编程。
　　鸿象多媒体协同编辑系统完成了集多媒体交互技术、版本控制技术、访问控制与信息安全技术于一体，支持不同模式群体协同工作的集成化多媒体编辑器，共享资源的互斥与同步等关键技术。多媒体编辑器功能强、方便实用，在共享白板设计中支持OLE目标连接功能，使得该系统在多媒体对象参与协同方面具有特色，不足之处主要是调度算法还不够优化，需进一步改进。
倪强（武汉华中理工大学电子与信息工程系430074）
朱光喜（武汉华中理工大学电子与信息工程系430074）
收稿日期：1999－12－22
