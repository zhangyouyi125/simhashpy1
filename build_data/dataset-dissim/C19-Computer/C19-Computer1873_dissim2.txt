微型机与应用
MICROCOMPUTER & ITS APPLICATIONS
2000 Vol.19 No.3 P.55-56



DOS工作站共享Windows NT/9x网络资源
刘杨　邓为　徐红霞
　　摘　要：针对目前各企事业单位仍有不少运行DOS低档微机的现象,为使以前的软硬件资源得到充分利用,介绍了一种DOS工作站登录Windows NT/9x网络以共享网络资源的方法。
刘茂诚（山东省东营市胜利石油管理局信息中心257001）
收稿日期：1999-09-20
。但是原先的一些运行在DOS平台上的低档微机,如386,486就面临着淘汰。为使DOS工作站能够登录WindowsNT/9x网络,实现资源共享,使得以前的软硬件投资得到有效利用,本文将介绍利用Microsoft Network Client for MS-DOS以实现DOS向Windows环境转移的一种过渡办法。
1 准备工作
　　要使DOS工作站登录网络后可以访问Windows NT Server或Windows 9x工作站的资源,其方法略有不同。
　　1.在NT服务器的“管理工具”中的“域用户管理器”上为DOS工作站新建用户名和口令,如WWH和WZ;默认隶属组为:DomainUser,其它组属性可自己设定或取默认值。如不采取分帧方式,用户需退出结果页面后,再进入条件输入页面,影响效率。并记下所装网卡的I/O地址和中断值。
　　3.制作安装盘。
　　方法一:将格式化好的空白软盘插入软驱,再将Windows NT服务器的CD-ROM插入光驱,然后在“资源管理器”中将光盘中\Clients\Misclient\Disks\Disk1文件夹上的所有文件拷贝到软盘上,这样,一张安装盘就准备好了。
　　方法二:将Windows NT服务器的CD-ROM插入光驱。在服务器的“管理工具”中的“网络客户管理器”上选“制作网络安装启动磁盘”,然后按提示进行选择,选择时要注意:
　　（1）选择DOS工作站的网卡型号,如兼容网卡NE2000Compatible。

图1 3层结构图
　　3层结构是这样划分的:第1层是表示层浏览器,主要完成用户和后台的交互及最终查询结果的输出功能。
　　（3）网络协议。根据作为服务器的Windows NT或9x所安装的网络协议来选择。系统一般默认为NWLINKIPX兼容协议。
　　插入软盘,所有的选择确定后系统自动复制安装程序,这样,安装盘就制作好了。
2 在DOS工作站上安装客户程序
　　这里以安装盘方法一为例介绍安装过程,方法二的安装过程与之类似。如不采取分帧方式,用户需退出结果页面后,再进入条件输入页面,影响效率。
　　（2）Web监听器（Web Listener）接收用户请求并进行分析,如果只是一般静态页面（请求的文件是＊.htm）请求,则调用简单转接器（simply Dispatcher）,进一步通过服务器的文件系统将所需页面返回给用户。选择Change Setup Options,若登录NT则把Do Not Logon to Domain改成Logon to Domain（登录Windows 9x不能改）,其余取默认值。
3.3 WEB页面中帧（Frame）的使用
　　巧妙使用帧可以使界面布局更加合理,带来好的视觉效果。
　　（4）每个WRB执行引擎使用WRB应用编程接口和Web请求代理组件（WRB Cartridge）接口。重新引导工作站,在输用户名处直接按回车键,即默认用户名（如:WWH）,输入口令（如:WZ）。第一次引导时,系统会提示:
　　There is no password-listfile for WWH（WWH为用户名）
　　Do you want to create onet（Y/N）[N]:
　　在这里选Y。接着,DOS工作站就能登录上Windows NT或9x网络了。
3 共享网络资源
　　DOS工作站网络登录成功后,网络驱动程序即加载成功,此时即可使用网络命令共享Windows NT/9x资源。
　　1.查看共享资源（共享目录、共享打印机）
　　NET VIEW \\Servername
　　其中Servername为提供共享资源的Windows NT/9x的计算机名,此命令将列出Servername机器上已共享的资源名称及类型。
　　2.利用网络驱动器映射的方式访问共享资源
　　NET USE drive：\\servername\sharename
　　NET、USE为命令项,drive:为映射驱动器名,servername同上,sharename为共享的文件夹名。具体在本系统中是通过在数据库中增加合法用户表,记录合法用户的单位等信息,以便应用程序按照数据的单位代码属性划分数据,具体过程如下:
　　（1）用户输入单位名称、用户名、口令,并且将输入值进行复杂运算,然后提交Web服务器验证用户的合法性,避免从URL栏里显示出用户口令。第2层是具有CGI或ODBC接口的Web服务器,属于功能层。
（2）键入命令:
NET USE G:\\Win9xname\DOS
这样DOS工作站便能访问DOS文件夹了。
若要安装应用软件的共享文件,也可按上述方法做。
　　利用打印机映射的方式访问共享资源的做法是:NET USE LPTt\\Servername\Sharename
　　其中?为打印机端口的号码,如1、2等;Sharename是类型为Print的共享资源名称。
　　3.断开网络驱动器的连接
　　NET USE drive：/DELETE
　　其中drive为映射驱动器名称。
　　用NET命令映射好驱动器名后,以后登录上网时系统会自动建立好映射,若要改变映射关系,可用NET命令重新设置,有关NET命令的详细情况可键入:NET/t来查询。
4 故障处理
　　软件安装好后如果DOS工作站登录不成功,一般有这样2种情况:(1)有关网卡的初始化设置发生错误;(2)网卡初始化设置正确,但登录失败。对情况(1),进入C：\NET子目录,运行SETUP,把IOBASE（输入/输出地址）、INTERRUPT（中断值）、netcard项（网卡驱动程序）设置正确。对情况(2),检查DOS工作站所安装的网络协议是否与提供共享服务的Windows NT/9x计算机的一致。对X轴,根据每组数据的个数来划分X轴刻度。经过上述处理,一般都能排除故障。如有特殊网卡,网卡驱动程序（Netcard项）需用其随卡驱动程序。
刘杨（武汉华中师范大学计算机系430079）
邓为（武汉华中师范大学计算机系430079）
徐红霞（武汉华中师范大学计算机系430079）
收稿日期：1999-10-28
