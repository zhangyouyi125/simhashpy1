微型电脑应用
MICROCOMPUTER APPLICATIONS
2000　Vol.16　No.1　P.59



工程制图试题库开发中的关键问题的探讨
张国珠　戴时超
摘　要：本文对以图形为主工程制图试题库的图形试题存储格式、题库查询、自动组卷以及试卷的排版打印等关键问题进行了较深入的探讨
关键词：试题库、关键问题、探讨。
Abstract：This paper explores the key problems of the test -question base of mechanical drawing such as the storage formats of graphical questions, retrieval of the question base, automatic generation of tests, and pr inting of test papers. 
Keywords：mechanical drawing　question base　retrieval▲
一、引言
　　工程制图是一门量大面广的技术基础课，研制和开发试题库是工程制图课程实现计算机辅助教学与测试的一项重要内容。它不仅使教师从繁重的组卷工作中解放出来，更重要的是易于实现教考分离，促进教学质量的提高。
　　一般试题库的信息主要是文字，图形很少或没有。而工程制图试题库的信息主要是图形，信息量很大。这就使工程制图试题库的设计和开发有其特殊性，不同于一般以文字为主的试题库。对工程制图试题库而言。关键在于图形试题的存储格式是否合理，题库的查询、维护是否方便，自动组卷能否满足规定条件，排版打印是否符合要求等，对这些问题我们在题库的开发过程中进行了较为深入的研究和探讨。
二、图形的存储格式及数据库管理系统选择
　　选择图形试题存储格式和管理图形试题的非图形信息数据库是开发初期首先遇到的问题。图形可分为矢量图和点阵图。很多数据库管理系统都支持点阵图形，这使点阵图形的管理比较容易。但点阵图形所占存储空间比矢量图大得多，上千道试题的图形如果采用点阵格式必将占居庞大的存储空间，使运行速度降低；再者点阵图形无法修改，题库只能设计成封闭型，给题库的维护和使用带不不便。
　　.是否指定其他人实行备份，他们是否享有必要的登录号和口令。
　　.检验备份完整性的周期。
关键词：数据库　备份　恢复
Abstract：This paper discusses the back-up strategy of dif ferent computers, which is used to restore data efficiently in case of a crash o f the data server or MS SQL Server so as to guarantee the entirety and security of data in the MS SQL Server. 
Keywords：database　back-up　restore▲
一、引言
　　信息技术的发展离不开数据库技术的不断发展，从dbase、Foxbase、Foxpro、Access,到Microsoft SQL Server、Sybase SQL Server、Oracle，数据库的规模越来越大，其功能也越来越强大。
　　通过比较各种数据库，我们选取了Access97数据库管理系统来管理Auto CAD中生成矢量图形试题，在Access97数据库中以OLE对象的方式插入图形试题，通过操作Access数据库中试题的非图形信息管理Auto CAD中的矢量图形，从而解决了矢量图形不易管理的问题。
　　题库选择目前最流行的可视化编程语言Visual Basic 6.o进行编程，使用OLE控件，可以同步将与Access数据库连接Auto CAD图形试题在VB程序中显示。当双击显示图形试题的OLE控件的内部时，可启动Auto CAD相应的图形试题将显示在Auto CAD的屏幕上，可对其进行编辑修改。也可在界面设置功能按纽启动Auto CAD ,对图形试题进行操作，实现相应的功能。
三、查询功能的实现
　　在题库中设置查询功能的目的是使用户可以迅速地掌握整个题库的情况，人工组卷时可以方便快捷地找到所需的试题。
　　查询是否方便快捷，首先取决于数据库中表的字段的设置是否合理。在试题的非图形信息数据库中。我们设置了试题编号、试题章节、试题特征、试题难易程度、答题参考时间、试题图幅大小、优先权等字段。
　　.备份存储的空间是否防窃、防磁干扰、防火。
　　.在负责备份和恢复的主要人员缺席的情况下，是否有其他人能代替他们。人工组卷时，只要匹配这些查询条件，就可以迅速选到所需的相应试题。也可将试题特征、难易程度、优先权设置为“无”按试题章节查询浏览库。
　　在VB程序中使用结构化查询语言SQL可实现上述查询功能。
四、自动组卷功能的实现
　　自动组卷的好坏取决于试卷模型的设计质量和产生合适的随机数
　　试卷模型的建立是根据考生专业、考试性质(考试、考查)、考试时间(期中、期未)等条件综合考虑，确定模型中每道试题的章节内容、难易程度以及试题总量 ，对每一类考试都确定一系列模型供随机选取。建立一个完整的备份策略需要考虑很多因素，包括：
　　.备份周期。
　　自动组卷时，打开模型文件，用设置的指针变量读出某类试卷模型的个数，用VB提供的随机数发生器返回一个随机数，其值在0-1之间，为了用此数去取到模型，必须将此数变成一个合适的整数，为此将随机数乘以10000后对试卷模型个数取余，再加上这类模型的开始位置即为选到的试卷模型，将试卷模型取出放到预先定义好的数组内。
　　以上是服务器镜象备份，也称为双机热备份，另外还有硬盘镜象备份，(最好有二个相同的硬盘)，因出于成本或其他原因考虑，尤其是双机热备份(单独专门使用一个与服务器配置一样的计算机作为备份服务器)采用者较少，因此我们提出了异机备份的策略，这也是最好最经济的备份方式，特别是当服务器崩溃或Microsoft SQL Sever系统崩溃时，因为此时除了双热备份可以启用备份服务器直接使用外，通过其他的各种备份策略(不包括异机备份策略)必须重装服务器操作系统(Microsoft Windows NT)或重装Microsoft SQL Sever，采用异机备份策略，则不必担心，这时候只需待装好Microsoft SQL Sever时，从异机传送数据恢复即可，具体做法是：
　　在局域网内的任何一台工作站计算机上安装Microsoft Windows NT及Microsoft SQL Server，并在该机上建立一个与服务器中的数据库同名的数据库，利用Microsoft SQL Server系统本身提供的异机传送工具(在Microsof SQL Enterprise Manager中的Tools菜单下的Database/Object Transfer)通过设置定时(可以是每周、每月、每日或每时)由计算机自动的把服务器中数据库的数据传送到该工作站机的数据库中，这样一旦服务器(操作系统)崩溃或Microsoft SQL Server系统崩溃时，只要重装服务器操作系统(Microsoft Windows NT)或重装Microsoft SQL Server仍然可以采用异机传送工具来通过该工作站机把数据传回至服务器的Microsoft SQL Server数据库中，以确保数据的安全恢复，上海宏士达公司就是使用这一方法才在恶劣环境下也保证数据不丢失。与上述处理相似，将随机数发生器返回的值乘以10000后对数据库中满足条件的记录总数取余加一，得到一个不大于满足条件的记录总数的整数，从而保证可取到满足条件的试题
　　编程时，先获取试卷模型，然后对模型中每道题定义一个SQL语句对数据库进行查询，得到满足条件的记录集，再由产生的随机数确定记录，取出记录中的试题编号和图幅字段的内容，写入试卷文件中。根据试题总数进行循环，完成自动组卷。
　　.错误使用，客户应用程序以及服务程序使用中的中途故障。
五、试卷的排版打印
　　试卷的排版打印是题库的重要组成部分，其效果好坏直接影响题库的使作用价值。
　　为了排版打印，首先在录入图形试题时要按图形大小确定其在一张试卷中所占的图幅大小，为方便排版，本题库按试题的复杂程度和试题本身的需要确定了三种图幅大小：四分之一页、二分之一页、一页。
　　排版算法：打开试卷文件，读出试题总数以及每道试题试题编号和图幅大小。首先计算整份试卷中图幅为四分之一页试题的整页数，只要将该图幅试题数除以4取整即得，然后确定合适的插入点依次在每页插入四道题进行排版。同理可计算图幅为二分之一页试题的整页数，并进行排版。
　　.仅使用全备份还是共同使用全备份和增量备份。
　　此外，定期的把某些数据，某些表或全部数据备份到光盘，软盘中，放于保险的安全处，也不失为一种好方法。
　　由于用VB编程排版打印复杂，本题库采用在VB中用Auto CAD软件自带的Lisp语言编写排版打印程序，然后在Auto CAD中调用此Lisp程序进行排版打印。■
作者单位：张国珠(杭州电子工业学院 310037)
参考文献：
［1］张宏 标准试卷自动处理系统概述，管理信息系统，1997.7
［2］左晓明，顾锋，计算机辅助制图试题库管理系统的研制与探讨，江西科学，Vol.16增刊
收稿日期：1999-8-20
