软件学报
JOURNAL OF SOFTWARE
1999年 第10卷 第12期  Vol.10 No.12 1999



模糊神经网络及其在时间序列分析中的应用
周春光　张冰　梁艳春　胡成全　常迪
摘要　给出了一种新型的模糊神经网络模型。该模型不需要领域专家的知识进行指导，而是通过对样本竞争分类产生模糊规则。每类样本对应于一条模糊规则，每条模糊规则的后件部分为一个对本类样本进行过学习训练的神经网络.文章以模糊神经网络在时间序列分析中的应用为例，通过与传统的时间序列分析方法以及前向神经网络方法的对比，说明了新型模糊神经网络的有效性.
关键词　模糊神经网络,模糊系统,样本,竞争分类,时间序列分析。DES(AGφ)是维护型愿望，希望在未来一直保持φ成立。目前，模糊系统在自动控制、信息处理、人工智能、图像识别以及心理学、社会学、语言学等方面都得到了广泛的应用［1］。DES(AGφ)是维护型愿望，希望在未来一直保持φ成立。但是，模糊规则的确定比较困难，通常需要领域专家的知识进行指导。
　　人工神经网络（artificial neural network）能够通过学习获得用数据表达的知识，除了可以记忆已知的信息之外，还具有较强的概括能力和联想记忆能力。有一些神经网络模型及算法已经较为成熟并达到了应用水准。神经网络在智能控制、模式识别、机器视觉、连续语音识别、知识处理等方面都取得了进展，令人鼓舞。但是，神经网络中的知识是通过网络的连接权值来表达的，因而难于理解和分析［2,3］。
　　随着对模糊系统和神经网络研究的深入，两个领域间相互独立的关系逐渐改变［4,5］。模糊系统和神经网络的相互融合导致了模糊神经网络（fuzzy neural network）的产生。模糊神经网络一经产生就在工业控制、金融时间序列分析、风险评估等方面得到了广泛的应用，展现了广阔的应用前景。［6～8］
1 模糊神经网络
1．1 典型的模糊神经网络模型
　　比较典型的网络模型有：
　　(1) Hiroyuki Okada等人提出的用于金融风险评估的模糊神经网络模型［7］，如图1所示。网络由Sigmoid型节点和线性节点构成。通过领域专家知识建立模糊模型，得到模糊规则，确定网络中节点的连接及其权值；用单个Sigmoid型神经元表示S型或Z型隶属度函数，用两个Sigmoid型神经元实现钟型隶属度函数；推理结果用重心法进行非模糊化，得到精确的评估结果；并可以利用系统的反馈信息对网络进行训练。这种网络模型的模糊规则由领域专家给出，能够充分利用领域专家的知识，模糊规则易于理解，网络结构简明，具有学习能力。但是，网络互连结构及其权值的确定依赖于领域专家的知识，而专家知识的获取较为困难，有时，专家的知识也会产生不一致性。

图1　用于金融风险评估的模糊神经网络模型
　　(2) Cai Yaling等人提出的由3种不同类型节点构成的网络模型［6］。此网络分为隶属函数层、取小层和求和层，分别由三角形隶属函数节点(TRAN-fuzzy neuron)、取小节点(MIN-fuzzy neuron)、求和节点(SUM-fuzzy neuron)组成，使用三角形隶属度函数。尽管定义了不同的模态算子，但都依赖于可达关系，不能反映三者间本质的不同。
　可得愿望与假设信念一致公理：
　　定理2.

　　以纯实现型愿望DES(AFφ)为例，定理说明，Agent不会愿望实现一个确信一定能达到的状态φ，也不会愿望实现一个确信一定不能达到的状态φ。通过学习来确定取小层的节点个数。该网络能够对学习样本快速记忆，不需要领域专家知识进行指导。但是，当学习样本较多时，规则数量较大，拒识情况较多。
1.2 一种新型的模糊神经网络模型
1.2.1 网络模型
　　本文提出的模糊神经网络模型不需要领域专家的知识进行指导，而是通过对样本竞争分类产生模糊规则。每类样本对应于一条模糊规则，每条规则的后件部分为一个对本类样本进行学习训练的前向神经网络。模糊神经网络由4层不同功能的节点构成，如图2所示。

图2　模糊神经网络模型
　　网络包含C条规则，每条模糊规则具有以下形式：
　　IF X1 is L1j AND X2 is L2j AND ... AND XN is LNj THEN Y=NETj(X1,X2,...,XN)
其中Lij为对应于输入变量Xi的第j个语言变量，NETj为第j条规则的后件神经网络的映射函数，i=1,...,N；j=1,...,C。
　　可得愿望与确信信念约束公理：
　　定理3. 
　　约束3,4给出了愿望存在的必要条件，并且由相应的公理将维护愿望所需的推理转化到信念中进行。每个输入Xi划分为C个语言变量，每一个节点对应于一个语言变量，节点的输出为隶属度函数值。节点的传输函数为
O1ij=μLij(xi)。
　　第2层为取最小层。本层节点与第1层节点给出的隶属度值进行取最小或代数乘操作，得到各条规则的点火强度(firing strength)。
　可得愿望与假设信念一致公理：
　　定理2.

　　以纯实现型愿望DES(AFφ)为例，定理说明，Agent不会愿望实现一个确信一定能达到的状态φ，也不会愿望实现一个确信一定不能达到的状态φ。
　　第3层为后件神经网络层.每条规则的后件部分对应于一个有两层隐层的前向神经网络。与Cohen和Levesque，Rao和Georgeff，Konolige和Pollack等人的工作相比，克服了对信念、愿望和意图的反直观解释问题，解决了关于愿望和意图的无为而治和副作用问题，强调了愿望的激发与维护作用，表达了信念、愿望和意图三者间的动态约束与激发关系.
关键词　理性Agent，思维状态，信念，愿望，意图。后件神经网络的输出与本规则的点火强度相乘作为该层的输出。节点的传输函数为

其中NETi为第i条规则的后件神经网络的映射函数，i=1,...,C。
　　第4层为非模糊化层。该层对各个后件神经网络的输出结果用重心法进行非模糊化，产生模糊神经网络的输出结果.节点的传输函数为

1.2.2 样本竞争分类
　　为了确定模糊规则前件中语言变量的隶属函数，首先对学习样本进行竞争分类.假设共有M个输入样本T1,T2,...,TM，其输入向量为Tk=(Tk1,Tk2,...,TkN)，k=1,...,M.用如下方法对输入样本进行竞争分类。
　　Agent模型是分布式人工智能和多Agent系统研究的重要组成部分。
　　（2） 对每个输入样本和每个种子计算具有最小Dik值的种子Si就是对输入样本Tk竞争的胜者，即输入样本Tk是第i类的成员。每个输入样本只有一个竞争胜者，即每个输入样本只属于C类中的某一类。
　　（3） 对所有的样本竞争完毕后，对每个种子根据竞争获胜的情况,按下式进行修正。

其中α为学习率，取较小的正数,Si为TK竞争的胜者。
　　（4） 如果竞争次数已到,则结束，否则转（2）。
　　在竞争分类过程中对种子进行修正，使种子在竞争所得样本的共同作用下向所得样本移动。经过多次竞争和修正，种子最终稳定在竞争所得到的样本中心。因为每个输入样本仅有一个获胜者，所以每个样本仅属于一个类。由于采用信念集进行语义解释，我们可以放弃Agent的全知假设。模糊规则前件中语言变量的隶属度函数(π4函数)采用如图3所示的梯形函数，其形状由参数a,b,c,d来确定。语言变量Lij的参数由下式确定。

图3　梯形隶属度函数


输入变量X的隶属度计算如下。

1.2.4 模糊规则后件子网的训练
后件子网采用遗传算法进行训练［8,9］。每个子网学习属于本类的学习样本，训练一定次数或误差满足要求后结束训练。
1.2.5 拒识样本的处理
经过竞争，学习样本分为C类，N维输入向量的每一维对应C个语言变量，共有CN种语言变量的组合，即有CN条规则。当N较大时，C条规则仅是CN种组合的一小部分。
　　第3，未能表达出BDI之间的动态约束与激发关系，特别是愿望在Agent动态执行过程中的约束与激发作用。
　　约束4. A(φ1∪φ2)，如果A(φ1∪φ2)∈des(w,t)，则φ1∈bel(w,t)且如果AGφ∈des(w,t)，则φ∈bel(w,t)。综合所有规则的结果，用重心法进行非模糊化即可得到一个能代表全体规则输出结果的值，从而解决了样本拒识的问题。
2 实验结果
　　将本文提出的模糊神经网络模型用在时间序列分析上，并和一些其他的方法相比较以验证其有效性。
　　DES(AFφ)是纯实现型愿望。
　　前向神经网络方法是把时间序列预测中的输入输出模式作为网络的学习样本来对应网络训练，利用网络的学习能力从样本中获取知识，从而作出预测。前向神经网络方法的主要问题是当样本较多时网络的训练难以收敛。
　　本文的实验使用武汉市1978年1月至1987年12月的月平均气温数据［10］，共120个数据。尽管定义了不同的模态算子，但都依赖于可达关系，不能反映三者间本质的不同。用前12个数据作为输入，进行向前一步预测，得到下一个数据。这样，120个数据可以产生108个输入输出模式，以其中前90个模式为学习样本，其他的作为测试样本。每个子网用遗传算法训练5 000代。模糊神经网络输出结果与样本输出结果的比较见图4所示。

图4　模糊神经网络输出与样本输出结果的比较
　　前向神经网络方法使用具有12个输入节点、1个输出节点、40个单隐层节点的网络，网络对90个样本进行学习训练，其他样本用来进行测试。传统的时间序列分析方法使用AR（12）模型，用12个数据作为输入，进行向前一步测试，得到下一个数据.AR（12）的参数确定为
　　Xt=0.728Xt-1-0.246Xt-2-0.080Xt-3-0.209Xt-4-0.203Xt-5+0.018Xt-6-0.375Xt-7+0.052Xt-8+0.007Xt-9-0.114Xt-10+0.043Xt-11-0.073Xt-12。
　　3种方法的测试结果对比如图5所示。由实验结果可以看出，本文提出的模糊神经网络用于时间序列分析上,取得了较好的效果。

图5　测试结果
3 结论
　　本文提出的模糊神经网络模型不需要领域专家的知识进行指导，通过样本的竞争分类产生模糊规则。相对于信念、愿望和意图，目标只是中间概念。
　　由约束3，
2.3 意图
　　定义8. 意图算子INT.
　　意图是承诺的愿望.从实现型意图中，Agent在不违反意图约束的前提下选择下一个动作，并确信由这种选择可能产生的动作序列能够保证所有意图的满足。文章通过与传统的时间序列分析方法及前向神经网络方法的对比，说明了模糊神经网络的实用性和有效性。与Cohen和Levesque，Rao和Georgeff，Konolige和Pollack等人的工作相比，克服了对信念、愿望和意图的反直观解释问题，解决了关于愿望和意图的无为而治和副作用问题，强调了愿望的激发与维护作用，表达了信念、愿望和意图三者间的动态约束与激发关系.
关键词　理性Agent，思维状态，信念，愿望，意图。可以得出的结论是，本文的模型避免了关于愿望的无为而治和副作用问题。
作者简介：周春光,1947年生,博士，教授，博士生导师，主要研究领域为神经网络，图像处理，遗传算法。
　　　　　张冰,1972年生,助教,主要研究领域为遗传算法，图像处理，模式识别。
　　　　　梁艳春,1953年生,博士，教授，博士生导师，主要研究领域为神经网络，图像处理，遗传算法。
　　　　　胡成全,1957年生,副教授，主要研究领域为计算机网络安全与加密，信息管理系统。
　　　　　常迪,女，1972年生,助教，主要研究领域为小波变换，图像识别，神经网络。ACT是原子动作集，动作函数act:弧ACT，为时间树的每条边标记一个原子动作