微型机与应用
MICROCOMPUTER & ITS APPLICATIONS
2000 Vol.19 No.2 P.19,59




网上证券的信息安全方案
高卓敏
摘 要： 申银万国公司的网上证券方案基于SSL协议，具有自定义的加密机制，在WEB服务器和认证服务器开发了相应的安全模块，并采用IC卡技术，提高安全性。
关键词： 网上证券 SSL协议 WEB服务器 认证服务器 IC卡
　　随着信息化建设的深入，网上金融服务业方兴未艾。网上证券作为证券公司树立良好企业形象、方便股民的一项举措，得到了申银万国这样大证券公司的重视，在为其设计的网上证券项目中，信息安全方案是关键，为了让股民放心，首先要保证信息安全。信息安全的中心内容是保证信息在系统内的私密性、认证性和完整性，针对这些要求制订方案。
　　信息安全需要综合各方因素，包括网络体系的安全、数据库的安全和操作系统的安全，若有一个环节相对薄弱，就会成为整个系统的隐患。
1．2 msbusmouse的驱动
　　1．数据结构设备驱动程序不可避免地要涉及硬件底层，因此应该简单了解一些底层硬件数据。而网络体系的安全，按ISO安全体系结构模型ISO7498，七层网络结构对应6类安全服务、8种安全机制，针对网上证券的实际应用特点，主要集中于WEB应用相关的会话层和应用层。
1 网上证券的信息安全方案框架
　　申银万国公司网上证券信息安全方案基于SSL协议，并在SSL协议之上实现了一重自定义的加密算法，以完成对关键数据的保护；在WEB服务器端和认证服务器端分别开发了加强的安全措施，保证实现高级别的安全策略；将IC卡用于证书的颁发、使用和管理，进一步提高可靠性。
　　SSLSecureSocketLayer是由Netscape开发的一种协议，它提供认证服务包括对服务器和客户机的认证，并为在Internet上安全地传送数据提供1个加密通道，即建立一个安全的连接。SSL有2个子层：记录协议子层和握手协议子层。记录协议子层为高层提供封装，握手协议子层允许服务器端和客户端相互认证并协商加密算法和密钥。SSL建立在可靠的传输层如TCP之上，对应用透明，相对于建立在应用层的SET协议显得轻巧和灵活，便于在SSL之上根据不同系统要求进行再开发。在打印机中，该功能函数可以读取和设置lp＿struct结构中的参数。客户浏览器与WEB服务器都有共同信任的第三方认证服务器的公开密钥副本。
　　2．客户端使用“HTTPS：／／”发起连接，通过与WEB服务器的协商确定加密和认证的算法和强度。
　　3．WEB服务器事先通过认证服务器得到一对公／私钥，并将由认证服务器签名了的公钥发给客户浏览器。
　　4．客户浏览器验证后，确认WEB服务器的真伪及其公钥的完整性。客户浏览器接着随机产生一会话密钥，并用WEB服务器的公钥加密传回给WEB服务器。
　　5．WEB服务器用自己的私钥解开会话密钥，自此，建立起1条用此会话密钥加密的安全通道。
　　SSL协议提供基于CA认证服务器的WEB服务器和客户相互认证。传统的口令机制早已不适应像Internet这样的环境，证书机制已被广泛接收。本质上，为进行身份鉴别的证书由公共密钥“加”密钥拥有者的用户标识组成，整个字块由可信赖的第三方签名。
　　struct file＿operations ms＿bus＿mouse＿fops＝｛
　　　　NULL， ／* mouse＿seek，字符设备是顺序文件*／ 
　　　　　read＿mouse， ／／read button，x and y coordinates． 
　　　　　write＿mouse， ／／事实上，调用本函数将返回错误信息 
　　　　　NULL， ／* mouse＿readdir *／
　　　　　mouse＿select， ／* mouse＿select*／
　　　　　NULL， ／* mouse＿ioct1*
　　　　NULL， ／* mouse＿mmap *／ 
　　　　　open＿mouse， 
　　　　　release＿mouse，
　　　}；
　　　（1）static int open＿mousestruct inode * inode，struct file *file）
　　函数首先判断鼠标是否存在或者是否有其它应用正在使用，如果没有，就标识占用鼠标，同时清数据区。它们的基本功能相同，即把buf中的字符写入设备文件，其中在中断方式下首先把buf中的内容放入打印机缓冲区中，然后再1个字符1个字符地打印，二种方式主要的不同是对异常情况的处理。这个功能一般与read＿mouse结合使用。
叶绿（杭州应用工程技术学院信电系310012）
参考文献
1，金连甫．UNIX系统代码分析．杭州：浙江大学出版社，1997
2，胡希明．UNIX结构分析．杭州：浙江大学出版社，1998
收稿日期：1999－09－27
。在客户端，为了实现零安装，采用了ActiveX的控件方式，在控件中完成加密，当需要改变加密算法或更新程序版本时，只需在服务器端修改，客户端会自动下载并安装。从这里可以看到，鼠标设备的检测由驱动程序完成，如果在系统启动的时候鼠标没有安装，那么即使在运行过程中再安装也无济于事。打印机的缓冲区分配在核心空间中，中断方式下用来暂存用户打印数据。在服务器端，解密在相应的ISAPI调用中完成。
2．2 WEB服务器的安全措施
　　网上证券十分强调客户端认证以保证交易的安全，因此，在WEB服务器端特别加强了客户认证，将客户证书鉴别与口令验证、IC卡识别等结合起来使用。客户只有使用“HTTPS”方式，并提交合法的客户证书后才有资格得到服务。WEB服务器端利用专用接口提取提交上来的客户证书中的关键信息，并检查客户输入的口令及IC卡上的证书使用密码，与后台数据库比较是否合法。为保证数据库数据的安全，库中不直接存放口令等信息，而是经过处理的映像或映射算法。
　　WEB服务器端安全模块主要利用ASP编程，由于安全是交易的关键，为防止跳过检验页面而直接进入交易查询页面，利用了ASP特有的session机制，使在原本无状态的HTTP协议中，保持同一应用中各次请求间的联系。ASP可通过一复杂算法产生用来唯一标识1次用户会话的sessionID，以后用户每次请求页面时，服务器都检查sessionID，可在1个应用的global．asa中的session＿OnStart过程中设立判断条件，迫使用户在不通过合法检验的情况下无法进入交易和查询页面。
2．3 认证服务器的安全策略
　　认证服务器的设计和管理也是信息安全的重要一环。实际上，设备文件／dev／mouse所对应的是1个逻辑鼠标，系统会自动地找到真正的鼠标，并对其进行操作。证书的管理还包括发证的审计、查询和证书的废止，其中证书的废止，主要是如何把证书废止列表通知给WEB服务器，既要有实时性又要保证效率，有改进的余地。目前方案中使用内部认证服务器作为起步阶段的选择，今后将考虑与通用认证体系的连通，接收其它根认证服务器的签名，作为可扩展性方面的考虑。
　　为加强证书使用和分发的安全性，方案中采用了IC卡技术。证券公司把内部认证服务器生成的客户证书以特殊的加密形式存放在IC卡上，客户再在自己的计算机上安装证书，并且在每次交易时必须插入IC卡，使证书信息和IC卡上客户的证书使用密码一起提交给WEB服务器，以杜绝证书的冒充和伪造。
　　随着IC卡工艺和功能的不断提高，如本方案中采用的CPU卡，就集成了完整的操作系统并有多重的自保护机制，因而在信息安全的应用中，扮演着越来越重要的角色。但由于目前IC卡读卡机的价格问题，在一般网络应用中的普及为时尚早。但可针对网上证券用户群的特点，制订不同的安全策略，采用不同的证书使用形式。可实时实现委托交易的网上证券在国内尚处于尝试阶段，安全方案有待完善。目前，SSL协议的应用成为一种趋势。今后，必须把握安全技术的最新发展，自主开发我国自己的信息安全技术，才能进一步深入推广电子商务等网络的应用，迎接信息化新世纪的挑战。如果当前存在1个合法的鼠标事件，它就将状态数据区mouse中的按钮和坐标状态数据共3字节写入到用户数据区buffer中，并更新状态mouse