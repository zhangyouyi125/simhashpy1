微型电脑应用
MICROCOMPUTER APPLICATIONS
2000　Vol.16　No.1　P.48-50



信用卡在线安全支付的分析与构建
蔡小虎　钱世德
摘　要：阐述了信用卡在线支付原理及应用手段，指出了其中存在的漏洞，提出了一种基于安全支付协议的解决方案，并对该方案进行了分析。它由美国学者Holland于1975年提出。有必要指出，这里的信用卡是一个广义的概念，它包括了信用卡、智能卡、ATM卡等。
　　在信用卡网上支付中，最为重要的特性是安全性和并发性。其中安全性指的是信息在网上传输时的机密性，可鉴别性及一致性。出于安全性考虑，当前网上信用卡支付主要基于SSL(安全套接层协议)和SET(安全电子交易协议)这两种安全交易协议。采用SSL的连接可以看成在TCP/IP连接的基础上建立一个安全通道，在这一通道中，所有点对点的信息都将加密，并提供了信息摘要功能，从而确保信息在Internet上传输时，不会被第三方窃取或篡改。当基于SSL进行信用卡支付时，SSL主要用于持卡人和商家之间的通信，而商家和银行之间的则通过专线等方式相连。而SET是由MasterCard和Visa这两家全球最大的信用卡公司创建的，它是一种特定于电子商务体系的框架性协议，定义了客户，商家，认证中心，支付网关，信用卡结算中心(结算银行)等参与方，并为各参与方之间的信息流走向、必须采用的加密及身份认证都制定了严密的标准。目前，SSL的最新版本更名为TLS(Transport Layer Security)，由IETF负责开发，并推出了相应RFC(RFC2246)，而SET也逐步被确立为网上交易的工业标准。系统的并发性是另一必须考虑的特性。电子商务系统必须随时准备同时应付大量访问，一次拒绝访问就可能丧失大笔商机。而若用IACRE作为目标函数，则相对可得到较满意的结果，系统无超调和振荡，稳态精度较高。
二、信用卡支付现状及漏洞
　　对于信用卡在线支付应用环境，基于SSL或基于SET这两种方式都存在优势与欠缺。
　　SSL相对较为简便稳定，目前已有较多开发工具。Dell和Amazon就是基于SSL的典型成功案例。然而作为一种针对两方通信的协议，SSL不完全适合需多方参与的电子商务环境；与SSL相比，SET针对性更强。遗传算法作为模仿自然界生物进化思想而得出的一种全局优化算法，它同模糊控制理论相结合，形成了遗传基因模糊控制技术，用遗传算法进行寻优克服了传统寻优技术中许多缺陷，目前受到逐渐重视。
　　SET协议建立在认证机制基础上，它提供了一条称为OPI的指令，将顾客的订单信息和信用卡帐号信息分别用商家的公共密钥和结算中心的公共密钥加密，然后将这两段信息打包在一起，发给商家，商家将其中信用卡帐号信息提取出来，发给支付网关，交由结算中心处理。相关参数取值如下：交叉概率PC=0.8，变异概率PM=0.05，步长为0.02，a=0.89,b=0.11采用两种性能指标ITAE和LACRE(integral of absolute control rate and error)的仿真结果见表1。通过这种方式，SET确保了信用卡帐号的保密。
　　模糊控制的发展至今已不仅仅限于早期经典的模糊控制器了，现在模糊控制系统注重提高稳态控制精度，提高自适应能力，相应产生了混合模糊控制，自适应模糊控制，专家模糊控制，神经模糊控制，遗传基因自适应模糊控制等。其中商家凭证反映了一种商家与经济机构的关系，使得后者能以一种信用卡结算方式与商家结算。这里必须指出一点：SET中商家对于每张信用卡都需要两张数字凭证。通过采用GA对系数a进行寻优，构成可自寻优的Fuzzy控制系统。因此商家必须具有两套公共密钥对，一对用于数字签名，另一对则用于加密对称密钥。然而，SET的严密必带来了一系列的问题：在当前使用的1.0版本中，存在身份验证复杂，加密环节多，处理效率低，商家服务器负荷重等问题，而旨在轻量化(Light-Weighted)的2.0版本却一拖再拖，迟迟未能推出。由例2与例3可见，在某些情况下以ITAE作为目标函数，用遗传算法寻优模糊控制规则时，系统可能出现严重振荡现象，不可用，由于SET整个结算规范都建立在EMV(Europe Master-Visa)卡基础上，对于其他信用卡缺乏兼容性，这也给它的推广带来了许多问题。因此，至今都鲜有完全基于SET的成功案例。
　　在并行性方面，目前许多电子商务网站常常因为前台处理、后台数据库及两者接口等因素的处理能力不足，导致经常性拒绝访问，由此带来的损失是难以估量的。
三、应用方案构建
　　基于安全电子交易协议的信息系统是上海大学与建设银行上海分行的一个合作课题。［1］
　　由表1可见用ITAE作为评价函数时，系统I/S(S+1)对阶跃响应有严重超调，在1.2S时，超调44.2%，而且经过两次振荡在4S时才趋于稳定，而且IACRE作为评价函数效果相当好，没有超调，系统在2S时就可稳定，且稳态精度较高。持卡人与商家之间的通信是完全基于SSL协议的。本系统中商家和部分支付网关功能在商家方实现，认证中心和信用卡结算中心的功能交给银行方完成。
　　考虑到跨平台性和安全性，本系统选用Java作为主要开发语言。Java程序根据应用场合可分为Application、Applet和Servlet三种。Application是Java应用程序，可用于服务器端和客户端，而Applet和Servlet分别用于客户端和服务器端。Applet与Application的优点已是众所周知的，而Servlet同样也具有强大的功能：它是用于互联网服务器上的Java程序，具有一种多线程机制，便于系统的维护和扩展，每个线程可以方便地处理各自的异常情况。 
表2

T(s)0.51.02.02.53.03.5
ITAE0.0582430.3361280.8427341.8274281.7906251.425724
IACRE0.582430.3039140.8589640.9028810.9035550.921909
T(s)4.04.55.05.56.06.5
ITAE0.8329520.3038020.1508290.3685610.8635731.482154
IACRE0.9299300.9331270.9524560.9606890.9681290.987869

　　例3对系统I/S2(0.1S+1)若输入R=15，a=0.1332,b=0.8668，步长为0.05，交叉概率PC=0.8，变异概率PM=0.05。一个遗传算法是一个迭代过程，在每次迭代中都保留一组候选解，按其解的优劣进行排序，并按某种指标从中选出一些解，利用一些遗传算子，如交叉(Cross)和变异(Mutation)等，对其进行运算，产生下一代的一组候选解，重复此过程直到满足某种停止准则为止。眼下大多数Web服务器都支持Servlet的使用。Servlet它为用户发来的每次http请求分配一个线程，一旦处理结束就会自动终止。在Servler基础上，可构架一种瘦客户机肥服务器模式，从而提供了分布式信息处理环境，可满足网上交易系统的并发性需求。此外。Java还提供了与数据库的良好连接，通过JDBC可以方便地实时存取数据库，这些对于建立一种先进通用的网上交易系统极为关键。本系统中使用了Servlet和Application。在数据库存取方面也采用了JDBC。而与银行内部网连接的基于RS232的串行通信程序是在Java Communication包的基础上开发的，它采用了多线程及同步，充分实现了系统并发性。
　　对于SSL开发，主要采用了J/SSL作为开发平台。随着硬件速度的提高和黑客技术的发展，有必要采用强加密。J/SSL是一种完全在美国之外开发的工具，不受出口限制，由此带来的直接好处是可以在它提供的平台基础上使用强加密。它还能支持约50个同时连接(Pending Connection)。(即达到某种性能指标或达到某一设定的遗传代数。
　　从数据库的角度来看，眼下JDBC或ODBC都提供了相当强大的数据库支持能力，在本方案提供的交易环境中，究竟使用哪种数据库并无限制。
　　对于信用卡在线支付，其中最需安全传输的信息是持卡人的信用卡信息，即卡号和密码。［1］
　　由表1可见用ITAE作为评价函数时，系统I/S(S+1)对阶跃响应有严重超调，在1.2S时，超调44.2%，而且经过两次振荡在4S时才趋于稳定，而且IACRE作为评价函数效果相当好，没有超调，系统在2S时就可稳定，且稳态精度较高。在商家与很行内部网间的通信采用了硬件加密器进行基于DES加密，从而最大程度上确保了客户信息的安全性。
　　我国信用卡在支付方面与国外用卡有所区别。本文采用一种带修正因子的控制规则：U=［a×E+(1-a)×EC］其中系统a是介于［0，1］间的实数，E为偏差，EC为偏差变化率，U是控制变量［2］。卡号是直接印置于信用卡表面的，而密码则是存放在卡的磁条上的。这些原始信息同时也存放在银行的后台数据库中。持卡人改变密码时，新密码相应与原始密码的偏移量将被记录在磁条上，新密码或偏移量都不在银行后台数据库中存放。而若用IACRE作为目标函数，则相对可得到较满意的结果，系统无超调和振荡，稳态精度较高。通过卡号及原始密码，可在后台数据库中核对并处理相应持卡人的帐号信息。由于后台数据库不存放持卡人新密码，而新密码与原始密码之间的转换完全在硬件上实现，而转换过程是完全对外保密的，由此导致无法直接对持卡人的信息进行验证。 
表2

T(s)0.51.02.02.53.03.5
ITAE0.0582430.3361280.8427341.8274281.7906251.425724
IACRE0.582430.3039140.8589640.9028810.9035550.921909
T(s)4.04.55.05.56.06.5
ITAE0.8329520.3038020.1508290.3685610.8635731.482154
IACRE0.9299300.9331270.9524560.9606890.9681290.987869

　　例3对系统I/S2(0.1S+1)若输入R=15，a=0.1332,b=0.8668，步长为0.05，交叉概率PC=0.8，变异概率PM=0.05。而商家端将该信息转发给结算银行，由后者与后台数据库加以比较，对合法的信用卡用户产生一个唯一的身份验证密码，并放入后台数据库中。结算银行将密码发给商家，由商家自动发还持卡人，在这一过程中，商家仅仅作为转发站，所有信息都不对它公开。以后，持卡人就能凭借卡号及身份验证密码进行网上交易了。
　　此后的支付的流程可用下图表示：

图1　支付流程
　　其中，顾客(持卡人)与商家间的信息交互采用了SSL加密，而商家与结算银行间则采用了DES加密。由此确保了系统的信息保密性；通过SSL对商家身份进行了鉴别，其中采用了基于X.509数字证书的扩展。而顾客的身份鉴别则由结算银行完成，从而满足了身份可鉴别要求；顾客需提供其个人信息，由此保证了信息的不可否认性；SSL提供了信息摘要功能，防止了信息被篡改的情况。这样，从最大限度上解决了系统安全性问题。系统中还采用了多线程机制，可同时处理多个顾客的请求，并实现了信息的同步处理，保证了系统的并发性。
　　本系统于今年6月在上海大学Internet招生项目中进行了试用。仿真结果见表3。在Internet上开放的短短五天中，该站点共有七千人次访问，其中千余人通过身份验证及各类登录验证，成功地通过网上进行登录。
四、结束语
　　信用卡交易主要基于SSL和SET两种协议。在当前情况下，它们各有优势和缺陷。仿真结果见表3。通过在上海大学Internet招生项目中的应用，证明这种构架在肥服务器瘦客户机模式基础上的方案能够确保网上交易的安全性和并发性。随着我国认证体系的完善及椭圆加密算法的采用，该方案将具有重大现实意义。■
作者单位：蔡小虎(上海大学计算机科学学院272# 上海大学网络中心 200072)
参考文献：
［1］Rob Macgregor,Catherine Ezvan.Secure Electronic Transactions:Credit Card Payment on the Web in Theory and Practice.International Technical Support Organization Raleigh Center.1997
［2］Marco Pistoia,Kenji Kojima,Narayan Raghu.Internet Security in the Network Computing Framework International Technical Support Organization,1998
［3］Paul Philion.Build Servlet-based enterprise Web Applications.Java World,December 1998
［4］Marvin S.Credits and Debits on the Internet.IEEE Spectrum,1997,34(2):23-29
［5］蔡小虎　钱世德　关于电子商务两大基本协议――SSL和SET的对比与分析　第十四次全国计算机安全学术交流会
［6］劳诚信　“上海，迈向卡的时代”《微型电脑应用》1999年第10期P1
收稿日期：1999-10-29
