微型机与应用
MICROCOMPUTER & ITS APPLICATIONS
2000　Vol.19　No.6　P.22-24




基于IEEE 1394数字传输的内容保护方案
王挺　吕述望
摘要：1394技术以及Intel等公司联合提出的、基于IEEE 1394数字传输系统的内容保护方案的工作原理和基本内容。
关键词：IEEE 1394技术 数字传输内容保护 密码技术
　　近来，微软公司的“维纳斯”计划和中国科学院的“女娲”计划在国内炒作得沸沸扬扬。但不管怎样，后PC时代的到来，数字化的信息家电将成为一个发展趋势，1394将成为数字设备的一种标准配制。其中，数字媒体的版权保护，特别是对数字媒体在各类数字设备（信息家电）间传播过程的保护，将成为一个非常重大的课题。
　　基于1394技术的数字传输内容保护系统的设计与实现具有极大的市场潜力，毫无疑问地会吸引企业界和学术界的高度重视。
　　(5)数字凭证（digital ID）。
1  1394技术
　　IEEE 1394是电气和电子工程师协会颁布的高速串行连接标准，它使各种系统和设备间高速、可靠和便捷地传送数字视频和音频。1394又称作i.Link或FireWire，是一种便捷的I／O接口，不需要专门的硬件设备捕获、编辑或记录视频，允许多达63种数字设备（各类信息家电或计算机外设）的连接，具有可伸缩的结构和“热拔插”功能，设计者和用户可随时对系统或设备进行剪裁。常规加密算法设计简单，比较容易破译，已不适用了。SSL利用机密共享和HASH函数数组提供信息完整性服务。在IEEE1394.1995标准基础上，其增强版本的P1394a于1998年末由IEEE着手审议，后继版本P1394b也已于1999年中期递交讨论。由此可见，电子商务的发展是未来25年内世界经济发展的主要推动力。如要用PC制做影视节目，就必须采用昂贵的模拟视频捕获卡以及NTSC制式的重放设备。如果采用1394技术，用户就可通过PC直接控制CE和PC外围设备、编辑音频／视频信息、将外围设备连入Internet网等，并且不会发生质量上的损耗。 Digicash是一个匿名的数字现金协议。SET的证书格式比较复杂，使用成本高，其支付方式和认证结构适用于卡支付，对其它支付方式是有限制的。
2  数字传输系统内容保护
　　DTCP要实现以下目标：
　　(1)能够为IEEE 1394总线上传输的版权音频／视频内容提供足够的安全保护，非法设备无法发送和接收有关内容；
　　(2)能够构造一个高效、可靠、安全的系统环境，所有的PC和CE设备可以正常运转。附加的安全设施对设备性能的影响尽可能小，且尽可能地便宜；
　　(3)能够保证系统的灵活性、可扩展性和可更新性；
　　(4)尽可能地为所有合法用户提供方便的操作，不给用户增加额外的负担；
　　(5)所有的知识产权都需经过适当的方式进行审核；
　　(6)所有的实现方案的设备能够获得进／出口许可，可以在市场上自由买卖。
为此，该方案的实现是建立在一定强度的密码技术之上的。所有的设备在生产制造时都附加一个唯一的密码“部件”，实现认证机制。在版权内容发送和接收之前首先进行认证过程，以保证设备身份的合法性，同时进行密钥交换。发送的内容经过加密处理，防止非法拷贝。系统的使用和密钥的管理都经过相应机构的审核。系统工作流程如图1所示。

图1  系统工作流程
　　(1)源设备首先发出初始帧，其中的加密模式批示符EMI标记内容受保护状态如：“copy once”、“copy never”或“no more copies”；
　　(2)接收设备收到初始帧后，首先查看EMI的有关内容保护标记。卖方可以在网上建立网页(Home Page)，这些网页可以随设立者的目的，提供各种各样的功用，可以有最简单的商品广告，可以有文字、图像、声音说明、性能示范等高度互动的多媒体商业活动。
　　从上可以看到，系统涉及以下几个方面内容：(1)拷贝控制信息(Copy control information)；(2)认证和密钥交换(AKE)；(3)内容加密(Content cipher)；(4)系统更新(System renewability)。由于Internet本身具有开放性，使网上交易面临种种危险。
2.1 拷贝控制信息CCI
　　内容的所有者可决定内容的拷贝限制CCI：“copy once”、“copy never”或“copy free”等。
　　CCI信息嵌入传输内容帧中，许多信息格式如MPEGII中有字段指定相应的CCI。CCI信息任何人都无法修改，同时用加密模式指示符EMI表示相应的CCI信息。对于IEEE 1394，EMI设定为帧头同步字段的最高2bit。这样比特流记录设备（如数字录像机）可直接得到CCI信息。如果EMI被改动，发送内容无法正常恢复。
2.2 认证和密钥交换AKE
2.2.1 完全认证和密钥交换
　　所有设备都由DTLA发放唯一的公／私密钥对和数字设备证书。只有这样，才能为电子商务的安全提供法律保障。数字设备证书也存放在设备中，在认证过程中使用。Full AKE采用基于公钥的数字签名标准DSS和Diffie－Hellman密钥交换算法DH。DSS用于保证数据的完整性。DH用于传输会话密钥，用于二方或多方生成共享密钥。
　　安全认证由接收设备首先向源设备发出请求，然后交换设备证书和随机challenge；之后，双方计算DH第一阶段的数值。最后交换包含如下内容的签名信息：对方设备发来的challenge、DH第一阶段的值、设备中存储的系统最新更新信息（SRM）版本号。以上认证过程很简单。SRM中含有被取消的设备证书列表，在认证过程中，设备将查询列表，确定对方的合法性。这种做法，可有效防止盗版设备的非法使用。全认证过程如图2所示。

图2  全认证过程
2.2.2 有限认证和密钥交换
　　有限认证和密钥交换用来在设备间交换“copy once”、“copy no more”内容。
　　数字凭证的内部格式由CCITTX.509国际标准所规定，格式如表1所示。
有限认证由接收设备首先发出请求，之后源设备要求对方发送设备ID；源设备收到ID后，生成一串随机challenge再发送给接收设备。收到challenge后，接收设备使用相应的密钥（由DTLA签发的服务密钥，service key）计算一个对应的值再发送给源设备。此时，源设备自身的服务密钥和接收方的设备ID对challenge也计算出1个相应的数值，与刚收到的值进行比较，如果二者符合，则完成认证。之后，源设备和接收设备再计算出1个认证密钥(Authorization Key)。
2.3 公共密钥生成
　　公共密钥生成适用于以上二种认证方式。源设备生成1个随机串作为交换密钥，并使用它自己计算出的认证密钥加密，发送给接收设备。接收设备收到后再使用它自己计算出的认证密钥解密，然后得到公共密钥，即内容加密密钥（content key）用于加密版权内容信息流。
2.4 内容加密
　　密码用来加密受保护的内容，不仅需要安全高效，而且要在PC和CE同时实现。为保证互操作性，所有的设备必须支持基本密码方案（Baseline Cipher），同时也可以支持其它密码。密码使用C－CBC工作模式，有效防止已知明文攻击或密钥穷举攻击。
　　采用M6和改进的Blowfish作为基本加密密码，DES等作为可选密码。
2.5 系统更新
　　支持全认证的设备可以接收和处理SRMs。这种系统更新能力可及时废除非法的设备ID，可以保证系统长期的完整性。
　　SRMs可以通过许多途径进行修改。由于系统是通过网络系统连接，并且始终是运行的。一个有效的SRM新版本会很快通知到所有设备。SRM主要内容包括：
　　(1)不断递增的系统更新版本号，保证始终使用最新的SRM；
　　(2)认证废弃表（CRL），记录那些不安全的或非法的设备信息。对于存储能力有限的设备，应首先优先记录那些可能威胁最大的设备信息；
　　(3)由DTLA对以上信息的数字签名，保证SRM的完整性。
　　因此，为了保证电子商务活动的安全性，必须有一套有效的安全机制作为保证，这就要建立电子商务安全基础结构。这种编码法采用单向Hash函数，将需要加密的信息原文通过特定的变换后，“摘要”成一串128 bit的密文。过素数域的椭圆曲线设为E(Fp)，满足以下方程式：
y＾2＝x＾3＋ax＋b a，b，x，y ∈Fp
　　基于椭圆曲线的DSA、DH，在椭圆曲线上选择1个基点G，公开密钥Y1和私有密钥Y－1满足以下关系：
Y1＝Y－1G overE(Fp)
　　ECC DSA和ECC DH的具体描述可参见有关规范说明。但SET协议不同寻常地复杂，该协议的描述有几百页之多。M6是一种基于伪随机置换的分组加密算法，它已被日本数字卫星广播系统采纳为加密标准。同类型的算法有MD5和SHA－1。这样一来，消费者既未收到所购之物，也未花费该电子钱币，肯定受到了损失。
许大为（南京河海大学国际工商学院210029）
参考文献
1，Hanilton S．E－commence for the 21st Century．IEEE Computer，1997；（5）
2，Jutla D．Making Business Sense of Electronic Commence．IEEE Computer，1999；（3）
3，Soon－Yong Choi，Andrew B．Whinston The Future of E－commence：Integrate and Customize．IEEE Computer，1999；（7）
4，Electronic Commerce Project grouping．Accelerating Electronic Commerce in Europe 2nd Edition，1998
5，http：／／www．commerce．org／
6，http：／／www．ispo．cec．be／ecommerce／
7，杨义先．电子商务中的安全问题．世界电信，1999；（1）
8，许榕生．电子商务实用指南．北京：机械工业出版社，1999
收稿日期：1999－12－10
。M6算法中没有采用查询表，软件实现的代码量也极少。M6的密钥长度可变（40～64b），主要是考虑出口限制的因素。
　　Blowfish也是一种密钥长度可变的分组加密算法。方案中对该算法进行了改进，提高了算法在PC上的性能，并降低了复杂性以减少在CE上的实现成本。主要体现在将算法的轮数降至8轮，S－盒减为1个。此外还考虑采用静态S－盒，以减少密钥调度的开销。认证中心是承担网上安全电子交易认证服务、能签发数字证书、并能确认用户身份的服务机构，是一个具有权威性、公正性的第三方。
　　基本密码都采用如图3所示的C－CBC工作模式。这样，利用这段摘要，就可以验证通过网络传输收到的文件是否是初始、未被非法篡改的文件原文了。

图3  C－CBC模式
4  结束语
　　通过对Intel等公司提出的方案分析，可以注意到以下几个问题：
　　(1)没有重新设计新的密码算法和协议，而是采用在机要部门广泛应用、久经考验的、比较成熟的密码方案，这样做无疑是想减少风险。
　　(2)采用基于椭圆曲线的密码算法。用较短的密钥长度获得较高的安全性，同时，也可提高性能、降低设备的成本。
　　(3)基本密码(用于内容加密)的选择或改进，在突出算法效率的前提下，强调软／硬件实现的简洁性。
　　(4)通信协议的设计有相当的灵活性和可扩展性。
　　可以预料，随着数字化技术、通信技术及计算机技术的进一步发展，数字化的信息家电将溶入我们的日常生活之中，1394将成为数字设备的一种标准配制。
3.2 安全认证手段
　　(1)数字摘要(digital digest)。SSL使用加密的办法建立一个安全的通信通道以便将客户的信用卡号传送给商家，它等价于使用一个安全电话连接将用户的信用卡通过电话读给商家