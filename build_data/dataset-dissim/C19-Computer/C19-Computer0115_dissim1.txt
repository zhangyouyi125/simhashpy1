计算机应用
COMPUTER APPLICATIONS
1999年 第19卷 第9期 Vol.19 No.9 1999



触发器的几种应用
李振华　李贵龙　刘涯
　　摘　要　列举了触发器的几种代表性应用：数据分散―集中式模型的设计，历史数据的导出，应用系统间的数据接口。并对如何设计这些触发器进行了探讨。
　　关键词　触发器，数据分散―集中模型，历史数据导出，数据接口
1　引言
　　在大型数据库设计中，会经常用到触发器。它不仅是一个开放平台，还能向用户提供直接的管理应用。
　　在文献［1］中，列举了触发器的几种应用：审计;复杂的完整性约束;复杂的安全性授权;事件登录;列值导出;分布式数据库中表复制。
2　触发器的另外几种应用
2.1　数据分散――集中式模型设计
　　在实际开发过程中，经常遇到这样的数据维护要求：单位由多个部门组成，要求各部门只能维护本部门的数据，但另一方面，又需要将分散到各部门的数据集中起来进行汇总，得到本单位的汇总数据。集中式是在单个控制台上实现监控网络的运行状况，收集网络运行数据，并对网络实施必要的控制。
　　在这种情况下，如果不使用触发器的话，数据库设计就存在困难：
　　. 如果为每个部门都建立一个表，显然难以得到汇总的数据（在这种情况下，无法利用视图机制）；
　　. 如果所有的部门都共享一个表的话（这时，这张表中的数据实际就是汇总的数据），因为每个部门需要维护数据，所以都对这个表有修改权，因此在数据安全上难以控制。
　　使用触发器的话，上述问题便可迎刃而解：为每个部门建立一个表（该部门的所有权限只限于对此表有修改权），再为汇总数据也建立一个表，然后在每个部门表上建立触发器，使得部门表上有数据更新时，便会对应地更改汇总表中的相关数据（见图1）。

图1　触发器应用于数据分散――集中式模型
　　在这种模型中，要注意设计好部门表相关字段的完整性约束，使各部门表内的数据是唯一的，以防止不同部门表出现相同的数据记录，从而导致在汇总表中出现混乱。HP OV事件代理报告管理功能，能寻径、发送、过滤事件。但在很多情况下，历史数据的记载与分析反而比现实数据更有意义（这也正是数据仓库与数据库的区别之一），比如学校中学号的变动，工厂定额的更改，公司产品和原材料价格的变化、股票的升跌等等，它们都需要记录历史数据。
3.1　HP OpenView 应用开发环境
　　HP OpenView 应用开发环境包括：应用程序接口，事件管理服务，以及数据库支持？使用触发器可以解决这类问题。被管对象是实际被管理的资源的抽象概念，这些被管对象能够由图形用户界面显示并控制。随着网络技术的发展，网管平台在最近也有了较大的发展，出现了一些基于Web和LDAP目录服务的网管产品。

图2　历史数据的导出模式
2.3　应用系统间的数据接口
　　一个完整的信息系统的建设一般不是一步到位的，往往是分期分批完成，而不同期次的系统往往又会有数据传递，然而由于需求发生变化或是其他原因，不同期次系统的数据库设计在表结构甚至字段上的设计都可能会互不一致（即使是在同一期的开发过程中，由于总体设计或数据字典方面的偏差或不足，或者需要集成多家系统，这种现象也会经常出现）。在不可能重建这些系统的情况下，它们之间的数据能无缝传递吗？换言之，它们之间能够做到无缝连接吗？
　　在这种情况下，触发器可以是一种较好的解决方式：建立中间表，中间表的设计符合需方应用系统的设计格式，而它的数据又与供方应用系统的数据保持一致。（见图3）

图3　中间作为不同应用系统间的数据接口
　　要注意的一点是：图示应用系统间的数据是单向流动的（即数据传递）；如果数据需要双向流动（即数据交换），那么在触发器设计中应有退出机制，以避免发生触发器的递归。
3　基于网管平台的应用开发环境
　　当前流行的网管平台都是具有开放性的平台，能通过各自的应用程序接口(API)来实现对公共管理服务的访问，使用户充分利用平台的公共管理服务，实现对特殊应用的开发。触发器能使数据库的设计变得简洁和高效。文中的3个例子，代表了触发器3个方面的典型应用。在大型网络中，控制台的大量通信造成处理负载过大，成为网络的处理瓶颈。随着网络技术的发展，网管平台在最近也有了较大的发展，出现了一些基于Web和LDAP目录服务的网管产品。例如，可以允许正常地启动和终止应用程序，并将进程活动情况记录到全局日志中