微型机与应用
MICROCOMPUTER & ITS APPLICATIONS
2000　Vol.19　No.6　P.53-54




新型锁具耐用度测试仪的研究
鲁墨武　蒋玉洁　曾小凡
摘要：对机电一体在新型锁具耐用度测试仪的应用进行了研究，着重讨论了SNC－4型锁具耐用度测试仪的软硬件设计。
关键词：锁具耐用度　测试仪　计算机测量
　　锁具耐用度测试仪是用来进行锁具寿命测试的专用检测仪器。
　　(2)对虽是动态，但其状态转换很慢的图像，如指示灯、仪表头等，可以对其每一种状态着不同的颜色后分别以不同状态部件的裁剪文件形式存盘，形成各种部件的多状态裁剪文件。测试时将锁具装在测试仪上，由步进电机通过传动机构带动锁体和钥匙运动，模拟锁具的使用状况，测量其使用寿命。
1  系统的构成
　　本图像采集系统的主要构成如图1所示。当部件的状态变化时，只需将部件的变化状态控件的图像内容赋值给其标准控件，而这在VB中只需要2条语句即可实现。采用这种方法存在着研制周期比较长，调试和维修不便，可靠性较差，人机界面环境较差以及运转噪声大等缺点。有鉴于此，我们在此基础上研制了新型的锁具耐用度测试仪――SNC－4型锁具耐用度测试仪。这种测试仪主要由计算机、数控系统和机械三部分组成，如图1所示。
　　下面用我们编制的图像采集程序来示例动态链接库的各部分结构。

图1  SNC－4型锁具耐用度测试仪结构图
　　新型锁具耐用度测试仪综合应用了计算机技术、自动化技术与机械技术。
1  硬件设计
　　锁具耐用度测试仪主要工作在实验室中，工作环境较好，所需要的数量较少。为了缩短设计周期，简化调试和维修过程，使操作简单方便且人机界面友好等，本设计采用了模块化结构。
关键词：Visual Basic　瞬态图像采集　数据处理
　　随着现代测量系统数据处理量的增大，其主控机也越来越多地采用高档计算机。利用基础软件进行二次开发，以构成1个完整的机电一体化数控产品。模块化结构具有结构简单，可靠性高，维修方便以及开发周期短等特点，对于多品种、小批量的设备比较适宜，保证了系统的高技术、低成本，可以方便地进行一些常用数控系统的开发。图2是我们设计的控制系统的硬件结构简图。图中的PSC卡是步进电机的专用控制卡，国内外都有现成的产品，插在计算机的扩展槽中即可。购买PSC卡时随卡提供的软件中有控制步进电机运动的各种函数，使用时直接按照用户输入的各个参数，调用相应的函数即可。

图2  控制系统的硬件结构简图
　　整个控制系统是利用计算机通过PSC卡控制步进电机，实现2个独立的运动。运动的基准位置由光电开关来保证，系统中采用的计算机就是普通的486或586微机。这就需要用户利用其丰富的用户控件VBX、动态链接库DLL、动态数据交换DDE及对象的链接与嵌入技术OLE来对其功能进行扩展。所有的硬件部分由图2中的各部分组合而成，硬件结构是模块化的，很容易进行组合。由于PSC卡和步进电机驱动电源都是较成熟的产品，性能比较稳定，从而确保了整个系统的可靠性。
2  软件设计
　　由于在硬件设计中采用PSC卡，软件不必从基础做起，提高了软件的设计水平。主要应用于DOS环境，有1个CCD视频信号入口和1个图像监视器信息出口，无直接的外触发功能。由于系统采用了以通用计算机为中心的控制系统，可充分利用通用计算机的软硬件资源，从而可开发出人机界面友好、操作简单且功能比较强的软件。
　　我们所开发的软件是以UCDOS汉字操作系统为平台，利用C语言在普通486微机上进行开发。整个软件以1个操作程序菜单为核心来进行设计。在对锁具耐用度测试所需要的各种要求进行综合考虑和分析的基础上，设计出如下的操作菜单：
　　　　　　　　　锁具耐用度测试仪操作程序菜单
测试件编号：测试时间：　年　月　日
基准点测试：　　　　　(1／2)预置顺时针旋转角度：　(度)
预置逆时针旋转角度：　　(度)预置钥匙旋转速度：　(转／s)
预置钥匙首先旋转方向：(0／1)预置锁体移动速度：　(mm／s)
预置锁体首先移动方向：(0／1)预置钥匙拔出距离：　　(mm)
预置测试次数：　　　　　(次)当前测试次数：　　　　(次)
当前测试频率：　　　(次／分)

以下为所设置的热键：
F1 预置  Enter 执行  F2 初始化  F3 暂停   F4 急停
F5 存盘  F6 打印  Esc退出
　　运行时，一般要先按F1键，在菜单中进行参数的设置。在软件中设计的菜单具有全屏幕编辑功能，可利用上下左右光标键移动光标至相应的位置，输入或修改各个参数。参数设置完毕后，按Enter键进行测试操作，计算机控制步进电机带动锁体和钥匙运动。在测试过程中，可能会出现一些异常情况，为此设置了暂停和急停功能，测试时用户可以随时按暂停键F3，测试仪在完成1个测试周期后暂停测试，暂停后可以按Enter键继续进行测试。出现紧急情况时，可直接按F4键立即停止测试，返回主菜单。为了保存测试结果，设置了存盘功能，按F5键可以将测试结果存盘。由于锁具的耐用度检测往往需要较长时间，一般持续几天，每天测试完毕后，都需将测试结果存盘，以便第2天继续进行测试。为防止突然断电引起的测试数据丢失，在软件设计中设计了定时存储数据的功能，每过5min程序会自动将数据存盘。每次退出测试时，程序都会提示用户，存储数据。测试结束时，按F6键可将检测结果打印出来。软件中设置的初始化热键F2，在每次进行新的测量时，可自动初始化各参数。
　　程序的设计主要是围绕上述的操作菜单来进行，在软件的设计过程中，以实现各个预定功能作为各个模块的设计原则。各独立功能一般都设计了相应的函数，例如文本编辑函数、打印函数、初始化函数、运行函数等，使所设计的软件具有层次清楚，修改方便等特点。在计算机控制步进电机运动时，由于是采用光电开关控制位置，程序设计时要注意在换向时，给出一些余量，以避免由于机器运行的惯性造成位置的偏差，使机器产生不必要的停机，余量的大小可在实际调试过程中确定。为了使测试仪开始测试时处于基准位置，在软件中另外设置了2组功能键，实现对2台步进电机的微调，以确定基准点。在转换期间用Byte变量存储二进制数据，当String变量在ANSI和Unicode格式间进行转换时，变量中的二进制数据会遭到破坏，在下列的任何一种情况下，VB都会自动在ANSI和Unicode之间进行转换：读文件时；写文件时；调用DLL时；调用对象的方法和属性时。但它主要是面向文档的交换技术。
3  结  论
　　与以往以单片机为核心的锁具耐用度测试仪相比，所研制的软件可完成参数输入和修改、参数初始化、运行暂停、运行急停、数据存盘、打印输出、故障报警、定时自动存盘等多项功能，功能得到了大大增强。当部件的状态变化时，只需将部件的变化状态控件的图像内容赋值给其标准控件，而这在VB中只需要2条语句即可实现。其主要部分有作为动态散斑光源的脉冲激光器、CCD镜头、插入计算机主板的P540图像采集卡和图像显示器及相应的测量工件。由于整体结构采用了模块化设计并具有良好的人机操作界面以及其它一些设计特点，使得测试仪具有运行平稳、噪声小、可靠性高、操作简单、调试方便和易于维修等特点。可以说这种测试仪是运用工业自动化和计算机等高新技术，方便、快捷、低成本开发机电一体化产品的一次有效尝试，对类似机电产品的开发具有一定的参考价值。
鲁墨武（沈阳航空工业学院110034）
蒋玉洁（沈阳航空工业学院110034）
曾小凡（沈阳航空工业学院110034）
参考文献
1,江秀汉，周建辉，吕岭．C语言实用荟萃．西安：西安电子科 技大学出版社，1993
收稿日期：1999－12－23
