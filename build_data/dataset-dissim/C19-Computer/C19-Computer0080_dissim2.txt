计算机工程
COMPUTER ENGINEERING
1999年 第25卷 第8期 Vol.25 No.8 1999



数据采掘支持的新型DSS系统在intranet上的扩展
徐海蔚，杨明福
摘要：提出了一种采用数据采掘技术的决策支持系统。 
　　(2) 细胞区域的宽度和高度 
　　定义ai在X轴上的分量为aix，在X轴上的分量为aiy，aix与aiy的取值如表1所示： 
表 1 aix 与 aiy 的取值 
ajaixaiy
010
111
201
3-11
4-10
5-1-1
60-1
71-1

　　设 x0 与 y0 是起始点的坐标，则
　　宽度 
　　高度 
　　(3) 细胞区域的面积 
 (1) 其中， yi =yi-1 +aiy
　　(4) 细胞区域的圆度　　(2) 
　　圆度用于描述细胞区域与圆形的偏离程度。一条曲线最终可以由下式表示： 
An= α1α2…αn，αi∈{0,1,2, … ,7} ，i=1,　　(1) 
　　An称为曲线的链码。
关键词：决策支持系统；数据采掘；Intranet；Web
Decision Support System with Data Mining and Its Expanding on Intranet
Xu Haiwei,Yang Mingfu
(Department of Computer Science and Engineering,East China University of Science a Technology,Shanghai 200237)
【Abstract】This article introduces a new kind of Decision Suppory System with Data Mining supported.After discussing the importance of more powerful and self-renewable DSS which could fit the demands more properly.
【Key words】DSS;Data Mining;Intranet;Web
　　由于数据采掘本身就是一种从事实或观察数据的集合中寻找模式的决策支持过程，因此数据采掘和决策支持系统 (DSS) 是密不可分的。可以说，数据采掘的目的，就是为目标决策提供支持；而以数据采掘作为支持技术的新型决策支持系统，则能更加强大和具有实用价值。然而 , 传统的决策支持系统往往无法为广大企业经营人员充分利用，更无法体现数据采掘技术的优越。改造 DSS 系统的体系结构并将其向 Intranet 扩展，是决策支持系统发展的必然趋势。
1 一种新型的决策支持系统 
　　数据采掘 (Data Mining) 就是从大型数据库 ( 或数据仓库 ) 中提取人们感兴趣知识的过程。这些知识是隐含、事先未知和潜在有用的。提取的知识表示为概念、规则、规律、模式等形式。更为广泛的说法是：数据采掘是在一些事实或观察数据中寻找模式的决策支持过程。数据采掘的对象不仅是数据库，也可以是文件系统或其他任何组织在一起的数据集合，例如像 WWW 上的信息资源。如图 4(b) 中曲线的链码为 :A=1,0,1,0,1,2,2,4,3,4 。该方法采用基于区域边界的链码方法提取形态学特征，再根据形态学识别算法，对细胞自动进行分类，从而识别出图象中的肺癌细胞。
　　基于验证的数据采掘方法已经在传统的决策支持系统中有了广泛的应用。但仅靠这些远远无法满足用户的需求。这是因为，如果指望人为地为数据采掘提供假设，不仅会影响数据采掘的效率，更会影响它的质量。因为很多最有价值的知识，是很难被事先假设的。因此，基于机器自动发现知识的数据采掘，才是这项技术的精髓。
　　(2) 基于发现的数据采掘 基于发现的数据采掘主要有 4 种：预测模型、数据库划分、关联分析、偏差发现等。在基于发现的数据采掘中，仅靠 DBMS 与统计分析技术已远远不够了，必须使机器具有一定的智能。常用的技术有人工神经网络、决策树、遗传算法、最近邻技术、规则归纳、可视化方法等。
　　从上面的介绍可以发现，数据采掘同决策支持系统相结合，能为其增添更加强大的功能。 

图 3 八链码原理图 
　　从链码可以得到一系列的细胞的几何形状特征，其周长、面积、宽度和高度等所采用的计算公式如下:
　　(1) 链码所围细胞区域的周长，即链的长度 

　　其中 ne表示链码中偶数码的数目， no表示链码中奇数码的数目。为了提高识别肺癌细胞的准确性，系统采用了形态学特征与色度学特征并举的多层次处理结构；同时，在系统中还运用了专家系统和神经网络技术进行识别和判断。而数据采掘所能提供的，不仅仅是对已有知识和假设的验证，更在于它能自动发现和更新知识，使系统具有自我学习的能力，能够根据形势变化提供符合客观情况的决策支持。这正是决策支持系统所迫切需要的。
　　2) 数据采掘技术能为决策者提供更有价值的信息 
　　由于数据采掘不仅能对假设验证，更能主动地发现知识，因此它能为决策者提供未知的、甚至是没有想到的问题和答案。典型的例子是，它不仅能告诉超市的经营者，商品甲和商品乙放在一起是否合适，更能告诉经营者什么商品和什么商品放在一起更好。这些事先无法预料到的知识，对于决策者来说更有价值，使他们觉得花时间使用决策支持系统是很值得的。根据这些参数以及人机交互输入的参数，再由肺癌病理专家系统和神经网络识别系统进行最终的判断和分类，可使整个系统识别癌细胞的正确率达到 95% 以上。 
2.3 形态学识别算法 
　　所采集的彩色细胞图象经过预处理之后，根据如下算法进行特征提取和识别分类。它们可能在不同类型的数据库、电子报表，甚至是文本文件中。而由于数据收集过程中的不可知因素，这些数据不可能完全正确，甚至可能不全。数据采掘技术为处理这样的大量复杂数据提供了可能，使人们能在海量的数据中淘到真金。系统所使用的涂片均采用 HE 染色法进行染色处理。结合了数据采掘的新型决策支持系统，具有强大的生命力，能适应应用的不同要求和不断发展，是这一领域发展的必然方向。
2 传统体系结构存在的问题 
　　传统决策支持系统建立数据库和知识库，并通过人机对话系统与用户交互，了解用户需求，表示知识，提供决策支持信息。随着应用网络化的需求，Client/Server 技术也被用在 DSS 中。常见的是，系统将数据库和知识库集中放在服务器端，由用户通过客户端应用程序向服务器端提出决策所需的数据和知识要求，根据这些数据和相关知识，应用程序作出决策分析和预测 ( 图 1 所示 ) 。
　　传统体系结构曾经发挥过它的功效，但随着应用需求的不断扩大和复杂化，尤其随着数据采掘技术的加入，它将越来越不能适应应用需要。有些问题是无法解决或难以解决的，它们表现在： 

图1　Client/Server模式
　　(1) 知识库结构和内容固定，更新困难。
　　(2) 混淆了知识发现者和决策支持使用者这两类角色，人机交互界面过于专业化。
　　(3) 难以适应分布范围广的用户的不同需求，浪费系统资源且维护成本高。
　　(4) 数据处理能力较弱。
　　可以看到，传统体系结构已无法适应决策支持系统的发展，必须对它加以修改并引入新技术。
3 新型决策支持系统的框架结构
　　根据企业用户范围广、流动性大的特点，同时考虑数据采掘技术的要求，我们提出了决策支持系统的一个新型框架结构 ( 图 2) 。在这种结构下，决策支持系统可以充分发挥数据采掘技术根据最新情况获得最新知识的特点。根据这些参数以及人机交互输入的参数，再由肺癌病理专家系统和神经网络识别系统进行最终的判断和分类，可使整个系统识别癌细胞的正确率达到 95% 以上。其中，在形态学识别部分，通过合理地选择特征向量，并且采用链码方法提取形态特征，提高了系统的运行效率；最小距离分类法的应用使分类识别有了客观定量尺度，大量的实验分析和学习过程以及在专家指导下的再学习功能，使系统的诊断更为科学，识别准确性得到进一步提高。使用者可以通过数字化仪、键盘或光笔监控系统对误差进行校对，以弥补算法上的某些不足并充分发挥技术人员的作用，从而提高系统的性能和准确率。
　　在决策支持系统服务器端，首先建立了收集所有数据采掘可能感兴趣数据的数据仓库。数据仓库的采集单元 (pump) 负责定期通过 Intranet 通信干线向分布在企业网络各处的有关数据库 ( 或其他数据来源 ) 收集最新数据，并完成数据的清洗和重组任务。由于数据仓库中数据对象较为复杂，数量又非常庞大，决策支持系统其他单元对数据仓库的访问 ( 通常是查询 ) 则通过 OLAP Server 完成。通过双重自适应阈值选取算法，求出一幅标示细胞所在位置和形状的二值图象，再经多次筛选后，得到感兴趣的区域。这些查询功能的性能往往直接影响到数据采掘和决策分析的性能，因此必须得到保证。许多应用厂商 ( 如 IBM 、 Oracle 、 Platinum 等 ) 都推出了自己的 OLAP Server 和 pump 产品，具有较好的性能。当然，用户也可以根据具体要求开发自己的 pump 和 OLAP Server 。
　　 在建立数据仓库的同时，系统也建立了知识库。但同传统体系结构不同的是，知识库中的知识除了在系统建立之初输入之外，还有另一个重要来源：决策支持系统的数据采掘功能单元。在这个功能单元中，采掘人员通过 OLAP Server 查询数据仓库中的数据，利用各种数据采掘工具和挖掘算法，将采掘所得的知识放入知识库中。所得到的知识有可能是一些定期固定的统计分析或关联度分析，也可能是一些未预料到的意外收获。在数据采掘单元中，可以使用已有的一些数据采掘工具，如 SAS,IBM Intelligent Miner 等，也可以安置自己开发的数据采掘算法单元。由于数据采掘处理的经常是非常大量的数据，复杂度高，因此要配置较高的硬件资源，并要保证它和 OLAP Server 间的高速数据通信 ( 最好用高速通信专线连接 ) 。由专门人员负责数据采掘的引导与控制工作，并维护知识库，发布新知识。
　　在服务器端，还设置有 Knowledge Server 和 Web 服务器。用户通过 HTTP 协议访问在 Web 服务器上的 HTML 格式 Web 页面，而 Web 服务器则根据页面设置和用户要求向 Knowledge Server 提出决策需求。Knowledge Server 是处理用户决策需求的综合服务单元。 

图 1 系统硬件配置 
　　彩色摄影机与显微镜观察平台相连接，它实时地获取肺癌穿刺标本涂片的视频信号，该信号经图象采集卡处理后转化为 RGB 真彩图象，供计算机系统进行处理。考虑到用户耐心有限，Knowledge Server 还应定期生成一些用户会经常查询到的知识，或分析处理时间较长的知识，等待用户的查询。如本月各子公司销售业绩统计和回归分析，就可以在月末生成出来，在用户需要时直接提供给他们。Knowledge Server 和 Web 服务器的维护由 DSS 专业人员进行。他们根据新发现的知识和用户的需求的变化，维护和扩充服务器端提供的所有服务。
　　在 Browser 端，所有经营决策人员都通过 Web 浏览器访问 Intranet 上连接有 Knowledge Server 的 Web 服务器来进行决策咨询。根据具体需求，决策支持系统用户可以分为以下两大类。一类是一般的经营人员，他们只需要了解一下企业总体经营情况，以及决策支持系统对具体经营的一般性建议，而不需要 ( 或企业政策不允许 ) 了解进一步的信息。这一类用户，不需要和系统动态交互，服务器上的静态 Web 页面就可以满足他们的需求。另一类用户则不是这样。该系统经试用，已实现了肺癌细胞的自动识别和分类，同时还有效地弥补了人工识别的缺陷和不足，提高了识别的准确性和效率。对每种方向赋以一种代码表示 , 如图 3(a) 中 8 个方向分别对应 0,1,2,3,4,5,6,7, 这些代码称为方向码。 
　　为了提高系统的自适应能力，在处理完一定量的穿刺涂片后，系统可以通过人机交互，针对可能出现的误分类，进行误差校对，对聚类中心进行修正，从而提高识别的精度。 
　　本系统在 Windows 95 环境下用 VC++ 语言编程实现。
　　相对于传统决策支持系统体系结构，新型框架具有其不可比拟的优点。其表现在： 
　　(1) 将数据采掘和决策支持两大功能分开，既保证数据采掘功能强大，又方便决策人员使用 
　　在新型体系结构中，彻底分离了知识发现者和知识使用者这两种角色。决策人员既不需要对决策系统有深刻的了解，也不需要学习统计、关联、 OLAP 等数据采掘知识。根据这些参数以及人机交互输入的参数，再由肺癌病理专家系统和神经网络识别系统进行最终的判断和分类，可使整个系统识别癌细胞的正确率达到 95% 以上。
　　(2) 无须管理的客户端，真正跨地域、跨平台使用，对客户端资源要求较低 
　　Web 技术使客户端可以定位于企业各地。只要有浏览器，就可以通过 TCP/IP 协议访问 Web 服务器，用户可以在任何地方的任何计算机上使用决策支持系统。这使流动用户使用方便，也使客户端的软件管理成本几乎为零。由于知识发现都集中于数据采掘单元完成，客户端的处理相对简单。计算机无需太高的配置，大大降低系统整体成本。
　　(3) 系统功能修改和扩充方便，用户访问功能权限集中管理 
　　由于使用 Web 技术，只要对 Server 进行维护和修改，就可以完成对不同用户系统功能的分配、维护和扩展。因此对于由于决策功能扩展和知识修正与发布所带来的变化，也只需通过修改 Web 服务器和 Knowledge Server 就可以完成。
　　(1) 初始化模块 定义系统中使用的各种数据结构 , 对所有全局变量进行说明 , 并分配图象存储区等。总之，不需要对客户端作任何修改。
　　(4) 具有强大、及时的数据管理功能。
　　决策支持系统可以及时处理来自企业各处的最新数据信息，并能将它们合理而系统地组织起来，为数据采掘提供最符合客观情况的依据。
　　总之，采用这样的体系结构，能使决策支持系统真正参与到企业的日常运作中去，被最广大的用户所使用，从而得到他们的承认。它解决了长期困扰决策支持系统开发和使用人员的很多问题。
4 实践中需要注意的问题 
　　当然，这样的体系结构并不是完美的。由于采用了一些新技术，并分离了数据采掘与决策支持两大单元，因此在系统的开发和使用中，必须要注意解决好以下这几个问题。
　　(1) 决策人员和数据采掘人员之间的协调问题 
　　在实际运作中，要求决策人员和数据采掘人员协调工作。为了保证系统的正确运行和分析结果的准确性，在系统的若干模块中还设计了人机交互功能。而决策者除了要向数据采掘人员提出明确的要求之外，更要向他们提供相应的背景知识，促进他们的采掘工作。
　　(2) 知识库中知识表示问题 
　　由于数据采掘是不断自动发现知识的过程，而要发现的知识是事先未知的，因此如何设计一种灵活、可扩展性强，又不失准确性的知识表示方法，是应用中要认真考虑并妥善解决的问题。
　　(3) 直观地表达知识的问题 
　　如何向所有的用户提供易于理解又能充分满足他们需求的多种知识表达方法，是设计人员要认真考虑的问题。
　　总之，新型决策支持系统的开发和应用涉及到许多计算机技术和管理思想的结合与实践。用户应该根据自己的实际需求和实际使用者的应用水平，选择适当的开发工具及技术支持产品，使系统既能满足需要又不要过于复杂和昂贵。 
　　(1) 对图象中的每个象素 Pi 计算其灰度值 Hi ，根据灰度直方图统计自动选取分割阈值 Hth 。
作者单位：华东理工大学计算机系，上海 200237
参考文献 
1 Eriksson H. Expert Systems as Knowledge Servers. IEEE Expert on Intelligent Systems, 1996-07:14-19 
2 Anand S S. Designing a Kernel for Data Mining. IEEE Expert on Intelligent Systems, 1997,(03-04):65-73 
3 Fayyad U, Piatetoky-Shapiro G, Smyth P. The KDD Process for Extracting Useful Knowledge from Volumes of Data. CACM,1996(11):27-34 
4 胡侃，夏绍玮. 基于大型数据仓库的数据采掘：研究综述. 软件 学报，1998-01:53-63 ； 
5 凌永明. 基于 Web 的 Client/Server 计算. 计算机工程，1997 ，23 (2) ： 3-7 
