微型机与应用
MICROCOMPUTER & ITS APPLICATIONS
2000　Vol.19　No.6　P.18-19




电子商务及其安全体系
许大为
摘要：在介绍电子商务的基础上，讨论了有关电子商务安全体系的手段和标准，进而对中国电子商务的发展提出了一些建议。
关键词：Internet 电子商务 安全 加密 认证
1  电子商务概述
　　所谓电子商务，就是指通过计算机网络(互联网)提供的通信手段在网上进行电子交易。这里买主有了广大的新视野，在网上可以从数以万计的供应商中，借助搜索引擎，选择中意的商品或服务。同时，它的编程方法是相当通用的，可以用于多种数据库格式。
　　(2)利用ODBC API直接与数据库连接。预计2000～2010年，网上交易额将上升至4500亿～6000亿美元。但是由此也带来了与数据库之间的通信问题。
　　影响用户网上交易的最主要原因就是电子商务的安全性。因此尽管电子商务的发展前景非常诱人，但如何建立一个安全可靠的网络应用环境，已经成为商家必须考虑的问题，也是电子商务的一个技术难点。
2  电子商务的安全性要求
　　电子商务发展的核心和关键问题是交易的安全性。由于Internet本身具有开放性，使网上交易面临种种危险。其中主要包括：
　　(1)信息泄露。在商务活动中，A公司与B公司进行交易如果不采取保密措施，那么其他人（公司）就有可能非法看到他们的商务信息。如信用卡的帐号和用户名被人获悉，就可能被盗用；如供应商的价格和数量被竞争对手获悉，就有可能丧失商机。
　　(2)识别。当A公司与B公司进行商务交易时，如果A公司的终端上显示“我是B公司”时，A公司如何相信与他交易的就是B公司而不是其它公司呢？同样，B公司又如何相信与他交易的就是A公司而不是其它公司呢？这就牵涉到一个用户识别的问题。
　　(3)篡改。如果A公司与B公司签定了一份由B公司向A公司供应石油工业1000t，单价＄10／t的合同后，适逢全球油价大幅上涨，B公司如能改动其合同数量，将原来1000t改为10t，则B公司可大幅受益，而A公司就可能因此蒙受损失。它采用统一的接口，即路由器选择MAPI DLL(16位)和MAPI32.DLL(32位)，用户无须考虑各种服务器之间的区别，利用它可以方便地开发邮件系统。由于商情的千变万化，商务合同一旦签成就不能被否认，否则必然会损害一方的利益。如果A公司向B公司定购石油，订货时油价较低，但收到订单后，油价上涨，如果B公司单方面否认收到订单的实际时间，甚至于否认收到订单的事实，则A公司就会蒙受损失。
　　因此，电子商务就提出了相应的安全控制要求：
　　(1)信息保密性。在电子商务在信息传播过程中，一般均有加密的要求，以保证诸如用户信用卡帐号、订单数量、供货价格等商业机密的安全。
　　(2)交易者身份的识别。MAPI全称为电子邮件应用程序接口(Mail Application Programmer Interface)，它是Windows开发服务框架系统的一部分，MAPI开放服务框架系统如图1所示。
　　(3)不可修改性。交易合同的文件不可被随意修改，以保障交易的严肃和公正。
　　因此，为了保证电子商务活动的安全性，必须有一套有效的安全机制作为保证，这就要建立电子商务安全基础结构。
3  电子商务的信息安全体系
　　概括起来，电子商务的信息安全体系可以分为以下几个层次：基本加密算法、安全认证手段和安全应用协议，如图1所示。

图1  电子商务信息安全体系
3.1 几个著名的安全交易协议标准
　　在早期的电子交易中，曾采用过一些简单的安全措施，包括：
　　(1)部分告知（Partial Order）。例如，通过使用MAPI驱动程序，Microsoft Exchange消息系统可被连接到绝大多数私用或公用电子邮件系统。
　　(2)另行确认（Order Confirmation）。即当在网上传输交易信息之后，应再用电子邮件对交易作确认，才认为有效。
　　(3)在线服务（Online Service）。为了保证信息传输的安全，用企业提供的内部网来提供联机服务。
　　这些方法，均有一定的局限性，且操作麻烦，不能实现真正的安全可靠性。VBSQL提供了几乎所有的数据库API，并被支持为Microsoft SQL Server本地接口。主要有：
　　(1)Digicash。MAPI全称为电子邮件应用程序接口(Mail Application Programmer Interface)，它是Windows开发服务框架系统的一部分，MAPI开放服务框架系统如图1所示。所谓匿名是指消费者在消费中不会暴露其身份，例如现金交易（虽然钞票有号码，但交易中一般不会加以记录）。同时，它的编程方法是相当通用的，可以用于多种数据库格式。至此消费者的身份仍保密。
关键词：远程数据控制 远程数据对象 ODBC驱动程序 电子邮件
　　随着数据库技术的不断发展完善以及数据仓库的出现，许多公司将大量的数据存放在数据库中，利用数据库管理系统(如：SQL Server，Oracle，Sybase等)对数据进行有效的管理。
　　上述3种方法对数据库操作的示意图如图2所示。此时消费者有2种选择：将其电子Token返回给银行或到另一商家处消费。如果消费者这样做了，而商家事实上在第③步已收到了该Token，则当商家去银行将该Token兑现时会发现该Token的重复使用。
图3是一封自动生成的Email。这样一来，消费者既未收到所购之物，也未花费该电子钱币，肯定受到了损失。在本程序的开发中利用了下列函数：

图1  MAPI开放服务框架系统
　　(1)消息类函数中的compose函数(清空编辑缓冲，以便写新邮件)、send函数(发送写好的邮件)、signon函数(登录邮件服务器，如：Windows95的Exchange、Windows NT的Windows message)。
　　(2)First Virtual。允许客户自由地购买商品，然后使用E－mail同客户证实每一笔交易。但是由此也带来了与数据库之间的通信问题。First Virtual比Digicash要好一些，但比其它电子商务系统要差。
　　(3)SSL。安全套接层协议SSL（Secure Sockets Layer）提供加密认证服务和报文完整性。它是由Netscape提出的安全交易协议。SSL使用加密的办法建立一个安全的通信通道以便将客户的信用卡号传送给商家，它等价于使用一个安全电话连接将用户的信用卡通过电话读给商家。SSL提供3种基本安全服务：
　　①信息私密：通过使用公开密钥和对称密钥技术达到信息私密。本系统在后台运行且每天只运行1次，对程序运行速度和灵活性没有很高要求。
　　②信息完整性：确保SSL业务全部达到目的。
　　这样就完成了任务的定义，此任务将根据要求每天执行1次。
　　③相互认证：即客户机和服务器相互识别的过程。它们的识别号用公开密钥编码，并在SSL握手是交换各自的识别号。这样就防止其他用户冒名顶替使用证明。
这一协议当然不能防止心术不正的商家的欺诈，因为该商家掌握了客户的信用卡号。商家欺诈是信用卡业所面临的最严重的问题之一。考虑到简便性和一定的灵活性，本程序采用RDO和RDC控件实现对数据库的访问。它是Visa和MasterCard联合开发的一个协议，它具有很强的安全性。该协议由若干以前发表的协议形成，它们是：STT（Visa／Microsoft）、SEPP（MasterCard）和iKP协议族（IBM）。SET及其适合的诸协议是基于安全信用卡协议的一个例子。按照SET，客户将采购请求和价格进行数字签名，然后用银行公共密钥将付款信息（例如信用卡号）加密。商家认可该采购并将该请求传给银行。银行加工该请求，若价格匹配，则银行对客户的帐号扣款并指令商家完成该笔买卖。
图3是一封自动生成的Email。
　　②验证持卡人的信用卡帐目，这是由数字签名和持卡人证书完成的。验证工作与收款机构共同进行。厂商验证工作由数字签名和厂商证书完成。
　　③保留付款信息集成，这是由数字签名完成。
　　④特别用途证书。
　　SET的安全性超过SSL，它可防止商家欺诈。但SET协议不同寻常地复杂，该协议的描述有几百页之多。其中任务管理功能可以对定义好的任务进行调度。卡内基.梅隆大学（现加州大学克利分校）的J.D.Tygar教授的研究组开发了Netbill协议，并正和CyberCash、MellonBank和VisaInternational一起在卡内基.梅隆开发Netbill的Alpha版。该协议已获得CyberCash的商业用途许可，CyberCash的CyberCoin协议也使用Netbill的方法。Netbill协议涉及客户、商家及Netbill服务器三方。
图3是一封自动生成的Email。
　　上述3种方法对数据库操作的示意图如图2所示。确认没有问题时，Netbill服务器即从客户的帐号上将相当于商品价格的资金划往商家的帐号上，并存储密钥K和加密商品的密码单据。然后准备1份包含值K的签好的收据，将该收据发给商家；
　　⑧商家记下该收据单传给客户，然后客户将第4步收到的加密信息商品解密。
　　Netbill协议就这样传送信息商品的加密拷贝，并在Netbill服务器的契据中记下解密密钥。
所有这些安全交易标准中，目前应用较多的是SSL和SET协议。一般认为SET协议安全性较好，可以推广利用信用卡支付网上交易，必将成为网上交易安全通信协定的产业标准，但SET协议在实际应用中并不理想。SET的证书格式比较复杂，使用成本高，其支付方式和认证结构适用于卡支付，对其它支付方式是有限制的。另外SET并不能真正提供不可否认性。
2  形成Email文本
　　由于Email的内容主要是一些相关产品的信息，而且这些信息分布在数据库的不同表格中，因此程序就要与数据库进行连接，并以不同的条件从相关的表格中读取有用信息，形成符合要求的Email文本。相对于SET，SSL近年来发展较好，目前随着高位加密的SSL协议(如SSL－128)开发成功，在美国SSL协议已逐步取代SET协议。但SSL协议不支持数字签名、不具有抗否认的特性，一定程度上限制了它的应用。
电子商务安全体系中的加密算法：
　　(1)常规加密算法。常规加密算法即加密密钥与解密密钥是相同的，它有代替密码、置换密码和数字密码等。常规加密算法设计简单，比较容易破译，已不适用了。
　　(2)对称密钥算法。对称密钥算法的加密过程Ek和解密过程Dk使用同1个密钥K，具有Dk(Ek(P))＝P的特性，又称为共享密钥加密算法。
　　其典型代表是DES(数据加密标准)算法，DES体制由IBM公司研制出，于1977年被美国定为联邦信息标准。
　　DES对64位二进制数据加密，产生位密文数据，使用的密钥为64位，实际密钥长度为56位(有8位用于奇偶校验)。VBSQL提供了几乎所有的数据库API，并被支持为Microsoft SQL Server本地接口。
　　(3)不对称密钥加密算法。该算法也称为公开密钥加密算法，即加密密钥与解密密钥不同，由已知加密密钥(Ke)来推导解密密钥(Kd)，它是由Diffie和Hellman于1976年提出的。
该算法解决了对称密钥加密算法中密钥量多难管理及费用高的不足，而且适应数字签名的需求。
　　(2)接收和接受器类函数中的RecipdisplayName函数(收件人的Email地址)、RecipType函数(表明消息来自于何方，其值为0表示为发送者；1表示来自To；2表示来自Copy)。RSA系统非常适用于制作数字特征和加密应用。
3.2 安全认证手段
　　(1)数字摘要(digital digest)。这种编码法采用单向Hash函数，将需要加密的信息原文通过特定的变换后，“摘要”成一串128 bit的密文。这串密文又称数字指纹(Finger Print)，它是有固定的长度的一段代码，而且，对于不同的信息原文，将它摘要成密文后的结果总是不同的，而同样的信息原文所形成的摘要必定是一致的。这样，利用这段摘要，就可以验证通过网络传输收到的文件是否是初始、未被非法篡改的文件原文了。
　　(2)数字签名(digital signature)。

图3  自动生成的Email
3  利用SQL Server的任务调度功能实现程序的自动触发
　　在SQL Server中有一项SQL Executive服务，该服务具有管理事件、任务和警报的功能。数字签名机制提供了一种鉴别方法，以解决伪造、抵赖、冒充和篡改等问题。应注意，要进行任务调度必须保证SQL Executive Manager已经启动。接收者使用发送者的公开密钥对签名进行解密运算，如其结果为明文，则签名有效，证明对方的身份是真实的。当然，签名也可以采用多种方式，例如，将签名附在明文之后。数字签名普遍用于银行、电子贸易等。
　　数字签名不同于手写签字，数字签名随文本的变化而变化，手写签字反映某个人个性特征，是不变的；数字签名与文本信息是不可分割的，而手写签字是附加在文本之后的，与文本信息是分离的。
　　(3)数字信封（digital envelop）。数字信封是用密码技术的手段保证只有规定的收信人才能阅读信的内容。在数字信封中，信息发送方使用密码对信息进行加密，再利用RSA算法对该密码进行加密，被RSA算法加密的密码部分称数字信封。
　　上述3种方法对数据库操作的示意图如图2所示。交易文件中，文件签署的时间是十分重要的信息。在书面合同中，文件签署日期和签名一样都是十分重要的，是防止文件被伪造和篡改的关键性内容。在电子商务中，同样需要对交易文件的日期和时间信息采取安全措施，而数字时间戳服务（DTS）的提出为电子文件发表时间提供安全保护和证明。
关键词：远程数据控制 远程数据对象 ODBC驱动程序 电子邮件
　　随着数据库技术的不断发展完善以及数据仓库的出现，许多公司将大量的数据存放在数据库中，利用数据库管理系统(如：SQL Server，Oracle，Sybase等)对数据进行有效的管理。
　　(3)利用VBSQL DB－Library API直接与SQL Server
相连。
　　时间戳产生的过程：用户首先将需要加邮戳的文件用HASH编码加密后形成摘要，然后将该摘要发送到DTS，DTS在加入了收到文件摘要的日期和时间信息后再对该文件加密（数字签名），然后送回用户。
　　(5)数字凭证（digital ID）。数字凭证又称为数字证书，是用电子手段来证实一个用户的身份和对网络资源的访问权限。在网络上的电子交易中，如双方出示了各自的数字凭证，并用它来进行交易操作，那么双方都可不必为对方身份的真伪担心。
　　数字凭证的内部格式由CCITTX.509国际标准所规定，格式如表1所示。
表1  数字凭证的内部格式
版本(Version)
数字凭证的序列号（Serial number)
颁发数字凭证单位的数字签名参数(Algorithm ID―parameters)
颁发数字凭证的单位(Issuer name)
公共密钥的有效期(Validity period)
凭证拥有者的姓名(Subject name)
凭证拥有者的公共密钥(Subject public key―algorithm)

　　数字凭证有3种类型：
　　①个人凭证（Personal Digital ID）。通过调用上述函数就可以发送Email了。
　　上述3种方法对数据库操作的示意图如图2所示。
　　②企业（服务器）凭证（Serve ID）。它通常为网上某个Web服务器提供凭证，拥有网上服务器的企业就可以用具有凭证的Internet站点来进行电子交易。有凭证的Web服务器会自动地与客户端Web浏览器通信的信息加密。
　　③软件（开发者）凭证（Developer ID）。它通常为Internet中被下载的软件提供凭证，该凭证用于与微软公司Authenticode技术（合法化软件）结合的软件，以使用户在下载软件时能获得所需的信息。
　　(6)认证中心（CA：Certification Authority）。认证中心是承担网上安全电子交易认证服务、能签发数字证书、并能确认用户身份的服务机构，是一个具有权威性、公正性的第三方。通常是企业性的服务机构，主要任务是受理数字凭证的申请、签发及数字凭证的管理。认证中心依据认证操作规定（CPS：Certification Practice Statement）来实施服务操作。CA的主要功能是：
　　①生成电子证书；
　　②对电子证书和数字签名进行验证；
　　③对电子证书进行管理，重点是证书撤消管理(CRL)，同时要追求实施自动管理(非人工管理)；
　　④建立应用接口，特别是支付接口。
张鸿源（北京工业大学信息与信号处理研究室100022）
贾克斌（北京工业大学信息与信号处理研究室100022）
收稿日期：1999－12－12
。认证中心（CA）作为第三方，如果对参与认证的用户和企业不能做到公正、权威的话，后果不堪设想。尽管使用ODBC API和VBSQL DB－Library API能最大限度地直接控制数据库，可以得到更高的性能和更大的灵活性，但却大大增加程序的复杂性。一个完整的安全策略的制定不仅要考虑如何防止外部对本网的攻击，也要考虑如何防止内部人员的破坏。
4.2 电子商务的相应法律法规
　　电子商务不同于普通商务。普通商务中签定的商务合同法律予以保障，人工签名也是普遍接受的。而电子合同法律是否承认，对于数字签名法律是否给予人工签名同样的认可，法律如何仲裁电子交易纠纷，消费者权益保护法是否适用与电子商务等等，这些，都需要制定相应的法律法规。只有这样，才能为电子商务的安全提供法律保障。
5  总  结
　　我国作为最大的发展中国家，应该充分认识到大力发展电子商务的重要性。一方面在政策上加强政府部门对发展电子商务的宏观规划和指导，并为电子商务的发展提供良好的法律法规环境；另一方面，要在技术上保证电子商务的安全性。在发展电子商务的过程中，应坚持建立中国自己的安全防范系统，而不应该片面照搬西方国家的安全系统。因为，国内几乎所有的主机、交换机、路由器、网络操作系统都来自国外，而且美国对别国采取歧视态度，对中国实行密钥信前控制和限制长密钥产品出口。因此，我们必须研制自己的加密算法，建立自己的CA认证中心，以保证中国电子商务的正常发展。
许大为（南京河海大学国际工商学院210029）
参考文献
1，Hanilton S．E－commence for the 21st Century．IEEE Computer，1997；（5）
2，Jutla D．Making Business Sense of Electronic Commence．IEEE Computer，1999；（3）
3，Soon－Yong Choi，Andrew B．Whinston The Future of E－commence：Integrate and Customize．IEEE Computer，1999；（7）
4，Electronic Commerce Project grouping．Accelerating Electronic Commerce in Europe 2nd Edition，1998
5，http：／／www．commerce．org／
6，http：／／www．ispo．cec．be／ecommerce／
7，杨义先．电子商务中的安全问题．世界电信，1999；（1）
8，许榕生．电子商务实用指南．北京：机械工业出版社，1999
收稿日期：1999－12－10
