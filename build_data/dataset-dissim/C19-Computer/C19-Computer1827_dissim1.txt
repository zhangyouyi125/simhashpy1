微型机与应用
MICROCOMPUTER & ITS APPLICATIONS
2000 Vol.19 No.2 P.13,54




ASP实现主页计数器的二种方法及其改进
张子贤
摘 要： 以二个具体的程序剖析了利用ASP技术实现主页计数器的原理，并对目前的二种方法进行了适当的改进。下面从数据传输环境、数据组织、数据表排序、数据传输、出错处理5个部分阐述多表复杂关联数据的传输处理过程。
2 数据组织
　　如果源数据库和目的数据库是同构的，则可以直接建立数据管道，处理起来比较简单。这里涉及的表与表之间的关联一致性检验就是对有关联的表进行主码-外码对应性检查。
　　主页计数器的显示方式有2种：文本显示和图片显示。利用ASP技术实现的主页计数器完全能够满足这2种显示方式，其基本原理如下：通过读取服务器硬盘上相应的计数器文件，把当前的计数值在客户端进行显示，然后对计数器文件的数据进行＋1操作，再写回该计数器文件。在Active Server Pages中可以用2种方法来实现。这是一个开放的对象关系型数据库管理系统，可为用户提供1个高性能、开放的、分布式的、端到端的体系结构，能满足网络中关键任务的专业化应用开发需求。为了解决这一问题，提出了在传输前对数据表按关联关系进行排序的解决方法。由于受Sybase数据库数据完整性的制约，如果传输次序不正确，容易造成某些表的整表数据或一些表的部分记录的丢失。针对这个问题，利用Active Server Pages的1个内置的组件Session，对上面2个源程序进行改进，解决了原来程序存在的缺陷。下面是改进后的源程序。
　　3．方法1的改进省略HTML源码


　　这样，通过对ASP的Session组件来判断用户是否仍然在本网站里逗留，从而判断是否应该给计数器文件做＋1操作。这二种改进均能达到避免主页计数器盲目＋1的操作。此外，如果是利用第一种方法来实现主页计数器的话，可以把相关的程序段写到global．asa里，然后直接在程序中进行调用（关于global．asa的知识点这里不进行讨论）。
　　2.目的数据组织
　　系统采用PB数据管道的更新／添加方式进行数据传输。
张子贤（上海同济大学经济与管理学院200092）
收稿日期：1999－08－26
