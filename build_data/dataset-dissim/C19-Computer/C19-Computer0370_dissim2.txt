信息与控制
INFORMATION AND CONTROL
1999年 第28卷 第2期 Vol.28 No.2 1999



基于奇异值特征的图像预处理及人脸识别
荆晓远　郭跃飞　杨静宇
　　摘要　从增强图像的分类信息角度出发，对人脸图像做频域上的带通滤波预处理，来提高奇异值特征的分类性能。给出了一组圆形滤波函数，并使用遗传算法来选择可分性较大的频段，设计了染色体的表示方式和适应度的求法。
　　　　　戴冠中，男，60岁，教授，博士生导师，校长。ANN以实验数据为基础，经过有限次迭代计算，就可获得一个反映实验数据内在规律的数学模型。人脸图像识别是其中一项有着重要的理论研究价值和应用价值,并且富有挑战性的课题。综述\[1\]比较全面地阐述了已有的各项研究成果。它指出代数特征反映了图像的内在属性，是一种本质特征。


图5　预测残差序列
　　6　结束语
　　语音系统是一类典型的非线性动力学系统，以音周参数为最小单位的ANN识别方法克服了时间不确定性在语音中的影响，又完整的表达了语音状态及拓扑结构。文献\[2,3\]用它来作人脸图像的分类和识别，取得了一定的效果。但是在以前的工作中，很少有针对代数特征去做图像的预处理，而是直接对原始图像矩阵做各种代数变化和分解，来提取代数特征；并且对于人脸图像而言，同一个人的不同人脸样本变化不大。当人脸的姿态和表情等发生较大变化时，实验表明奇异值特征的分类效果不是很理想。因此，我们除了选择合适的分类器以外，需要提高奇异值特征的可分性能。本文认为有两个因素值得考虑：(1)选择合适的可分性判据来评价奇异值特征的可分性大小；(2)对人脸图像做预处理。本文计算出语音稳态吸引子的维数是介于2和3之间的分数，说明语音系统是一个低维混沌系统，这些结果有助于对语音的了解，为实用化的语音识别提供了良好的基础。但是人脸图像的识别在实际应用中是一个需要识别的种类较多，而训练样本数较少的识别问题。非线性向量函数可由多层ANN实现，化为标量形式就是一个多输入多输出网络，其输入、输出分别为
　　　　　　　　　　　　　　　　　　(2)
　　　　　　　　　　　　　　　　　　　　　　(3)
由和分别构成轨道矩阵和输出矩阵。图像的预处理方法很多，如对比度增强、平滑、锐化等。其中不少方法是从图像的描述和表示角度出发，使处理后的图像更符合人的主观感觉。但是为了提高奇异值特征的分类性能，我们需要从增强图像的分类信息角度出发，选择合适的预处理方法。本文对人脸图像做频域上的带通滤波，并使用遗传算法来选择可分性较大的频段。本文计算出语音稳态吸引子的维数是介于2和3之间的分数，说明语音系统是一个低维混沌系统，这些结果有助于对语音的了解，为实用化的语音识别提供了良好的基础。
　　2　带通滤波
　　代数特征是由各种代数变换和矩阵分解抽取的，是图像的本质特征。奇异值特征矢量是一种良好的代数特征。用神经网络建立非线性系统模型研究。(2)对图像平移不变。(3)对图像矩阵的转置不变。(4)对图像的镜面变换不变。我们对大小为32×32的原始图像提取奇异值特征，就得到32维的特征向量。
　　当我们只对图像的某些频率分量感兴趣时，希望通过带通滤波处理，使这些特殊的分量得到增强，而其余的分量衰减。常用的带通滤波函数有矩形滤波函数和环形滤波函数\[4\]。如果我们以零频率分量为频域中心，靠近零频率分量的是低频段，远离它的是高频段，即不同的频段到频域中心的距离不同，则使用环形滤波函数几何意义更明确一些。常用的环形滤波函数为
　　　　　　　　　　　　　　　　　(1)
其中，u0,v0是频域中心坐标， u,v是频域上某点坐标， r1,r2分别是环形窗口的内，外半径。通常a,b只取1或0两个值，当a=1时， b=0；当a=0时，b=1。RPE算法的基本原理是沿J的Gauss-Newton搜索方向修正未知参数向量，从而使J→min，参数向量按下式修正
　　　　　　　　　　　　　　　　　　　　　　　　　(6)
其中是Gauss-Newton搜索方向，而
　　　　　　　　　　　　　　　　　　　　　　　　　　　(7)
　　则递推预报误差算法为
　　　　　　　　　　　　　　　(8)
这里λ(t)是遗忘因子。假设tk时刻的语音信号由下列方程给出
　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　(10)
其中，x∈Rn,u∈R，时间序列y∈R，音周参数θk∈Rm。ai为第i个频段的权值，可为任一实数。为减少计算量，类似于常用的环形滤波函数，我们取ai=1，bi=0。因此，我们先对32×32大小的原始图像矩阵做离散付立叶变换，得到32×32大小的付氏变换矩阵。然后将零频率分量平移到矩阵中心，即点（17,17），则该点对应的频段就是零频率段。取隐藏层节点的作用函数为S型函数g(x)。图1给出了ANN结构示意图，它由输入层、隐藏层和输出层组成，整个网络的特性取决于相邻层间神经元的联结权值以及隐藏层中神经元的阈值。在应用遗传算法时，需要考虑几个关键问题：① 如何将问题描述成串的形式，即问题编码。设重构吸引子所在嵌入空间为Rn0，则重构吸引子状态方程为
　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　(1)
其中，为服从特定分布的噪声向量。下面，我们将遗传算法用于频段选择中.
　　(1) 染色体的表示
　　本文将用二进制数0和1组成的串来表示染色体，染色体的长度是24位，代表24个频段。图4中的A是人们听到的16位采样的一段语音信号y(t)。由此可见，选择得到的频段个数是不确定的。用这种形式的染色体来进行问题编码，实验表明，计算量不是很大，算法容易收敛。
　　(2) 染色体的适应度
　　选择合适的适应度函数是十分重要的，它是衡量特征可分性的标准。如引言中所述，我们选择类内类间距离判据来表示特征的可分性大小。常用的距离判据有

其中，Sb,Sw分别表示类内散布矩阵和类间散布矩阵。当Sw为奇异矩阵时， J2和J3判据就不合适。使用奇异值特征向量来计算Sw，往往Sw为奇异矩阵。随着计算机科学、智能技术尤其是人工神经网络(ANN)的发展，使得实现这种愿望成为可能，并已在混沌的研究与开发中取得了重要进展。求取染色体适应度的具体算法如下：① 根据染色体选择的频段，对原始图像矩阵做频域上的带通滤波，得到一个相同大小的新的灰度图像矩阵。②提取新矩阵的奇异值特征向量，并用J1判据给出奇异值特征的可分性大小，即染色体的适应度。
　　(3) 遗传算法的具体实施
　　我们基本上采用经典的遗传算法，并做一些改进。经典遗传算法在换代时是将原有种群中所有成员全部删除，用新成员取而代之。这样一代中有较高适应度的个体不能保留下来，容易出现进化振荡现象。我们可以在每次换代时仅仅删除原有种群中适应度最低的部分个体，并重新繁殖出同样数目的新个体填充空缺。整个种群就会表现出不断进化的趋势，不会发生振荡。这样遗传算法可以收敛到解空间的某一点，达到全局收敛。另外，本文采用的收敛条件为平均适应度值占最大适应度值的百分比大于某个阈值，这里阈值取为95%。对于频段特征的选择而言，做上述改进就可以使算法收敛，获得较优解，也就是说得到对模式分类起较大作用的频段。
　4　实验结果
　　在实验中，我们从南京理工大学模式识别与人工智能实验室的人脸图像库NJUST-FDB603中抽取了18个人的脸部图像。在建立人脸图像库时，我们让每个人坐在固定的位置上，摄像机与人脸的相对位置和光照条件略有变动，脸部表情和姿态等有较大变化。每人拍12次，得到大小为32×32，256级灰度的图像，这样共有18×12=216个样本。从数学上讲，这就要求该集合在连续函数空间上是致密的。



图1　一个人的样本图像集
　　一般地，在应用遗传算法时，种群数目取30到160之间比较合适，交叉概率取0.25到0.75，变异概率取0.01到0.2。在实验中，我们取种群数目为80个，每次更新替换适应度值最小的60个染色体，交叉概率为0.5，变异概率为0.05，当进化到平均适应度值占最大适应度值的百分比大于阈值0.95时为止。为比较实验结果，我们取前10类样本作为一个较小的样本集，设为样本集A，取所有18类样本作为一个较大的样本集，设为样本集B；并且每类的前4个样本作为训练样本，后8个样本作为测试样本。这样对于样本集A，有10×4=40个训练样本，10×8=80个测试样本,进化到第35代收敛；对于样本集B，有18×4=72个训练样本，18×8=144个测试样本,进化到第44代收敛。我们用最近邻分类器来对奇异值特征向量进行分类，因为它是最常用的分类器之一，通常分类效果较好。表1给出了部分实验结果。
表1　实验结果

选择的频段样本集A1,0,1,0,0,0,0,0,0,1,0,0,1,0,0,1,1,0,1,1,1,0,1,0
样本集B1,0,1,0,0,1,0,1,0,0,0,1,0,0,1,1,0,1,1,1,1,0,1,1
奇异值特
征的可分
性大小样本集A原始图像5.0739
带通滤波后的图像100534
样本集B原始图像3.7197
带通滤波后的图像5.8535
识别率样本集A原始图像81.6%
带通滤波后的图像90.1%
样本集B原始图像72.5%
带通滤波后的图像85.3%

　　下面，我们将对样本集A和样本集B都包含的一幅人脸图像，选择不同的频段做带通滤波。图2从左到右分别显示的是原始图像，样本集A所做的带通滤波处理得到的图像，样本集B所做的带通滤波处理得到的图像。由图2可见，我们对人脸图像所做的带通滤波处理增强的是图像的分类信息，而不是描述信息。

图2　原始图像
　　5　结束语
　　代数特征是图像的本质特征，尽管它的物理意义并不明显直观，但是它对模式分类起着重要的作用。在以前的工作中，很少有针对代数特征去做图像的预处理，而是直接对原始图像矩阵做各种代数变化和分解，来提取代数特征。我们的实验表明，对原始图像做带通滤波预处理，可以提高奇异值特征的分类能力。我们的算法同样适用于其他的代数特征。研究领域为神经网络，非线性科学中的混沌与分形理论。目前这方面已有一些新的进展，如Billings等人将传统的参数估计预报误差方法(RPE)运用于多层ANN的学习训练，以取代反向传播BP算法，该算法收敛速度快、预报精度高\[1\]。
　　我们认为还有不少问题值得进一步研究：(1) 我们对频段的权值只是简单地取为1或0。如果我们将每一个频段的权值作为参数，用遗传算法来进行参数估计，这样带通滤波的处理效果可能会有提高，但是计算量会增大。(2) 考虑其他更好的预处理方法，例如用小波变换对感兴趣的频段进行细化，能否增强代数特征的分类性能。
国家自然科学基金(批准号为69672013)和博士点基金资助,中图法分类号TP391.4
作者简介：荆晓远，男，28岁，博士生。研究领域为图像处理，模式识别，神经网络，信息融合等。
　　　　　郭跃飞，男，35岁，博士生。研究领域为图像处理，模式识别等。
　　　　　杨静宇，男，58岁，教授，博士生导师。图4中的A、B和图5分别是实测数据及用RPE算法训练后ANN的预报输出和残差序列。文献\[2\]运用该方法对实际工业过程进行了建模研究，也取得了良好结果