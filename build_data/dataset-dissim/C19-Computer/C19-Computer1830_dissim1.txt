微型机与应用
MICROCOMPUTER & ITS APPLICATIONS
2000 Vol.19 No.2 P.19,59




网上证券的信息安全方案
高卓敏
摘 要： 申银万国公司的网上证券方案基于SSL协议，具有自定义的加密机制，在WEB服务器和认证服务器开发了相应的安全模块，并采用IC卡技术，提高安全性。由于其重要性，必须采取各种隔离保护技术，防止任何非法入侵，如防火墙技术、数据加密传输等，有条件的还可对其在物理实体上加以封闭性隔离。好的操作系统应对存放此类数据的安全性有严格的控制。信息安全的中心内容是保证信息在系统内的私密性、认证性和完整性，针对这些要求制订方案。
　　信息安全需要综合各方因素，包括网络体系的安全、数据库的安全和操作系统的安全，若有一个环节相对薄弱，就会成为整个系统的隐患。本方案着重于网络体系的安全。而网络体系的安全，按ISO安全体系结构模型ISO7498，七层网络结构对应6类安全服务、8种安全机制，针对网上证券的实际应用特点，主要集中于WEB应用相关的会话层和应用层。
1 网上证券的信息安全方案框架
　　申银万国公司网上证券信息安全方案基于SSL协议，并在SSL协议之上实现了一重自定义的加密算法，以完成对关键数据的保护；在WEB服务器端和认证服务器端分别开发了加强的安全措施，保证实现高级别的安全策略；将IC卡用于证书的颁发、使用和管理，进一步提高可靠性。
　　SSLSecureSocketLayer是由Netscape开发的一种协议，它提供认证服务包括对服务器和客户机的认证，并为在Internet上安全地传送数据提供1个加密通道，即建立一个安全的连接。SSL有2个子层：记录协议子层和握手协议子层。本文从选卡、系统设计到运作管理等方面来对此问题作一论述。SSL建立在可靠的传输层如TCP之上，对应用透明，相对于建立在应用层的SET协议显得轻巧和灵活，便于在SSL之上根据不同系统要求进行再开发。
　　（1）文件存储权限。客户浏览器与WEB服务器都有共同信任的第三方认证服务器的公开密钥副本。
　　2．客户端使用“HTTPS：／／”发起连接，通过与WEB服务器的协商确定加密和认证的算法和强度。
　　3．WEB服务器事先通过认证服务器得到一对公／私钥，并将由认证服务器签名了的公钥发给客户浏览器。
　　4．客户浏览器验证后，确认WEB服务器的真伪及其公钥的完整性。
　　IC卡系统的这几个方面是相辅相成的，每一部分的设计都是相互影响的。
　　5．WEB服务器用自己的私钥解开会话密钥，自此，建立起1条用此会话密钥加密的安全通道。
　　SSL协议提供基于CA认证服务器的WEB服务器和客户相互认证。传统的口令机制早已不适应像Internet这样的环境，证书机制已被广泛接收。本质上，为进行身份鉴别的证书由公共密钥“加”密钥拥有者的用户标识组成，整个字块由可信赖的第三方签名。认证服务器提供WEB服务器证书和客户证书的产生、发放、管理、回收等功能，从而实现客户和服务器的相互认证，一方面使交易服务器确认合法用户的身份，另一方面杜绝第三方恶意冒充服务器，截取用户关键信息，进一步冒充用户，造成严重后果。认证服务器具体完成：
　　（1）生成自己的公私钥对，生成并公布自己的根证书；（2）接收客户和服务器的请求，根据内部的证书颁发策略签发证书；（3）管理证书包括：回收、作废证书、公布证书作废表；4对关键数据的审计和查询。
2 网上证券的信息安全方案实现
　　具体实现中，申万网上证券WEB服务器选用了WinNT平台，认证服务器采用微软的CertificateServer产品，开发时可充分利用微软提供的一套加密、认证的程序调用接口，适应证券交易的特殊要求。在设计IC卡系统过程中，大多数设计者会将整个系统的安全性集中在IC卡本身，其实对于IC卡系统，系统的安全性分布在主机、前置机、脱机终端、联机终端以及通信线路等各个部分。在客户端，为了实现零安装，采用了ActiveX的控件方式，在控件中完成加密，当需要改变加密算法或更新程序版本时，只需在服务器端修改，客户端会自动下载并安装。下载受严格保护，用户必须插入IC卡，通过服务器认证后方可进行下载。Internet上控件的使用正日趋普遍，为使控件体积适应目前国内网络的情况，采用微软的ATL方式开发的控件，大小可控制在几十K范围内。在服务器端，解密在相应的ISAPI调用中完成。其次，常见的恶意攻击往往从这里入手，例如搭线窃听、非法终端等。客户只有使用“HTTPS”方式，并提交合法的客户证书后才有资格得到服务。WEB服务器端利用专用接口提取提交上来的客户证书中的关键信息，并检查客户输入的口令及IC卡上的证书使用密码，与后台数据库比较是否合法。为保证数据库数据的安全，库中不直接存放口令等信息，而是经过处理的映像或映射算法。
　　WEB服务器端安全模块主要利用ASP编程，由于安全是交易的关键，为防止跳过检验页面而直接进入交易查询页面，利用了ASP特有的session机制，使在原本无状态的HTTP协议中，保持同一应用中各次请求间的联系。ASP可通过一复杂算法产生用来唯一标识1次用户会话的sessionID，以后用户每次请求页面时，服务器都检查sessionID，可在1个应用的global．asa中的session＿OnStart过程中设立判断条件，迫使用户在不通过合法检验的情况下无法进入交易和查询页面。
2．3 认证服务器的安全策略
　　认证服务器的设计和管理也是信息安全的重要一环。选用微软的CertificateServer，在证书的颁发策略上十分灵活，利用动态链接库方式定制用户自己的颁发策略，支持手动和自动等方式。
　　（3）防拨特性。目前方案中使用内部认证服务器作为起步阶段的选择，今后将考虑与通用认证体系的连通，接收其它根认证服务器的签名，作为可扩展性方面的考虑。
　　为加强证书使用和分发的安全性，方案中采用了IC卡技术。
　　IC卡可分为接触式与非接触式2种，其最重要的性能：①存储容量要大；②保密性要强。
　　随着IC卡工艺和功能的不断提高，如本方案中采用的CPU卡，就集成了完整的操作系统并有多重的自保护机制，因而在信息安全的应用中，扮演着越来越重要的角色。但由于目前IC卡读卡机的价格问题，在一般网络应用中的普及为时尚早。但可针对网上证券用户群的特点，制订不同的安全策略，采用不同的证书使用形式。可实时实现委托交易的网上证券在国内尚处于尝试阶段，安全方案有待完善。同时，对于不成熟的IC卡系统，不提倡在未进行大量测试的情况下，就大量发卡。今后，必须把握安全技术的最新发展，自主开发我国自己的信息安全技术，才能进一步深入推广电子商务等网络的应用，迎接信息化新世纪的挑战。
高卓敏（华东师范大学计算机系200062）
收稿日期：1999－09－02
