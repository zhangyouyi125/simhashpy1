宇 航 学 报
JOURNAL OF ASTRONAUTICS
1998年  第3期   No.3 May   1998
科技期刊
　　用于飞行器导航的边缘匹配
方法研究

丁明跃　吴　晏　彭嘉雄
(华中理工大学*武汉*430074)
　　摘　要　地图匹配制导由于具有良好的自主性而成为飞行器导航的一种重要方式。本文首先从飞行器导航的应用出发,对于可用于地图匹配制导的匹配方法的特点进行了分析;然后,提出了一种基于二值边缘新的匹配度量,并给出了基于距离变换的边缘二值图像匹配方法;通过采用航片与卫片、可见光图像与合成孔径雷达图像等所进行的大量实验,结果表明本文所提出的方法比常用的平均绝对算法和归一化互相关算法速度更快、匹配定位精度更高。
　　主题词　边缘匹配　飞行器导航　距离变换
STUDY OF EDGE MATCHING APPROACH 
TO AIRCRAFT NAVIGATION

Ding Mingyue　Wu Yan　Peng Jiaxiong
(Huazhong University of Science and Technology*Wuhan*430074)
　　Abstract　Map matching becomes an important means of aircraft navigation due to its high autonomousness.In this paper,beginning from the consideration of the application of aircraft navigation,the characteristics of matching approaches which can be used to map matching guidance are analyzed.Then,a new matching measure based on binary edges is proposed and a new natching method based on Distance Transform is given.After a lot of experiments using aerial and satellite photographs as well as optical and SAR images,it is demonstrated that the method proposed in this paper is much better than the common used correlation algorithms,such as MAD algorithm and Normalized Cross Correlation algorithm in speed and registration accuracy.
　　Key words　Edge matching　Aircraft navigation　Distance transform
1　引　言
　　图像匹配(也称之为图像配准)是图像处理的一项关键技术［1］,可广泛用于目标识别与跟踪、立体视觉、变化检测、测绘等领域。随着计算机技术的不断发展,特别是速度更快、价格更低处理芯片的问世,图像匹配速度大大提高,从而使其在飞行器导航与控制等实时性要求很高的领域也得到了广泛应用。与传统的惯性导航、无线电导航等方式比较,地图匹配制导具有自主性强、制导精度高等优点,因此受到人们的高度重视。
　　与一般的图像匹配应用不同,飞行器导航地图匹配具有以下特点:
　　1)实时性强、存储量小。由于整个地图匹配相关器将安装在飞行器上,因此它对于体积、重量等都有一定的要求。同时由于飞行器速度快,因此要求它实时完成匹配,并能够及时提供所需要的导航信息。
　　2)对于场景适应性强。作为一种导航方式,要求它能够在不同的地点、时间等条件下正常工作。因此要求它能够在不同类型的场景,如山区、平原、丘陵,以及不同特征的场景,如农田、道路、村庄、街道、湖泊、森林等,均具有良好的匹配性能。
　　3)基准图像与实测图像之间不仅在灰度上,而且在特征上(如边缘、拐点等)存在差异。这种差异来源于不同传感器的成像特性,成像距离的变化以及视点的变化等［2］。因此,它是一种所谓的不相似图像匹配(dissimilar image matching)问题(见文献［3］)。
　　目前在飞行器导航中所采用的算法主要有平均绝对差算法和归一化互相关算法。然而,这类相关算法主要基于图像灰度的相似性,所存在的主要问题是对于噪声及各种干扰十分敏感,因此其匹配定位精度和可靠性难以保证。近年来,人们为了解决这一问题也提出了许多不同的匹配方法［4-6］,但主要是针对测绘中图像的对准问题而提出来的,不能满足飞行器导航中实际应用的需要。
　　本文从在正确匹配点,实测图像与窗口图像的像素重合和基本重合的比例最大这一基本思想出发,提出了一种基于二值边缘新的匹配度量,并讨论了该定义的有关性质。同时与距离变换相结合,给出了一种可用于飞行器导航的匹配方法。从一些实验得知,T300、M40纤维复合材料纤维断裂对应高振幅AE信号,一般高于80dB,明显高于界面脱粘对应的AE信号振幅;碳纤维增强塑料的压缩、基体拉伸和纤维束拉伸试验表明,纤维剥离破坏时的AE最大振幅为30dB,基体破坏时的AE最大振幅为40dB,纤维断裂时的AE最大振幅为80dB,因此可用AE的振幅分布来鉴别有关碳纤维复合材料的损伤破坏类型。
2　基于边缘的匹配度量
2.1　基本定义
　　对于实测图像和基准图像,经过边缘检测和分割预处理可以获得边缘的二值图像。基于二值边缘图像的匹配被证明是飞行器导航的一种有效的方法,例如在美国的战斧式巡航导弹上所采用的DSMAC景象相关器就属于这一方式。早期AE峰压强则反映壳体的整体坚固性,Pi值小表明壳体的基体开裂应力低,相应的壳体爆破压强也偏低;反之需要较高的应力才能使壳体的基体开裂,则壳体的爆破压强也高。
　　定义2.3　重合:当集合A中一元素a与集合B中一元素b有‖a-b‖=0,则称a与b重合。它是一种可以在损伤扩展的同时测定损伤情况的有效方法,能对损伤的类型和损伤的程度进行定位与跟踪测定,也是在出现严重破坏之前预测将发生损伤区域的理想方法。这里th为一预置门限。
3.2　AE仪探头分布
　　采用一台微机控制的十四通道AE分析仪,其门坎值为65dB,主放增益为20dB,前放增益为40dB,探头中心频率为150kHz。因此,可以假定在正确匹配点,实测图像集合与窗口图像集合中像素重合和基本重合的比例最大。
2.2　新的匹配度量
　　新的匹配度量定义为:
Sth(A,B)=min(numa/TotalA,numb/TotalB)
(1)
　　其中numa,numb分别表示集合A与集合B中重合和基本重合点的总数;TotalA,TotalB分别表示集合A与集合B中点的总数。下面就(1)式所定义匹配度量的有关性质进行讨论:
　　1)A,B,0≤Sth≤1
　　Sth(A,B)=0时,有numa=0或numb=0,这时集合A与集合B完全不匹配。
　　Sth(A,B)=1时,有numa=TotalA和numb=TotalB。这时集合A中任意一点与集合B中某一点匹配。反之,集合B中任意一点与集合A中某一点匹配。
　　通过对APMOC/环氧树脂复合材料试件实验得知,产生大振幅长时间持续AE事件标志着基体开裂、分层以及它们的扩展,而分层AE振幅能量较基体开裂的大;产生大振幅短时间事件标志着纤维断裂。
　　Sth(A,B)=1(th≠0),是考虑了成像机理的不同和边缘提取可能出现的偏移时的集合A与B的匹配。
　　2)对称性
　　从(1)式的定义中很容易看出A,B,Sth(A,B)=Sth(B,A)。
　　3)弱传递性
　　定理2.1　当th≠0时,Sth(A,B)=1,Sth(B,C)=1,不一定有Sth(A,C)=1,但是一定有S2+h(A,C)=1。
　　证明:由Sth(A,B)=1,Sth(B,C)=1可以推断出,A中任意一点a一定与B中某一点(如b)基本重合,即满足‖a-b‖≤th。这时,不一定有‖a-c‖≤th,因此无法保证A与C完全匹配。并且可以在试验或服役过程中进行远距离连续监控。证毕。
　　定理2.1的结果表明,如果将基本重合的定义从th扩大到2th,那么a可以与c基本重合。
　　定理2.2当th=0时,Sth(A,B)=1,Sth(B,C)=1,一定有Sth(A,C)=1。
　　证明:采用与证明定理2.1类似的方法可推得
‖a-c‖≤‖a-b‖+‖b-c‖=0
(2)
从(2)中即可得到‖a-c‖=0。证毕。
　　定理2.2表明,在th=0的条件下,A与B完全匹配,B与C完全匹配,则一定有A与C完全匹配。材料为APMOC/环氧树脂,由6个纵向循环和13个环向层交替平面缠绕而成。
3　基于距离变换的边缘匹配方法
3.1　距离变换
　　距离变换是将二值图像变换为近似距离的图像(称之为距离图像)。在距离图像中,一点的图像灰度值反映了该点到最近边缘点的近似距离。文献［5］中说明了在计算距离时,采用直接计算像素点之间的欧几里德距离是不必要的。在这里,我们采用文献［5］中所提出的3-4DT算法计算距离图像,具体算法如下:
　　(1)初始化:
　　将边缘二值图像中的边缘点赋为0,非边缘点赋为无究大。
　　(5)费利西蒂比(Feilicity Ratio)　材料在加载过程中产生AE,卸载后重新加载又开始产生AE时载荷与卸载前的载荷之比称为费利西蒂比。
　　(3)重复步骤(2)直到所有点的灰度值不再改变。
　　显然,迭代的次数取决于图像中非边缘点到最近边缘点的最大距离。变换后图像边缘点的灰度值为0。
3.4　纤维缠绕壳体水压爆破试验AE监测
　　水压爆破试验是在水压检验之后,继续增加压强,直至纤维缠绕壳体爆破的过程。对于实测图像和基准图像,我们选用Sobel算子进行边缘检测,并采用文献［7］中的方法进行边缘二值比。
　　(2)距离变换
　　对于(1)所获得的边缘二值图像采用第3.1节的方法进行距离变换即可得到近似距离图像。观察图6,在6MPa稳压期间AE信号呈收敛趋势。如果在初始化时将非边缘点赋初值为无穷大,则可能迭代的时间较长。考虑到在我们的匹配方法中只需确定图像中每一点到离它最近的边缘点的距离是否小于门限th,即若实测图像中一边缘点位于窗口图像中小于th的位置时,则认为此边缘点与窗口图像的最近边缘点基本重合;而若实测图像中一边缘点位于窗口图像中大于或等于th的位置时,则认为窗口图像无边缘点与之对应。
　　(3)图像匹配
　　对于基准图像中每一个可能的匹配位置(x,y),将实测图像作为集合A,对应的窗口图像作为集合B(x,y)。初始化TotalA=TotalB=0,numa=numb=0。对于集合A中的每一个灰度值为0的像素点A［u,v］,TotalA加1。如果窗口图像中的对应点B(x+u,y+v)的值小于TH(门限TH由th和具体的距离变换算法确定,在本文中采用文献［4］中的3-4DT算法,通过大量实验取TH=12)则认为它与窗口图像内的某一个边缘点重合或基本重合,numa加1;类似地,对于集合B中的每一灰度值为0的像素点B［i,j］,TotalB加1。如果实测图像中对应点A(i-x,j-y)的值小于th,numb加1。最后,根据(1)式计算它们之间的相似度。
　　(4)AE能量　由于AE信号表征材料内部缺陷损伤扩展时以应力波形式释放应变能的一些主要特征,在一定程度上反映了材料缺陷损伤引起的应变能改变。
4　实验结果与分析


图1　采用航片和卫片的匹配结果
为了验证本文所提出匹配方法的有效性,我们在486/50微机上进行了大量的匹配实验,并与常用的平均绝对差值算法和归一化互相关算法进行了比较。图1给出了采用航空照片和卫星照片所进行实验的部分结果图像。表1则列出了它们的匹配精度和运行时间的比较结果。在图1中,(a)、(c)分别是实测的航片和卫片基准图,其大小分别为64×67和120×131。(b)、(d)分别是它们所对应的边缘二值图像,而(e)、(f)、(g)则是采用本文的方法、平均绝对差算法和归一化互相关算法的匹配结果。在一般情况下,λ的取值在0.2左右。


图8　纤维缠绕壳体AE计数率
与内压的关系
4　水压试验AE监测研究分析
　　纤维缠绕壳体的AE监测表明,AE计数率与内压之间的关系曲线如图8,AE特性曲线可分三个阶段:早期AE峰阶段,平静阶段及爆破阶段。其结构见图1。从图2的结果中可以看出,对于不同传感器图像,其灰度和特征的变化更为剧烈,因此平均绝对差算法和归一化互相关算法等方法产生了较大的误匹配,而只有采用本文所提出的基于边缘的匹配方法仍能获得理想的实验效果。
3.2　AE仪探头分布
　　采用一台微机控制的十四通道AE分析仪,其门坎值为65dB,主放增益为20dB,前放增益为40dB,探头中心频率为150kHz。针对这些特殊要求,本文提出了一种计算简单、匹配定位精度高的基于边缘点相似度量的匹配新方法。实验结果表明,本文所提出的这种匹配方法对于灰度变化具有较强适应性,同时也适合于不同传感器图像之间的匹配,较好地满足了飞行器导航对于匹配方法的要求,为飞行器导航及制导用地图匹配相关器的研制提供了一条新途径。水压爆破试验监测分析过程与水压检验试验类似,这里不再重述。如何使该方法更好地适应旋转、比例失真以及透视失真等变化将成为我们进一步开展的主要工作。固体火箭发动机壳体在装药前要进行水压验收检验,即水压检验试验,水压检验压强与发动机最大工作压强之比称为水压检验系数,其值一般为1.05～1.10