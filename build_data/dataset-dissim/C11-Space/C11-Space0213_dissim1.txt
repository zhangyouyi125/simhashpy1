宇航学报
JOURNAL OF ASTRONAUTICS
1999年 第2期　No.2 1999



基于神经元的容错组合导航系统设计
马　昕　袁　信
　　摘　要　本文讨论了容错组合导航系统中的多传感器信息融合问题,提出了一种用于多传感器组合导航系统信息融合的神经元方法。f1((t))滤波器的时间常数是f2((t))滤波器时间常数的10倍左右。
　　主题词　组合导航系统　神经元　容错性　信息融合
FAULT-TOLERANT INTEGRATED 
NAVIGATION SYSTEM BASED ON NEURONS
Ma Xin
(Department of Automation,SDUT.Jinan.250061)
Yuan Xin
(Department of Automatic Control,NUAA.Nanjing.210016)
　　Abstract　In this paper,multisensor data fusion of fault-tolerant integrated navigatin system is discussed.A neural approach to data fusion is proposed for multisensor integrated system.The simulation results show that this neural approach to data fusion is available.The paper analyzes the problems still existing,provides a few possibly available methods for these problems,and predicts the future tendency in this field.
　　Key words　Integrated navigation system Neuron Fault-tolerant Data fusion
1　引言
　　现代化的航行体对导航系统的精度和可靠性两方面都提出了越来越高的要求,单靠提高部件的设计和制造来达到要求的精度和可靠性是十分有限的。采用组合导航系统来提高导航精度、可靠性,已成为导航技术发展的方向。逻辑微分控制对于改善控制系统动态品质起了至关重要的作用。目前,寻找一种简单、有效且实用的信息融合方法仍是这一研究领域的重要课题。
　　神经元网络由于其固有的并行结构和学习方式,提供了一种新的信息融合方法。本文提出了一种把神经元作为数据融合中心的容错组合导航系统,通过仿真,验证了该方法的有效性,并进一步分析了该研究领域所存在的问题,提出了可能解决的技术途径,预测了未来的发展趋势。
2　容错组合导航系统的基本思想
　　在多种导航设备综合的导航系统中,多传感器数据融合算法可以分为两类:第一类是用一个集中的滤波器来处理全部量测信息,这种方法的优点是信息丢失量最少,缺点是不仅滤波器的阶次太高,计算量太大,而且任一导航系统故障,就直接影响组合导航系统的性能,甚至使组合导航失效。
　　
图3(a)　30°机动自适应控制实验曲线　　图3(b)　30°机动自适应控制实验曲线
　　
图3(c)　30°机动自适应控制实验曲线　　图4(a)　60°机动自适应控制实验曲线
　　
图4(b)　60°机动自适应控制实验曲线　　图4(c)　60°机动自适应控制实验曲线

　　图5(a)～图6(c)为采用PD控制的实验结果。若不知道局部状态量的协方差的话,需要根据历史数据进行精确估计。
　　作者单位：北京控制工程研究所.北京.100080)
参考文献
　1　吴宏鑫.全系数自适应控制理论及其应用.北京:国防工业出版社,1990
　2　解永春,吴宏鑫,吕振铎.液体远地点发动机工作期间卫星姿态的自适应控制.航天控制.1993,(4):32～38
　3　周军.挠性结构的变结构控制和实验研究.博士后出站报告.北京控制工程研究所,1995
　　本文为国家自然科学基金资助项目
　　收稿日期:1997年4月8日,修回日期:1998年5月18日
。然而,若要保证这些方法有效,必须要求航行体的状态方程非常精确。N.A.Carlson以信息分配原则为基础提出了联合滤波算法［2,3,4］,这种方法按照信息守恒原理在各子滤波器、主滤波器间分配整体系统信息,该算法计算简单、结构灵活、且具有很强的容错性。F.N.Chowdhury提出了一种用于状态估计的神经元数据融合方法［5］,这种方法不需要精确估计方差,但是不具备容错性。本文在各子滤波器中引入故障检测与隔离方法,提出了用多组神经元作为融合中心的容错组合导航系统。其原理框图如图1所示。f1((t))滤波器的时间常数是f2((t))滤波器时间常数的10倍左右。

图1　基于神经元的容错组合导航系统结构框图
3　神经元数据融合中心
3.1　问题描述
　　考虑如下离散系统模型:
　　　　　　X(k)=φ(k,k-1)X(k-1)+Γ(k,k-1)W(k-1)　　　　　　　　(1)
其中X(k)∈Rn是系统状态,φ(k,k-1)∈Rn×n是状态的一步转移矩阵,Γ(k,k-1)∈Rn×r是系统噪声矩阵,W(k-1)∈Rr是白噪声序列,并有E{W(k)}=0,E{W(k)WT(j)}=Q(k)δkj,
设该系统有N组量测值,则相应地有N个局部滤波器,每个滤波器均可独自完成滤波计算。
　　
图5(a)　30°机动PD控制实验曲线　　图5(b)　30°机动PD控制实验曲线
　　
图5(c)　30°机动PD控制实验曲线　　图6(a)　60°机动PD控制实验曲线
　　
图6(b)　60°机动PD控制实验曲线　　图6(c)　60°机动PD控制实验曲线
　　表1给出了全系数自适应控制和PD控制实验结果的比较。在一致分布的情况下,后验概率密度函数f(X|i)正比于联合概率密度函数f(X-1,X-2,…,X-n)(为一似然函数)。
　　　(5)
记
则联合概率密度函数可表示为:
　　　　　　　　　　　　　(6)
矩阵的维数为:X=(n×1),u=(nN×1),e=(nN×n),S=(nN×nN),F=(n×1),PF=(n×n)
对上述似然函数求导,可得极大似然估计F:
　　　　由　l=(u-eX)TS-1(u-eX)　　　　　　　　　　　　(7)
　　　　令　　　　　　　 　　(8)
　得　　　　　　　　　　　　　(9)
　　由(9)式可见,为了得到最优全局状态估计解,在各局部估计量的协方差信息未知的情况下,需要精确估计矩阵S。然而由式(9)可知,实际上并不需要知道S,而只需要得到［eTS-1e］-1eTS-1的估计值。令D=［eTS-1e］-1eTS-1
　　则　　　F=Du　　　　　　　　　　　　　　　　　　(10)
　　若F是一标量,则有N个局部状态估计值,S是N×N维矩阵,而D是一个1×N的列矢量,这样待估计量大为减少。假定第i个局部状态估计的方差是σ2i,且各局部状态估计无关,则S是对角阵,且列矢量D的第i个元素为:
　　　　　　　　　　　　　　　　(11)
显然D有以下约束条件:
　　　　　　　　　　　　　　　　(12)
从而,为了得到最优全局状态估计解,只需要估计相对权重,而无须计算估计方差。
3.3　神经元作为融合中心
　　在对各局部状态估计量进行融合处理前,先利用残差χ2检验法对各传感器进行故障检测［6］。然后根据各传感器的工作情况,明确应选择哪组神经元作为数据融合中心。为了使系统具有容错能力,在不同传感器有故障时,应选择不同的神经元。
　　设ym为机动角设定值,当|y(t)-ym|平稳地小于r1时停止参数估计,取=(t-1)。从而应有五组神经元。对于每组神经元,应有n个单独工作的神经元,也就是说一个神经元处理一个状态标量的估计融合(各状态融合单独进行)。因此,容错组合导航系统数据融合中心需要5×n个神经元。
　　每个神经元都有N个输入、一个输出,如图2所示。通过融合来自N个传感器观测到的第j个系统状态,i=1,2,…,N,而得到第j个系统状态的全局估计解。该神经元是最简单的线性神经元,0为其阈值。

图2　作为数据融合中心的神经元
　　事先应用大量样本训练各神经元以确定其权重值,样本的局部状态估计量为,相应的真实状态为XTm,m为样本数。Xm为N×m维矩阵。为了使系统超定,应使m＞N。训练的目的就是使融合方程:
　　　　　　D(opt)Xm=XTm　　　　　　　　　　(13)
成立。D　(opt)是最优权重矢量。神经网络学习方法为求解D提供了一个迭代算法,权重初值为一个随机小量,在后面的迭代中,权重由下面公式进行修正:
　　　　　　Dk+1=Dk+ηεkXm　　　　　　　　　(14)
其中η为学习步长,0＜η＜1,εk为第k步的误差。
　　　　　　εk=XTm-Dk/Xm　　　　　　　　　　(15)
　　另外,在每一步的运算中,还应考虑D的约束条件(12)式。训练结束后,权重D收敛到一固定量,此时该神经元就可以作为一个融合中心来处理某一种传感器工作情况下,来自各传感器的局部状态估计量了。训练过程是离线进行的。
4　仿真
4.1　数学模型
　　本文设计的容错组合导航系统如图1所示。各子滤波器的状态方程为惯导系统的误差方程,即采用间接法直接估计惯导系统的误差,利用输出校正来校正惯导系统的参数,得到局部状态估计。设惯导系统为指北方位系统,采用东北天坐标系,取平台误角φE,φN,φU,位置误差δL,δλ,δh,陀螺漂移εbx，εby，εbz，εrx，εry，εrz,加速度计漂移x,y,z作为状态量,系统状态方程的离散形式为:
　　　　　　X(k)=φ(k,k-1)X(k-1)+Γ(k,k-1)W(k-1)　　　　　　　　(16)
　　SINS/GPS采用位置、速度综合,其量测值有两组:一组为两系统的位置差值;另一组为两系统的速度差值。GPS只考虑了SA误差。SINS/GPS系统观测方程为:
　　　　　　ZG(k)=HG(k)X(k)+VG(k)+γGρ(k,φG)　　　　　　　　　 (17)
　　SINS/TAN采用SITAN算法,其量测值是根据惯导系统和数字地图信息估计的相对高度和无线电高度表测量的相对高度之差,是一维的,其量测方程为:
　　　　　　ZT(k)=HT(k)X(k)+VT(k)+γTρ(k,φT)　　　　　　　　　 (18)
　　由于惯导系统垂直通道是不稳定的,而多普勒雷达提供的垂直速度精度又很低,因此子系统SINS/DNS不考虑垂直通道。该系统状态不包括垂直速度误差和垂直位置误差,而考虑了DNS的刻度系数误差δK及Doppler速度误差,状态方程仍为18阶。为加快将全系数自适应控制方法应用于实际航天控制的进程,本文考虑一类刚性主体上带有挠性板的航天器,在采用喷气和飞轮执行机构的控制模式下,设计了绕单轴转动的全系数自适应控制方案,并利用挠性卫星单轴气浮台全物理仿真系统进行控制实验。
　　飞机的飞行轨迹由专门的仿真程序产生,提供包括时间、即时位置、速度、姿态、航向、姿态角速度及加速度等信息。整个航迹有滑跑、起飞、爬高、转弯、平飞等过程,总飞行时间为1000s。仿真的初始数据及参数见表1。
表1　仿真初始数据及参数

参　　　数　数　　　值
初始位置(纬度,经度,高度)L0,λ0,h0N32°,E118°,5m
初始位置误差δL0,δλ0,δh030″,30″,5m
初始速度误差δVE,δVN,δVU0.6m/s,0.6m/s,0.6m/s
初始姿态误差角φx,φy,φz300″,300″,600″
陀螺白噪声漂移ωgx,ωgy,ωgz0.01°/h,0.01°/h,0.01°/h
陀螺常值漂移εbx,εby,εbz0.1°/h,0.1°/h,0.1°/h
陀螺一阶马尔可夫漂移εrx,εry,εrz
Trx,Try,Trz0.1°/h,0.1°/h,0.1°/h
7200s,7200s,7200s
加速度计一阶马尔可夫零偏σax,σay,σaz
Tax,Tay,Taz10-4×g,10-4×g,10-4×g
1800s,1800s,1800s
GPS接收机(C/A码)
(位置测量误差)σPE,σPN,σPh
TPE,TPN,TPh25m,25m,25m
100s,100s,100s
GPS接收机(C/A码)
(速度误差)σVE,σVN,σVU
TVE,TVN,TVU0.05m/s,0.05m/s,0.05m/s
100s,100s,100s
数字地图制作误差γm5m
无线电高度表测量误差γr5m
DNS刻度系数漂移σδK0.25%
Doppler速度误差
一阶马尔可夫零偏
σδVD,TδVD
1000m/h,300s


　　为了对五种传感器工作情况下的神经元进行训练,需要产生五组训练数据,即分别假定(1)全部正常工作;(2)GPS故障;(3)TAN故障;(4)DNS故障;(5)SINS故障产生五组训练数据。我们只对位置L,λ,h进行融合,因此,需要单独训练15个神经元。
4.2　训练
　　对于每组神经元中的三个神经元(分别用于L,λ,h的融合),输入为4个子系统的状态估计,理想输出应为真实位置(L,λ,h)。
　　挠性结构卫星单轴气浮台全物理仿真实验验证了所设计控制方案的有效性和可行性,这为今后将全系数自适应控制方法实际应用于航天器控制进一步准备了条件。实验结果见图3(a)～图4(c)。为加快将全系数自适应控制方法应用于实际航天控制的进程,本文考虑一类刚性主体上带有挠性板的航天器,在采用喷气和飞轮执行机构的控制模式下,设计了绕单轴转动的全系数自适应控制方案,并利用挠性卫星单轴气浮台全物理仿真系统进行控制实验。设OXYZ是原点为O,以OZ轴为垂直轴的轨道坐标系,oxyz是原点为o,oz轴与OZ轴重合的固连在刚体上的直角坐标系。为了进行比较,仿真了利用N.A.Carlson的联和滤波方法而得到的融合估计量(采用在初始时刻分配一次信息的无反馈模式)。图4为真实轨迹与训练用轨迹相同时各局部估计量及融合估计量的纬度误差比较曲线。当真实轨迹与训练用轨迹很不相同时,如真实飞行轨迹如图3(a)、3(b)中虚线所示,融合估计效果仍很好,图5为当DNS在t=100s发生故障、且真实轨迹与训练用轨迹不同时的各状态估计量的经度误差比较曲线。
　　
图3(a)　飞行轨迹(经度纬度)　　图3(b)　飞行轨迹(经度高度)
　　　　　　
图4　真实轨迹与训练用轨迹相同时　　图5　真实轨迹与训练用轨迹不同、且DNS在
各状态估计量的纬度误差比较曲线　　100秒故障时各状态估计量的经度误差曲线
5　分析
　　从上面的仿真情况可以看出,基于神经元的容错组合导航系统的导航精度较好,且具有容错性,可以替代传统的需要估计协方差的数据融合方法。但是这种方法离线学习时间较长,且不具备自适应性。如果可事先知道协方差数据的话,也许可以进一步完善这种基于神经元的数据融合算法,这是今后的一个研究方向。如何减少训练时间也是一个重要问题。另外,如果专家系统与神经网络相结合,也许可以进一步改善融合算法的性能。因为神经元信息融合不是基于严格的协方差估计,而是基于实际的经验积累,所以专家系统也许可以提高神经元数据融合的性能。
4　单轴气浮台实验
　　挠性航天器大角度机动全系数自适应控制实验在挠性结构卫星单轴气浮台全物理仿真实验装置上进行。总之,神值元用于数据融合方面的研究刚刚起步,还有许多工作等待人们去解决。
6　结论
　　本文提出了一种基于神经元的容错组合导航系统,用神经元作为各子系统产生的局部状态估计量的信息融合中心,不需要知道其协方差信息,可以替代传统的要求精确估计协方差信息的数据融合方法。为充分发挥航天器既定执行机构的作用,考虑到机动角变化范围较大,在过渡过程阶段和稳态阶段分别设计不同的控制律,根据状态逻辑判断进行切换。

图2　全系数自适应控制系统总体结构
3.1　参数估计
　　取二阶估计模型
　　　　　　y(t)=φT(t-1)θ(t-1)+ε(t)
其中y(t)是姿态角在t时刻的采样值,回归向量
　　　　　　φ(t-1)=［y(t-1)y(t-2)u(t-1)］T
其中u(t)为t时刻的控制量