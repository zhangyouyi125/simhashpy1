宇 航 学 报
JOURNAL OF ASTRONAUTICS
1998年4月  第19卷  第2期科技期刊


宇宙飞行器定点着陆自动控制算法
田玉成
(航天工业总公司710所*北京842信箱*100037)
摘  要   本文描述了宇宙飞行器以第一宇宙速度返回地面并定点着陆的控
制算法。分析了在大气中下降的过程，研究了下降段上的空间运动。给出了
数值计算机上的模拟结果。本报告共分为4部分。

主题词  控制  飞行器  再入轨道  制导   定点着陆
　
AUTOMATIC CONTROL ALGORITHM OF 
SPACECRAFT FIXED-POINT LANDING
Tian Yucheng
(Beijing Institute of Information and Control*Beijing*
100037)
Abstract  This Paper Presents an automatic control algorithm of fixed-point landing for 
spacecraft with first cosmic speed.It analyzes motion of spacecraft in descending process 
in atmosphere.The model which is created on computer indicates that the results of caculation 
for horizontal and vertical coordinate acquires high precision.This paper includes four parts.

Key words  Control  Spacecraft  Reentry trajectory   Guidance  Fixed-point landing

1  引言

　　宇宙飞行器再入大气的飞行控制通常有两种方法：标准轨道控制和落点
预报法。“联盟”号载人飞船采用的是前一种方法。滤波是抑制噪声、提高跟
踪精度的一种有效方法,而正确的目标测量模型和动态模型是实现精确跟踪与
滤波的前提和基础。仿
真时模型切换概率取p11=0.9,p22=0.9,p12=p21=0.1;模型概率初值μ10=0.9,
μ20=0.1。由此可以看出:该算法消除了显式的机动性检测,且滤
波维数低。

主题词  图像相关  多模跟踪   速度和加速度滤波器  模型概率
　
MULTIPLE MODELS ADAPTIVE 
TARGET IMAGE TRACKING
Zhou Rui Shen Gongxun
(Beijng University of Aeronautics and Astronautics*
Beijing*100083)
Cui Hutao Yang Di
(Harbin Institute of Technology*Harbin*150001)
Abstract  In this paper,the target image position offset measurement models in image 
sequence are developed under the effects of additive and multiplitive noise.In consid-
eration of the target maneuvering,the target states are estimated by multiple-model 
filters and two-stage Kalman filters,depressing the effects of noise and avoiding the 
explicit maneuvering detection.The algorithm has good performance with high speed 
and small savings.

Key words  Image correlation  Multiple model tracking   Velocity and acceleration 
filter  Model probabitity 

1  引言

　　在基于图像传感器的目标跟踪系中,由于各种噪声影响,例如传感器噪声、
背景噪声和图像量化噪声等,使得跟踪器提取到的目标位置信息含有较大误差。
进一步假设飞行器上带有制导、控制计算机。



该算法结构如图1所示。

2  模型函数方法和它的应用

　落点预报法的控制原理有以下几个方面：每一步算法调节参数γ(t)幅值
和换向时间，使轨道的落点指向预定的落点。

    

图1 基准滚动角

　　基准函数即滚动角γ与时间t标准函数关系。对于帧频较高
的跟踪器,εx,εy一般较小,于是可对r(x,y)Taylor展开,并保留到一阶项
s(x,y)=c［r(x,y)+εxrx+εyry］+n(x,y)
(2)
其中rx=r/x,ry=r/y是r(x,y)在X,Y方向偏导数。设r(x,y)为目标参考图像,s(x,y)为传感器检测到的
实时图像,并假定实时图像是由参考图像平移以后并迭加不相关高斯噪声n(x,
y)的结果,于是有
s(x,y)=cr(x-εx,y-εy)+n(x,y)
(1)
其中,εx,εy为目标图像参考点的偏移量,c是比例变换因子。两个横向的截线AB和DE，与坐标
轴的距离分别为l1和l2，斜线为BD，变向开始与结束时刻分别为t1和t2。对γ
=0升力位于垂直平面里，方向向上，对γ＞0升力的横向分量沿飞行器运动
方向向右，对γ＜0向左。
在再入大气后函数γ(t)最小限度应有一次转换符号，才能克服飞行过程
中的横向偏差。图1中的函数γ(t)满足这个要求。

    在基准函数的基础上引入两次变换，分别对幅值和相位进行调节，对航程
和横向的修正尽可能不出现同时修正航程和横向距离的困难。修正的外形如
下：
γ(t)=γ0(t)［1+φ(t)β］
(2.1)
这里γ0―基准函数，我们取象图1这样形状的函数，确定参数l1，l2，t1，
t2。公式(2.1)里的函数φ(t)是时间函数，它确定了变形的形式，参数β确定
了变形的幅值。函数φ(t)叫做调制函数，参数β―调制参数。由于以上各式是建立在Taylor展开基础上,因此估值误差将随偏移量
减少而减少。β＞0时幅值增加，而β＜0时幅值减小。可以看出,该算法对机动目标具有很好的跟踪效果,
位置跟踪基本重合。采用本文建立
的图像偏移值测量模型和多模滤波算法对目标图象的运动状态进行估值。调节与函数φ(t)相关。在各段上通过变化调制函
数可以把基准曲线变成所要求的形状。

    第二种变换是相位基准函数的变形，研究基准函数变形：
0(t)=γ0［1+Ψ(t)ε］
(2.2)
公式(2.2)的作用是相位调节。调节函数Ψ(t)调节形状，参数ε调节高度。

　　在个别情况下Ψ(t)≡1时转换变成相位移动，ε＜0时向右，而ε＞0时
向左。对于图1形状的基准函数移动变换实质上将影响到基准函数的变向部分，
这与转换开始、结束时间t1，t2以及时间tn等量移动是一回事，tn即飞行器从
一种状态转向另一种状态的时刻，升力的横向分量在垂直平面里从左转到右的
时刻。

　　另一方面，基准函数倾斜部分位置的移动实际上对应于横向偏差的变化。
假如转换时间t2-t1相对地不大，这样的变形不应明显地影响航程，这是由于
短的转换时间对滚动角影响很小。

　　当然上述关于γ0(t)、φ(t)和Ψ(t)的选取仅是引起思考和必要的审查。
显然引入的概念在算法中是有用的。对于帧频较高
的跟踪器,εx,εy一般较小,于是可对r(x,y)Taylor展开,并保留到一阶项
s(x,y)=c［r(x,y)+εxrx+εyry］+n(x,y)
(2)
其中rx=r/x,ry=r/y是r(x,y)在X,Y方向偏导数。



该算法结构如图1所示。就可做出基准的预报，即已知β0和ε0对运
动方程进行积分，同时在必要的精度要求下，确定纵、横向偏差。引入两步预
报，每次从两个参数里分出一个预报。应用线性近似，对于参数Δβ，Δε有
两个线性方程，增量Δβ，Δε能满足纵、横向偏差要求：


(2.3)
这里下标o表示基准预报，下标1和2，两次后补的预报，由β0得β1，ε0
得ε2；L和D是给定坐标系里纵、横向偏差。

　在每一步上求解方程(2.3)。假如先前预报条件，最近一步和下一步的预
报条件没有变化，即迅速收敛，通常方程(2.3)随着条件改变会进一步收敛，
求出的调制函数在下一步不能给出零偏差。显然选择两个参数补偿纵向和横
向偏差只可能在这之前有转弯时刻。在转弯之后只能选一个参数β。


图2 调制函数的确定
3  再入大气后的控制逻辑
设有直角坐标系OXY，坐标上的值为：
x=R(λ-λT)cosφT
y=R(φ-φT)
(3.1)
这里R―地球半径，数值X，Y表示离开着陆点(经度φT，纬度λT)的偏差(图
2)。假如返回轨迹的方向靠近子午线方向，那么数值Y和X可以认为是纵、横
向偏差。然而实际上却不完全是这样的。

　　向量在纵向的位移点A0的预报点为A1，对应的预报调制参数为β(图2)。现
在来看参数ε变化引起向量A0称到A2。

    有了目标偏移值测量模型,就可建立目标运动模型,对目标状态进行滤波估
值。线段AA0和OA是纵向和横向的偏差L0和D0。

　　假如有向量位移A0 A1和A0 A2，在线性状态终点上解方程组(2.3)可以得把
A0移到点O的调制参数值β和ε。

　上述过程只要解一连串的线性方程。穿过起始坐标线的平行向量A0 A1。仿
真时模型切换概率取p11=0.9,p22=0.9,p12=p21=0.1;模型概率初值μ10=0.9,
μ20=0.1。并针对目标机动性,采用多模虑波器和两段卡尔曼虑波器对目
标状态进行估值,有效抑制了各种噪声影响,又消除了显式的目标机动性检测,
且有较高的实时性和较少的存储量等优点。
按前面所述，确定点A0没有横向偏差，而仅有纵向偏差，它等于线段长OA′0，
它与起始的纵向偏差不同，既然横向补偿是一些纵向偏差带来的。对于点A′0
移到点O第二步要解决选取β。

　　上述几何可以很容易地解释。由参数β的变化确定纵、横向偏差时没有
横向偏差。方程(2.3)里第二个方程的第一个系数趋向于零。解这样方程组通
常方法是由方程组(2.3)的第二个方向确定Δε，然后代入第一个方向：
(L1-L0)/(β1-β0)Δβ+(L2-L0)/(D2-D0)D0+L0
(3.2)
由此求出Δβ。

    有了目标偏移值测量模型,就可建立目标运动模型,对目标状态进行滤波估
值。

　　在逻辑上只变化一个参数β来对基准函数γ(t)倾斜的位移部分变形是不
可能的。这种情况下在点A最合理的办法是沿线把β的符合反转，总的分布其
趋向于零点(图2)。算得Δβ代入方程(3.2)，求出第二部分。本文将上述方法和多模跟踪算法［4］相
结合,消除显式的机动性检测,又具有较少的计算量和存储量等特点。可以看出,该算法对机动目标具有很好的跟踪效果,
位置跟踪基本重合。
　　实际上由于点O开始的变化，对应下一步的基准预报，也许与点A不一致，
到点A的距离是上一步到点O的最小距离。然而作用线β转向的明显作用帮助
减少了导入预定着陆点的误差。采用本文建立
的图像偏移值测量模型和多模滤波算法对目标图象的运动状态进行估值。

　　再就是在每一步的边界内要合理地限制转向时刻变化允许的时刻。假如
由方程组(2.3)的第二个方程算出的转换数据小于允许的极值。那通常就采用
求出的解。假如转变数据大于极值，那就取转变的极值，并修正公式(3.2)算
出调制参数β，公式里第二项D0由横向偏差代替，该偏差可能是补偿给定步里
对转变数值的约束。上述约束的利用可以使调节过程更加可靠和平稳。4  仿真结果与结论

　　模拟产生含噪声的高斯分布的目标图象,且目标图像在传感器平面上作运
速直线、运加速、加速拐弯几种运动,并且几种运动交替出现。
假如关系γ(t)不太接近于零或有±π的极值约束而且试验预报的变化不大，
那直接应用上述逻辑是没有困难的。然而也许是方程(3.2)算出的调制参数β
或者要求函数γ(t)等于±π，这样使得为负的最大，或者取β＜-1，它使升
力为正，它最大时γ≡0，升力方向在全部时间里向上。wxk,wgk是高斯
白噪声,均值为零,方差为
E［wxk(wxl)T］=Qxkδkl,E［wgk(wgl)T］=Qgkδkl,E［wxk(wgl)T］=Qxgkδkl
测量模型可以表示为:
Zk=HkXk+Ckgk+vk
(11)
测量噪声方差vk～N(0,Rk)。

　　在进一步的调节中可以要求滚动角离开支点，显然为此会出现困难：例
如当β=-1有γ=0且cosγ变成零。这个困难也许可以避免，只要选择基准轨
道时使γ(t)边界的位置在基准区域外一些距离，在这几种种情况下，上一步
的γ(t)边界超出基准或位于上述边界上，β应向远离支点方向上变化。

　　可以避免这样的困难，假如基准的预报关系γ(t)取自上一步，其中包括
有的朝向支点，而随β关系的变化不比区域边界更接近支点。在这种情况下
获得的导数将小于某些值，这些值保证平稳地离开支点。4   计算结果

　　计算和求控制解的间隔取10秒。在仿真模块和导航模块里考虑了地球引
力场与中心场的偏差。预报计算中心引力场取中心场。对于大气密度计算用
的高度从球半径超过由地心到着陆点距离h。

　飞行器的升阻比取0.3，外形同联盟TM，返回再入的初始条件为高度100km、
纬度41.144度、轨道倾角51.6092、再入角-1.638度、绝对速度7.887km/s、
运动结束高度为10km返回轨道接近子午线。滤波是抑制噪声、提高跟
踪精度的一种有效方法,而正确的目标测量模型和动态模型是实现精确跟踪与
滤波的前提和基础。在下降过程中l1=l2=45°。设区间t2-tn和tn-t1
相等。基准曲线的转换时间取值为t2-t1=30秒。

　　基准预报的参数β满足下列要求：有关的β值使关系γ(t)靠近支点不超
过0.2弧度。

　　大气模型能反映大气密度偏差、风等随季节、昼夜变化，即密度偏差的
各种特征取决于时间的参数值，该大气模型的建立详见文献［6］。计算模型
见2、3节，其中φ(t),Ψ(t)=1。
　　表1给出了再入角θ=1.6°和不同密度分布偏差上的一些计算结果，密度
分布是指极值参数各种组合，密度偏差的组合。表1中的最后一行(序号137)
对应于密度是标准分布，没有密度偏差(ζ=1)。

　　表1中的数值ΔL和ΔD单位是公里。它们为在子午线或其平行方向上偏离
着陆点的距离。这些数值表明了算法的精度。在大多情况下偏差不超过1公里，
或有一些超出。

    仿真结果表明：算法能保证足够平稳的调节过程。
表1.θ=1.60
NoΔL(km)ΔD(km)
23-0.0310.097
34-0.0470.137
1370.0000.043


5  结  论

　本文研究了宇航器以第一宇宙速度进入地球大气的空间运动控制。控制的
目的是把飞行器导入给定着陆地点。建立了多步控制算法，并把它有效地用
于再入大气过程。可以看出,该算法对机动目标具有很好的跟踪效果,
位置跟踪基本重合。统计计算时间必须包括每一步求解控制的时间。模型中的大气密度
偏差有些会超过实际观察值。

由计算机上算法模型的结果可以得出如下结论：

1.飞行器被以很高精度导入给定着陆点。绝大多数情况下离给定着陆点
的偏差不超过1公里。

2.在调节过程中得到的滚动角与时间的关系接近实际实现中的关系。

3.一连串的求解时间间隔可取10秒。



该算法结构如图1所示。

本文于1995年9月1日收到
参考文献
1  Ю.Г.希哈鲁里泽.返回大气(俄文).莫斯科航空学院：1991
2  Ю.Г.希哈鲁里泽.飞行器弹道力学(俄文).莫斯科《科学》出版社
3  Д.Е.阿赫基牟斯克等.再入大气的优化控制.宇宙研究，1968,1
4  Д.Е.阿赫基牟斯克等.再入大气的优化控制.宇宙研究，1969,2
5  А.Г.格拉斯科夫.宇宙飞行器再入大气的飞行控制.宇宙研究，1969,2
6  Ю.Г.希哈鲁里泽 .30-80公里高度上大气密度偏差模型.1969年数学所报告
7  国家宇航局和美国空军部著.标准大气.美国国家海洋和大气局，1976
8  田玉成.载人飞船在大气中返回轨道的研究.1995年3月
