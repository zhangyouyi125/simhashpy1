航空计测技术
AVIATION METROLOGY & MEASUREMENT TECHNOLOGY
1999年 第1期 No.1 1999



一种新型的分布式数据采集器（一）
朱军　刘剑国　彭泽兵　陈荔莹　李滨
　　摘　要　介绍了一种新型的分布式智能数据采集系统――ALPHA900系列数据采集器。该采集器由中国航空工业总公司第三○四研究所与英国ADAS公司联合设计研制。它既能反映任何材料、任何层数的膜层相互叠加的结果，了解各层膜之间的变化规律，又能对实际操作起到一个从理论上指导和验证的作用。该采集器已成功地投入了工业生产，并且应用于工业过程监测、条件监测或加工监测。该系统使用价格低廉的RS485网络，各种型号模块提供了精确的温度、压力、应变及数字事件和频率等数据的测量及控制，并有相当突出的性能价格比。两层以上的光学薄膜为多层膜，计算方法可以在单层膜的基础上加以推广，进行层层递推，求出整体膜系的计算结果。这其中工业自动化测试和控制的水平又是反应自动化程度的关键。为了达到某种反射率和透射率，怎样确定沉积材料及厚度，正是我们所要研究的问题。以目前市场上出现的各类产品来看，各种产品均各自有着自己的侧重面。以总线系统为例，在工业领域应用的有：STD、STE、ISA、EISA、PCI、VME、MULTIBUS、PC/104、OPTOMUX、LONWORKS、CAN、MODBUS等等。加上网络技术、图象技术、隔离技术及组态软件等形成了各具特色的工业控制系统。这些总线的构成主要考虑了工业测试和控制过程，系统组成可能出现的因素有：
　　①计算机处理器的处理能力；②总线的定义与构成方式；③处理器和I/O之间的访问方式和速度；④软件的兼容性和编程的灵便程度以及工具软件的支持能力；⑤应用的方便性和标准性；⑥系统通讯能力，联网能力；⑦系统的扩展能力，远程分布控制能力；⑧I/O能力及I/O分布情况；⑨可维护性；性能价格比；抵御外界恶劣环境能力；安装方式及物理结构。

图　1
　　计算程序的使用，给计算薄膜的反射率和透射率带来了很大方便。提到DCS，人们也许立刻就会浮现出一个庞大的体系结构，包括：复杂的网络结构、高大的机柜、繁杂的接线、大量的仪表等，更为头疼的是其昂贵的价格。利用菲涅尔系数矩阵法来计算多层膜的分光特性，它的膜堆特征矩阵表示为

膜堆的光学导纳Y为
Y＝C／B＝(η2cosδ1＋iη1sinδ1)／(cosδ1＋iη2／(η1sinδ1))
反射系数：　r＝(η0－Y)／(η0＋Y)
反射率：　R＝r.r*
透射率：　T＝1－R
　　计算程序是根据膜堆的特征矩阵基本公式编写的，求出一层界面上的等效导纳Y，再求出振幅反射系数，叠加起来，最后求出整个膜系的反射率。的确，这些公司的DCS是相当出色的，它们为许多结构复杂、设备门类繁多、数据交换吞吐较大、软硬件结构复杂的大规模系统做出了许多贡献。从我国国力来看，对一些大中型分布式控制系统无论是从财力物力，以及DCS的性能价格比上考虑，大多数用户均有些心有余而力不足;但中小型测量及控制系统是否需要分布式测量和控制呢？事实证明，答案是肯定的。让我们先来看一下为什么要采用分布式控制。
　　当今的工业生产对工业测量和控制过程的要求越来越高，并且也越来越复杂。随着这种要求和复杂性的增加，各种协同测量仪器、产品和各种相关设备也必然会相应的增加。往往各个局部现场彼此之间又有一定的距离(有时各个I/O点之间相距非常遥远)，进而主计算机的功率和过程控制自动化软件也必然会相应增加;所以整个系统的硬件和软件的维护也就成为一件非常困难和复杂的工作。在这种情况下，测量和控制任务最好转交给各个局部小计算机，使每个分散在各个局部的小计算机分别成为一个独立功能岛或功能块，根据需要完成其独特的测量及控制功能，再将计算机技术、控制理论、控制算法、通讯技术、隔离技术、输入及输出技术、管理体制等有机的结合起来，即实现了当今世界上最为流行的分散控制，集中管理的模式。这就是现在被称之为带有智能的分布式控制系统。
　　这种现代的分布式控制系统的模式可广泛适用于多种工业自动化的场合。包括过程控制、工厂自动化、半导体制、石油淬取和精炼、能源管理、冶金工业、电厂控制、食品工业、 给水与废水处理、管泵监测、造纸工业、化工产品制造、医药产品制造、石化过程控制、建材制造、纺织自动化、质量检测和控制、大型印刷业、远程遥测、玻璃及陶瓷制造、生物工程、港口运输工程、计算机集成制造、公路监测系统等。例如：有一要求镀反射、透射比为中性的分光镜，查出用硫化锌、氟化镁两种材料，镀四层合适，每层厚度为1／4波长。
2　ALPHA900系列智能分布式数据采集器简介
　　ALPHA900系列数据采集器综合了目前国内外各种同类产品的优点，是一种可用于工业过程监测、条件监测或加工监测及控制的经济型的并带有一定可编程的数据采集前端。数据采集系统使用价格低廉的RS485网络，不同的型号可提供精确的温度、压力及应变等物理量的测量、数字量的采集、事件和频率的测量等。当一束光入射到膜层的表面时，在每一层膜的表面，光都对它们发生作用。
　　其特点是：
　　1）高性能――在低价位的基础上使用先进技术以获取高性能。

图　1
　　计算程序的使用，给计算薄膜的反射率和透射率带来了很大方便。图1中,n0―入射介质(空气)折射率；ni―材料折射率，i＝1,…,K；θ0―空气中入射角；θi―各层介质中入射角，i＝1,…,K。可通过主机或本地终端进行编程以及参数设置和初始化。
　　在理论上，利用薄膜光学的计算公式，可以计算出任何层数薄膜的反射率及透射率。模块上的EEPROM可存储所有的校准与设置参数；
　　5）性能完备――系统允许同步进行测量、工程转换、报警控制及通讯，以获取最好的操作性能；
　　6）坚固的注塑壳体――模块尺寸紧凑，包括20个测量通道及4个附加I/O通道。主要是仪器、仪表的精度，施加电压、电流是否合适，材料纯度，工件表面清洁度，观察仪表读数的准确性，关闭挡板的速度等等。可以方便地和其它设备一起安装在仪器柜内。模块可以重叠实装并带有标准导轨联接器；
　　7）RS485多分支网络――网络以标准波特率工作。每个模块具有两个RS232接口，用于现场本机编程。ISA485串行接口可直接为5个以内模块供电；
　　8）数字模块――数字模块可提供信号计时功能控制、计数及事件的频率周期测量功能。从光学的角度看来，改变沉积材料、基底材料和膜层的厚度，是一种改变材料光学性质的方法。Ethernet通讯作为可选功能，可以使用TCP/IP协议以自身IP地址进行数据传输；
　　10）灵活的供电方式――模块可使用24 V AC或12～28 V DC供电。电源输入与信号端及通讯端完全隔离；
　　11）本机报警――所有模块具有输入信号本机报警功能，由预先设置的报警门限进行触发。从光学的角度看来，改变沉积材料、基底材料和膜层的厚度，是一种改变材料光学性质的方法。
　　ALPHA900系列产品严格依照当前工业标准制造。CE设计满足EC98/336EEC标准、92/32/EECEMC标准以及73/23/EEC低电压标准。校准满足IP55/NEMA4标准。ALPHA900系列产品功能见表1。
表1

型号910911912913930931933980981982
通道数20201020201018
测量类型模拟模拟模拟模拟数字数字数字通讯通讯通讯
直流电压****
热电偶*
直流电流　*　*
电阻　　*
应变　　*
RTD　　*
RS485通讯*********
RS232通讯*******　*
ETHERNET
通讯　　　　　　　　　*
计数　　　　***
数字输入　　　　**
数字输出　　　　　*
计时　　　　　　*
周期　　　　　　*
频率　　　　　　*
辅助报警I/O***　***
电源　　　　　　　*
高隔离
(1000 V)　　　*


3　各模块性能简介
　　ALPHA900数据采集器共有91X、93X、98X三大系列十种型号。其中91X系列用于模拟量的测量，93X系列用于数字量的测量或控制，98X系列用于系统控制和网络通讯。
3.1　91X系列模拟模块
　　91X系列包括910热电偶模块、911电压和电流模块、912 RTD、电阻和电压输入模块、以及913具有隔离功能的电压和电流模块。其特点是：
　　①模拟量的测量；②多通道；③辅助报警I/O；④可编程设置测量类型；⑤报警电平和设置功能。
　　多项功能（测量、工程换算、报警处理和通讯）并存于同一模块。
　　910热电偶模块可进行20个通道14～17位可变字长分辨率和1 μV灵敏度的电压和热电偶测量。该模块配有专用热电偶联接器，具有精确的热电偶冷端补偿，在较高精度的输出热电偶上可获得0.6 °C的精度。910模块适用于大部分工业通用热电偶，可监测热电偶的工作状态、报告开路及损耗情况。
　　911电压和电流模块可进行20个通道14～17位可变字长分辨率和1 μV灵敏度的电压和电流测量。该模块配有通用的隔离螺栓联接器，可用于测量标准4～20 mA电流测量，并带有相应的内部分流器。模块组装时确定了测量电流的通道号，不带分流时，该模块可用于测量电压，费用低于910模块，而且还配有方便的隔离螺栓联接器，可使用外部分流器，但精度取决于连接及所用分流器的灵敏度。直接通过检测来了解膜层的光学性质是一种直观的手段,但存在着一定的缺点，它不能反映出沉积过程中，各膜层之间叠加起来光学性质是怎样发生变化的，而且可靠性及准确性均不高。直接通过检测来了解膜层的光学性质是一种直观的手段,但存在着一定的缺点，它不能反映出沉积过程中，各膜层之间叠加起来光学性质是怎样发生变化的，而且可靠性及准确性均不高。从运算结果就可以看出反射率和透射率值。
　　913是具有高隔离（1000 V）功能的电压和电流模块，除没有辅助报警I/O外，其余功能与911模块相同。
　　可对91X系列模块编程，在一个完整的主循环（50或60 Hz）中对被测信号积分，使模块能抑制叠加在mV信号上的干扰。在测量中连续监测干扰，如果干扰超出了测量模式所允许的动态范围（自动量程下该范围要大些），将会产生错误报告。光波是一种电磁波，光波在界面上反映出的光学性质，是通过电磁波在介质中传播的普遍性质推导而来的。
　　91X系列具有报警功能。91X系列模拟模块有三个数字输出和一个数字输入,它们可一起驱动一个本机报警指示器。两个报警输出可由高于（第一个报警输出）或低于（第二个报警输出）报警限的任一通道设置。可对每一个通道编程设置报警上限和下限以及死区阈值，以确保信号转换到报警状态。数字输出电平适用于采用隔离输入的外部小功率继电器。由麦克斯韦方程推导出光波入射到两个光学性质不同的介质界面上时，入射波、反射波及透射波的电矢量分别为
E(i)＝E(i)0exp(i(ω(i)t－2πn0／λ.(Xsinθ0＋Zcosθ0)))
E(r)＝E(r)0exp(i(ω(r)t－2πn0／λ.(αrX＋βrY＋γrZ)))
E(t)＝E(t)1exp(i(ω(t)t－2πno／λ.(αtX＋βtY＋γtZ)))
菲涅尔把电失量分解为振动方向平行于入射面与垂直于入射面的两个分量，即P分量和S分量两个方向的偏振光。该报警输出可通过使数字输出的触点闭合来表示“收到”和取消。当出现新的报警或通道状态错误时，输出可再次打开。（注意：两个报警输出和表示“收到”的输入未与RS485通讯口隔离）。
3.2　93X系列数字模块
　　93X系列包括930数字输入模块、931数字输入/输出模块和933事件捕获模块。其特点是：
　　对于930、931模块，有：
　　①数字状态输入（931有10个通道用于输出）；②计数；③低频测量；④每个模块多通道；⑤辅助报警I/O；⑥完全隔离输入（931有继电器输出）；⑦低速功能可进行编程过滤；⑧每个通道有指示灯。
　　933模块的功能有：
　　①状态、计数、频率、周期和现场计时功能；②每个模块18通道；③4个通道支持20 kHz计数和频率测量；④4个通道支持周期测量；⑤所有输入通道状态改变的计时测量,分辨率为1 ms；⑥与网络中其它933模块同步测量；⑦本机存储数据。
　　930模块有20个隔离数字输入通道，用于状态监测、计数和频率测量，输出可用于本机报警或监控。该模块成本低，适用于要求输入间相互隔离的场合。
　　931模块有10个隔离数字输入通道，用于状态监测、计数及频率测量，并有10个继电器输出通道。每一个输出通道间相互隔离，能直接驱动开关装置或其它交流或直流负载。模块还为本机报警或监控提供了额外的输出。
　　933事件捕获模块用于精确记录检测到的事件。该模块提供18个全隔离输入通道用于事件测量。可用于事件时序的监测，例如工业现场的跳闸和控制反应等，以便研究原因及影响。933的主要功能是以实时时间为基准，记录输入端的变化。所记录的事件进入缓存区并由主机读取，不会丢失后续事件。每个933都有一个独立的缓存区，能随时接受访问。输入信号是有条件的。如果工艺操作中出现误差，马上能够显露出来;如果测量结果和理论值有一定的差距，在确定使用什么材料，镀多少层时，修改工艺方便，速度快，提高了工作效率和精度，从理论和实践两方面保证产品更加可靠和完善。主机与933的通讯是通过RS485网络，用于设置该模块的指令只有很少几个。事件记录的分辨率是1 ms，在分散使用时，所有933记录器能够保持同步。输入状态的变化也可同时被计数，并不影响事件记录功能。输入通道的当前状态或计数值可根据需要返回主机。全部通道也可进行不超过400 Hz的频率测量。根据现有的材料，可以先把不同层数膜系的反射率和透射值算出来。
　　在实际工作中，所遇到的各种技术要求各不相同，如果对于每项技术要求都通过实验来确定膜系，无疑是人力物力的浪费。与现场的联接采用隔离螺栓联接器。
　　数字模块同样具有报警功能。数字模块有三个辅助数字输出和一个数字输入。它们可一起驱功一个本机报警指示器。
　　关键词　膜堆特征矩阵　振幅反射系数　光学导纳　反射率　透射率
Computer Program Design of Calibrating Film System of Thin Film
Ma Qian
　　Abstract　The optical admittance of a single-layer film is derived from the characteristic matrix of the film pile.Based on the single-layer,recurring layer by layer,supercomposing one by one,deriving the equivalent admittance of the film pile and calculating the reflect coefficient of the amplitude,the reflectivity and transmissivity of hte whole film system is derived at last.
　　Key words　Characteristic matrix of film pile,Reflect coeffient of the amplitude,Optical admittance,Reflectivity,Transmissivity

　　薄膜膜系是指由不同的材料的膜层与基底所构成的整体。可对每一个状态通道，编程设置报警状态（0或1）。计数输入只能指定一个高电平报警。在工作中，需要确定某一膜系时，查阅一下便能知道用什么材料、镀多少层合适。
　　对于933模块，可对每一个状态或事件通道编程设置报警状态（0或1）。利用边界条件的连续性，考虑到相位因子，推导出光束在具有两种不同偏振状态的反射光和透射光能量公式
E(r)0P＝
E(r)0S＝
E(t)1P＝
E(t)1S＝(n0cosθt－n1cosθi)／(n1cosθi＋n0cosθt).E(i)0P
(n0cosθi－n1cosθt)／(n0cosθi＋n1cosθt).E(i)0S
2n1cosθi／(n1cosθi＋n0cosθt).E(i)0P
2n0cosθi／(n0cosθi＋n1cosθt).E(i)0S

单层膜的反射率公式为
R＝r.r*＝(r21＋r22＋r1r2cos2δ)／(1＋r21r22＋2r1r2cos2δ)
其中菲涅尔系数为
r1＝
ηP1＝
ηS1＝
r2＝
η2＝
ηS2＝(η0－η1)／(η0＋η1)
n0／cosθi
n0.cosθi
(η1－η2)／(η1＋η2)
n1／cosθi
n1.cosθi

把菲涅尔系数带入反射率公式得到
R＝((η0－η2)2cos2δ1＋
(η0η2／η1－η1)2.
sin2δ1)／((η0＋η2)2
cos2δ1＋(η0η2／η1－
η1)2sin2δ1)

其中位相差
δ＝2π／λ.ndcosθi
可见单层反射率、透射率取决于入射介质折射率、膜层材料折射率、基底材料折射率、入射角、膜层厚度、光波长及膜层数。只有当通道设置为计数时才能指定高电平报警。两种报警输出的数字电平适用于采用隔离输入的外部小功率继电器。数字模块三个输出是一个隔离继电器，可用于驱动声音报警。该报警输出可通过使数字输出的触点闭合来表示“收到”和取消。当出现新的报警或通道状态错误时，输出可一次打开。（注意：前两个报警输出和表示“收到”的输入未与RS485通讯口隔离。）
3.3　98X系列主机适配器及接口
　　98X系列包括980带隔离电源（与PC电源隔离）的ISA总线RS485接口、981RS232―485适配器、982无线电网适配器，该系列主要用于数据采集器的网络通讯和控制。
　　980ISA总线RS485接口可直接向五个模块供电，支持标准波特率76.8 kB或更高的波特率，具有标准COM口；981RS232―RS485适配器具有内部方向控制功能，982无线电网适配器拥有IP地址，这两个模块均用DIN导轨安装。
　　这些适配器使模块的接口能与标准PC相连，通过RS485接口进行通讯和监测。对于要求使用标准串行口的场合，981主机适配器允许通讯口对RS485网络操作。标准软件语言能以软件支持的波特率与输入输出模块通讯。对用户而言，RS485收发设备的操作是自动并且透明的。根据现有的材料，可以先把不同层数膜系的反射率和透射值算出来。
　　作为替代品，982无线电网络适配器能直接与无线电网络服务器通讯，该模块运行自己从服务器调用的相应软件，在其IP地址上按TCP/IP协定传送数据。
50岁　男　高级工程师　读者服务卡索引号： 116
作者单位：长城计量测试技术研究所，北京市，100095
(未完待续)
1999-01-22收稿
