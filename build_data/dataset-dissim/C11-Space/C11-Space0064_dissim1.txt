航空计测技术
Aviation　Metrology　&　Measurement　Technology
1999年 第19卷 第3期 Vol.19 No.3 1999



最小二乘参数估计若干问题的讨论
周维虎啊》岩堤　丁叔丹
摘　要　讨论了最小二乘估计中应注意的几个问题，指出了最小二乘估计的一些新的研究和应用方向。
关键词　最小二乘　参数估计　精度预测　稳健估计
Discussion on Some Problems about the Use of Least Square Parameter Estimation
Zhou Weihu　Fei Yetai　Ding Shudan
Abstract　Some attentive problems involved in least square(LSQ) parameter estimation are discussed in this paper.The new research and application trends about LSQ are pointed out as well.
Key words　LSQ,Parameter estimation,Precision prediction,Robust estimation
　　在各种工程测量中，最小二乘参数估计不受测量值误差分布的影响，因而是一种有效的方法，得到了广泛的应用。但也会出现一些问题，使最小二乘法的应用受到影响，如：随着参数的增加，解算效率和解算精度下降；参数相关或复相关导致法方程奇异；粗差对参数估计影响较大等。本文提出若干问题加以讨论。于是固定在环腔上的光电探测器，就接收不到干涉条纹移动所对应的拍频信号。本文所提的补偿方法对于线性工作范围较差、精度较低的激光陀螺提高测量精度具有一定的实用价值。
法方程为　ATPAX＋ATPl＝0 (2)
参数的最佳估计值为　X＝－(ATPA)－1.(ATPl)＝－N－1.U(3)
式中，N＝ATPA　U＝ATPl
当误差方程为非线性时，设vi＝fi(x1，x2，…，xt)－Li (i＝1，2，…，n)
按泰勒公式展开，略去二次以上的高次项，得

按线性方程处理，解得δxj(j＝1，2，…，t)
参数解　　　　　　　　xj＝x0j＋δxj　　
以下讨论仅限于线性参数最小二乘估计。本文所提的补偿方法对于线性工作范围较差、精度较低的激光陀螺提高测量精度具有一定的实用价值。此时，可引入未知数近似值加以简化。对于工作区线性特性不好、成本低廉的激光陀螺，根据实测曲线精确拟合确定出激光陀螺的数学模型，对于进一步提高测量精度及对系统进行误差补偿具有重要实用价值。否则，将得不到正确的估计结果。其次，由于引用了参数近似值，误差方程(5)中常数项li有效数字变少。为了计算方便，计算单位应作相应调整，选用测量值最小单位作为计算单位。
　　当参数模型为非线性时，误差方程需在x0j处展开成线性模型，若x0j给的不准，会影响计算精度。因为，只有当δxj很小时，高次项才可忽略不计。一般先通过少量数据或其它简单公式得到近似值。
　　例如：在球面拟合中，当(xi，yi，zi)为球面上的均匀采集点时，球心坐标和半径(球面拟合中的待估参数)的近似值可取为近似圆心到第i点的距离。也可以采用多次迭代。此时，参数的最后估计结果为

中等式右端分别为xj的初值、第一次、第二次、…第n次迭代结果。
2.2　待估参数的选取
　　最小二乘参数估计中，未知数个数应等于待估参数的个数，且应相互独立，当未知数之间相关时，法方程(2)中ATPA奇异，法方程无确定解。本文所提的补偿方法对于线性工作范围较差、精度较低的激光陀螺提高测量精度具有一定的实用价值。拟定测试方案时，应使未知数足数且相互独立。因此问题转化为如何确定k1，k2，k3，…，kn的问题。或者，通过检查A阵，发现相关列则去掉这些列，将列中待估参数当成零处理。在最小二乘参数估计中，过度选取参数极易造成相关，这一点使用时需加以注意。
　　例如:在机器人空间定位误差补偿时，需识别关节几何误差参数。加抖动偏频后的实际模型(图1中曲线3)与下式样条函数的定义较为接近。若有n个关节，待估参数总数为6n个。因此，当n较多时，极易造成相关或复相关。
　　根据上文所述的三次样条原理，首先建立差商表1，并在自然条件下，根据公式(3)求得k2，k3，…，k11：
表1　函数y的差商表
序号xyP[xi,xi＋1]P[xi,xi＋1,xi+2]
10-279　　
21077200077227.9　
320154495677295.63.385
4302700009115505.31910.485
540309066139065.2-3822.005
650366387457321.3912.805
7604637554973682002.335
870551100887345.4-501.13
980618522567421.7-9966.185
1090695976677454.1501.62
11100773462877486.21.605
121109249141151451.33698.225

　

k1＝0.0000×104k2＝0.0003×104
k3＝0.1910×104k4＝－0.3822×104
k5＝0.0913×104k6＝0.2002×104
k7＝－0.0501×104k8＝－0.0996×104
k9＝0.0502×104k10＝0.0002×104
k11＝0.3698×104k12＝0.0000×104
　　将k2，k3，…，k11代入公式(2)可求出分段函数(4).
　　由分段函数(4)得到的被测激光陀螺拟合曲线为图3中的曲线3(其中曲线1为被测陀螺的理想模型曲线)，该曲线在0～110(°)／s工作范围内呈单调递增。
2.3　参数及其函数的精度评定
2.3.1　单位权标准偏差σ0＝([pvv]／(n－t)1／2 (7)
式中，n为测量值个数；t为未知数个数。
[pvv]值可根据剩余误差直接求得　vi＝aiδx1＋biδx2＋…＋tiδxt＋li (i＝1，2，…，n)也可按下式求得


顾及ATPV＝0，得

ATPl是(2)中的常数项矩阵。
顾及(3)式得
　　
　　可以看出，由(8)式计算[pvv]较之先计算vi再计算[pvv]要简便得多。[pvv]的两种计算方法可相互核验。
　　单位权标准偏差求得后，还需给出参数及其函数的权倒数，才能计算出它们的精度。
由于x＝xi时，Pi(xi)＝yi；x＝xi＋1时，Pi(xi＋1)＝yi＋1,按牛顿基本差商公式知Pi(x)＝Pi(xi)＋(x－xi)Pi[xi,xi＋1]＋(x－xi)(x－xi＋1)Pi[xi,xi＋1,x]
其一阶及二阶导数为

因 Pi(x)，P′i(x)，P″i(x)分别为x的三次、二次、一次多项式，若设

则
根据以上条件，解算出在区间[xi,xi＋1]上三次样条函数为

其中 (2)
在整个区间[x1,xn]上的三次样条函数可由公式1表示。由(13)式可以看出，只要将法方程(2)中的常数项换成f，解法方程即可求得q。最后，参数函数F的标准偏差
　　
　　由上述推导可以看出，参数的权倒数阵Qxx无论对于参数精度或是参数函数的精度都具有重要意义。在图1中曲线3应是采用Honeywell机械抖动偏频后的输入―输出特性曲线，由图中可看出曲线3消除了曲线2的闭锁且较曲线2更接近理想特性曲线1。这样，在实施测量之前，就有可能利用误差方程系数阵(由具体问题决定)求得N－1。根据N－1可以知道某估计量的权倒数，从而事先预测该参数的精度。80年代中期，美国激光陀螺随机漂移的指标就已优于10－3(°)／h，在波音757／767飞机上装备激光陀螺的成功，标志着激光陀螺已进入实用阶段。
2.4　粗差检验
　　最小二乘参数估计遵循VTPV＝min准则，估计结果容易受到粗大误差的影响;因此，在测量过程中和参数估计之后尤其应注意粗差检验。
关键词　三次样条拟合原理　曲线拟合　激光陀螺(环形激光器)　数学模型
A Study on Fitting Ring Laser Gyro Mathematic Model
Yang Heng　Frank.Bosselman　Chen Ming　Qin Yongyuan　Wang Jianpei
　　Abstract　Based on the analysis of mathematic model of ring laser gyro (RLG) and the principle of cubic spline data interpolation,pointing to the data of practical input-output characteristic curve of some Russian model of RLG and making analysis and treatment with the cubic spline data interpolation method,the mathematic model applying to error compensation in the nonlinear working range and being accordance with the practical gyro characteristic has been deduced.The method proposed in this paper can be applied to accuracy compensation of the RLG with worse linearity and lower working accuracy in the working range.
　　Key words　Principle of cubic spline data interpolation,Curve fit,Ring laser gyro,Mathematic model

　　前言
　　激光陀螺作为一种可靠、高精度、低成本的角度传感器，是现代高科技的结晶，也是世界各国竞相开展研究的焦点。整体检验一般可用F分布或χ2分布检验法。检验通过说明所有测量值均不含有粗差，检验不通过则需对测量值进行单个粗差检验。一般选统计量

式中，qii为残差V的权倒数阵Qvv的对角线元素。

　　根据选定的显著水平α，查正态分布表的双侧检验临界值zα，若｜zi｜＜zα，认为该测量值不含有粗差。否则，应剔除该测量值，重新解算。
　　值得一提的是，为了抑止粗差的影响，人们提出了稳健估计(也称抗差估计)，它可以有效减小粗差对参数估计的影响。
2.5　稳健估计
　　稳健估计(Robust Estimation)的含义是，在估计过程中自动进行粗差剔除，使参数估计结果不受含有粗差的测量值影响。稳健估计最具代表性的有选择权迭代法和P―范最小法。
　　选择权迭代法的思路是，从最小二乘估计开始，每次迭代估计后，根据残差大小和选择的权计算每个测量值在下一步迭代计算中的权值。如果权函数选择适当，含有粗差的测量值的权将越来越小，直至趋于零。迭代中止时，参数估计结果将不再受粗差影响。选择权迭代法的准则为

式中，pni为第n次迭代时，第i个测量值的权。计算公式为

f(vi)为测量值Li的权函数，它是残差vi的函数。权函数的选择有不同的方法，如丹麦法、李德仁法等等。应根据具体测量对象而定。
　　稳健估计另一种典型方法是P―范最小法，也称LP法。该估计的准则为

　　当测量误差服从P―范分布时，参数估值与极大似然法估计值一致。一般常取P＝1～1.5，当P＝1时，即为绝对值最小和法。绝对值最小和法被认为具有较好的粗差识别能力，但估计效率很低。最好的办法是将各种估计方法组合起来，以充分发挥各自的优势。加抖动偏频后的实际模型(图1中曲线3)与下式样条函数的定义较为接近。
3　结束语
　　随着理论研究和应用的深入，新的计算方法不断发展。对于线性最小二乘问题，传统的方法是从构造法方程入手，而新的算法则试图直接从矛盾方程入手，避免了法方程的缺陷。在图1中曲线3应是采用Honeywell机械抖动偏频后的输入―输出特性曲线，由图中可看出曲线3消除了曲线2的闭锁且较曲线2更接近理想特性曲线1。在参数直接估计的基础上，又出现了各种带约束条件的最小二乘问题。
1　激光陀螺的理想输出模型
　　理想情况下，当环形激光器在惯性空间旋转时，具有不同辐值、相位和偏振特性的相向行波将呈现非交互效应。特别是随着计算机、矩阵代数、概率统计理论的组合应用，产生了现代参数估计理论。
　　关于现代参数估计理论，首先是测量值广义化导致了相关参数估计，其次是秩亏参数估计，随后又出现了最二乘推估，它将随机过程也作为未知数包含在模型之中。
资金项目：中德合作研究项目,博士点基金资助
作者简介：26岁　男　博士研究生
作者单位:杨　恒啊〕隆∶鳌∏赜涝　王建培(西北工业大学自动控制系183＃信箱，西安市，710072)
　　　　　Frank*Bosselman　(德国布伦瑞克工业大学导航与控制研究所)
参考文献
　　1　Pyrna.Test Methods and Test Facilities to Determine Fiber Optical Gyro Characteristics at IABG Inertial Test Laboratory.Symposium Gyro Technology,Stuttgart,GERMANY:1988,17.2～17.32
　　2　Hugh J.Murphy.Digital pathlength control for ring laser gyros.United States Patent[19\],5108182.1992\|04\|28
　　3　Bo H G.Pathlength controller for ring laser gyros.United States Patent[19\],4320974.1982\|05\|23
　　4　Forederick Aronowitz.美国激光陀螺仪研制报告.惯导与仪表,1997,(1):42～46
　　5　曹立凡,史万明.数值分析.北京:北京工业学院出版社,128～226
收稿日期：1998-03-17
修订日期：1998-07-02
。上述方法有效地改进和完善了最小二乘法。关于近代最小二乘估计超出了本文范围，不作深入讨论。
作者简介：36岁　男　高级工程师
作者单位：周维虎啊》岩堤　丁叔丹　(长城计量测试技术研究所，北京市，100095)
参考文献
　　1　费业泰.误差理论与数据处理.北京:机械工业出版社,1995
　　2　於宗寿.测量平差基础.北京:测绘出版社,1984
　　3　李广云.工业测量系统.北京:解放军出版社,1994
　　4　夏凯等.机器人控制.北京:清华大学出版社,1994
　　5　刘钦圣.最小二乘问题计算方法.北京:北京工业大学出版社,
收稿日期：1998-10-09
