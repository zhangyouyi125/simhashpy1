　宇航学报
JOURNAL OF ASTRONAUTICS
1999年 第20卷 第3期 vol.20 No.3 1999



利用雷达测高仪的卫星自主定轨
韩　潮　章仁为
　　摘　要　提出了利用星上雷达测高仪及星敏感器进行卫星自主定轨的基本方法。不适当的搜索方法可能会遗漏某些固有频率，因此在求解过程中应利用结构的各种频率响应，以判定固有频率的位置及迭代初值。
　　主题词　卫星　自主导航　Kalman滤波
AUTONOMOUS ORBIT DETERMINATION WITH 
RADAR ALTITUDE SENSOR
Han Chao Zhang Renwei
(Beijing University of Aeronautics and Astronautics.Beijing.100083)
　　Abstract　This paper studies a basic method of the autonomous orbit determination with radar altitude and star sensors.With sea level model,a simply method for modifying the influence of earth shape has been presented.Direct and Kalman filter orbit determination methods have been studied.The simulation results show that precision of orbit determination is about 100 meter.
　　Key words　Satellite Orbit determination Kalman filter
　　1　引言
　　雷达测高仪(或称卫星高度计)是海洋卫星必备的有效载荷,用于测绘海洋起伏、表面流、潮汐和波浪。卫星定轨的基本测量有测角、测距、测角-测距和测距-测速等方法。在侧角法中,通常应用的参考天体为地球、太阳或恒星,测量仪器有星、太阳和红外地平仪等。采用红外地平仪测角法影响定轨精度的主要因素为地球光学边缘的模糊性使得地心方向的测量精度仅为0.08度,利用成为对称斜装的雷达测高仪测量卫星至地球表面的斜距,考虑地球的形状的影响可获得高精度(0.004度)的地心方向,同时伴有高度的测量值,因此利用卫星高度计和星敏感器的混合观测,预计可获得较高精度的卫星自主定轨。本文针对利用雷达测高仪测量对卫星自主定轨进行研究。主要包括以下几部分内容:一、影响地心矢量计算精度大地水准面(海平面)模型的研究;二、利用卫星高度计和星敏感器的混合观测,考虑海平面起伏的影响,测直接计算卫星的位置和姿态(直接定轨法);三、在直接定轨法的基础上,采用修正的广义Kalman滤波技术提高自主定轨的精度(滤波定轨法);文章最后部分以海洋卫星为背景进行了模拟计算,结果表明直接定轨计算可达到600米的定轨精度,广义Kalman滤波定轨可达到100米的定轨精度。
　　2　海平面模型
　　大地水准面是指在地球重力场作用下,地球表面的水面沿重力等位面分布而形成的曲面,根据文献［2］中的方法,利用地球引力模型系数求得大地水准面形状方程。设大地水准面极坐标形式的方程为
　　　　　　　　　　　　　　　　　r0=R(1+Y1+Y2+Y3+……)　　　　　　　　　　　　　(1)
其中Yi为对应第i阶地球引力系数的小量,是地理经度λ和地心纬度φ的函数。R为地球的平均半径,Yi和R分别满足
　　　　　　　　　　　　　　　　　　　(2)
其中GM为地球引力常数,ωe为地球自旋角速度,Wei为重力水准面的重力值,ae为地球赤道半径
　　　　　　　　n=2,3,…　　　　　　(3)
φ为地心纬度,λ为经度,Pmn为勒让德多项式,Anm和Bnm为地球引力场系数,地球引力场系数参见文献［3］,其中包括n=30和m=28的地球引力场系数。
　　对结构的固有频率ωi,A(ωi)为n维复数空间到其自身的线性变换，因A(ωi)奇异，故有
　　　　　　　　　　　　　　　ri=n-rank(A(ωi))＞0,i=1,2,…　　　　　　　　　　　(5)
式中ri为A(ωi)的缺秩数。J2项(即克莱饶海平面椭球模型)造成海平面高度相对地球平均半径起伏为-14公里至7公里,高于J2项的引力系数对海平面形状影响相对较小。根据模型(1)计算的海平面相对克莱饶椭球模型计算的海平面起伏约为-101米至75米。
　　3　直接定轨计算
　　所谓直接定轨法是根据测量数据直接进行定轨计算,具体步骤为:利用雷达测高仪的测量结果和地球形状模型,计算地心矢量在卫星本体中坐标系的方向,利用星敏感器测量,计算卫星本体相对惯性空间的姿态矩阵;根据地心矢量在卫星本体坐标系的方向及卫星本体相对惯性坐标系的姿态矩阵,计算卫星在惯性空间中的位置,完成直接定轨的计算。

图3　两端简支梁示意图
　　自由振动的Euler-Bernoulli梁的数学模型在频域中的表示
　　　　　　　　　　　　　　　　　　　　　　　　　　(8)
其中v为横向位移，EI为弯曲刚度，ρ，A分别为质量密度和截面积。
　　直接定轨法的关键步骤为地心矢量的计算。由于地球形状非常复杂,卫星姿态、位置都直接影响着沿雷达测高仪射线方向卫星到地球表面的距离(简称斜距),因此利用测量结果和地球形状地球模型直接计算地心矢量在卫星本体中坐标系的方向几乎不可能。假设地球形状为球形,地心矢量的计算与卫星的轨道和姿态参数无关,并且可以直接求出卫星的高度及滚动角和俯仰角等运动参数。由于地球形状基本上为一球形,海平面的起伏相对地球平面半径为小量,可作为小量修正处理,修正结果与卫星的轨道和姿态等运动参数有关,但相对卫星的运动参数不敏感,因此可以求得高精度的地心矢量在卫星本体系中方向。截面P处的模态位移和内力为
　　　　　　　　　　　　　　　　　　　　　　　　　(7)
式中λm,Y(xp,),ξm(xp,)分别为坐标变换阵、状变变换阵、和波传递矩阵。要计算(x0,y0,z0),至少需要3个ρi测量结果。Wi和Wo分别称为系统出射和入射波模式向量。当m＞3,只能求最小二乘解,即
　　　　　　　　　　　　　(6)
方程(6)采用高斯――牛顿方法［6］很容易求解,由于方程的性态较好,一般2-3次迭代就收敛结束,并且m的实际阶数很低(m=4),所以计算量很少。
　　3.2　考虑海平面起伏的地心矢量的计算
　　由于地球海平面是一个受地球引力场作用下很复杂的三维曲面,而雷达测高仪的测量结果为卫星到海平面的斜距,为提高地心矢量的计算精度,需要考虑海平面起伏的影响。对运动方程及边界条件都很简单的结构，如均质简支梁、悬臂梁等，其模态特性可从一函数特征值问题解得［2］。具体方法为,根据雷达测高仪射线与球模型球面的交点坐标,求得地心纬度和经度,从而计算海平面相对球面的起伏ΔR。
　　2　框架结构行波动力学模型［6，7］
　　框架结构由一维的单元(图1)通过结点(图2)组装而，在每一个单元上有不同频率的拉压、扭转、弯曲波传播。
　　3.3　卫星的位置的计算
　　根据地心矢量在本体坐标的方向及卫星本体坐标系相对惯性坐标系转换矩阵,即可求得卫星在空间惯性坐标系中的位置
　　　　　　　　　　　　　　　　　　　ri=-CibRb　　　　　　　　　　　　　　　　　(11)
Cib为卫星体到惯性空间的转换矩阵,可根据星敏感器测量计算,Rb为地心矢量在本体坐标系的投影。ri为卫星在惯性空间的位置矢量。
　　对球形地球一次计算即可完成卫星位置的计算,但海平面起伏影响的修正依赖卫星的位置、速度和姿态,并且关系十分复杂,只能通过迭代计算不断提高定位精度。这种迭代算法的收敛性本文没有进行深入的研究,仅在仿真中比较了不同迭代次数的影响。
　　由于海平面修正模型误差,海浪 的随机误差,会造成地心矢量计算的误差,同时星敏感器测量造成卫星方位确定的误差,二者都会影响定轨计算的精度。根据(11)式,直接定轨计算主要由Cib和Rb两部分组成。其中Cib的精度主要由星敏感器测量精度决定,而Rb的计算误差取决于设雷达测高仪射线方向卫星到地球球模型球面的距离的计算精度及雷达测高仪安装角的精度等。直接定轨法的具体算法、流程及精度分析参见文献［9］。
　　　
图4　三维框架结构示意图
　　从行波模型(TWM)和有限元方法(FEM)所得到的结构的最低8阶固有频率列于表1，各阶固有频率对应的振型如图5示。单元任一截面上的波模式向量定义为wm=［wTl,wTr］T，其中wl和wr分别称为左行波模式向量和右行波模式向量。由于采用计算结果(直接定轨法的结果,而不是测量)作为Kalman滤波的测量修正量,传统的广Kalman滤波算法需作适当的修改。
　　4.1　Kalman滤波算法的修正
　　传统意义下广义Kalman滤波的测量方程为
　　　　　　　　　　　　　　　　　　z=h(x,t)+v　　　　　　　　　　　　　　　　　(12)
其中z为测量量,x状态变量,v为反映测量误差的白噪音信号,如果以直接定轨法的计算结果替代测量信号作为Kalman测量修正项,测量方程的形式就变为
　　　　　　　　　　　　　　　　　g(x,z,v,t)=h(x,t)　　　　　　　　　　　　　　(13)
其中z为测量量,x状态变量,v为反映测量误差的白噪音信号,g(x,z,v,t)为测量量、状态量和测量误差的函数,本文中对应着直接定轨法的计算结果。由于测量方程(13)的形式与传统意义下广义Kalmam滤波的测量方程(12)形式不同,广义Kalman滤波算法必须作适当的修正以适应方程(13)形式的测量方程,修正的广义Kalman滤波算法见算法Ⅰ,算法Ⅰ中当gk(xk,zk,tk,vk)=z时,算法Ⅰ退化为传统的广义Kalman滤波算法(文献［4］)。
　　4.2　轨道运动和测量模型
　　Kalman滤波的状态模型为在地心惯性坐标系中考虑J2项引力摄动项影响轨道动力学模型。以直接定轨法的计算结果作为测量结果,即测量模型为
　　　　　　　　　　　　　　g=［x* y* z*］T　　h=［x y z］T　　　　　　　　　　　(14)
由于直接定轨法的计算结果x*,y*,z*为ρ1,ρ2,ρ3,…,ρm和ai,bi及测量误差v的函数,所以g,h对应的Jacob矩阵为
　　　　　　　　　　　　　　　　　　　　　　　　　　　(15)
h和g的具体形式详见文献［9］。
算法Ⅰ　连续―离散广义Kalman滤波算法
状态模型:　　　x(t0)=x0
测量模型:gk(xk,zk,tk,vk)=hk(xk,tk)　　k=1,2,…
统计特性:E{x0xT0}=P0
　　　　　E{w(t)}=0,　E{w(t)wT(t)}=Q(t);
　　　　　E{vk)=0,　　E{vk(t)vTk}=Rk;
　　　　　E{x0wT(t)}=0,　E{x0vTk)}=0;
　　　　　E{w(t)vTk}=0;　　k=1,2,…
Kalman预测:　　　　　　　　
　　　　　　　P(t0)=P0
Kalman滤波反馈增益矩阵:
　　　　　　　　Kk=P-kHTk(HkP-kHTk+SkRkSTk)-1
Kalman测量修正:
　　　　　　　　
Kalman方差修正:
　　　　　　　　P+k=(I-KkHk)P-k
其中Jacobi矩阵:
　　　　　　　　;;。将由一维波导组装成的框架结构的振动作为弹性波研究，弹性波在波导上传播，在结点处反射和散射。本文给出的方法具有一定的通用性，对某些单元可以采用更为精确的模型，以获得理想的结果。

　　图1　滤波定轨及模拟仿真框图
　　轨道运动数据是由模拟仿真程序产生,该程序包括了地球引力摄动(n=30,m=28)、大气层阻力、太阳和月球摄动等因素的影响,卫星的姿态运动简单地采用正弦变化模拟卫星相对其轨道坐标系姿态角的变化;采用n=20的海平面模型模拟海平面的起伏变化;而海浪采用零均值的随机白噪声模拟产生,并以白噪声序列的最大值作为海浪高度。
　　本文以轨道高度为900km,轨道倾角98°的极地低轨卫星为模拟仿真对象。选取20颗星等最亮的恒星［9］模拟星敏感器的测量对象。结构的振型(图5)也是高阶的差别较大，而且单元内部的差别要比结点上的差别大，原因在于行波方法中单元上的位是通过精确的传递特性求得的，而且限中元是用假设的插值函数插值得到的。模拟的计算结果详见表1至表4,图2为其一种情况的时间过程曲线。模拟仿真计算结果表明直接计算的定轨精度为400～600米,Kalman滤波定轨精度为100米左右,地心矢量计算的精度为0.004度左右,速度精度为0.5～0.6米/秒。
表1　直接和滤波定轨计算结果(测量扰动与海浪影响)
(直接定轨迭代=3次,采样周期=1.0秒、海平面模型阶数=3)

序号海浪高
度(m)星敏感
器(Deg)滤波定轨位
置误差(m)直接定轨位
置误差(m)速度误差
(m/s)角度误差
(Deg)
100.00.00085780.350.0017
210.00.000934150.430.0041
310.00.0031145640.570.0043
410.00.0051447650.860.0050

表2　直接和滤波定轨计算结果(测量扰动影响与海浪影响)
(直接定轨迭代=3次,采样周期=1.0秒、海平面模型阶数=10)

序号海浪高
度(m)星敏感
器(Deg)滤波定轨位
置误差(m)直接定轨位
置误差(m)速度误差
(m/s)角度误差
(Deg)
500.00.00044380.240.0011
610.00.000544000.320.0038
710.00.003885600.530.0040
810.00.0051077570.790.0047

表3　直接和滤波定轨计算结果(采样周期影响)
(海浪高度=10.0米,直接定轨迭代=3次,采样周期=5.0秒)

序号海浪高
度(m)星敏感
器(Deg)滤波定轨位
置误差(m)直接定轨位
置误差(m)速度误差
(m/s)角度误差
(Deg)
9030.0032225710.750.0044
10030.0052697581.060.0055
11100.0031725560.630.0041
12100.0052087530.890.0052

表4　直接和滤波定轨计算结果(直接定轨迭代次数影响)
(海浪高度=10.0米,星敏感器精度=0.003度,采样周期=1.0秒)

序号海浪高
度(m)星敏感
器(Deg)滤波定轨位
置误差(m)直接定轨位
置误差(m)速度误差
(m/s)角度误差
(Deg)
132031315680.570.0043
14210855590.510.0040
151033596560.860.0052
161103816630.880.0051





图2　
　　比较表1和表2的结果,不考虑海浪高度和星敏感器测量误差影响,海平面模型阶数取3阶和10阶时,定轨精度相差约40米左右,随着海浪高度和星敏感器测量误差的增加,3阶和10阶时定轨Kalman滤波定轨精度相差仍维持在40米左右,这是由于海平面的起伏是缓慢变化的,而海浪高度和星敏感器测量误差是随机的,Kalman滤波只能消除随机误差的造成的影响,海平面起伏的影响只能根据海平面模型的计算消除。表3给出了Kalman滤波采样周期对定轨精度的影响。表4反映了直接定轨迭代计算次数对定轨精度的影响。其中两次迭代与三次迭代的结果是相同的,但只迭代一次的定轨精度明显降低,特别是Kalman滤波定轨的精度只有400米,其原因为海平面起伏的修正计算误差所致。
　　Kalman滤波的初始收敛速度较快。采样周期为1秒时200秒达到稳定状态,采样周期为5秒时500秒达到稳定状态,而研究中曾试图采用标准的广义Kalman滤波,根据斜距和星敏感器测量直接进行滤波定轨计算,但不是不收敛就是收敛速度很慢,一般都在1000秒以上。称每一种独立传播的波得傅利叶变换为波模式(Wave Mode)。
　　6　结论
　　根据研究,可得以下结论:
　　①海平面的相对地球参考球面或地球参考椭球面的起伏对利用雷达高度计进行自主定轨的定轨精度有较大的影响,其影响是不能通过Kalman滤波消除的,只能通过海平面模型消除。
　　②采用测量数据的预处理结果(直接定轨的计算结果)作为Kalman滤波测量修正项,并结合修正的广义Kalman滤波,可明显提高Kalman滤波定轨的性能。
　　③本文中给出的修正的广义Kalman滤波算法具有良好的收敛性和稳定性。
　　④直接定轨法中的地心矢量计算的算法简单、性能可靠,并能提供姿态角的计算结果,有利于采用并行Kalman滤波处理技术以减少Kalman滤波的计算量。
　　⑤根据模拟计算,直接计算定轨的精度为400～600米,滤波定轨的精度为100米左右。
作者单位：北京航空航天大学.北京.100083
参考文献
　　1　Stewart R H.Method of Satellite Oceanography.University of California Press,1985
　　2　H.伊捷尔松.位理论及其在地球形状理论和地球物理中的应用.中国工业出版社,1963年2月
　　3　徐廷万主编.控制系统(上).导弹与航天丛书――液体弹道导弹与运载火箭系列,宇航出版社,1989年3月
　　4　Lewis F L.Optimal Esimation with an Introduction to Stochastic Control Theory.John Wiley & Sons,1986
　　5　王照林.现代控制理论基础.国防工业出版社,1981年
　　6　Dennis J E,Schnabel Robert B.Numerical Methods for Unconstrained Optimization and Nonlinear Equation.
　　7　Kane T R.Spacecraft Dynamics,McGraw-Hill.New York,1983
　　8　陈芳允,贾乃华.卫星测控手册.科学出版社,1993年12月
　　9　韩潮,章仁为.利用雷达测高仪的卫星自主定轨.中国空间技术研究院技术报告,1996年7月
　收稿日期:1996年11月20日,修回日期:1998年8月12日
