　宇航学报
JOURNAL OF ASTRONAUTICS
1999年 第20卷 第3期 vol.20 No.3 1999



　　大型弹道式飞行器六自由度仿真
研 究 与 展 望
邓方林　阎　斌　王仕成
　　摘　要　本文针对大型弹道式飞行器传统建模和仿真方法的局限性，采用多种运动形态一体化建模方法，建立了飞行器全干扰、全量、全通道、时变非线性六自由度模型，并进行了数字仿真和接入部分实装的半实物仿真。该模型已在控制系统设计、系统质量评估、误差分析与精度评定、飞行效果预报和发射技术决策等领域中应用并获得了良好效果，证明该模型与传统三自由度模型相比更正确、更符合实际，深化了系统分析与仿真的研究。
　　主题词　大型弹道式飞行器　六自由度建模　六自由度仿真　系统分析
THE RESEARCH AND EXPECTATION OF 
SIX-DEGREE-OF-FREEDOM SIMULATION 
OF LARGE SCALE BALLISTIC VEHICLE
Deng Fanglin Yan Bin Wang Shicheng
(The Second Artillery Engineering College.Xi'an.710025)
　　Abstract　This paper aims at the limitation of traditional modeling methodology and analysis method of large scale ballistic vehicle,adopts incorporate modeling method of various movement forms and establishes complete disturbance,complete quantity,complete passage and time-variant non-linear six-degree-of-freedom model of ballistic vehicle,and carry out mathematical and parcel hard-in-loop simulation.The application of the model in the field of control system design,system performance estimation,error analysis,accuracy evaluation,flight effect predication and launch technique decision have gained satisfactory effect which indicates the six-degree-of-freedom model is much more correct and accordance with real circumstance of flight.It develops and deepens the research of system analysis and simulation.
　　Key words　Large scale ballistic vehicle Six-degree-of-freedom modeling Six-degree-of-freedom simulation System analysis
　　1　问题的提出――大型弹道飞行器基于摄动理论简化方法的局限性
　　飞机或有翼导弹虽曾采用六自由度模型，但无一例外地都依据摄动理论采用质心与绕质心运动分离式建模和基于小偏差假设的线性化增量方程。弹道式飞行器不曾采用六自由度模型，它的飞行包含箭体质心运动、绕质心运动、弹性振动、推进剂晃动和发动机摆动等多种彼此耦合且相互激励的运动形态，形成复杂的变质量质点系非线性运动，一体化建模十分复杂。
　　经过100次Monte-Carlo仿真，得到了自适应两步滤波器(ATSF)对相对距离、相对速度及目标加速度的估计误差，分别见图1～图3。基于摄动理论的分析方法，在严格的小偏差条件下可以将复杂问题简化到便于工程处理的程度。但弹道式飞行器在很多情况下不满足小偏差条件，例如导弹机动发射或水下发射时，姿态角初始偏差可达几十度；在能量管理段的大姿态飞行、为突防而进行的大姿态机动飞行、弹头再入段的大攻角再入等都将出现大扰动、大姿态偏差的飞行，小偏差假设已不成立，各种运动之间的铰链项不能忽略，质心运动和绕质心运动不能截然分开，三自由度模型的分立式分析和仿真造成的误差，足以导致导弹失稳和飞行失败。当时，迭代过程结束。
　　2　六自由度建模与仿真的关键技术
　　2.1　复杂大系统的一体化建模。上述算法完成了第一步滤波的测量修正功能。包括气动力、推力、重力、哥氏力、牵连惯性力、控制力、弹性振动的广力、推进剂晃动力、发动机摆动惯性力、综合干扰力等十类力和对应的八类力矩同时作用于弹体上，每一类力或力矩又可能包括若干品种或若干分量。上述力和力矩值又与导弹运动状态密切相关，形成各种外作用之间的耦合。
　　3　自适应两步滤波器在导弹被动制导中的应用
　　假设目标加速度可以用一阶Gauss-Markov随机过程描述，那么，在直角坐标系中目标和导弹相对运动关系可以用线性离散形式的动态方程描述，见文献［6］。
　　2.1.2　多种运动同时存在。导弹的质心运动、绕质心运动、弹性振动、推进剂晃动、发动机摆动等同时存在，各种运动状态的变化，伴随各种作用力和力矩的变化，它们相互激励、相互耦合，增加了运动描述和建模的难度。
　　2.1.3　多种坐标系的转换。
　　显然，系统状态xk的一步预报值及预报误差协方差阵可以由下列算法求得：
　　　　　　　　　　　　　　　　　(16)
　　　　　　　　　　　　　　　　　　　　　　　　　(17)
(16)式和(17)式完成了第二步滤波的时间修正功能。
　　2.2　六自由度仿真模型的校验、验证和确认(即仿真模型VVA)
　　仿真模型的校验、验证和确认是六自由度建模与仿真需要解决的关键技术之一，在大型飞行器系统仿真、分析和设计中占有很重要的地位。检验仿真模型最基本、最直接的方法是考察仿真模型输出与实际系统输出在统计意义上的一致性，也就是六自由度仿真与飞行试验的相容性检验，验证的方法是比较二者在相同输入条件(试验条件)下，试验结果在统计意义上的一致性。对于静态性能采用秩和检验法和游程检验法，对于动态性能采用由Burg和UCN算法构造的极大熵谱估计检验法，根据飞行实验数据，运用多种静态、动态验模方法，验证了六自由度仿真模型的可信性。上述算法完成了第一步滤波的测量修正功能。为了提高仿真精度和仿真速度，我们采取了很多有效措施：(1)积分算法采用高精度的龙格库塔转阿达姆斯法以保证仿真精度；(2)仿真基本步长取为2ms，在积分过程中采用变步长、倒积分和逐次逼近积分等方法提高仿真精度，特别是关机点的仿真精度；(3)针对非线性函数采用平均值算法提高积分精度；(4)采用多种插值算法提高插值的速度和精度；(5)运用软件工程技术优化仿真程序设计。
　　2.4　接入控制系统实装的闭环六自由度仿真
　　闭环六自由度仿真与传统的仿真方法相比存在更多的工程难题和技术难题。控制系统实装的接入特别是惯性制导系统或惯导器件的接入，是目前仿真界正在致力解决的重要问题。最大难题是线加速度表以实际飞行加速度状态接入问题。取第二步滤波时的性能指标函数为
　　　　　　　　　　　　　　　　　　　　　(11)
显然，求解xk使Jk达到最小值这一问题是一个非线性估计问题，我们用Gauss-Newton迭代法求最优解，即令
　　　　　　　　　　　　　　　　　　　　　　　　　　　　(12)
其中i代表迭代次数，，。
　　3　六自由度仿真的模式和特点
　　有些专家把已开展的六自由度仿真形式分为联合制导规律仿真模式和联合稳定性仿真模式［2］，两者的共同特点是考虑质心运动与绕质心运动的相互激励和相互影响，但建模和仿真方法差别很大。联合制导规律仿真考虑姿态运动过程、弹性振动、推进剂晃动、发动机摆动等各种因素对制导及精度的影响，同时也考虑了质心运动和上述多种运动形态对姿态稳定性的影响以及各种运动形态之间的铰链影响，是严格意义的六自由度仿真，本文主要讨论该模式的建模与仿真问题，它与传统建模方法质的区别主要表现在：
　　3.1　采用多种运动形态的一体化建模，基本形成了制导回路闭环仿真
　　六自由度仿真原理框图如图3-1所示。由图可见，六自由度仿真是全箭运动特性的描述和模拟，揭示了箭体内外各种激励因素的相互作用和影响，把箭体质心运动和绕质心运动进行一体化建模，考虑了多种运动形态(刚体运动、弹性振动、推进剂晃动、发动机摆动)的铰链和影响，接入控制系统实装(或局部用数学模型)基本实现制导回路闭环仿真，这是传统三自由度仿真无法实现的。

图3-1　六自由度仿真原理框图
　　3.2　全面研究了各种运动形态之间的相互作用和影响
　　箭体一体化建模仍然依据变质量质点系动量和动量矩定理，但它不同于传统的三自由度模型，而是充分考虑了各种运动形态的共存和它们之间的铰链影响，如箭体质心运动视加速度为：
　　　　　　　　　　　(3-1)
等式右边一、二两项分别为空气动力和发动机推力在箭体坐标系的投影，是传统三自由度模型也有的，而后三项分别为发动机摆动、推进剂晃动和弹性振动作用于箭体上的力在箭体坐标系的投影，这三项是六自由度模型独有的，它们各自的表达式可充分说明各种运动之间的铰链影响，为减小篇幅不再展开讨论。
　　3.3　采用时变、全量非线性方程描述，比传统模型具有更好的适应性
　　采用线性化增量方程还是采用时变非线性全量方程，是传统三自由度仿真与六自由度仿真最根本的区别之一。由于现在求解的是一个线性状态估计问题，所以可以用线性时变测量噪声统计估值器［3］对rk和Rk进行实时估计，即
　　　　　　　　　　　　　　　　　　　　　　　(8)
　　　　　　　　　(9)
其中dk=(1-b)/(1-bk+1),0＜b＜1，b代表遗忘因子；,εk代表新息向量；Kk=PykHTkR-1k。
　　　　　　　　　　　　　　　　　　(3-2)
该方程只能在严格的小扰动假设条件下才能使用，这是因为：
　　3.3.1　所有运动变量Δφ、Δθ、Δα、Δδφ均由三角函数台劳展开取其一次项得到，即假定sinΔφ=Δφ,sinΔα=Δα,sinΔδφ=Δδφ,cosΔθ=cosΔα=cosΔδφ=1，显然，当Δφ、Δθ、Δα、Δδφ较大时，小扰动假设将不成立，模型将会失真，严重时该模型不能使用。当时，迭代过程结束。
　　3.3　(3-2)式中第三个方程Δφ=Δα+Δθ严格说是不成立的，因为Δφ、Δα、Δθ以及ψ、β、σ是不同坐标系里的欧拉角，三者不共面，不能代数相加，三者之间有较复杂的坐标转换关系：
　　　　　　　(3-4)
只有在小扰动条件下满足Δφ、Δθ、Δα、Δδφ、ψ、β、σ、γc趋近于零时近似认为Δφ、Δα、Δθ三者共面，(3-2)式的第三个方程才近似成立，当扰动和姿态偏差较大时，(3-2)式不能使用。
　　以上三点说明严格的小扰动条件是十分苛刻的，若不满足，传统的线性化增量模型将会失真。六自由度建模对飞行器运动不作任何小扰动假设，也不进行线性化，而是采用时变非线性全量模型，从而避免了许多误差，无论对大扰动还是小扰动都是适用的。
　　4　六自由度仿真的应用研究及其前景
　　六自由度仿真应用领域非常广泛，目前已经投入使用或正在研究使用的主要有以下几个方面：
　　大扰动、大姿态偏差条件下的控制系统设计
　　飞行器系统质量评估和飞行落点预报
　　弹头再入段的误差分析
　　弹道导弹的精度分析和精度鉴定
　　基于六自由度的全弹半实物仿真
　　基于六自由度仿真的导弹闭环动态测试
　　导弹系统作战仿真和作战效能分析
　　通过六自由度仿真，进行飞行故障分析
　　进行爆高控制的误差补偿，提高毁伤效果
　　5　结论
　　国内开展大型弹道式飞行器六自由度建模理论和仿真方法研究已有十年，目前已经取得了重大进展，很好地解决了大扰动、大姿态飞行条件下弹道式飞行器的建模与仿真问题。虽然六自由度仿真研究是一个新的研究领域，部分理论和应用问题还处在探索和研究之中，但从目前成功的应用实例来看，这项技术具有良好的发展潜力和应用前景。
　　下面，我们把第一步滤波的估计值yk作为第二步滤波的测量值，测量方程为
　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　(10)
其中测量噪声ek的协方差矩阵为Pyk