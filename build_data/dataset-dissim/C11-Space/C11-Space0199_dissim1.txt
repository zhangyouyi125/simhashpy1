宇航学报
JOURNAL OF ASTRONAUTICS
1999年　第1期　No.1　1999



　基于广义模糊熵的液体火箭发动机
故障检测研究*
谢涛　张育林
　　摘　要　定义了系统状态的广义模糊熵及其计算公式,即当前时刻滑动数据窗口上聚类结果的广义模糊度,给出了滑动数据窗口中采样数据矢量方向分布中心的离散度定义及其与广义模糊熵之间的负指数关系,并基于该离散度概念对自适应窗口滤波器进行了改进,提高了滤波器对噪声的敏感度,从而进一步提高了基于自适应窗口滤波器的故障检测算法对强干扰噪声的鲁棒性。本文基于受强噪声干扰的实际试车数据,采用模糊Kohonen聚类网络(FKCN)作为滑动数据窗口上的聚类算法,进行了数值仿真比较实验。仿真结果表明,基于广义模糊熵的故障检测算法具有对干扰噪声的强鲁棒性,是低信噪比环境下的一种有效的故障检测算法。
*国家自然科学基金资助项目
作者单位:马爱军　(航天医学工程研究所．北京．100094)　刘守荣　陈塑寰(吉林工业大学．长春．130022)
参考文献
　[1]Rao S S,Sunar M.Piezoelectricity and Its Use in Disturbance Sensing and Control of Flexible Structures:A Survey.Applied Mechanics Review,1994,47(4):113-123
　[2]Gibbs G P,Fuller C R.Experiments on Active Control of Vibrational Power Flow Using Piezoceramic Actuators/Sensors.AIAA Journal,1992,30(2):457-463
　[3]Tzou H S,Gadre M.Theoretical Analysis of a Multi-Layered Thin Shell Coupled With Piezoelectric Shell Actuators for Distributed Vibration Controls.Journal of Sound and Vibration,1989,132(3):433-450
　[4]Allik H,Hughes T J R.Finite Element Method for Piezoelctric Vibration.International Journal for Numerical Methods in Engineering,1970,2(2):151-157
　[5]Tzou H S,Tseng C I.Distributed Piezoelectric Sensor/Actuator Design for Dynamic Measurement/Control of Distributed Parameter Systems:A Piezoelectric Finite Element Approach.Journal of Sound and Vibration,1990,138(1):17-34
　[6]Moetakef M A,et al.Closed-Form Expressions for Higher Order Electroelastic Tetrahedral Elements.AIAA Journal,1995,33(1):136-142
　[7]Hwang W S,Park H C.Finite Element Modeling of Piezoelectric Sensors and Actuators.AIAA Journal,1993,31(5):930-937
　[8]孙慷,张福学.压电学.国防工业出版社,1984
　[9]Cook R D.Concepts and Applications of Finite Element Analysis.New York:John Wiley,1981
收稿日期:1996年8月9日,修回日期:1997年12月5日


。文［3,4］介绍了一种适用于离线或在线系统故障检测与诊断算法框架,并基于实际试车数据用GA-HCM混合聚类算法、FKCN、FCM及HCM硬聚类算法进行了故障检测的性能比较分析。该算法框架的内核是“自适应窗口滤波器”,故障检测的准确率取决于“自适应窗口滤波器”对噪声的敏感度,而“自适应窗口滤波器”对噪声的敏感度直接依赖于对滑动数据窗口中采样数据矢量方向分布的离散度定义的客观性。为了改进文［3,4］中硬边界的噪声识别方法,提高该故障检测算法对强噪声环境的鲁棒性,本文提出一种对滑动数据窗口中数据矢量几何分布中心离散度的广义模糊熵定义,该离散度定义基于广义信息熵的形式客观地反映滑动数据窗口中数据矢量分布中心的离散度,从而使“自适应窗口滤波器”建立在客观的离散度定义基础上。
2　数据矢量方向分布中心离散度的广义模糊熵定义及其计算公式
　　一般地,液体火箭发动机地面试车是一个强噪声环境,监测参数受到相互耦合的强噪声干扰。因此,滑动数据窗口中数据矢量方向分布具有随机性,但总体上呈现不同的分布中心。对实际试车数据的统计分析结果表明,相互耦合的强噪声在幅值上呈均值不为零的正态分布,而在时序上的随机性服从一阶或二阶Markov链。受这种噪声干扰的采样数据矢量的几何分布会明显地偏离未受噪声干扰的采样数据矢量,并呈正态分布。一般地,滑动数据窗口中受强噪声干扰的数据矢量少于未受干扰的数据矢量。数据矢量几何分布离散程度可以用欧氏距离或矢量方向的离散程度来描述,鉴于监控数据矢量方向在故障检测中的实用性,本文使用数据矢量方向的几何分布离散度。由于稳态工况下系统状态及测量参数的稳定性,未受噪声干扰的数据矢量在高维欧氏空间中呈均匀分布且高度集中,其矢量伸展方向高度一致,因此可以通过对滑动数据窗口上数据矢量进行二分组聚类(对于单向噪声环境)或三分组聚类(对于双向噪声环境)来识别当前数据窗口中受强噪声干扰的数据。本例中方程(20)和(25)的求解采用模态迭加法,计算时主结构的阻尼比取为0.01,各压电传感元件的反馈增益均取为100。因为样本个数少于或等于10个的聚类组的中心矢量方向并不一定代表受噪声干扰的样本均值矢量方向,样本个数大于10个的聚类组中并非一定不包含受噪声干扰的样本数据,因此,这是一种硬边介的噪声识别方法,不适用于强噪声环境下的自适应窗口滤波器。同样地,根据连续滑动数据窗口上聚类结果的一致性及其在时间上的持续性的分析结果来判断系统是否已发生故障并区分间歇性故障及永久性故障的方法也是硬边界的,因为故障发生时相邻二滑动数据窗口经过聚类分析而形成的二部分数据矢量个数差异不可能保持绝对一致(如小故障发生时)而只能大体一致。仿真分析表明,正确识别当前数据窗口中是否存在异常数据的关键问题是,如何定义数据窗口中数据矢量方向分布中心的离散度。
　　对于单向分布的噪声环境,如果滑动数据窗口中不存在受强噪声干扰的数据矢量,则该窗口中的二模糊聚类组中的样本个数应基本相等,且数据矢量的模糊隶属度均接近0.5,即每一数据矢量对二互补模糊集合的隶属度极其模糊。该梁被均匀分成5个单元。样本对模糊集合的隶属度的模糊性定义为模糊集合的模糊熵［6］,即:
对于论域V={v　1,v2,…,vT},模糊集合A(vi)的模糊熵可定义如下:

(1)
　　其中ui∈［0,1］,i=1,2,…T;ui=A(vi)为样本vi的隶属度。易知,0≤H(A)≤1。
　　一般情况下,可以定义具有三个以上互补模糊闭集的广义模糊熵,用来度量双向噪声环境下滑动数据窗口中采样数据矢量的几何分布离散度。
　　设:V={v1,v2,…,vT},其中vi为第i个d维采样数据矢量,1≤i≤T;
　　　O={c1,c2,…,cC},其中ci为第i个d维模糊聚类中心数据矢量,1≤i≤C;
　　　uij∈［0,1］,,1≤i≤C,1≤j≤T;uij为数据矢量vj对聚类中心矢量ci所代表的模糊集合的隶属度;
　　则模糊聚类结果的广义模糊熵可如下计算(为便于计算离散度,去掉分母lnc):

(2)
　　其中0*为最优聚类中心矢量组。
　　用Lagrange乘子法容易证明:当uij=u2j=u3j=…=ucj=,1≤j≤T时,也即聚类结果极其模糊时,广义模糊熵F(O*,V)取最大值lnc;相反,当uij={0,1}时,广义模糊熵F(O*,V)取最小值0。因此,聚类结果的广义模糊熵F(O*,V)可用来度量论域中样本分布中心的离散度。
　　滑动数据窗口中数据矢量方向分布中心的离散程度与滑动数据窗口上聚类结果的广义模糊熵F(O*,V)成反比,数据矢量方向分布中心离散程度越大,F(O*,V)就越小。图中u1,u2,u3,u4,u5,u6为单元的节点位移,φ1,φ2为单元上表面执行器的节点电势,φ3,φ4为单元下表面传感器的节点电势。概括地讲,用有限元法研究压电材料在结构振动控制中的应用目前所使用的单元类型还比较单一,有必要进一步建立新的压电单元模型。同时,通过k2值可控制基于自适应窗口滤波器的故障检测算法对故障的敏感度,k2越小,算法对故障的敏感度越大。
　　其中,Dfil(O*,V)为滤波门限值,Dfau(O*,V)为故障门限值;0＜k1+k2＜1-;0＜k1＜k2＜1-
　　基于广义模糊熵定义的滑动窗口中数据矢量离散度不仅是对硬边界的软化,更重要的是以基于广义信息熵的形式来客观地描述数据窗中数据矢量分布中心的离散度,使自适应窗口滤波器建立在客观的离散度定义基础上。基于广义模糊熵改进的故障检测算法程序流程如图1所示。


图1　基于广义模糊熵的故障检测程序流程图
3　高维数据的FKCN(Fuzzy Kohonen Clustering Network)聚类算法
　　FKCN算法在迭代过程中不断地修改其学习因子及待学习的相邻样本数目,使聚类问题逐渐收敛到其全局最优解或局部最优解。实质上,FKCN是FCM聚类算法与KCN聚类算法的有机结合,每一次FKCN迭代过程即是一次相关参数变化了的FCM聚类算法。因此从“自适应性”角度来说,FKCN优于FCM聚类算法,从而聚类结果的全局性及收敛性也优于FCM聚类算法。文［5］在以欧氏距离定义数据样本之间的相似度及隶属度基础上给出了FKCN算法,本文基于样本数据矢量之间相似度的矢量夹角余弦值度量,给出了按数据矢量几何分布方向聚类的FKCN算法。
　　设:V={v　1,v　2,…,v　T},其中v　i为第i个d维采样数据矢量,1≤i≤T
　　　　O={c1,c2,…,cC},其中ci为第i个d维模糊聚类中心数据矢量,1≤i≤C;
　　数据矢量样本v　i与vj之间的相似度采用矢量夹角的余弦值度量,即:
即相应vi与vj的两个单位矢量之间的点积。
　　定义FKCN算法的学习因子为αij,t=(uij,t)mt,其中mt=m=m0-t．Δm,Δm=(m0-1)/tmax,m0＞1为常数;t为迭代次数,tmax为迭代次数极限;uij,t按模糊中心聚类(FCM)算法中计算模糊隶属度的公式计算,即

FKCN1:设定聚类类数C及迭代终止条件ε＞0(如0.001);
FKCN2:初始化O0={c1,0,c2,0,…cc,0}∈Rd×C,取常数m0=12.0,迭代次数极限tmax=50;
FKCN3:分别取t=0,1,2,3,…,tmax-1;
　　a. 计算αij,t=(uij,t)mt,1≤i≤C,1≤j≤T;
　　b. 用如下学习公式更新所有(C个)聚类中心矢量{ci,t}

　　可以证明该式等价于:
　　c. 计算Et=cos(ci,t,ci,t-1),或:Rt=J(Wt,Ot)-J(Wt-1,Ot-1)=(uij,t)mt.cos(vj,ci,t)-(uij,t-1)mt-1cos(vj,ci,t-1),Wt={uij,t;}
　　d. 如果Et≥C-ε或Rt≤ε,则终止迭代学习;否则t←t+1,继续迭代学习过程。近十年来,由于压电材料在结构的振动控制中的普遍应用,促使各国研究人员建立考虑压电效应的新的压电单元,如文献［5中,Tzou和Tseng建立了分布参数系统分布压电传感器和执行器的薄六面体压电单元;文献［6中,Moetakef等给出了高阶四面体压电单元――直边线性应变四面体单元和二次应变四面体单元,并通过对所推得的四面体单元的组合构成了六面体单元,这有利于联合使用六面体单元和四面体单元对实际结构进行离散分析;文献［7］中,Hwang和Park建立了二维四边形弯曲板单元的压电传感器和执行器的有限元模型,该单元有四个节点,十二个位移自由度,每个单元的电场被假设成具有一个电自由度,该单元的优点是计算量小,且能大大节省计算机的内存,缺点是对单元电场的处理过于简单。
　　在悬臂梁端点处加一横向单位阶跃力,分别用式(20)、(25)计算其开环和闭环系统的响应。
　　在悬臂梁端点处加一横向单位阶跃力,分别用式(20)、(25)计算其开环和闭环系统的响应。氢泵壳温度受到的强噪声干扰在幅值上有时高达氢泵壳温度的3至4倍,而且是双向分布的叠加噪声。整个地面试验过程持续380.00秒,发动机起动段(start-up)持续2.70秒左右即进入稳定的主级段运行。为验证改进的故障检测算法性能,对25.00秒到25.82秒间的采样数据进行了某种定向的微小修改,如让8个参数测量值中某些参数持续减小,而让某些参数测量值持续增大,以模拟某些典型故障的过渡过程,部分参数的变化如图2所示。


图1　平面复合压电框架单元
2.2　含压电传感器和执行器的复合框架单元的有限元方程
　　为了导出如图1所示的平面复合压电框架单元的动力方程,我们用哈密尔顿原理

(3)
式中T、Ta、Ts分别为单元主体结构,执行器和传感器的动能,U、Ua、Us为势能,W为机械外力所作的功,Wa、Ws分别为电场在执行器和传感器上所作的功。
　　图3说明基于硬边界噪声识别方法并用FKCN进行模糊二分组聚类时,基于广义模糊熵的离散度随采样时刻的变化趋势,容易看出当故障检测算法处理到21.10秒时产生故障误报警(由强噪声干扰所引起),虽然也能检测出25.00秒后人为所设置的轻度故障。

　　　　　　　　　　　图3：采用硬边界的噪声识别方法时，基于模糊　　　　　　　　　　　　　　　熵的数据分布中心离散度随时间的变化关系
　　图4(a)、图5(a)分别说明基于广义模糊熵的离散度定义并用FKCN进行模糊二分组、三分组聚类时的滤波结果。与基于二分组的自适应窗口滤波器比较,基于三分组聚类分析的自适应窗口滤波器对双向分布噪声的敏感度稍高。图4(b)与图5(b)分别说明基于广义模糊熵离散度定义并用FKCN进行模糊二分组和三分组来检测故障时,滑动数据窗口中数据矢量离散度随采样时刻的变化趋势。容易看出,当故障检测算法处理到试车数据中25.00秒时刻后,滑动窗口中数据矢量的离散度值持续超过(1/C+k1+k2)值,直到人为设置的故障过渡过程结束。故障检测算法即根据离散度超过(1/C+k1+k2)的持续次数,判断发动机系统是否发生故障,并区分间歇性故障与永久性故障。
　　　
图4（a）：基于模糊熵的自适应窗口滤波器的滤波器的滤
波输出，聚类分析采用模糊分组FKCN算法

　　　　　　　　　　　图4（b）：聚类分析采用模糊二分组FKCN算法时，　　　　　　　　　　　　　　　　　　基于模糊熵的离散度随时间的变关系

图5（a）：基于模糊熵的离散度定义的自适应窗口滤波器的滤
波输出，聚类分析采用模糊三分组FKCN算法

　　　　　　　　　　　图５（b）：聚类分析采用三分组FKCN算法时，基于　　　　　　　　　　　　　　　　　模糊熵的离散度随时间的变化关系
5　结论
　　聚类结果的广义模糊熵客观地反映了数据矢量分布中心的离散程度。该梁被均匀分成5个单元。概括地讲,用有限元法研究压电材料在结构振动控制中的应用目前所使用的单元类型还比较单一,有必要进一步建立新的压电单元模型。
3　结构的振动控制
　　由式(15c),可推得压电传感元件的输出电压表达式
φs=K-1φφs(-Gs+KφusU)
(22)
一般情况下,没有外电场作用到压电传感元件上,即Gs=0,因此式(22)化为
φs=K-1φφsKφusU
(23)
由式(20)可知,含压电传感器和执行器的复合结构所受外激励由两部分组成,F与FG,前者是机械激,后者在闭环控制系统中充当反馈控制激励,其一般表达式为式(17)。随机干扰噪声在幅值上的统计分布可以根据现有试车数据通过统计分析得到,因此,基于Shannon统计信息熵的液体火箭发动机实时故障检测算法可以进行工程应用开发。
*国家自然科学基金资助项目，批准号：669785002
作者单位：谢涛　张育林　（国防科学技术学航天技术系.长沙.410073）
参考文献
　[1]Nemeth E,Norman A M.Development of a Health Monitoring Algorithm.AIAA 90-1991,July 16～18,1990/Orlando,FL
　[2]Tulpule S,Galinaitis W S.Health Monitoring System for the SSME-Fault Detection Algorithms.AIAA 90-1988,July 16～18,1990/Orlando,FL
　[3]谢涛,张育林.基于滑动数据窗聚类结果分析的复杂动力系统故障检测与诊断算法框架及其应用.第二界全球华人智能大会(CWCICIA’97,西安)
　[4]谢涛,张育林.GA-HCM混合聚类算法及其在液体火箭发动机故障检测中的应用.推进技术,1997,18(1):35-42
　[5]Eric Chen-Kuo Tsoa,Bezdek J C,Nikhil R Pal.Fuzzy Kohonen Clustering Networks.Pattern Recognition,1994,27(5):757-764
　[6]De Luca A and Termini S.A Definition of Nonprobabilistic Entropy in the Setting of Fuzzy Sets.Infor.Contr.,20(1972),201-312

收稿日期：1996年10月13日,修改日期：1998年9月25日
