　宇航学报
JOURNAL OF ASTRONAUTICS
1999年 第20卷 第3期 vol.20 No.3 1999



利用雷达测高仪的卫星自主定轨
韩　潮　章仁为
　　摘　要　提出了利用星上雷达测高仪及星敏感器进行卫星自主定轨的基本方法。研究了地球海平面模型的重要性,提出了对测高仪测量数据处理的简明算法,利用滤波定轨算法,明显提高自主定轨的精度,数学仿真表明自主定轨精度可达100米。
　　主题词　卫星　自主导航　Kalman滤波
AUTONOMOUS ORBIT DETERMINATION WITH 
RADAR ALTITUDE SENSOR
Han Chao Zhang Renwei
(Beijing University of Aeronautics and Astronautics.Beijing.100083)
　　Abstract　This paper studies a basic method of the autonomous orbit determination with radar altitude and star sensors.With sea level model,a simply method for modifying the influence of earth shape has been presented.Direct and Kalman filter orbit determination methods have been studied.The simulation results show that precision of orbit determination is about 100 meter.
　　Key words　Satellite Orbit determination Kalman filter
　　1　引言
　　雷达测高仪(或称卫星高度计)是海洋卫星必备的有效载荷,用于测绘海洋起伏、表面流、潮汐和波浪。卫星定轨的基本测量有测角、测距、测角-测距和测距-测速等方法。在侧角法中,通常应用的参考天体为地球、太阳或恒星,测量仪器有星、太阳和红外地平仪等。原点O离地心的距离为Ro，相应的轨道角速度为Ω。本文针对利用雷达测高仪测量对卫星自主定轨进行研究。主要包括以下几部分内容:一、影响地心矢量计算精度大地水准面(海平面)模型的研究;二、利用卫星高度计和星敏感器的混合观测,考虑海平面起伏的影响,测直接计算卫星的位置和姿态(直接定轨法);三、在直接定轨法的基础上,采用修正的广义Kalman滤波技术提高自主定轨的精度(滤波定轨法);文章最后部分以海洋卫星为背景进行了模拟计算,结果表明直接定轨计算可达到600米的定轨精度,广义Kalman滤波定轨可达到100米的定轨精度。
　　2　海平面模型
　　大地水准面是指在地球重力场作用下,地球表面的水面沿重力等位面分布而形成的曲面,根据文献［2］中的方法,利用地球引力模型系数求得大地水准面形状方程。设大地水准面极坐标形式的方程为
　　　　　　　　　　　　　　　　　r0=R(1+Y1+Y2+Y3+……)　　　　　　　　　　　　　(1)
其中Yi为对应第i阶地球引力系数的小量,是地理经度λ和地心纬度φ的函数。R为地球的平均半径,Yi和R分别满足
　　　　　　　　　　　　　　　　　　　(2)
其中GM为地球引力常数,ωe为地球自旋角速度,Wei为重力水准面的重力值,ae为地球赤道半径
　　　　　　　　n=2,3,…　　　　　　(3)
φ为地心纬度,λ为经度,Pmn为勒让德多项式,Anm和Bnm为地球引力场系数,地球引力场系数参见文献［3］,其中包括n=30和m=28的地球引力场系数。
　　分析表明造成地球水准面偏离以地球平均半径为半径的球面主要为地球引力场J2项系数的影响。J2项(即克莱饶海平面椭球模型)造成海平面高度相对地球平均半径起伏为-14公里至7公里,高于J2项的引力系数对海平面形状影响相对较小。

图3　子星俯仰运动(初始俯仰角0.1弧度)

图4.1　子星俯仰运动(初始滚转角0.1弧度)

图4.2　子星滚转运动(初始滚转角0.1弧度)

图4.3　子星偏航运动(初始滚转角0.1弧度)
　　模拟计算显示出，当仅存在初始俯仰角偏差时，系绳与子星仅有轨道平面内的运动(参见图1.1与图1.2，以及图3)。子星本体坐标系相对轨道坐标系的方位由偏航角β1，俯仰角β2及滚转角β3确定。直接定轨的计算中不但可完成定轨的计算,同时可进行卫星姿态的计算。
　　直接定轨法的关键步骤为地心矢量的计算。由于地球形状非常复杂,卫星姿态、位置都直接影响着沿雷达测高仪射线方向卫星到地球表面的距离(简称斜距),因此利用测量结果和地球形状地球模型直接计算地心矢量在卫星本体中坐标系的方向几乎不可能。假设地球形状为球形,地心矢量的计算与卫星的轨道和姿态参数无关,并且可以直接求出卫星的高度及滚动角和俯仰角等运动参数。由于地球形状基本上为一球形,海平面的起伏相对地球平面半径为小量,可作为小量修正处理,修正结果与卫星的轨道和姿态等运动参数有关,但相对卫星的运动参数不敏感,因此可以求得高精度的地心矢量在卫星本体系中方向。
　　3.1　球模型中的地心矢量计算
　　假设地球表面为球形,球半径为Re,地心和地球表面在卫星本体坐标系的坐标为(x0,y0,z0)和(x,y,z),则球模型描述的地球表面的方程为
　　　　　　　　　　　　　　　(x-x0)2+(y-y0)2+(z-z0)2=R2e　　　　　　　　　　　　(4)
设雷达测高仪在卫星体轴内的方向余弦为［ai bi ci］T,i=1,2,…,m,m为雷达测高仪的个数,假设第i个雷达测高仪的射线与地球球面相交,并且到地球球面的斜距为ρi,则(aiρi,biρi,ciρi)满足方程(4),即
　　　　　　　　　　　　　(aiρi-x0)2+(biρi-y0)2+(ciρi-z0)2=R2e　　　　　　　　　(5)
m个斜距的测量结果ρi(i=1,2,…,m)就可得到m个类似(5)的方程,组成一非线性方程组。要计算(x0,y0,z0),至少需要3个ρi测量结果。由于(5)组成的方程组为非线性方程组,因此只能采用迭代方法求解。

式中，是子星在惯性系中的绝对角速度；ωi(i=1,2,3)是表示在子星本体坐标系中的分量，ωi是Ω,βj与(J=1,2,3)的函数。(2)轨道坐标系O-XoYoZo：原点O位于系统质心(即主星)，Xo轴沿运动方向水平向前，Zo轴沿当地垂线指向地心，Yo轴完成右手系。该动力学模型可用于微重力实验平台及空间容器返回等系绳使命的分析与设计。具体方法为,根据雷达测高仪射线与球模型球面的交点坐标,求得地心纬度和经度,从而计算海平面相对球面的起伏ΔR。子星本体坐标系相对轨道坐标系的方位由偏航角β1，俯仰角β2及滚转角β3确定。原点O离地心的距离为Ro，相应的轨道角速度为Ω。ri为卫星在惯性空间的位置矢量。
　　对球形地球一次计算即可完成卫星位置的计算,但海平面起伏影响的修正依赖卫星的位置、速度和姿态,并且关系十分复杂,只能通过迭代计算不断提高定位精度。这种迭代算法的收敛性本文没有进行深入的研究,仅在仿真中比较了不同迭代次数的影响。
　　由于海平面修正模型误差,海浪 的随机误差,会造成地心矢量计算的误差,同时星敏感器测量造成卫星方位确定的误差,二者都会影响定轨计算的精度。根据(11)式,直接定轨计算主要由Cib和Rb两部分组成。其中Cib的精度主要由星敏感器测量精度决定,而Rb的计算误差取决于设雷达测高仪射线方向卫星到地球球模型球面的距离的计算精度及雷达测高仪安装角的精度等。直接定轨法的具体算法、流程及精度分析参见文献［9］。(2)轨道坐标系O-XoYoZo：原点O位于系统质心(即主星)，Xo轴沿运动方向水平向前，Zo轴沿当地垂线指向地心，Yo轴完成右手系。以直接定轨法为基础,采用广义Kalman滤波方法,结合卫星本身的运动特性进行动态定轨,可提高定轨精度。由于采用计算结果(直接定轨法的结果,而不是测量)作为Kalman滤波的测量修正量,传统的广Kalman滤波算法需作适当的修改。
　　4.1　Kalman滤波算法的修正
　　传统意义下广义Kalman滤波的测量方程为
　　　　　　　　　　　　　　　　　　z=h(x,t)+v　　　　　　　　　　　　　　　　　(12)
其中z为测量量,x状态变量,v为反映测量误差的白噪音信号,如果以直接定轨法的计算结果替代测量信号作为Kalman测量修正项,测量方程的形式就变为
　　　　　　　　　　　　　　　　　g(x,z,v,t)=h(x,t)　　　　　　　　　　　　　　(13)
其中z为测量量,x状态变量,v为反映测量误差的白噪音信号,g(x,z,v,t)为测量量、状态量和测量误差的函数,本文中对应着直接定轨法的计算结果。由于测量方程(13)的形式与传统意义下广义Kalmam滤波的测量方程(12)形式不同,广义Kalman滤波算法必须作适当的修正以适应方程(13)形式的测量方程,修正的广义Kalman滤波算法见算法Ⅰ,算法Ⅰ中当gk(xk,zk,tk,vk)=z时,算法Ⅰ退化为传统的广义Kalman滤波算法(文献［4］)。
　　4.2　轨道运动和测量模型
　　Kalman滤波的状态模型为在地心惯性坐标系中考虑J2项引力摄动项影响轨道动力学模型。以直接定轨法的计算结果作为测量结果,即测量模型为
　　　　　　　　　　　　　　g=［x* y* z*］T　　h=［x y z］T　　　　　　　　　　　(14)
由于直接定轨法的计算结果x*,y*,z*为ρ1,ρ2,ρ3,…,ρm和ai,bi及测量误差v的函数,所以g,h对应的Jacob矩阵为
　　　　　　　　　　　　　　　　　　　　　　　　　　　(15)
h和g的具体形式详见文献［9］。
算法Ⅰ　连续―离散广义Kalman滤波算法
状态模型:　　　x(t0)=x0
测量模型:gk(xk,zk,tk,vk)=hk(xk,tk)　　k=1,2,…
统计特性:E{x0xT0}=P0
　　　　　E{w(t)}=0,　E{w(t)wT(t)}=Q(t);
　　　　　E{vk)=0,　　E{vk(t)vTk}=Rk;
　　　　　E{x0wT(t)}=0,　E{x0vTk)}=0;
　　　　　E{w(t)vTk}=0;　　k=1,2,…
Kalman预测:　　　　　　　　
　　　　　　　P(t0)=P0
Kalman滤波反馈增益矩阵:
　　　　　　　　Kk=P-kHTk(HkP-kHTk+SkRkSTk)-1
Kalman测量修正:
　　　　　　　　
Kalman方差修正:
　　　　　　　　P+k=(I-KkHk)P-k
其中Jacobi矩阵:
　　　　　　　　;;。
　　5　模拟仿真及结果分析
　　利用海洋高度计的卫星自主导航的Kalman滤波定轨的包括并行处理的轨道和姿态的两部分,既可降低Kalman滤波器的阶数,减少计算量,又可以提高系统的稳定性。Kalman滤波定轨与卫星轨道和姿态仿真及测量的系统流程图如图1所示。

　　图1　滤波定轨及模拟仿真框图
　　轨道运动数据是由模拟仿真程序产生,该程序包括了地球引力摄动(n=30,m=28)、大气层阻力、太阳和月球摄动等因素的影响,卫星的姿态运动简单地采用正弦变化模拟卫星相对其轨道坐标系姿态角的变化;采用n=20的海平面模型模拟海平面的起伏变化;而海浪采用零均值的随机白噪声模拟产生,并以白噪声序列的最大值作为海浪高度。
　　本文以轨道高度为900km,轨道倾角98°的极地低轨卫星为模拟仿真对象。选取20颗星等最亮的恒星［9］模拟星敏感器的测量对象。
　　为分析和比较直接定轨法与滤波定轨法的性能,本文针对定轨计算采用的海平面模型阶数、海浪起伏高度、星敏感器测量精度、直接定轨迭代次数及Kalman滤波采样周期等不同状况进行数值模拟仿真,共计16种情况,具体值为:
海平面模型阶数　　　　3,10阶
海浪起伏高度　　　　　0,10米
　　　　　　星敏感器测量精度　　　0.0,0.003,0.005度
　直接定轨迭代次数　　　1,2,3次
　　滤波采样周期　　　　　1.0,5.0秒
　　Kalman滤波状态初值的偏差为:位置偏差为1000米,速度偏差为1.0米/秒,姿态角位置偏差为0.5度。模拟的计算结果详见表1至表4,图2为其一种情况的时间过程曲线。模拟仿真计算结果表明直接计算的定轨精度为400～600米,Kalman滤波定轨精度为100米左右,地心矢量计算的精度为0.004度左右,速度精度为0.5～0.6米/秒。
表1　直接和滤波定轨计算结果(测量扰动与海浪影响)
(直接定轨迭代=3次,采样周期=1.0秒、海平面模型阶数=3)

序号海浪高
度(m)星敏感
器(Deg)滤波定轨位
置误差(m)直接定轨位
置误差(m)速度误差
(m/s)角度误差
(Deg)
100.00.00085780.350.0017
210.00.000934150.430.0041
310.00.0031145640.570.0043
410.00.0051447650.860.0050

表2　直接和滤波定轨计算结果(测量扰动影响与海浪影响)
(直接定轨迭代=3次,采样周期=1.0秒、海平面模型阶数=10)

序号海浪高
度(m)星敏感
器(Deg)滤波定轨位
置误差(m)直接定轨位
置误差(m)速度误差
(m/s)角度误差
(Deg)
500.00.00044380.240.0011
610.00.000544000.320.0038
710.00.003885600.530.0040
810.00.0051077570.790.0047

表3　直接和滤波定轨计算结果(采样周期影响)
(海浪高度=10.0米,直接定轨迭代=3次,采样周期=5.0秒)

序号海浪高
度(m)星敏感
器(Deg)滤波定轨位
置误差(m)直接定轨位
置误差(m)速度误差
(m/s)角度误差
(Deg)
9030.0032225710.750.0044
10030.0052697581.060.0055
11100.0031725560.630.0041
12100.0052087530.890.0052

表4　直接和滤波定轨计算结果(直接定轨迭代次数影响)
(海浪高度=10.0米,星敏感器精度=0.003度,采样周期=1.0秒)

序号海浪高
度(m)星敏感
器(Deg)滤波定轨位
置误差(m)直接定轨位
置误差(m)速度误差
(m/s)角度误差
(Deg)
132031315680.570.0043
14210855590.510.0040
151033596560.860.0052
161103816630.880.0051





图2　
　　比较表1和表2的结果,不考虑海浪高度和星敏感器测量误差影响,海平面模型阶数取3阶和10阶时,定轨精度相差约40米左右,随着海浪高度和星敏感器测量误差的增加,3阶和10阶时定轨Kalman滤波定轨精度相差仍维持在40米左右,这是由于海平面的起伏是缓慢变化的,而海浪高度和星敏感器测量误差是随机的,Kalman滤波只能消除随机误差的造成的影响,海平面起伏的影响只能根据海平面模型的计算消除。
　　(4)系绳结构阻尼
　　系绳结构阻尼可借助Rayleigh耗散函数表示：

式中，Ci、CMi和CT为相应的结构阻尼系数。
　　主题词　绳系卫星系统　动力学
A SOPHISTICATED DYNAMICAL MODEL OF 
TETHERED SATELLITE SYSTEMS
Zhu Renzhang Lei Da
(Beijing University of Aeronautics and Astronautics)
Lin Huabao
(Chinese Academy of Space Technology)
　　Abstract　A sophisticated dynamical model of tethered satellite systems is presented in this paper,where the tether is modeled as a system of N discrete point-masses connected by massless springs,the nominal length of the tether is constant,the main satellite is taken as a point with msaa much greater than the subsatellite's mass,and the subsatellite is modeled as a rigid body.So,this dynamic model is described with 3(1+N） generalized coordinates (coordinates of the N beads and three attitude angles of the subsatellite).This model can describe the motion of the center of mass of the subsatellite and the attitude motion of the end body.
　　Key words　Tethered satellite system Dynamics
　　1　概述
　　绳系卫星系统的运动可分为系统质心的轨道运动(绝对运动)以及系统各部分的相对运动［1，2］。其中两次迭代与三次迭代的结果是相同的,但只迭代一次的定轨精度明显降低,特别是Kalman滤波定轨的精度只有400米,其原因为海平面起伏的修正计算误差所致。

式中，是珠点mi，在惯性系中的绝对速度;Vij(i=1,2,…,N;j=1,2,3)是表示在轨道坐标系中的分量，它是位置(xi,yi,zi)与速度(,,)及Ω的函数。采样周期为1秒时200秒达到稳定状态,采样周期为5秒时500秒达到稳定状态,而研究中曾试图采用标准的广义Kalman滤波,根据斜距和星敏感器测量直接进行滤波定轨计算,但不是不收敛就是收敛速度很慢,一般都在1000秒以上。这表明本文中给出的修正的广义Kalman滤波算法具有较好的性能鲁棒性,在具体应用时具有很大的灵活性,同时保持了标准的广义Kalman滤波算法的规范化的形式。
　　6　结论
　　根据研究,可得以下结论:
　　①海平面的相对地球参考球面或地球参考椭球面的起伏对利用雷达高度计进行自主定轨的定轨精度有较大的影响,其影响是不能通过Kalman滤波消除的,只能通过海平面模型消除。
　　②采用测量数据的预处理结果(直接定轨的计算结果)作为Kalman滤波测量修正项,并结合修正的广义Kalman滤波,可明显提高Kalman滤波定轨的性能。
　　③本文中给出的修正的广义Kalman滤波算法具有良好的收敛性和稳定性。
　　④直接定轨法中的地心矢量计算的算法简单、性能可靠,并能提供姿态角的计算结果,有利于采用并行Kalman滤波处理技术以减少Kalman滤波的计算量。
　　⑤根据模拟计算,直接计算定轨的精度为400～600米,滤波定轨的精度为100米左右。当仅有初始滚转角偏差时，系绳与子星既有轨道平面内的运动，又有轨道平面外的运动(参见图2.1至图2.3，以及图4.1至图4.3)，但俯仰运动与偏航运动很弱(参见图4.1与图4.3)