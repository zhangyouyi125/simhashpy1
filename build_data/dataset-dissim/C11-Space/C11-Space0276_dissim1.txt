宇航学报
JOURNAL OF ASTRONAUTICS 
1999年　第20卷　第4期　vol20　No.4　1999




基于小波分析的SAR图象数据压缩与
噪声抑制综合技术
李强　王正志
　　摘　要　本文给出了一种基于小波分析方法的数据压缩与噪声和抑制综合技术，它具有运算简便，能在保持原图精度的同时有效地降低斑点噪声影响的优点。更重要的是，它将噪声抑制与数据压缩过程同时进行，在对SAR雷达图象的处理上取得了良好的效果。
　　主题词　小波分析　噪声抑制　图象压缩
THE WAVELET-BASED SYNTHETIC TECHNOLOGY 
OF DENOISING AND COMPRESSION SAR IMAGE
Li Qiang Wang Zhengzhi
(National University of Defense Technology . Changsha . 410073)
　　Abstract　A Wavelet-Based compression and noise reduction synthetic technique is presented.The method is computional efficient and can significantly reduce the speckle while preserving the resolution of the original image.More importantly,it can integrate the noise reduction and data compression process,and yield good result on processing the SAR images.
　　Key words　Wavelet Noise reduction Image compression
1　概述
　　从四、五十年代航空摄影算起，遥感技术发展到今天已有半个多世纪的历史。目前遥感技术正向着高空间分辨率，高光谱分辨率以及光学、红外与微波多谱段遥感相结合的方向发展。
　　遥感技术的这些发展趋势造成的一个结果是遥感数据量日益庞大，因此遥感数据的压缩问题日益受到重视。遥感数据信息量巨大，细节较为丰富，它的压缩要综合考虑图像的时　(空)　统计特性和频率域的频谱特性。亦即考虑把［T5,TN+2］分成［T5,T6］，［T6,T7］，…，［TN+1,TN+2］共N-3个小区间考虑。
　　微波遥感越来越受到重视是因为它除了提供与光学、红外遥感完全不同的信息外，还具有穿透性强和不受时间和气候条件限制的优点。同样可得上述时间序列参数在［Tj,Tj+1］(j=6,7,…,N+1)的估计。
　　SAR遥感应用中的一个重要问题是斑点的影响。斑点是由于成象过程中对图象的一致辐射特性的要求而引起的，呈现出一种复杂无序的模式，所以它可以被认为是一种导致图象降质的噪声［2］。传统的斑点噪声去除方法主要有两种：基于斑点噪声倍增模型的去除方法和峰值去除法。近年来基于小波分析的信号处理方法为斑点噪声的去除提供了另一条思路，它在抑制了图象噪声的同时保持了图象的细节信息［3］。理论分析和仿真计算表明：本文所建的模型准确，参数估计方法精度高，应用本文方法能明显提高弹道跟踪数据质量。因此，我们考虑通过该方法将噪声抑制和数据压缩综合在一个统一的过程中。通过SAR数据处理的实验证明，这是可行而且有效的。时序参数矩可以视为时间t的函数。噪声抑制就是要产生一个估计(y)将噪声e从信号y中平滑掉，同时保持信号x的特征。当噪声e是不相关(包括空间不相关和与x不相关)的Gaussian噪声时，这变成了一个经典的统计估计问题。如果采用均方误差作为性能评价度量，则(y)的估值应使得最小。这又被称为最小化均方误差　(MSE)　问题。
2.1　SAR图象的斑点的统计特性
　　文献［2］分析了斑点噪声的统计特性，证明了当成象系统的分辨单元相对于目标的细节很小，且被斑点污染的图象采样间隔足够大，使得一个象素的降质基本上独立于其它象素的降质时，斑点噪声可模型化为一种独立的相乘性噪声。Arsenault［4］证明了SAR图象的数据值经对数变换后，斑点噪声近似为独立的Gaussian相加性噪声。因此SAR图象的斑点噪声抑制是一种最小化MSE问题。
2.2　基于小波分析的软阀值方法
　　假定成象过程模型为　　　yi=f(ti)+σzi,　　　i=1,…,n　　　　　　　　　　　　(2）
f是一个未知函数，ti是等间隔的点，zi是独立同分布的标准Gaussian噪声，σ为噪声的方差；则基于小波的噪声抑制方法可分为三步：
　　1)对数据集{yi}进行小波变换得到其小波系数wj,k。
　　2) 设定一个阀值(n为样本数)，对上一步得到的小波系数进行软阀值变换：
　　　　　　　　(3)
　　3)对(2)的结果进行逆小波变换，得到对原信号x的估计(y)。
　　基于小波分析的软阀值噪声抑制方法具有三个显著的特点：①与最小二乘法不同，信号的估计不引入任何与噪声有关的结构；②对于多数平滑性较好的信号，该方法得到的信号的估计具有近似的最小均方误差；③该方法可保留信号的边缘特征，视觉效果好。考虑一组不等距的样条节点分划：
Δ:T1＜…＜T5=t1＜…＜TN+2=tm＜TN+2＜TN+4
　　在选取样条节点Ti(i=1,2,…,N+4)时，要注意：
　　(Ⅰ)不能太大，根据我们的经验，在弹道的一、二、三级分别取h=3,5,8秒左右，h太小不能有效地减少参数，h太大不能保证逼近精度。如何充分发挥好每一个测量元素的作用，尽可能提高轨道参数的估计精度，是本文关心的问题。于是

综合上述，我们就得到了矩阵A1，A2，QS的估计。从理论上讲，一般利用六个测量元素就能确定弹道参数(x,y,z,,,)［1，2］。今后，正交小波的边缘问题如能得到解决，理论上正交小波基效果应更好；2)规则性(Regularity)。小波基的规则性与对应的滤波器组长度有关：滤波器组越长，规则性越好。小波基的规则性对最小化量化误差是很重要的，如果规则性太差，噪声抑制效果就不明显；但如果规则性太好，会平滑掉图象的细节部分，所以一般选滤波器组长度为4～9对应的小波基。
　　为讨论问题方便，以下我们考虑测元数量确定的情况。显然，变换级数还应与滤波器组长度有关。文献［5］选取了长度为4的Daubechies正交小波，变换级数取5，这只考虑了噪声抑制一个方面的要求。由于小波变换的边缘效应，数据压缩一般采用双正交小波基，且变换级数取3［1］。综合考虑噪声抑制和数据压缩两方面的要求，经多次实验检验，我们选取了长度为9的双正交小波，变换级数取3。
　　③阀值的确定：阀值的确定是本方法最关键的因素。一般情况下噪声的方差是未知的，需从数据中估计。文献［5］给出了几种方法，其中有一种取第一级小波分解系数的HH波段子图的方差作为噪声的方差，对所有子图以统一的阀值t=1.5～3σ进行软阀值变换。
　　对于这种情况，我们把t1,t2,…,tm时刻的数据分为若干个连续的时间段(5段以上)，每段不超过3秒。
　　但是我们知道经过小波变换后，噪声的能量大多集中在HH子图，因此噪声的方差也应取决于HH子图的方差。我们采用下面这种方法，实践证明其比较简单而且效果更好。取信号y的每一级二维小波分解系数的HH波段子图的方差作为噪声在该级的分解结果的方法。各子图的阀值取为ti,p=λi,b×σi,HH。记
X=(xij)m×N=(ψj(ti))m×N=(XT1,XT2,…,XTm)T,　β=(β1,β2,…,βN)T　　　　　(7)
那么由(2)、(5)、(6)式，并注意到A1，A2为对角矩阵，因而我们有：
(ti)=Xiβ+a(1)1［(ti-1)-Xi-1β］+a(2)1［(ti-2)-Xi-2β］+εS1(ti)　　　(8)
　　应用(8)式的非线性回归模型，可以给出参数a(1)1,a(2)1,qS11及β的估计。记
X=(xij)m×N=(ψj(ti))m×N=(XT1,XT2,…,XTm)T,　β=(β1,β2,…,βN)T　　　　　(7)
那么由(2)、(5)、(6)式，并注意到A1，A2为对角矩阵，因而我们有：
(ti)=Xiβ+a(1)1［(ti-1)-Xi-1β］+a(2)1［(ti-2)-Xi-2β］+εS1(ti)　　　(8)
　　应用(8)式的非线性回归模型，可以给出参数a(1)1,a(2)1,qS11及β的估计。
3　图象编码
　　我们采用了基于小波变换和矢量量化的压缩方法，关于这一方面已有许多文章作为详细的阐述［6］，本文不准备在重点讨论了。这里只谈谈两个应注意的方面。
　　首先，位分配(Bits Allocation)问题是基于小波变换的编码问题的关键因素。小波变换结果各波段子图的重要性是不同的，对重要的子图需要分配较多的位数(Bits)来表示。因此，在总位数一定的条件下，位分配问题是小波变换编码的关键。令Wi　(bi)表示对第i个子带分配Ri位表示时该子带的失真，D为总体失真，b为要求达到的总位数，R为实际总体比特数，即

这样，位分配问题实际上就是找到一组Ri,i=1,…,K使R≤b时，D最小。于是
(1)1(t)=1+2t+3t2,　T5≤t≤TN+2
同样，我们可以得到每个时变的时序参数的估计。详细推导请参考文献［6，7］
　　其次，高压缩比重构图象的失真是比较大的。为了克服这一问题，Niss［8］、Wu和Gersho［9］等提出了一系列的补偿方法。我们将图象重构引起的失真看作是由于图象重构过程中引入噪声而导致的，通过采用上一节讨论的噪声抑制方法，比较明显地改善了图象质量。关于这一点，作者已另文进行了讨论［10］。
4　系统整体描述
　　我们已在前两节讨论了基于小波分析的数据压缩和噪声抑制技术。显然，噪声抑制过程可以在如图1中虚线框所示的两上时刻进行。以1(t)为例，在每一个小区间上将S1(t)+a1用三次多项式表出，即
S1(t)+a1=g1+g2t+g3t2+g4t3,　T5≤t≤T6
设t1=T5,tl=T6，记
　　　　　　　　　　　(11)
类似模型(10)，我们可得到
　　(12)
使用4.1的方法，可以给出所有的时间序列参数矩阵Ai,Bi,Ci(i=1,2),QS,Q*,QP的估计。这样，我们就把数据压缩和噪声抑制统一在如图1所示的一个系统中。

图1　SAR图象噪声抑制与数据压缩综合系统
　　说明：图中的图象重构包括两步：小波综合与指数变换。
5　实验结果分析
　　图2(a)中的数据是法国巴黎近效的一幅SAR图象，图象中心点的经度为5∶26∶30E，纬度为53∶1∶45.7N，图中有三种比较明显的地物：树林、草地和水体。我们将前面的基于小波分解的软阀值噪声抑制方法应用于该图，下面是几种常用的斑点噪声抑制性能评价标准：
　　①标准偏差均值比(s/m)：s/m是用于衡量均质区域的斑点噪声大小的［2］。我们计算了上述三幅图象中三种地物的s/m值列于表1。
表1　三种地物的s/m值
　树林草地水体
原图1.29450.64532.3178
噪声抑制处理后图象1.01290.31241.7865
噪声抑制解码图象0.99140.31071.7903

　　②对数标准偏差：这个数值是直接影响标准的双参数恒定误报率算法(CFAR)的重要因素。三种地物的对数标准偏差值列于表2。
表2　三种地物的对数标准偏差值
　树林草地水体
原图4.89732.91743.1753
噪声抑制处理后图象3.83211.32971.6493
噪声抑制解码图象3.83301.32981.6512

由表可见，经过斑点噪声抑制处理，s/m值和对数标准偏差值都大幅度下降了，这表明主要的斑点噪声都已被抑制。亦即：e(ti)=1e(ti-1)+2e(ti-2)+ε(ti);这里{ε(ti)}是0均值的平稳正态白噪声序列，1,2为常数，并且满足平稳条件。
　　　　　
　　　　　(a)原图　　　　　　　　(b)量化前的噪声抑制处理图象

(c)量化后的噪声抑制解码重构图象(比特率：0.213bpp，PSNR：37.15dB)
图2　基于小波变换的数据压缩和噪声抑制结果
(下转第24页)
*本项研究得到国家卫星应用重点项目的支持
作者单位：国防科技大学自动控制系302教研室 . 长沙 . 410073
参考文献
1　Werness S A,Wei S C，Carpinella R.Experiments with wavelets for compression of SAR data,IEEE Trans.on Geoscience and Remote Sensing,1994,32(1):197-210
2　Goodman J W.Some fundamental properties of specklt.J.Opt.Soc.Am.,1976,66(11):1145-1150
3　Guo H,Odegard J E，et al.Wavelet Based Speckle Reduction with Application to SAR Based ATD/R.Proc.ICIP,Austin,TX,Nov,1994
4　Arsenault H H，April G.Properties of speckle integrated with a finite aperture and logarithmicaly transfomed.J.Opt.Soc.Am.,1976,66(11):1160-1163
5　Donoho D L.De-noising by soft-thresholding.IEEE Trans.on Inform.Theory,1995,41(3)：613-627
6　Cosman P C,Gray R M,Vetterli M.Vector Quantization of Image Subbands:A Survey,IEEE Trans.On Image Processing,1996,5(2):202-225
7　Shoham Y,Gersho A.Efficient Bit Allocation for an Arbitrary Set of Quantizers,IEEE Trans.On ASSP,1988,36(9):1445-1453
8　Niss B.Prediction of AC Coefficients from the DC Values.ISO/IEC JTC1/SC2 WG8 N745,May 1988
9　Wu S W，Gersho A.Enhancement of transform coding by nonlinear interpolative.Proc.SPIE Visual Commun.Image Processing,1991,1605:487-498
10　李强，王正志.基于小波分析的解压图象增强方法的研究，待发表
收稿日期:1997年7月14日
修回日期:1997年12月22日
