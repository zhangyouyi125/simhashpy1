环境技术
ENVIRONMENTAL TECHNOLOGY 
1999年  第4期  No.4 1999



VSS算法用于抑制心电图中50Hz干扰
杜丽冰 
摘要：由于可变步长LMS(VSS)算法能有效地改善LMS算法存在的收敛速度与收敛误差之间的矛盾，因此可以显著地提高对干扰的抑制性能。为进一步改善心电图（ECG）中的50Hz干扰的抑制性能，本文应用VSS算法。
表３国外天然曝露试验情况摘报
序号曝露试验场投试样品试验情况
1美国、英国、比利时、法国、瑞典、德国、日本和南非的工业环境、农村和海洋环境 100×150毫米Cor-TenA钢、Cor－TenB钢、含铜轴承钢和碳素钢等 分别以朝北、朝南30°和朝北、朝南90°四种方式放置样品，考验其在不同国家的三种环境条件下的性状。
表2国外曝露试验场的分类
类别功能
1只有少数固定人员和少量检测仪表和设备，负责样品检测，作好记录，不写试验报告，或由委托单位定期派员来曝露试验场检测样品。试验结果：在腐蚀生成物层未完全形成前，潮湿时间起着支配作用；在腐蚀生成物层完全形成 后，氯化物离子的影响非常大
4 阿根廷六个曝露试验场铝和锌经不同天然环境曝露试验后，以样品失重考核其腐蚀程度。为更有效地抑制50Hz干扰，在[1]中采用了变动量LMS（VMS）算法，通过计算机模拟实验，在相同条件下分析比较了LMS和VMS算法的抑制性能。从结果表明VMS算法较之LMS算法收敛速度改善了近一半，但收敛误差仅改善了1.8dB，因此抑制性能还不够理想，故本文提出采用VSS算法［2］以进一步提高抑制性能 。
15新西兰不同环境曝露试验场几种涂装了醇酸、丙烯酸和丙烯酸／醇酸涂层 的木材自１９８９年以来进行大规模的曝露试验。
2ＶＳＳ算法
　　本文仍采用[1]中的最简单的两个权的凹口滤波器自适应干扰对消器（AIC）抑制ecg中的50Hz干扰，它的结构如图1所示。

おおね1AIC的原理图 
　　图中原始输入d(t)=S(t)+no(t)，  
其中S(t)为ECG信号，no(t)为50Hz干扰，AUC中的自适应滤波器（AF）的参考输入为50Hz的干扰源n1(t)=X(t)，它们均以取样周期T取样，在k时刻的取样值分别为Sk、nok、n1k、dk，Sk与nok、n1k不相关，但nok与n1k相关，这里考虑两者的幅度有关。
　　AIC的输出或误差信号ek=dk-yk，其中
　　yk为AF的输出，W1k、W2k为权值取样值。1906年，美国有人在亚利桑纳进行涂料的天然曝露试验。 
　　VSS算法使步长因子随e2k变化而变化，权值调整公式如下［２］ 
　　Wk+1=Wk+μkＸkek (1)
　　μk+1=αμk+γe2k(2)
其中0＜α＜1，γ＞0
 由(2)式可见，μk总为正，并由ek和两个常量α、γ来控制。在权值调整开始时， ek较大，μk也较大，以快速跟踪达到快速收敛。收敛后ek减小，μk也随之减小，失调也减小。衡量收敛误差的稳态失调M经推导为
　　M=(1-B)/(1+B) (4)
其中B=［1-2tr［R］(3-α)γξmin/(1-α2)］1/2 
其中ξmin为均方误差MSE=E［e2k］=ξk的最小值，tr[R]为R的迹，R=E［XkXTk]。由（2）式可见，M随着α和γ减小而减小。为使M小，α、γ应尽可能小，但为保证跟踪的自适应能力，也不能太小。1939年，又改为45°角曝露试验，并被多数科研试验人员沿用至今。初始步长μo选为μmax，μmin的选择以提供最小跟踪能力，通常按LMS算法中的μ值。1939年，又改为45°角曝露试验，并被多数科研试验人员沿用至今。 
3计算机模拟及分析
　　为便于与LMS算法和其LMS改进的算法的抑制性能比较，模拟中仍采用稳态平均相对误差SMRE或输出噪信比NSR。来衡量，即160次迭代的10lg(ek-sk)2/s2k(dB)的平均值。采用的参数与[1]相同，即取样频率fn=1/T=200Hz，输入信噪比为-5dB，ECG的等效幅度为0.113858,n0=0.286337，n1=c=1.030814,no、n1为no(t)、n1(t）的幅度。不同参数α、γ时的收敛曲线如图2所示。由图2曲线可见，曲线①最佳，此时α1=0.986601,γ1=0.00065,AIC的输出波形如图3所示，图3波形基本上与AIC的输入心电图S(t)的波形一样，说明心电图中的50Hz干扰基本上完全被抑制，此时AIC的SMRE=-33dB，收敛迭代次数为640。铜的腐蚀情况相反，棚下要比露天严重一些。 
　　　　　　
图4SMRE相同   　　　　　　　　　　　　图5收敛迭代次数相同
　　图4、图5中曲线2是变步长变动量因子LMS算法（VSVMS），由于此算法的运算量最大，且抑制性能较差，不适合用于抑制ECG中50Ｈz干扰，所以本文中不进行讨论。由图4、图5可得到三种算法的抑制性能列于下表1，在表中也比较了它们的运算量和调节参数。
　　・法国约有曝露试验场30个，其中包括世界上海拔（4843m）最高的曝露试验场。
2有一定数量的检测人员和配备必需的检测仪表和设备，负责样品检测，作好记录，并按要求编写阶段报告和结束报告。
　　王晋龙、倪敬华、陈学、宋鸿升等同学参加了模拟实验，在此表示感谢！
参考文献：
[1]杜丽冰．改善ECG中50Hz干扰的抑制性能[J]．环境技术，1999年，(1)，P8～10
[2]R.H.Kwong & E.W.Johnston, A Variable Step Sije LMS Algorithm［Ｊ］. IEEE.SP-40,NO.7,1992,PP1633～1642〗 
作者简介：杜丽冰(1937-)，女，江苏江阴人，教授，主要从事通信理论、通信与电子系统的电磁兼容和じ扇乓种频慕萄Ш涂蒲泄ぷ鳌
作者单位：北京邮电大学电信工程学院171信箱， 北京100876）
收稿日期：1999-07-09
