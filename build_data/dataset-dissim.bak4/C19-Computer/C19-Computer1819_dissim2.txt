微型机与应用
MICROCOMPUTER & ITS APPLICATIONS
2000　No.19　No.1　P.54




关于Office 2000 
　　Office 2000 Office 2000在支持编程开发方面有哪些新特点？
　　1．支持对病毒的防护。″，Exclamation。同时Office中也有内置的病毒检查工具。
　　2．为宏添加数字签名以提高安全性和用户的安全感。开发人员可以为其Visual Basic for Applications （VBA）宏签名，这样用户便可以知道宏的来源以及它们是否被改动过。用户可以指定对于有特定开发人员签名的未经改动的宏不显示警告信息。 
关键词： 打印机 注册表 动态设置
1 问题的提出
　　在许多应用系统中，常常需要打印各式各样的票据和报表，它们经常是没有统一的格式，所需的打印纸也就大小不一，有的甚至有专用的格式。第2项为打印纸设置有关的项目，其注册表入口为：HKEY＿LOCAL＿MACHINE\System\CurrentControlSet\Control\Print\Printers\SETPRINTER，其中的SETPRINTER要替换为你所安装的打印机的名字，如Epson LQ－1600K等，这一分支有许多个项，最关键的项(也是与打印纸张设置有关的项)是Default DevMode，此项的设置值为1个二进制串，其中主要的几个参数的偏移地址和意义见表1。
进纸方式0x3920x04-手动送纸，0x08-传纸器。（1）共享Add－In结构。在统一的插入模式下，利用Microsoft Office COM加载项，开发人员可建立Office集成的解决方案。（2）Microsoft Office反病毒API。
表1 打印机参数表

设置项目偏移量字节数说明
纸张设置0x2F2打印机纸张类型，256为用户自定义纸张，小于256的数值为该打印机能打印的标准纸张的编号，随打印机类型改变。这种方法的缺点是每次打印时还要去选择1个逻辑打印机，增加了操作人员的操作步骤。（3）基于应用程序的Visual Basic（VBA）宏数字签名。为了提高安全性和用户满意度，开发人员可以通过宏签名来保证他们不受病毒影响。具体应用时，可以用第1个函数将打印设置为我们需要的状态，并将打印机的原状态保存起来，再用第2个函数将打印机状态恢复。
2 动态设置打印机
　　在WINDOWS 95环境下，与计算机设置有关的信息全部记录在注册表(REGISTRY)中。运用此方法开发打印程序，打印时用户只需往打印机中加入适当的纸张即可打印出正确的报表。（6）Microsoft脚本编辑器。，
　　　　　lb＿newvalue)
if li＿ret＜＞1 then return 0
return 1 
　　本文所提供的程序在1台内装WINDOWS 95操作系统的PentiumⅡ266计算机上用PowerBuilder 6．0和Epson LQ－1600K打印机调试通过，并在我们开发的MRP/ERP系统中得到应用，效果良好。
