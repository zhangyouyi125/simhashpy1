计算机应用
COMPUTER APPLICATIONS
1999年 第19卷 第9期 Vol.19 No.9 1999



可以动态修改的数据库系统
王臻
　　摘　要　本文介绍了利用PowerBuilder6.0的动态（Dynamic）数据窗口(DataWindow)技术修改数据库的列属性名称，并且保存所做修改的办法。
　　关键词　数据窗口，对象，数据库
　　在实际的数据库开发中，用户往往会有这样的要求，他们希望能够根据企业（公司）环境的变化实时对数据库的列属性名称进行调整。整个过程实际上是在客户端建立了一个类似于串口的PPTP虚拟接口，如图2所示。这就要求数据库系统有良好的灵活性和可扩充性。Cisco公司提出了企业级VPN解决方案，它通过一系列的VPN安全功能来实现安全保障，包括隧道技术、加密技术、分组验证、防火墙、用户认证等。
　　企业内部网VPN（Intranet VPN） 这种功能可通过Internet 将远程分支与中心Intranet 连接起来。同时，定义一个附加的保存表，将这些列属性名称的修改信息保存在该表中。这样可以使此次所做的修改可以保存到下次修改为止。例如，通过带认证的域名解析系统（authenticated Domain Name System）实现基于DNS的VPN等。
　　通过动态地创建数据窗口对象中的对象、设置数据窗口对象的属性以及数据窗口对象中对象的属性、访问数据窗口控制中的数据可以达到修改数据窗口外观的目的。VPN中的发送主机将需要路由的数据发送给发送端的VPN网关，由该网关对发送数据进行加密，并把这些数据封装在发往接收端网关的IP数据包内。目前，IBM的2210、2212及2216系列产品已能支持IPSec、IKE(Internet Key Exchange)、 L2F、L2TP、X.509 数字认证协议等多种VPN协议，为VPN的建立提供了良好的解决方案。
3　设计步骤
3.1　定义表结构
　　在PowerBuilder6.0的数据库画笔（DataBase Painter）中定义表结构。在该协议中，客户机首先拨号到拨号服务器，与拨号服务器建立基于V.X Modem协议的链路层连接；拨号服务器识别该连接请求后，根据其上的配置建立与远端的L2TP服务器之间的L2TP隧道，然后在此隧道上，客户机与远端L2TP服务器之间进行PPP连接，成功后，L2TP服务器为客户机分配一个VPN内部IP地址。
　　. 为职员信息表（personnel）定义数据窗口对象d―personnel，PowerBuilder6.0自动将列的相应文本对象（用于显示列的header及label值）命名为:
Per―id―t 
Per―name―t 
Per―department―t
　　可以通过修改这些文本对象的text属性达到修改列属性名称的目的。路由过滤技术既保证了属于同一集合中的各子网间的路由互通， 同时，又将本集合中的子网与连接在同一公用网络平台之上的其他子网进行了有效的隔离，从而将该集合中的各个子网组成一个虚拟专用网络。
　　缺点：
　　. 难于管理
　　IP隧道需要手工建立，技术要求较强，因此，IP隧道一般由专业ISP提供。
3.3.1　定义职员信息窗口
　　. 定义职员信息窗口对象w―1；
　　. 在窗口上放置数据窗口控件dw―1，并将之与数据窗口对象d―personnel相连接，dw―1的显示属性设置为visible；
　　. 在窗口上放置数据窗口控件dw―2，并将之与数据窗口对象d―define相连接，在窗口画笔中将dw―2的显示属性设置为invisible。
　　W―1的open事件的处理程序为：
　　{ 
dw―1.settransobject(sqlca)
dw―2.settransobject(sqlca)
//dw―2为隐藏的列属性名称的保存表
dw―1.retrieve()
dw―2.retrieve()
dw―1.object.per―id―t.text=dw―2.getitemstring(1,1)
dw―1.object.per―name―t.text=dw―2.getitemstring(1,2)} 
dw―1.object.per―department―t.text=dw―2.getitemstring(1,3) 
} 
　　. 在窗口上放置按钮控件“修改列属性名称”（cb―1）
　　cb―1的clicked 事件的处理程序为： 
　　{ open(w―2) 
// 用于弹出3.3.2中创建的列属性名称保存窗口w―2
}
　　w―1窗口的外观如图1。

图1
3.3.2　创建列属性名称保存窗口
　　. 创建列属性名称保存窗口对象w―2；
　　w―2的open事件的脚本程序为： 
　　{ 
dw―2.settransobject(sqlca)
dw―1.retrieve()
} 
　　. 在窗口上放置数据窗口控件dw―1，并将之与数据窗口对象d―define相连接。
　　. 在窗口上放置按钮控件“保存”（cb―1），cb―1的clicked事件的脚本程序为：
　　{ 
if update(dw―1)=1 then 
commit ;
messagebox("ok!","成功保存!")
else 
rollback ;
messagebox("pity!","保存失败!")
end if
}
　　w―2的外观如图2。
　　优点：
　　. 良好的专用性和安全性
　　VPN虽然借用了公网中的网络地址和路由，但由于采用了IP隧道技术和加密技术对VPN中的数据包进行再封装，公用网对VPN只相当于一个廉价的虚拟物理链路平台；通过该平台构建的虚拟专用网在专用性、安全性及私有性等方面与传统的封闭型专用网几乎可以媲美。
作者简介：王臻　硕士研究生。主要从事计算机软硬件环境、MIS及数据库应用系统的研究开发工作。
作者单位：中国科学院空间中心四室　北京（100080）
收稿日期:1999-06-18
