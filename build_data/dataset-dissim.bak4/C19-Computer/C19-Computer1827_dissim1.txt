微型机与应用
MICROCOMPUTER & ITS APPLICATIONS
2000 Vol.19 No.2 P.13,54




ASP实现主页计数器的二种方法及其改进
张子贤
摘 要： 以二个具体的程序剖析了利用ASP技术实现主页计数器的原理，并对目前的二种方法进行了适当的改进。
关键词： 主页计数器 Active Server Pages Session组件
　　大多数网站的主页内容少不了3大部件：计数器、留言簿和联系方式如Email地址、联系电话等。然而由于计数器标志着本网站主页被访问的频度，因此在一个网站的主页内容中的位置显得比后二者重要，实现一个美观大方而又有个性的计数器是大多数网站管理员的所求。由于受Sybase数据库数据完整性的制约，如果传输次序不正确，容易造成某些表的整表数据或一些表的部分记录的丢失。首先要组织好源数据，之后建立数据管道，最后用程序调用数据管道。大家知道，1个表只能设置1个主码，且主码值必须唯一，即表中的记录由主码值唯一确定；外码是在建立关联的过程中由非主码的字段定义的，其值或者设置成空值，或者等于对应主码值，此即数据的参照完整性。
　　数据表可分成2大类，一类是由有主码而无外码的数据表组成，其中包括主码与其它表的外码没有关联及主码与其它表的外码有关联二种情况；另一类是由既有主码又有外码的数据表组成，其中也包括主码与其它表的外码没有关联及主码与其它表的外码有关联二种情况。
　1．方法1省略HTML源码



　　目前的网站计数器或者大多数ASP教程所讲的计数器实现方法大都不会脱离这二个源程序的模式，但是利用这二种方法实现的主页计数器运转起来有一个很明显的特点：只要指向包含该主页计数器文件的程序段的超链被触发，或者说只要该程序段被执行1次，而不管这是不是简单的“返回主页”操作，计数器文件就会自己＋1。这样，主页的计数器就会增加得很快。这是一个开放的对象关系型数据库管理系统，可为用户提供1个高性能、开放的、分布式的、端到端的体系结构，能满足网络中关键任务的专业化应用开发需求。针对这个问题，利用Active Server Pages的1个内置的组件Session，对上面2个源程序进行改进，解决了原来程序存在的缺陷。下面是改进后的源程序。

图1　数据表的向下关联全图
　　具体实现时，采用的方法是根据数据表向下关联全图，利用拓朴排序算法编程，自动产生表传输顺序，也允许用户人工制订次序。这二种改进均能达到避免主页计数器盲目＋1的操作。此外，如果是利用第一种方法来实现主页计数器的话，可以把相关的程序段写到global．asa里，然后直接在程序中进行调用（关于global．asa的知识点这里不进行讨论）。
　　目前，Active Server Pages技术已经在绝大多数的网站中得到广泛地应用，如果能更深入地钻研这方面的技术，相信对网站的开发会有很大的用处。
3 数据表排序
　　数据库管理系统所进行的数据完整性检验，主要有单表的数据一致性检验和多表之间的关联一致性检验