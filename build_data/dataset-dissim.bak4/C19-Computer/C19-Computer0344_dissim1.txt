计算机应用
COMPUTER APPLICATIONS
1999年 第19卷 第9期 Vol.19 No.9 1999



轧钢监测诊断系统的研究
黄　史铁林　何岭松
　　摘　要　本文针对轧钢生产过程的自动化、智能化，开展了轧钢生产线特别是关键轧机的监测系统研究，讨论了系统组态软件特征，构造了系统结构和配置，制定并完成了网络实时数据传输方案。一个知识库是由各种对象组成的树型结构。在走向CIPS的过程中，其关键设备――大型轧钢设备正向着大功率、高速、强载、高自动化、智能化的方向发展，结构越来越复杂，功能越来越完善。因此开展对轧钢生产线轧机的监测研究具有非常大的经济实用价值，采用流行的Intranet网络技术又给监测实现方式带来新的惊喜。
1　系统的组态软件特性
　　轧钢监测诊断系统的性能在很大程度上依赖于运行的软件系统。早期的监测诊断系统的软件功能，是靠软件专业人员通过编程实现的，工作量极大，不同的部门需要对系统软件作不同的修改，以满足该部门工作的需要。这种工作对专业软件人员来说是一种重复劳动，同时加大了系统维护成本，减弱了应变能力。随着监测诊断系统的发展，人们越来越重视系统的“软件组态和配置”功能(如图1所示)，并有如下经济价值：


图1　组态软件结构框架
　　. 与一般的监测诊断软件的结构框架基本相同，适用于不同企业、不同类型的轧钢过程监测，有更多的软件灵活性。“组态软件”提供了灵活的组态工具和面向对象的模块，以适应不同的轧制过程。
　　. “组态软件”提供了良好的人机交互界面，它可提供各种图形编辑工具、参数定义组态界面等，使系统功能有易于实现，从而加快监测系统的开发速度，简化了系统的维护功能。
　　. 系统的应用软件直接影响整个监测诊断的诊断精度。采用“组态软件”能使开发人员把更多的精力投入到系统诊断方案的设计上，建立完备的知识库，选择合理的推理规则，设计最佳的诊断方案。
　　. “组态软件”提高了系统的可靠性。组态软件工具一般是由有数年实践经验的程序员完成，其代码经过周密的设计，经过严格的测试，相对某一特定的系统可靠性高，并经过现场实际运行，其稳定性、可扩展性较好。
　　轧钢监测诊断系统的组态内容主要包括：
　　系统定义组态：对监测诊断系统工作环境、工作任务和自身性能进行描述信号。
　　采集组态：采集站名称、IP地址、采样方式、采样频率、采样通道数等。
　　数据库组态：对测点特征的详细描述信号数据结构的详细内容。
　　监测组态：将数据源同某一控件组合，包括控件的大小、位置、数据源、数据更新时间等。
　　分析组态：提供波形分析、相关分析、频谱分析、谱阵分析、轴心轨迹分析和数字滤波分析等常用信号分析模块，用户可在此基础上用组态的方式快速构造新的分析方法。
　　报表组态：提供基本的报表格式，报表内容包括文字、图表( Excel)和波形(BMP)。用户也可自定义报表格式。
2　系统结构与配置
　　轧钢监测诊断系统采用先进的Windows NT网络结构，工程师站、数据库服务器运行在Windows NT软件平台上，采集站和监测站运行在Windows 95软件平台上，其系统结构如图2所示。图中采集站选用工控机集中安放在电缆沟里，数据库服务器、工程师站和监测站选用高档微机，安放在集中控制室，用Hub将分布在这两处的计算机连接在一起，并与企业网相连。

图2　轧钢监测诊断系统结构
2.1　采集站
　　采集站所测量的信号主要有：测力系统(扭矩、轴向力、扭振等)，液压系统(模拟量、慢变量、开关量、数字量等)，振动系统，工艺量和电气系统(温度、转速、轧制力等)。系统各采集站应同步采集有钢和无钢信号，这样才能进行全面的对比分析。通过受载信号和卸载信号，判断轧机有钢和无钢状态，然后向各采集站发布统一的外触发信号启动和停止各采集站A/D板工作。信号采样方式初步分为巡检采样模式、高速巡检采样模式和高速连续采样模式三种。
　　采集站采集 的数据可按实时传输和集中传输两种方式向外发送，实时传输将数据写盘换为网络数据发送，由于网络数据发送速度远大于信号采集速度，故可以可靠的实现实时采样数据传输，该方式用于巡检采样数据的实时传输。电气信号采集站要求有72小时黑匣子记录功能，黑匣子通过设置文件存储缓冲区方式实现，初步设置的文件存储缓冲区为2160块钢的采样文件，每记录一块新钢的数据则将最老的一块钢数据删除。它采用集中传输方式，当一块钢数据采集完成后可用FTP进行一次性网络数据传输。
　　应用软件为用于实时网络命令收发的数据报服务器程序、用于采样数据集中传输的FTP服务器程序和信号采集等程序。每一个对象可以有三个方法：先序方法，中序方法和后序方法。它是系统的调度中心，设计成为“一机双屏”，两个显示屏的实时数据、图形可相互切换，以提供尽量多的信息，便于监测管理人员工作。OKPS是我们自主开发的一套可视化专家系统工具。
2.3　数据库服务器
　　采集的数据通过网络实时送往数据库服务器中保存，主要是对数据进行管理，对用户进行分类，设置不同的访问权限，执行各种数据库操作并负责返回结果，同时对外提供采样数据访问服务的Web服务器程序，由于数据库服务器的数据吞吐量较大，工作任务繁忙，可设置备份数据库。第二层有三个结点，分别对应该专家系统所要解决的三部分需求，即求总许可捕捞量（TAC）或评估最大持续产量（MSY），评估渔业资源量、可捕量或进行产量预报，以及控制总捕捞努力量，确定开捕年龄tc、捕捞努力量水平（即捕捞死亡系数）。
2.4　监测站
　　监测站主要对设备运行状态进行监测，对超门限值进行报警，可在企业网的任何位置上，主要通过浏览器浏览设备运行状况，领导和相关技术人员足不出户便能了解关键设备的状况，便于科学管理与决策。采用了Web技术，最大限度地发挥了软件扩展优势 ，使该系统便于迅速扩展。
收稿日期:1999-03-15
。
　　轧钢监测诊断系统采用VC++和VJ++开发，网络监测及查询由嵌入页面的Java小程序构成。轧钢监测诊断系统的主体软件有：
　　系统组态模块；采样数据库管理；监测模块；报警模块；制表报表模块；网络传输模块；接口模块。
　　这些模块挂接在基本模块上，每个模块互相独立，这样提高了系统的可靠性和可扩展性。同时提供模块的接口标准，允许用户自行开发需要的功能模块。基于以上的设计思想，在宝钢热轧F2轧机监测系统中初步实现。
3　系统的技术特色
　　该轧钢监测诊断系统采用浏览器工作模式，所有监测、分析、诊断软件都放在WWW服务器上，并通过WWW主页进行管理。用户通过主页访问WWW服务器，并启动内嵌在主页中的DHTML、Java或JavaScript程序，然后由这些内嵌程序提供监测、诊断服务。访问某一主页则自动下载并启动其中的程序，离开该页面则程序自动删除。如图3所示。

图3　系统工作原理图
　　监测系统工作过程中通过网络交换命令和数据，图4是系统运行中的数据流图。系统工作过程为用户从任一监测站的浏览器向工程师站发布命令，若是数据请求命令则工程师站立即返回数据，若是控制命令则工程师站校验用户身份后再对命令进行转发。

图4　系统数据流程图
　　系统监测站到工程师站采用HTTP方式交换命令和数据，这样可保证系统的对外开放性，任何连网计算机终端都可对轧机工作状态进行监测。工程师站服务器、数据库服务器和信号采集站之间采用数据报方式传输命令和数据，以保证信号采集层数据传输的效率。
　　本系统中大数据量采样数据的实时传输是一个难题，为了实现采样的实时传输，利用Winsock自行设计专用的数据报程序，并将其嵌入到信号采集程序中；利用A/D板的双缓存采样模式，设计双线程程序，一个线程用于双缓存信号采集，另一个线程用于双缓存网络数据发送。在A/D板采集的同时，主机发送上一个采样模块的；由于网络数据发送速度远大于信号采集速度，故可以可靠的实现实时采样数据传输，远端信号延迟=采样间隔*缓存点数。主要研究方向：人工智能、智能软件、神经计算。则因不能嵌入到信号采集程序中，无法利用A/D板工作时的主机空闲时间，必须等采样完成后再集中传输，导致传输效率低下，而目前许多商业网络数据采集系统还采用这种方式。
4　系统的其他特点
　　该轧钢监测诊断系统的系统界面选择主页形式，图形界面采用JavaScript设计成可点图像页面，直接用设备图做背景，点击一部件或设备则启动该部件或设备的监测诊断画面，文字界面采用超链接设计，并用图标做装饰。
　　关键词　专家系统, 知识处理, 面向对象, 渔业资源评估
AN APPROACH TO IMPLEMENT A FISHERY RESOURCE 
ASSESSMENT EXPERT SYSTEM
Tan Ning　Lu Feng　
Graduate School, University of Science and Technology of China, Beijing 100080
Shi Zhongzhi
Institute of Computering Technology,Chinese Academy of Sciences, Beijing 100080
　　Abstract　This article introduces how to implement computer evaluation of fishery resources in Chinese East Sea by using an expert system. This expert system is constructed with Object-oriented Knowledge Processing System (OKPS), which is an expert system tool developed by us. The article focuses on the principles of OKPS and the expert system, rules of model selection, structure of the knowledge base, and so on.
　　Keywords　Expert system, Knowledge processing, Object-oriented, Evaluation of fishery resources
　　本文所讲述的渔业资源评估专家系统，是国家863项目《海洋渔业遥感信息服务系统技术示范试验》（课题号863-818-07）中03子课题的一部分。
　　先进性：系统的硬件配置和软件结构设计都采用了目前国际主流技术和规范，便于今后扩充与升级。
史忠植　研究员，博士生导师。系统的主要功能和特点是：
　　采用面向对象的知识表示方法　知识表示是指用计算机表示知识的可行的、有效的、通用的原则和方法。
作者简介：黄　在职硕士研究生。
总许可捕捞量（TAC）或评估最大持续产量（MSY）

控制总捕捞努力量
确定开捕年龄 tc、捕捞努力量水平（即捕捞死亡系数）

评估渔业资源量、可捕量或进行产量预报

3　系统实现
3.1　知识库结构
　　根据上面总结的规则，我们可以建立起基本的专家系统知识库，其结构如图3所示。
史铁林　教授，博士生导师。
何岭松　副教授。
作者单位：华中理工大学机械学院　湖北.武汉（430074）
参考文献
［1］　叶　.基于Web的应用系统开发.计算机世界，1998；18(17)
［2］　王华强.工控组态软件功能分析和应用实例.电气自动化,1998;(4)
［3］　张宝社,等.Windows界面下的网络编程.合肥：中国科学技术大学出版社,1997,4
收稿日期:1999-03-09
