计算机应用
Computer Applications
1999年 第19卷 第7期  Vol.19 No.7 1999



VAX/VMS与Windows NT间实时文件传输的一种方法
刘鲁川

　　摘　要　作者结合工作实际，论述了FTP服务器的安装配置、客户端的具体操作、改交互的FTP命令为批处理命令和如何在应用系统中实现异种操作系统间的实时文件传输。
　　关键词　FTP，VAX/VMS，Windows NT，实时文件传输

1　问题的提出
　　TCP/IP是网际互连协议，其协议簇中的文件传输协议FTP，具有适用范围广、通用性强、操作简单的特点。但用FTP进行不同操作系统间的文件传输，必须人工干预，在交互状态下完成。由于我们的系统涉及了较多的数据库操作，就必然要使用到JAVA连接数据库的JDBC技术。济南铁路局计算中心有DEC VAX系列机6台，VMS操作系统，其上运行着铁路运输统计报告、精密统计、货运计划、货票传递等系统。
　　传统的答疑一般采取类似于医院里专家门诊看病的形式，由任课教师定期在固定地点"坐堂"，接待前来答疑的学生并解决他们的"疑难杂症"。本文中简称之为DECnet网。这种方式存在着不均衡、不充分、不灵活和效率低等缺点。在济南铁路局机关办公自动化系统建设中，我们采用了IBM PC Server为Windows NT Server服务器，各处室现有PC机为客户机的client/server体系结构。由此产生的问题是，由于各种生产信息均在DECnet网上，为满足局机关各级管理人员及时了解生产情况的需求，必须使办公自动化局域网与DECnet相连，并实时地无须人工干预地自VMS向NT server传输数据文件。　　
2　传输方案
　　通过TCP/IP协议可实现不同机种、不同操作系统的互联。
作者简介：印 女，27岁，讲师，主要研究方向为面向对象的程序设计和Internet上的数据库开发应用
作者单位：清华大学计算机信息管理中心北京100084
参考文献
1　Thomas M,Patel P,Hudson A,et al.熊伟华译.Java for Internet编程技术.北京：电子工业出版社, 1997-11
收稿日期：1998-08-03
。整个系统的模块结构可以用图4表示。为此，需在VAX/VMS端安装配置TCP/IP for VMS, NT server 端安装配置FTP，系统配置如下图所示。　


3　FTP服务器的安装与配置
　　在安装与配置FTP服务器前，首先应确保基于TCP/IP协议的局域网、广域网已正确安装，与此相关的参数、文件已正确设置，使用ping 命令测试网络能够正常运行。
　　a） 在VMS系统下，很容易实现FTP服务。只要基于TCP/IP协议的网络功能已完整安装并能够正常运行，该机器就可以作FTP服务器使用了，无须任何额外设置。
　　b） 在Windows NT Server 4.0中实现FTP服务。
　　(2)JAVA是跨平台的编程语言，用它编写的CGI程序可以工作在不同的服务器上。

图3 JDBC基本结构
　　可见JDBC主要包括JDBC API，JDBC Driver API和各种JDBC驱动程序，它是JAVA程序通过因特网访问数据库的接口。安装完FTP服务以后，要进行必要的配置。主要选项有：最大连接数、空闲超时时间，这两项选缺省值即可；宿主目录用以指定FTP客户连接后要进入的初始目录；不允许匿名连接，只允许用户使用Windows NT的注册帐号来登录。
　　* 双击FTP服务器图标，单击安全按钮，设置各磁盘分区的读写权限。
　　* 双击FTP服务器图标，选中FTP Server将FTP的启动类型设为“自动”。
　　重新启动机器后，该机器便可实现FTP服务了。　
4　 FTP客户端的具体操作
　　一旦启动安装、配置好的FTP服务器，在客户端就可以使用FTP命令存取FTP服务器上的文件了。FTP客户程序在以上两种操作系统下具有统一的操作界面，使用起来很象DOS下的命令解释程序COMMAMD.COM。1998年被称为是JAVA在服务器端大量应用的一年，这与JDBC技术的广泛使用是分不开的。
　　利用FTP传输文件的过程很简单。首先使用open命令与FTP服务器建立连接，若连接成功，系统则提示输入用户名、用户口令，口令验证通过后，FTP客户成功注册到FTP服务器上。这时可使用cd命令切换目录，使用put命令将本地文件传输到FTP服务器上，也可使用get命令从FTP服务器上下载文件，文件传输结束后，使用quit命令退出FTP 。
　　在我们的网络答疑系统中，采用了服务器端JAVA语言编写的CGI程序和客户机端Java Script编写的脚本语言相结合的模式。设定本方案中NT server的Host name为JNOV3B ，以下脚本打开一个Host name为JNOV3B的连接，作为一个帐号、口令均为guest的客户登录到NT server上，卸载FILE1文件，然后退出。
　　Open JNOV3B
　　Guest
　　Guest
　　Put FILE 1
　　Quit
　　在VAX/VMS下必须使用-S选择项来读该文件。如果先前的脚本是在称为test.scr 的文件中，可以通过输入ftp -s：test.scr来启动该脚本。在NT server一端向VMS端卸载文件道理亦然。
　　实时文件传输　文件的实时传输是通过在VAX/VMS下编写的TRF.EXE　进程来实现的。网络答疑系统是利用网络来沟通教师和学生，无论是学生提问还是教师解答，都需要主动的参与性的活动，所以我们采用了三级的系统体系结构来开发和实现交互式的网络答疑系统，如图2所示。
　　刘鲁川　硕士，工程师。从事MIS开发、Internet/Intranet系统集成、网络配置与管理等工作。
　　作者单位：刘鲁川（山东财政学院网络中心　山东．济南 250014)
参考文献
［1］　TCP/IP培训教程. 北京：人民邮电出版社，1998，3
［2］　WindowsNT安装与配置. 北京：清华大学出版社，1998，5
　　收稿日期:1999-01-19
