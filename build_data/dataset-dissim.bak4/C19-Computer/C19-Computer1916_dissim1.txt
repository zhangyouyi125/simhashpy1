微型机与应用
WEIXINGJI YU YINGYONG
2000　Vol.19　No.5　P.57-58




在中文VFP6．0中使用OLE自动服务
李元
摘 要：使用OLE自动化服务在VFP中调用Excel或Word，完成报表的制作。
关键词：OLE VFP数据库应用软件 报表制作
　　制作各种各样的报表是Visual FoxPro6．0数据库应用程序设计必不可少的任务。
　　（2）BBS软件的获取
　　BBS软件属于自由软件，没有版权的限制，也不需要任何费用。本文以Linux为例，讲述BBS站点的安装和设置过程。
　　Firebird BBS、Maple BBS等各种BBS软件可以从下面的地址获得：
　　ftp：／／ftp．whu．edu．cn／pub／Linux／bbs／
　　解压后会自动在当前目录下建立1个目录bbs＿src，内含bbs程序和各种工具程序。下面简单的例子说明如何在VFP应用软件运行中将数据库中的数据交给Word来完成1个报表的制作。
　　为简单起见，假定在1个VFP项目中有关于科研经费开支情况的数据表：kyjf．dbf（其中不录入合计数），如表1所示。
表1 科研经费开支情况表
费用项目一季度二季度三季度四季度合计
科研材料1500200020004000　
科研出差3000300040004000　
其它费用15001200140001100　
合计　　　　　

　　我们希望在VFP的这个项目运行时，调用Word来制作这个数据表的“科研经费开支情况报表”，并在处理时自动计算合计数，最后将报表以Word文件存盘。下面的程序Word01．prg实现了这些要求。程序中用CreateObject（）函数启动Word，并新建1个Word工作稿（用通常方式或模板方式均可），先设置报表的标题，然后根据数据库的字段与记录在这个文稿中编程设置1个表格，打开数据库table1．dbf，取得该表的记录数，将数据表table1．dbf的记录数据逐条送到Word文稿的表格中（同时计算合计：各费用项目的合计--各季度开支的合计以及全年开支的合计），在Word中稍加修改这个报表，并用templ．doc文件名存盘。转信按照方式的不同可以分为二类：
　　本BBS站点←→转信软件←→News Server←→转信软件←→其它BBS站点
　　主动取信（client gateway）和被动等信（server gateway）。
4 BBS的转信功能
　　转信功能是BBS站点之间进行交流的主要方法。

图1 程序运行结果
李元（贵阳贵州大学计算机软件与理论研究所550025）
参考文献
［1］李元．Visual FoxPro 6．0中调用AutoCAD的应用实例． 中国计算机报，1999年10月18日
［2］Microsoft Corporation．Microsoft Visual FoxPro6．0程序 设计员指南．北京：希望电脑公司，1998
［3］Bazian M．Visual FoxPro6．0开发使用手册．北京：机械工 业出版社，1999
收稿日期：1999－11－10
