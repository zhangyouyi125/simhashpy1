微型机与应用
MICROCOMPUTER & ITS APPLICATIONS
2000 Vol.19 No.2 P.13,54




ASP实现主页计数器的二种方法及其改进
张子贤
摘 要： 以二个具体的程序剖析了利用ASP技术实现主页计数器的原理，并对目前的二种方法进行了适当的改进。
3 结束语
　　ActiveX Automation技术是应用程序之间进行控制和集成的一项先进技术，ActiveX自动控制在2个应用程序的内部对象中进行，并以客户／服务器的方式进行控制。以AutoCAD为对象的开发程序，既可直接调用任何AutoLISP命令，又可直接调用其它方法程序开发的命令。随着微软的Active Server PagesASP技术的出现，用ASP技术来实现主页计数器则更简单方便，而且其原理也更容易被理解，同时这种方法能够制作出非常漂亮的计数器图片，还可以通过各种条件的设置和相应的判断，经常变换主页计数器，让主页在不同的时刻或者不同的用户访问时显示不同风格的计数器。

图3 AutoCAD的ActiveX对象模型
　　值得注意的是在ActiveX对象模型中，AutoCAD环境中的许多部件或特定概念被确定为模型对象。语句如下：　　　SetWindowPos Acadhwnd，HWND＿TOP，0，0，Screen．Width，
　　　 Screen．Height，SWP＿NOMOVE
　　ShowWindow Acadhwnd，SW＿SHOWMAXIMIZED
　　SetFocus Acadhwnd
　　通过以上处理，用户可以使用各种方法进行高效图形绘制和交互处理。在Active Server Pages中可以用2种方法来实现。本文针对如何有效地对AutoCAD软件系统实现ActiveX控制进行了探讨。这样，主页的计数器就会增加得很快。然而主页计数器的初衷并非如此，因此只要您尚未离开某个网站，您在其中的跳转并不能当作是“再次光临”该网站。②程序编制自由。下面是改进后的源程序。位于根部的是Application对象，从根对象出发可到达其它AutoCAD对象并利用它们的属性和方法。这二种改进均能达到避免主页计数器盲目＋1的操作。此外，如果是利用第一种方法来实现主页计数器的话，可以把相关的程序段写到global．asa里，然后直接在程序中进行调用（关于global．asa的知识点这里不进行讨论）。
　　目前，Active Server Pages技术已经在绝大多数的网站中得到广泛地应用，如果能更深入地钻研这方面的技术，相信对网站的开发会有很大的用处。
张子贤（上海同济大学经济与管理学院200092）
收稿日期：1999－08－26
