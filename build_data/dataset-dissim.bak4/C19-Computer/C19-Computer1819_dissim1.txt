微型机与应用
MICROCOMPUTER & ITS APPLICATIONS
2000　No.19　No.1　P.54




关于Office 2000 
　　Office 2000 Office 2000在支持编程开发方面有哪些新特点？因为不同的机型的BIOS代码差别较大，不同的机型要进行相应的修改，因此这种方案有相当的难度，而且兼容性很难保证，但效果较好，某些跟踪INT 13原始入口的病毒也无法攻破。可以对前1种方案稍加改进，并从IDE接口电缆上获得硬盘读写信号。同时Office中也有内置的病毒检查工具。BOOT区程序搜索可启动操作系统分区的标志80H，搜索成功则读取引导分区内的操作系统的引导扇区，并把控制权交给引导扇区程序。开发人员可以为其Visual Basic for Applications （VBA）宏签名，这样用户便可以知道宏的来源以及它们是否被改动过。新的INT 13服务程序把访问0磁道BOOT区的操作都定向到以前的BOOT区内容的备份扇区中，使操作系统及用户感觉不到BOOT区信息有什么异常（但Windows 9x知道）。方法是将BIOS数据区0040：0013H记载内存大小的数据减少2KB，使DOS以为常规内存的底端由638KB（或小于640KB的其它值，取决于写保护程序大小）开始，而把硬盘写保护程序搬至638K至640K之间即可。VBA 6为Office提供了非模态用户窗体以及对附加ActiveX控件的支持等功能。
　　4．可编程性。
　　这种方案并不是攻不破的，有些病毒程序有自己的INT 13，具有直接写端口的能力，它能直接读写与硬盘有关的1F0～1F7端口，对于这种病毒，任何基于软件的写保护程序都形同虚设。在统一的插入模式下，利用Microsoft Office COM加载项，开发人员可建立Office集成的解决方案。
　　新的写保护程序先于操作系统加载，因此这种方案较前一种更为隐蔽。改方案是把写保护程序烧在EPROM中，并以接口卡的形式安装在扩展槽内，成为扩展的BIOS，因此，除具有前者的所有优点以外，安全性更高，用软盘启动，也无法写受保护的硬盘分区。这些新的API能让第三方供应商在加载Office文档前对其进行扫描。（3）基于应用程序的Visual Basic（VBA）宏数字签名。为了提高安全性和用户满意度，开发人员可以通过宏签名来保证他们不受病毒影响。程序流程见图1所示。（5）应用程序级事件。为了改进自定义解决方案，添加了新型事件。（6）Microsoft脚本编辑器。这样一旦D盘的系统被损坏，可以从C盘快速恢复。
