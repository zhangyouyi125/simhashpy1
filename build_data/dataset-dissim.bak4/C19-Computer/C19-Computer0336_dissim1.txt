计算机应用
Computer Applications
1999年 第19卷　第8期 Vol.19　No.8 1999



VB实现所见即所得的报表打印一例
高欣婷　潘书军
　　摘　要　通过对利用VB实现报表打印的几种方法的概要分析，本文提供了一种VB环境下完全意义上的所见即所得打印功能的实现方法。
　　. Proxy Server 2.0代理软件。利用VB实现所见即所得的功能，根据用户要求亦有多种实现方法。
3　计费系统的实现
3.1　实现的环境
　　图4是一个典型的代理计费网络结构,在该图中,装有计费软件代理服务器这台计算机配置二个100M的网卡，一块要与Router连接，网卡置为正规的IP地址，另一块配企业自己定义的内部IP地址跟企业网的主干线连接。
　　但是由于图像框的显示及窗体的打印仅仅局限于屏幕显示范围内的内容，不能实现真正意义上的所见及所得的功能。主要从事网络设计和管理、计算机应用开发。
　　笔者在工作实践中，摸索出了一种方法，集中了以上所介绍的两种方法的优点，实现了完全意义上的所见及所得的功能，现介绍给广大读者，希望能对大家有所裨益。
1　方法概述
　　为了在屏幕上模拟打印效果，我们仍然利用VB的一个窗体模拟打印纸。但为了能让此窗体显示为打印纸的实际大小，我们还得在项目中加入一个父窗体，以之作为被打印窗体的容器。将被打印窗体设为子窗体，其大小设为打印纸大小，这样即可利用父窗体的水平和垂直滚动条实现待打印对象的100%的预览。
　　程序设计语言Visual Basic 5.0是一种功能非常完善的嵌入式智能工具，它能使你的编程工作取得事半功倍的效果，特别是VB 5.0的数据访问可以使用户的程序十分轻松方便地读取SQL Server 6.5数据库中的数据。
2　程序实现
　　下面以实现以下报表为例，讲述程序的具体编制。而对于企业来讲，计费管理是尤为重要的，因为，目前单位或企业要想进入Internet都是向电信局租用X.25或DDN专线入网,其有效带宽从9600-128K不等，并且带宽越宽租用费越贵，还有如果让人们无限制地访问Internet必造成以下问题：
　　企业网出口拥挤，数据传送速度变慢；
　　使急需访问Internet用户得不到保障；
　　费用大量增加。这样这台服务器就象“桥”一样使内部网可以跟外部Internet网接通，所有内部计算机与Internet交换的数据都记录在这台服务器的硬盘中了。
　　本文介绍了一种与路由器无关的基于代理服务的计费思想，并已在一些单位正式运行，取得了很好效果。所用VB版本为：Visual Basic 4.0-32专业版。　　　
作者简介：高欣婷　助理工程师。针对这种计费的网络结构，我们用VB5.0开发的计费软件可以以多种方式统计出用户上网的数据量和费用。
　　解决以上问题最有效的措施是采用计费机制约束入网用户，谁能上网谁不能上网，对每位上网用户详细纪录他们的使用情况，因此用户只有需要时才上Internet，这样才能达到企业网与Internet网连接的真正目的。
作者单位：高欣婷　潘书军　长城计量测试技术研究所　北京(100095）
收稿日期:1999-02-04
