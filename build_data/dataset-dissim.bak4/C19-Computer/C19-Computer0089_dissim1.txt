计算机工程
COMPUTER ENGINEERING
1999年 第25卷 第8期 Vol.25 No.8 1999



面向对象的程序设计模拟细胞有丝分裂
王，傅廷亮，管菅
摘要：介绍了在微机上编程模拟细胞生长及周期分裂过程，提出了一个面积对象的细胞类结构，为利用计算机辅助研究细胞分裂作了一次新的探讨。 
　　传统的 RGB 颜色模型的可分辨色差是非线性的，且没有直感 , 所以不是一个好的颜色描述系统。 
1 基本设计思想 
　　本仿真系统采用基于 Windows 95 操作系统的 Microsoft Visual C++ 4.2 作为开发工具。因此，如何准确、快速地选择图象的主色调仍是需要进一步研究的问题。 
　　采用面向对象的程序设计技术，首先要为模拟的对象定义一个完整的类，类是对一组性质相同的对象的程序描述，它由概括了一组对象共同性质的数据和函数组成。图象数据库是图象处理技术和传统数据库技术的应用，又为图象处理技术提供了有力的支持。系统各对象之间的关系如图 1 所示，其中 CCellApp 是应用的全程对象， CMainFrame 和 CChildFrame 是系统应用主框架和子框架。 

图1 类及对象关系
　　本系统采用单文档多视的结构，视分两种：细胞分裂及显示 (CCellView) 和数据监测及统计分析 (CChartView) ，其共用的文档模板 CCellDoc 完成对公用的数据区及数据对象进行转储等操作。 
　　系统在内存中申请分配点阵位图作为细胞生长分裂的环境，我们采用的是 Windows256 色 BITMAP 位图，因为通过 Bitmap 位图可以方便快捷地进行图形显示及数据复制、转储粘贴等操作，并且 256 色位图以字节存放颜色值，可以方便地编写存取函数。 
　　上述问题也可采用模式识别中的聚类方法对颜色空间进行量化处理 [4] 。因此，对主色调进行扩展是弥补上述缺陷造成漏检的一种有效的方法。在模式识别技术中，特征的相似度量均采用距离法。因此如何高效准确地查询用户的图象数据是图象检索方法的主要目标，采用多阶段的 " 粗粒度 " 和 " 细粒度 " 相结合的相似匹配检索方法则不失为一种提高检索效率的有效方法。由于这种模型具有线性伸缩性，可感知的色差与颜色分量的相应样值上的欧几里德距离成比例 [2] ，因此 HSV 颜色模型比 RGB 颜色模型更直观、更容易接受。 
　　(2) 中层：介于低层和高层之间不直接与模拟对象有关的用于完成某些辅助操作功能的函数。考虑到基于内容的图象检索方法具有传统的文本检索技术无法比拟的优越性，因此，研究和开发基于内容查询的图象数据库是当今研究的热点。 
　　(3) 高层包括： 1) 封装定义的细胞类及进行细胞周期各阶段功能的数据和模拟函数； 2) 细胞分裂仿真过程中的辅助操作函数如逻辑坐标与为了坐标映射变换； 3) 数据分析 ( 监测及统计图表 ) 模块。 
　　每个细胞以 Bitmap 位图的颜色值表示的本细胞的区分标志，此外位图的颜色还用来区别细胞内其它各种物质，将细胞周期离散化为一系列的时间段，细胞周期的不同阶段都根据时间的长短对应某些时间段，在每个细胞对象中有一个基因控制因子 (CDC) 来确定此细胞当前所处的时间段位置。细胞类对象的主要内容还包括： 
　　1) 细胞形态及环境模拟 
　　细胞面积、细胞边界周长及其计算函数；细胞大致区域、细胞核大致区域及核仁位置；相邻细胞的数量及邻居细胞的标志链表、与其它细胞相邻的边界长度；细胞类的构造函数、析构函数；细胞对象初始化、有丝分裂各期仿真操作函数；分裂间期细胞生长、有丝分裂末期的细胞分离等辅助操作函数。 
　　2) 细胞仿真控制变量及其变化控制函数 
　　细胞生长促进因子 细胞分裂抑制因子； DNA 的含量 DNA 聚合酶含量 ；有丝分裂因子 (Mitotic Factors) 有丝分裂抑制物 (Inhibitor Mitotic Factors) 。 
　　3) 嵌套中心体对象 
　　中心粒初始位置、中心粒移动曲线参数 ( 采用二次曲线仿真 ) ；中心粒的目标位置、随机确定细胞分裂极及分裂方向的函数；中心体运动函数及运动中的中心粒当前位置、运动的上一点位置；纺锤丝定义参数 ( 采用抛物线仿真 ) 及纺锤丝的形成函数等。 
　　4) 嵌套染色体对象 
　　染色体着丝点或染色质定位点及其随机定位函数；染色体的运动轨迹、染色体移动时的形态控制参数；模拟各期染色质、染色体的形态及运动函数等。 
2.2 系统流程及仿真程序 
　　仿真开始先建立系统模拟的环境，在内存中产生一个 256 色 Bitmap 位图并对其进行必要的格式化，然后确定初始种子细胞的位置、标志区域及细胞内部环境。本仿真系统用一条对象链表连接不同的细胞对象，系统计时器定时激活随机选择细胞链中的一个细胞对象，根据细胞的基因控制因子每次执行当前时间段的仿真操作，完成本段仿真后保存细胞当前状态，等待下一次随机激活继续下一时间段的仿真。经过若干次时间段完成一个细胞周期操作后分裂成两个细胞，将其加入细胞对象链表中，从而周而复始地开始新细胞的生长分裂过程。 
　　在有丝分裂的 G1 期开始细胞生长过程，当某个方向遇到别的细胞时此方向停止生长， G1 期存在一个细胞增殖控制点 R ，细胞增殖的限制与许多因素有关，比如当细胞密度较大时分裂抑制因子随着接触抑制的增加而增大，阻止 G1 期向 S 期过渡从而抑制细胞分裂，这时细胞离开增殖周期处于休止期，在一定条件刺激下或细胞密度等条件符合时又可 返回增殖周期。对每个细胞周期经历模拟的详细流程见图 3 。 
　　由于颜色是人识别图象的主要感知特征之一，因而基于颜色的查询是基于内容的图象检索中最基本的方法。计算机提供了一个极好的研究此类问题的工具。 
作者单位：中国科技大学计算机系，合肥 230027
参考文献 
1 鲁润龙，顾月华 . 细胞生物学 . 合肥：中国科学技术大学出版 社， 1991 
