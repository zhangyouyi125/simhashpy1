微型电脑应用
MICROCOMPUTER APPLICATIONS
2000　Vol.16　No.1　P.59



工程制图试题库开发中的关键问题的探讨
张国珠　戴时超
摘　要：本文对以图形为主工程制图试题库的图形试题存储格式、题库查询、自动组卷以及试卷的排版打印等关键问题进行了较深入的探讨
关键词：试题库、关键问题、探讨。
Abstract：This paper explores the key problems of the test -question base of mechanical drawing such as the storage formats of graphical questions, retrieval of the question base, automatic generation of tests, and pr inting of test papers. 
Keywords：mechanical drawing　question base　retrieval▲
一、引言
　　工程制图是一门量大面广的技术基础课，研制和开发试题库是工程制图课程实现计算机辅助教学与测试的一项重要内容。它不仅使教师从繁重的组卷工作中解放出来，更重要的是易于实现教考分离，促进教学质量的提高。
　　一般试题库的信息主要是文字，图形很少或没有。而工程制图试题库的信息主要是图形，信息量很大。这就使工程制图试题库的设计和开发有其特殊性，不同于一般以文字为主的试题库。
关键词：团组织　管理系统　数据库
Abstract：This paper describes an Youth League Organizatio n IMS using VFP5.0, which is suitable for universities and colleges. This IMS sy stem proves useful, flexible and with a friendly interface, which has been put i nto practice.
Keywords：Youth League 　management system　database▲
一、前言
　　高校团的工作一直是工作量很大的工作，就普通高校来说，全体学生和青年教职工都属于团组织管理范畴，表现出人员众多，数据源复杂，统计管理工作困难等特点，一般要求一组很简单的统计数据，就得花费很大的工作量去人工统计，故在团组织的要求下，我们开发了这个管理系统，经试运行和不断完善，目前运行较好。
　　2.系团委数据录入
　　该模块完成各系团组织数据录入，修改等，包括：系团总支机构，各系各班团支部信息，系学生会，系级社团，系志愿者服务队，系团总支获奖情况。
二、图形的存储格式及数据库管理系统选择
　　选择图形试题存储格式和管理图形试题的非图形信息数据库是开发初期首先遇到的问题。图形可分为矢量图和点阵图。很多数据库管理系统都支持点阵图形，这使点阵图形的管理比较容易。但点阵图形所占存储空间比矢量图大得多，上千道试题的图形如果采用点阵格式必将占居庞大的存储空间，使运行速度降低；再者点阵图形无法修改，题库只能设计成封闭型，给题库的维护和使用带不不便。
　　矢量图形的存储空间远远小于点阵图形，而且可以在绘图软件(如Auto CAD)中进行编辑修改，因而采用这种图形格式的题库可以设计成开放型和可扩充型，随时修改试题和增加试题。■
作者单位：张春生(内蒙古民族师院数学系 通辽 028043)
参考文献：
［1］Michael Antonovich著《Visual FoxPro5开发使用手册》机械工业出版社　1997
［2］瓮正科著《FoxPro2.5实用教程》清华大学出版社　1995
［3］Griffith Kadnier著《Windows NT 4使用详解》机械工业出版社　1998
［4］巴亚东　继续教育管理信息系统的设计　《微型电脑应用》　1998年第6期
收稿日期：1999-09-06
。但由于一般数据库管理系统不支持矢量图形，使矢量图形的管理比较困难。
二、设计思路
　　由于Windows98的优良性能，特别是与internet的结合，我们采用它作为开发运行平台，以便本系统进入校园网和教育网，开发工具采用VFP5.0，该系统具有面向对象、可视化的编程思想，丰富的控件，可以缩短软件周期，程序用户界面友好，使用简单，维护方便。
　　题库选择目前最流行的可视化编程语言Visual Basic 6.o进行编程，使用OLE控件，可以同步将与Access数据库连接Auto CAD图形试题在VB程序中显示。
　　2.简便的使用方法
　　由于我们面向不同层次的使用者，故界面清晰，图文并茂，语言描述详尽，一看就懂，一学就会，容错性能好，自动化程度高。也可在界面设置功能按纽启动Auto CAD ,对图形试题进行操作，实现相应的功能。
三、查询功能的实现
　　在题库中设置查询功能的目的是使用户可以迅速地掌握整个题库的情况，人工组卷时可以方便快捷地找到所需的试题。
五、结束语
　　由于本软件采用windows98系统平台，网络环境设计，所以非常适合于校园网中运行，同时该软件涉及面广，实用价值强，再加上强大的查询功能，友好的人机界面，具备一定的推广价值。在试题的非图形信息数据库中。我们设置了试题编号、试题章节、试题特征、试题难易程度、答题参考时间、试题图幅大小、优先权等字段。其中试题章节、试题特征(每一章节试题根据特征分成若干类)、试题难易程度、优先权(根据教学要求和试题特点确定选择的先后顺序)是查询所需的关键字段。
　　查询时可同时或分别匹配难易程度、试题特征、优先权等条件进行查询济览。
　　3.团员青年基本信息录入
　　这项内容工程量大，包含的信息量大，几乎包含所有学生及青年教职工的方方面面。也可将试题特征、难易程度、优先权设置为“无”按试题章节查询浏览库。
　　在VB程序中使用结构化查询语言SQL可实现上述查询功能。
四、自动组卷功能的实现
　　自动组卷的好坏取决于试卷模型的设计质量和产生合适的随机数
　　试卷模型的建立是根据考生专业、考试性质(考试、考查)、考试时间(期中、期未)等条件综合考虑，确定模型中每道试题的章节内容、难易程度以及试题总量 ，对每一类考试都确定一系列模型供随机选取。所有试卷模型放在同一文件中，同一类型的模型放在一起。
　　自动组卷时，打开模型文件，用设置的指针变量读出某类试卷模型的个数，用VB提供的随机数发生器返回一个随机数，其值在0-1之间，为了用此数去取到模型，必须将此数变成一个合适的整数，为此将随机数乘以10000后对试卷模型个数取余，再加上这类模型的开始位置即为选到的试卷模型，将试卷模型取出放到预先定义好的数组内。
　　试卷模型中每道试题的选取也依赖于产生随机数。与上述处理相似，将随机数发生器返回的值乘以10000后对数据库中满足条件的记录总数取余加一，得到一个不大于满足条件的记录总数的整数，从而保证可取到满足条件的试题
　　编程时，先获取试卷模型，然后对模型中每道题定义一个SQL语句对数据库进行查询，得到满足条件的记录集，再由产生的随机数确定记录，取出记录中的试题编号和图幅字段的内容，写入试卷文件中。
三、功能介绍
　　本软件为了使结构清晰，功能独立性强，模块化分比较详细，具体来说有以下平行的9大模块，现分别介绍如下：
　　1.院团委数据录入
　　该模块主要完成院团委有关的信息录入修改等工作，具体内容为：院团组织分工，院团校信息，文件目录，奖项，人才库，院学生会，院社会实践团体，志愿者服务队。为避免取到相同的试题，应将每次取到试题和已取到的试题进行比较，如果有相同的试题则此次选取作废，从而保证取到满足条件又不相同的试题。
　　例如：按姓名、性别查人数，按性别、年龄、民族和指定入党入团时间查团党员人数，查推优人数及姓名，单位列表查询，按奖项查人数及姓名，按时间和单位查获奖人数及姓名。
　　为了排版打印，首先在录入图形试题时要按图形大小确定其在一张试卷中所占的图幅大小，为方便排版，本题库按试题的复杂程度和试题本身的需要确定了三种图幅大小：四分之一页、二分之一页、一页。
　　排版算法：打开试卷文件，读出试题总数以及每道试题试题编号和图幅大小。首先计算整份试卷中图幅为四分之一页试题的整页数，只要将该图幅试题数除以4取整即得，然后确定合适的插入点依次在每页插入四道题进行排版。同理可计算图幅为二分之一页试题的整页数，并进行排版。余下的图幅为四分之一页、二分之一页的试题有七种排版模式，根据具体情况选择相应模式排版，不足一页按一页计。最后将图幅为一页的试题进行排版。
　　由于用VB编程排版打印复杂，本题库采用在VB中用Auto CAD软件自带的Lisp语言编写排版打印程序，然后在Auto CAD中调用此Lisp程序进行排版打印。■
作者单位：张国珠(杭州电子工业学院 310037)
参考文献：
［1］张宏 标准试卷自动处理系统概述，管理信息系统，1997.7
［2］左晓明，顾锋，计算机辅助制图试题库管理系统的研制与探讨，江西科学，Vol.16增刊
收稿日期：1999-8-20
