计算机工程
COMPUTER ENGINEERING
1999年 第25卷 第8期 Vol.25 No.8 1999



华东电力系统数据通信增值网的设计
何星，施华军，唐亮，方兴其，李根蔚
摘要：介绍了华东电力系统数据通信增值网的系统结构设计和增值网通信服务软件的设计思想。其要点是引入了前置通信服务机减少了主站的通信负荷，实现了不同网络通信协议的透明调用，扩展了电力部部颁应用层协议，提供了不同应用层协议的主站接入方式。细胞类对象的主要内容还包括： 
　　1) 细胞形态及环境模拟 
　　细胞面积、细胞边界周长及其计算函数；细胞大致区域、细胞核大致区域及核仁位置；相邻细胞的数量及邻居细胞的标志链表、与其它细胞相邻的边界长度；细胞类的构造函数、析构函数；细胞对象初始化、有丝分裂各期仿真操作函数；分裂间期细胞生长、有丝分裂末期的细胞分离等辅助操作函数。该信息网主要应用于华东总调、上海市调、江苏、浙江、安徽省调和天荒坪电站各监控系统计算机间的实时通信。其通信子网为 X.25 分组交换网。但通信子网仅提供低级的通信服务，而调度自动化系统实时信息的交换业务的实现还需要有基于通信子网的增值业务的开发，即资源子网的开发。本文将重点阐述增值网的系统结构的设计及增值网通信服务软件的设计。 
1 增值网系统结构的设计
　　通信子网增值业务的开发，原则上可以直接在主站上进行开发，各主站通过支持其网络协议的路由器直接接入通信子网，从而形成数据交换网。但考虑到华东电网各省市调的 EMS 主机负载已过重，若直接在 EMS 主机上进行增值业务 ( 网络管理、信息管理等 ) 的开发必将使负载问题严重恶化。为了解决这个矛盾，我们引入了通信服务机。各 EMS 主站通过服务机接入分组交换网。大部分的增值业务由通信服务机完成，减轻了主站的负担。华东信息网系统结构可分为图 1 所示的 3 个层次： (1) 信息源网层 信息源网为信息网中产生原始数据、信息和最终使用这些信息的主站接入系统。如 EMS/SCADA 系统， RMIS 系统等。 (2) 增值网层 增值网层从硬件上讲有通信服务机、 RIMS 通信服务机和路由器等。主要包括： 1) 消息传递、计时器触发； 2) 公用堆栈、数据区操作； 3) 基于内存 Bitmap 位图的基本图形函数。 Pentium 通信服务机主要用于 RMIS 系统的接入，本文将不作详细的讨论。 (3) 通信网层 通信网层指负责通信底层的部件如 X.25 分组交换网，程控交换节点机等。 
1 基本设计思想 
　　本仿真系统采用基于 Windows 95 操作系统的 Microsoft Visual C++ 4.2 作为开发工具。 Pentium 通信服务机采用高性能的 Pentium PC ，操作系统是 Window 95 。 
　　增值网结构就网络通道而言有以下两个特点： 
　　(1) SUN 通信服务机通过 SunLink HSI(High-speed Serial Interface) 卡直接接入分组交换网，实现基于 X.25 的网络互联。 SUN 通信服务机还可通过以太网卡经局域网接到路由器，以 TCP/IP 外包 X.25 的方式接入分组交换网，实现 SUN 服务机之间基于 TCP/IP 的网络互联。这两条通道可根据需要，在服务机上通过界面配置灵活切换，互为备用。 
　　(2) SUN 通信服务机在增值网中不但要实现路由器的路由选择和协议转换功能，同时还要扮演网管角色，负责链路状态的监视、通信性能检测、流量统计和实时报文监视。 
　　增值网结构从数据交换的层次上看，它为网上任意两个节点的数据交换提供了数据通道。主站的交换信息通过服务机的代理，利用广播的方式由服务机负责发送至全网各站点，大大缓解了主站的负担。此外，主站的交换信息还可以存储在服务机的数据库中，由服务机发布到信息网上，使得主站只需面对服务机一个节点，而不是全网的所有节点，这也大大缓解了主站的负担。 
2 增值网通信服务软件的设计
　　增值网通信服务软件用于向上层应用提供统一的调用接口，实现各种应用层服务原语。 
　　华东电力信息网是一个具有多种网络协议和多种应用层协议的复杂网络。 
　　(3) 高层包括： 1) 封装定义的细胞类及进行细胞周期各阶段功能的数据和模拟函数； 2) 细胞分裂仿真过程中的辅助操作函数如逻辑坐标与为了坐标映射变换； 3) 数据分析 ( 监测及统计图表 ) 模块。系统中定义的 CellDib 类完成了对内存位图对象的各种操作。为适应网络通信，我们对应用层协议进行了扩展，在部颁应用层协议的报文头加了 8 个字节的路由块，前 4 个字节为报文目的地址，后 4 个字节为报文源地址称之为扩展部颁应用层协议。 

图2 细胞周期动态图
2.1 数据结构及操作层次 
　　系统数据和操作函数分 3 个层次： 
　　(1) 低层：系统中的资源 (Cell.rc) 、内存 Bitmap 类 (CellDib) 及文档模板 (CCellDoc) 中的大部分函数都属于低层数据操作，它们是其它功能性操作的基础，主要包括： 1)Windows DIB 位图的内存分配、结构建立、数据读取、屏幕显示及调色板的颜色设置等； 2) 对内存的图形数据区进行格式化：建立坐标、周期边界条件及点阵的邻居； 3) 细胞对象链表及其它公用数据区的定义、数据转储、根据数据存放格式编写位图在内存空间的存取函数； 4) 系统资源及常量定义。 
　　由以上分析可知，通信服务机软件既要提供多种网络协议的支持，又要提供多种应用层协议的支持。为了充分实现可扩充性、可移植性、高效性、故障检测与隔离、便于调试、屏蔽低层细节及透明调用，通信服务软件强调协议分层：应用层和网络功能层。 
　　系统中细胞类 (CellCls) 是仿真系统的核心对象，它定义了一个完整的细胞完成生长、分裂过程的数据和操作函数，其中包括嵌套说明的细胞核、染色体及中心体。 
2.1 应用层 
　　如图 2 ，应用层用于实现上层应用报文到应用层协议的报文格式的转换。应用层调用界面直接为信息网上层应用提供服务。管道调度用于解决调用接口的竞争问题。由于整个信息网涉及到异种机连网，但不同机型机器不但数据格式可能不同，甚至数据编码也可能不同。由此带来的后果将是灾难性的。为此，须在有关应用层协议下面增加一个表示层，用以解决异种机数据内部表示格式不一致的问题。 

图2 应用层结构示意图
　　应用层协议的调用界面实现了上层应用对它的透明调用，提供以下几个服务原语的统一调用： 
　　联系报文： A_Associate{request/indication/response/confirmation} 
　　释放报文： A _ Release{request/indication/response/confirmation} 
　　放弃报文： A_Abort {request/indication} 
　　联系复位： A_Reset {request/indication/response/confirmation} 
　　数据报文： A_Data {request/indication} 
　　通信报文： A_Poll { request/indication/response/confirmation} 
　　send报文： A_Send { request/indication/response/confirmation} 
　　同时，应用层还具有良好的开放性和扩充性：扩充新的应用层协议时不须受上层应用和下层网络细节的限制，只需符合应用层调用接口即可。 
　　2) 细胞仿真控制变量及其变化控制函数 
　　细胞生长促进因子 细胞分裂抑制因子； DNA 的含量 DNA 聚合酶含量 ；有丝分裂因子 (Mitotic Factors) 有丝分裂抑制物 (Inhibitor Mitotic Factors) 。如图 3 ，本网络功能层将支持 TCP/IP 、 DECNet 、 X.25 和串行口数据链路层协议的接入。对于 TCP/IP 采用基于传输层的 Sockets 调用界面，网络路由由其内部的 IP 网络层解决；对于 DECNet ，则采用基于 SunLink DNI 8.0 的调用界面；对于 X.25 ，采用 SunLink X.25 8.0 网络层调用界面，该层的下层支持包括 SunLink HSI/S 2.0 driver 。对每个细胞周期经历模拟的详细流程见图 3 。本仿真系统用一条对象链表连接不同的细胞对象，系统计时器定时激活随机选择细胞链中的一个细胞对象，根据细胞的基因控制因子每次执行当前时间段的仿真操作，完成本段仿真后保存细胞当前状态，等待下一次随机激活继续下一时间段的仿真。底层的网络协议接入进程都遵循这个接口规范实现与网络功能层的交互。当要实现新的网络协议时，只要该网络协议的接入接口符合规范，不必修改网络功能层就可直接接入。这就是网络协议的开放性。 
3 结束语
　　电力调度数据网的设计建造正是在电力系统的分组交换网基础上，引入了通信服务前置机，减轻了调度系统的负担。同时在通信服务机通信软件的设计上强调协议分层，提供统一的外部调用接口，适应了各调度系统应用层协议、网络协议多样性的要求，大大方便了调度系统的接入。 
作者单位：何星　施华军　唐亮　方兴其　上海交通大学自动化研究所，上海 200030；
　　　　　李根蔚　华东电力管理局高度室，上海 200001
参考文献 
1 能源部调自 [1992]66 号 . 电网调度自动化信息传输规定 .1992 
2 华东电网调度系统计算机网络规划 .1995 
3 电力行业标准 DL476-92. 电力系统实时数据通讯应用层协议 . 1992 
