航空计测技术
AVIATION METROLOGY & MEASUREMENT TECHNOLOGY
1999年　第19卷　第6期　Vol.19　No.6　1999



坐标测量机发展的新方向――虚拟坐标测量机
黄庆成　叶东　刘得军　车仁生
　　摘要　虚拟坐标测量机是虚拟现实技术与坐标测量技术相结合的必然产物，是虚拟制造技术发展的需要。本文提出了三坐标测量机的一个新的发展方向――虚拟坐标测量机(VCMM)，介绍了虚拟坐标测量机的体系结构和基本功能以及虚拟坐标测量机仿真运行所需要的软硬件环境。其中二态键根据形态的不同又划分为13种，面板控制框则根据功能的区别划分为两类。
　　近几年，制造全球 化概念的提出和快速设计制造的崛起[2]，推动了“并行工程”、“虚拟制造”的发展[3]。1995年，美国国家虚拟现实研究和发展顾问委员会在一篇大型研究报告中，提出并推荐的四个主要领域是：(1)设计、制造及市场；(2)医疗和健康保键；(3)有害操作；(4)训练[4]。从而进一步推动了虚拟现实在设计和制造领域的发展。虚拟制造的发展对制造过程中的加工、测量和检验等提出了更新更高的要求，特别是作为现代先进制造中质量保证和测量信息反馈重要组成部分的坐标测量机，毫无例外地也必须适应这种发展的需求。
　　世界上第一台坐标测量机是在1959年由英国制造的，现在国内外的应用已相当普遍。坐标测量机的万能性强，自动化程度高，成为现代化工业生产、科学研究必不可少的精密测量仪器。近几年，国内外很多坐标测量机的生产厂家，不断采作新技术、新材料、新工艺和新结构，提高产品的性能，降低产品的价格，同时，坐标测量机的测量软件也有了较大的改进[5-6]，但虚拟坐标测量机的研究基本属于空白。因此，在虚拟环境下，虚拟坐标测量机的研究是虚拟制造技术发展的需要，虚拟坐标测量机的出现，不但开辟了坐标测量技术的一个新的研究领域，而且必将成为虚拟制造系统中一个十分重要的组成部分。本文采用流程方法来实现一个通用的测试软件开发环境。虚拟坐标测量机是一种没有真实量仪实体，但却有真实量仪感觉和功能的坐标测量机，它是一种建立在虚拟现实或虚拟环境科学基础上的，集量仪设计理论、计算机辅助设计、计算机辅助测量、计算机辅助检测规划和测量过程建模与仿真技术等于一体的，以个人计算机或工作站为母体、以软件为主的一个计算机空间。在FDE中，测试人员可调用有IDM环境开发的仪器驱动器，以完成测试代码的自动生成。本文介绍了一种在Microsoft Windows平台上开发测试软件自动生成环境的方法，即通过组建仪器驱动器库，利用结构化的流程设计思想来实现测试软件的生成。FDE是一个图形化的自动测试软件编制工具，它以图形化编程元素的方式向测试人员提供编程所需的各种虚拟控件，如循环、分支、结果显示、数据传输、仪器控制等，根据既定的测试任务，测试工程师按照测试流程，将这些编程元素组合起来，即可生成所需的测试软件。真实坐标测量机已广泛地应用于三维复杂零件的尺寸、形状和相互位置的高准确度测量，以及实物模型数字化和在线质量控制等领域。在这里，我们利用VB同ACCESS数据库的良好接口，实现虚拟仪器驱动器文件的存储。它利用当今先进的计算机软件技术，通过构筑虚拟仪器驱动器技术实现对真实仪器的控制，并采用流程设计方法，完成特定测试软件的可视化生成。由图可知，每个虚拟面板对应Windows的一个窗体(Form)，窗体大小与面板包含的功能按键多少有关，用户可任意调整其大小。
　　为了满足一般计算机用户的要求，我们所开发的虚拟坐标测量机没有使用SUN、SGI等类型的图形工作站，而是选用了高档PC或微机图形工作站，这样构成的系统操作简单，便于使用与推广。
　　实时模式：此时，测试人员在虚拟面板上对控件的操作可立即实现对仪器的控制，相当于直接操作仪器，这种模式便于用户检测仪器驱动器编制的正确性。虚拟坐标测量机的产生，促进了虚拟现实技术与坐标测量技术的结合，是虚拟现实技术在制造领域又一典型应用。在这里，我们设置了一个标志位VPRunMode，当环境检测到面板操作时，根据其属性设置的不同分别执行以下操作：
　　编辑模式：在此模式下，测试人员可通过菜单条与工具栏完成虚拟面板和虚拟控件的添加、放缩、移动、删除及属性设置等编辑功能，同时将向仪器库中添加或删除有关信息