　宇航学报
JOURNAL OF ASTRONAUTICS
1999年 第20卷 第3期 vol.20 No.3 1999



　　基于FBM的分形地形模拟原理研究
佘龙华　沈林成　常文森
　　摘　要　本文通过分析FBM(Fractional Brownian Motion)的数学特征，指出它能基本吻合真实地形的数学特征。ri为卫星在惯性空间的位置矢量。
　　主题词　DEM　FBM　分形　地形　插值
FBM―BASED FRACTAL SIMULATION OF TERRAIN
She Longhua Shen Lincheng Chang Wensen
(National University of Defense Technology.Changsha.410073)
　　Abstract　This paper analyses the mathematical characteristics of realistic terrain and FBM(Fractional Brownian Motion).The the basic principle of FBM―based fractal simulation of terrain is introduced.
　　Key words　DEM　FBM　Fractal Terrain Interpolation
　　1　引言
　　地形模拟有着广泛的应用价值，主要体现在如下方面：(1)地形研究，这主要是指如何根据DEM研究地形的特征和构造；(2)地形视景仿真，这主要是指如何根据DEM构造颇具真实感的地形模型，从而提高如飞行可视化仿真、动画制作、电影场面、电子沙盘等同地景相关的画面的品质；(3)地形特征仿真，这主要是指如何构造符合真实地形特征的地形模型，使得它在诸如卫星遥感地面仿真、地形匹配地面仿真等实验中具有较高的置信度。
　　地形模拟在这三方面的应用，又可分为两类：(1)地形初始数据集是由算法随机生成的；(2)地形初始数据集是由DEM给定的，本文着重研究后者。经典的DEM地形模拟方法是线性插值和随机插值，然后在此基础上进行三角形剖分，二者的共同不足之处是不能保持自然地形表面的大部分数学特征，从而使得它们在仿真实验中真实感较差或置信度不能满足要求。模拟仿真计算结果表明直接计算的定轨精度为400～600米,Kalman滤波定轨精度为100米左右,地心矢量计算的精度为0.004度左右,速度精度为0.5～0.6米/秒。以前关于这方面的文献着重研究各种具体的分形插值方法，具有算法的性质［7］［8］，本文详细研究了基于FBM的分形地形模拟方法的可行性和基本原理，从而为分形地形模拟算法提供了理论依据，并为进一步设计各种算法提供指导。
　　2　真实地形与FBM
　　2.1　真实地形的数学特征
　　到目前为止，还没有一种从纯理论角度推导真实地形数学特征的方法，所以许多地球物理学家从跨越大范围时间和空间尺度的地形数据分析入手，总结了大量与真实地形相关的数学特征［4］［5］，现枚举如下：
　　(1)分数维
　　(2)多级分形
　　(3)各向异性
　　(4)一定标度范围内统计自相似
p(X(t)＜x)=p(X(γt)＜γαx
　　(5)变异差满足
E［X(t+h)-X(t)］2=k|h|2α
　　(6)剖面功率谱密度满足
G(ω)=2πkω-α
　　(7)非平稳过程
　　(8)增量平稳
　　地形模拟要解决的问题就是如何构造地形模型，使该模型尽可能地具备上述数学特征或者具备实际应用领域所需要的数学特征。
　　2.2　FBM的数学特征
　　FBM是定义在某概率空间上的一随机过程X∶［0,∞］→R,且满足如下条件：
　　(a)以概率1，X(t)连续且X(0)=0
　　(b)对任何t≥0和h＞0,X(t+h)-X(t)服从如下分布：
　　　(0＜α＜1)　　　(2-1)
　　FBM的性质之一　X(t)～N(0,t2α)
　　证明：对式(2-1)取t=0得：

　　因为FBM的条件(b)已经指出式(2-1)对任何h＞0均成立，所以可将上式中的h置换成t，从而

即X(t)～N(0,t2α)
　　FBM的性质之二　增量平稳
　　证明：式(2-1)表明X(t+h)-X(t)的分布与t无关，故结论成立。
　　FBM的性质之三　统计自相似
　　证明：
　(u=γ-αu1)
　　　　　　　　　　　　
　　　　　　　　　　　　

对上式两边取t=0，然后将h置换为t得到：
p(X(t)＜x)=p(X(γt)＜γαx)
此即所谓的统计自相似。
　　FBM的性质之四　平方变异差为h2α，绝对变异差为
　　证明：
　　　　　　　　　　　　　　　　　　　(根据式(2-1))
　　　　　　　　　　　　　　
　　　　　　　　　　　　(根据式(2-1))

　　FBM的性质之五　FBM曲面的Hausdorff维数和盒维数以概率1等于(3-α)
证明：用坐标变量(x,y)代替时间变量t，则随机变量X(x,y)可被认为曲面在点(x,y)的高度，因此FBM曲面可以描述如下：
　　(a)以概率1，X(0,0)=0且X(x,y)为(x,y)的连续函数
　　(b)对(x,y)，(h,k)∈R2,高维增量X(x+h,y+k)-X(x,y)服从如下分布
　　　　　　　
　　　　　　　　　(0＜α＜1)
在此基础上，可以推证FBM曲面的维数为3-α(由于推证过程需要用到许多复杂的数学概念，在此暂略之)［3］。由于采用计算结果(直接定轨法的结果,而不是测量)作为Kalman滤波的测量修正量,传统的广Kalman滤波算法需作适当的修改。
　　2.3　用FBM模拟真实地形的可行性分析
　　从2.1和2.2的分析可以发现，FBM在五个性质依次满足了真实地形的数学特征(7)、(8)、(4)、(5)、(1)。要计算(x0,y0,z0),至少需要3个ρi测量结果。
　　本文以轨道高度为900km,轨道倾角98°的极地低轨卫星为模拟仿真对象。在此基础上，根据特征参数选择基于原DEM数据集进行插值方法和插值参数，从而可以获得新的DEM数据集。
　　③本文中给出的修正的广义Kalman滤波算法具有良好的收敛性和稳定性。选取20颗星等最亮的恒星［9］模拟星敏感器的测量对象。对上式两边取对数得：

由此可见，logE［|Z(X+ΔX)-Z(X)|］与log‖ΔX‖成线性关系，因此可采用最小二乘法。
最小方差为


通过最小化e2可以求出α和σ，再根据FBM的性质之五可以求出其相应的分形维数α为D=3-α。
　　3.2　基于DEM的分形插值
　　在抽取了σ和D以后，就可以对DEM进行插值，假设Xk=(x,y)为待插值点，Xi(i=1,…,k-1)为Xk的邻近点，那么一般的插值方法可统一表示为：
Z(Xk)=F(Z(Xi))　　(i=1,…,k-1)
其中F是某种类型的可递归函数，通过选择不同的F，可以产生具有各种特性的地形模型。基于FBM的分形地形模拟可表示成下式：
Z(Xk)=∑λiZ(Xi)+Y=LTZ+Y
其中LT为系数矢量，Z为Xk的邻接点矢量，Y为一分数布朗函数。
　　为分析和比较直接定轨法与滤波定轨法的性能,本文针对定轨计算采用的海平面模型阶数、海浪起伏高度、星敏感器测量精度、直接定轨迭代次数及Kalman滤波采样周期等不同状况进行数值模拟仿真,共计16种情况,具体值为:
海平面模型阶数　　　　3,10阶
海浪起伏高度　　　　　0,10米
　　　　　　星敏感器测量精度　　　0.0,0.003,0.005度
　直接定轨迭代次数　　　1,2,3次
　　滤波采样周期　　　　　1.0,5.0秒
　　Kalman滤波状态初值的偏差为:位置偏差为1000米,速度偏差为1.0米/秒,姿态角位置偏差为0.5度。
　　4　结论
　　本文研究了基于DEM的分形地形模拟的可行性和基本原理，为设计各种地形模拟所采用的分形插值算法提供了依据。最后指出，有待进一步研究的两个问题：
　　(1)真实地形是各向异性的，但按上述原理模拟出的地形是各向同性的，因此，需要进一步研究如何构造有方向特征的模拟方法。
　　3.3　卫星的位置的计算
　　根据地心矢量在本体坐标的方向及卫星本体坐标系相对惯性坐标系转换矩阵,即可求得卫星在空间惯性坐标系中的位置
　　　　　　　　　　　　　　　　　　　ri=-CibRb　　　　　　　　　　　　　　　　　(11)
Cib为卫星体到惯性空间的转换矩阵,可根据星敏感器测量计算,Rb为地心矢量在本体坐标系的投影。采用红外地平仪测角法影响定轨精度的主要因素为地球光学边缘的模糊性使得地心方向的测量精度仅为0.08度,利用成为对称斜装的雷达测高仪测量卫星至地球表面的斜距,考虑地球的形状的影响可获得高精度(0.004度)的地心方向,同时伴有高度的测量值,因此利用卫星高度计和星敏感器的混合观测,预计可获得较高精度的卫星自主定轨