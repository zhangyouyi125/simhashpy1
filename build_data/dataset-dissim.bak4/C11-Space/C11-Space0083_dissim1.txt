航空计测技术
AVIATION METROLOGY &MEASUREMENT TEHNOLOGY
1999年　第19卷　第4期　Vol.19　No.4　1999



ALPHA900系列数据采集器测试系统的设计
陈荔莹+
摘　要　介绍了一个数据采集器测试系统的构成及其软件设计，并对系统软件的设计方法、主要功能和主要特色进行了讨论。
关键词　数据采集　ALPHA900　模块　PCB板
Design of Series ALPHA900 Data Acquisition Test System
Chen Liying
Abstract　The system configuration and its software design of a data acquisition test system are presented in this paper.The design method of the system software,main functions and characteristics are discussed.
Key words　Data acquisition,ALPHA900,Module,PCB
引言
　　ALPHA900系列数据采集器能够对模拟信号(如温度、压力、电阻、电压、电流、应变等)和数字信号(如开关状态、事件捕获、测频计数等)进行连续、高精度的测量，具有抗干扰性强、通讯速率快、传输距离远、智能化程度高、使用简单灵活、安装维护方便等一系列优点，因此是人们对生产过程和生产设备进行运行监测、安全分析、故障诊断和优化控制的理想工具。
　　最小二乘法评价直流增益和直流偏移[1]是将输入值组E1，…，Em及其测量值组y1，…，ym按残差平方和最小的含义进行处理而确定被评价系统的数学模型参数G和d，则直流增益

直流偏移
　　如图1所示，直流增益和直流偏移的评价由硬件和软件两部分组成。以往的测试方法，是测试人员在Windows的终端仿真环境下，依照测试步骤，逐条输入测试命令，并从终端屏幕上记录测试数据，不但效率低、可靠性差，而且对测试人员的要求也较高。评价原理、方法误差，通过方法和原理的选取消除或限定。既免去了测试人员记忆与查询诸多测试命令的辛苦，又提高了测试的可靠性。使用最小二乘法评价直流增益和直流偏移，是一种总体最优意义上的模型化测量方法，在数字存储示波器、瞬态记录仪器以及数据采集系统等数字化线性测量系统的直流增益和直流偏移评价中，获得了较为广泛的应用，本文所要讨论的主要内容，是使用等间距最小二乘法评价直流增益和直流偏移的误差及来源，并以一个实例来说明直流增益和直流偏移评价结果不确定度。
　　●对合格产品进行计算机库存管理。
1　系统的硬件结构
　　系统硬件由ALPHA900系列数据采集器、电源、校准器、通讯电缆和主机构成，见图1。


图1　系统硬件结构图
　　ALPHA900系列数据采集器是测试系统的主要组成部分，负责完成多路传感器信号的扫描、采集、放大、A／D转换、信号发送等功能。
　　数据采集器外接12 V直流电源，并通过通讯电缆与主机的串行通讯口相连。
　　校准器用来为测试系统提供标准信号。根据被测信号的不同，校准器可以是直流电压校准器、电阻箱、频率计等。把校准器与数据采集器的一个或多个采集通道相连，通过比较系统的测试结果和校准器的标称值来检验产品是否合格。
2　系统软件的功能
1)简化测试过程
　　根据功能的不同，ALPHA900系列数据采集器可分为不同种类的模块，每一种模块出厂前都必须经过四项测试：PCB板测试、老化测试、校准测试和最终测试。而每一项测试又分成若干步骤，其中每一步都需要向模块发几条命令，因此要完成一个模块的完整测试，测试人员需要输入数十条命令；对于批量测试，这项工作将更为繁琐，测试人员须反复查阅命令集，输入各项命令。
2　不确定度来源及其影响
　　直流增益及直流偏移评价的不确定度σT主要来源于：
　　1)环境温度、湿度及其它因素变化的影响σH：
　　2)评价原理、方法及评价软件造成的不确定度σY；
　　3)评价用信号源或测量设备不确定度σS。同时，测试系统采用了友好的人机交互界面，使得非专业人员也可容易地进行测试。
4　结束语
　　由上述过程可见，在使用模型化测量方法评价仪器设备的直流增益和直流偏移指标时，其测量不确定度分析较为复杂，影响评价结果的因素较多，尤其是信号源提供的信号量纲与被评价参数的量纲不一致时，更是如此，这一点，在进行数字存储示波器等设备相应指标的评价以及这些设备测量标准进行不确定度分析和验证时应引起注意。若要求测试人员完整地记录测试结果，会占用大量人力，而且也不能保证不发生错记、漏记。此外，在连续进行72 h的老化测试中，要求测试人员时刻监守岗位也是不现实的。测试系统承担了这一部分工作，它能够实时地记录数据，并存储在指定的表格中。在测试过程中，当数据超标时，系统可自动记录出错信息。
3)提供查询服务
　　通过该测试系统，可以对测试过程中所记录的数据进行查询。根据用户指定的查询项目对测试记录进行排序、筛选，便于用户查找所需数据，还可以将查询结果以报表形式打印出来。
4)规范管理成品
　　在完成全部测试后，合格产品需要进行入库管理。成品管理能够对模块的入库、出库以及维修情况进行登记、查询和统计管理。
3　系统软件的设计
　　系统软件用Visual FoxPro编写。根据测试任务，分为以下几大功能模块，如图2所示。


图2　系统软件结构框图
1)系统设置模块
　　完成测试项目、测试模块类型和测试设备的设置。需要指出的是，在系统设置中，不可缺少的是由测试人员输入被测模块的产品的序列号，这个序列号在测试记录中被视为主索引。
2)测试记录模块
根据相应的测试项目，设置所需的试验参数，选择测试步骤、测试量程、需采集的通道，向模块发测试命令，进行实时采集与显示，采集结束后进行数据整理、结果评定。
　　测量系统的直流增益属于其静态特性指标。测试系统装入了FoxPro


图3　模块通讯流程图
中的FOXTOOLS.FLL程序库文件，它是Windows的一种动态链接库，利用这个库中的RegFn()及CallFn()例程便可调用Windows中的USER.EXE,GDI.EXE及KRNL386／KRNL286.EXE这3个最大的动态链接库中的例程。在16位Windows中，对串口的操作有其特定的函数：
.OpenComm
.CloseComm
.ReadComm
.WriteComm
.GetCommState
.SetCommState
　　它们都属于USER.EXE程序库。在Visual FoxPro中要调用其它动态链接库中的例程必须先“注册”，在取得一个例程句柄后，再利用此句柄进行调用。其详细分析如下：
设:线性测量系统的输入E输出y的关系为y＝GE＋d，Ei(i＝1，…，m)为输入值，yi为要直接测量的值，xi为有误差的实际测量值，则有
yi＝GEi＋d
误差方程组为 
γi＝xi－yi＝xi－GEi－d
直流增益
　　　　　　　　　　　　　　　　　(2)
直流偏移
　　　　　　　　　　　　　　　　(3)
测量结果不确定度[2]
 　　　　　　　　　　　　　　　　(4)
　　　　　　　　　　　　　　　　　 (5)
　　　　　　　　　　　　　　　(6)
其中，为信号源的不确定度；为被校设备的不确定度；m＝16，Ei(i＝1，…，m)居中覆盖测量范围(－Er／2，Er／2)，E＝0.5Er((2i－1)／m－1)
则G及d评价的不确定度σG和σd分别为[2]

本评价系统中，选取读值Er＝10 V，直流标准源误差限为±0.0008％读值±4 μV＝±84 μV，设误差在(－0.000084 V，0.00084 V)内均匀分布，

相对不确定度：
 

扩展不确定度为
　　　　　　　　　　　　　　(7)
　　　　　　　　　　　Ud／Er(kp＝31／2，p＝100％)＝kpσd／Er 　　　　　　(8)
　　使用HP54501A型数字存储示波器作为被评价的线性测量系统，由于HP54501A型数字存储示波器的技术指标为：
输入频带宽度：直流～100 MHz(－3 dB)
垂直分辨力：8BitsA／D
直流增益误差：±1.5％
直流偏移误差：±1.5％×直流偏置±0.2×(V／div)
电压测量误差：增益误差＋偏移误差＋A／D分辨力
采集速率误差：±0.005％
存储深度：500
实际实验中，选取“直流偏置”为0，增益G＝1，则直流偏移误差：(±1.5％×直流偏置±0.2×(V／div))／量程＝±2.5％
电压测量误差： 增益误差＋偏移误差＋A／D分辨力误差＝±4.4
△A01／A0＝±4.4％
电压测试不确定度为 σsc／Er＝4.4％／31／2,由式(7)得直流增益扩展不确定度 UG(kp＝31／2，p＝100％)＝3.9％
由式(8)得直流偏移扩展不确定度 U\-d／E\-r(k\-p＝3\+\{1／2\}，p＝100％)＝1.1％
当被校设备为理想状况，即σsc＝o时，评价系统自身的相对不确定度：
σGO／G＝4.2×10－6
σdO／Er＝1.2×10－6.G
其相应的扩展不确定度分别为[3]
UGO／G(kp＝31／2，p＝100％)＝kp.σGO／G
＝7.3×10－6
UdO／Er(kp＝31／2，p＝100％)＝kp.σdO／Er
＝2.1×10－6.G　
　　由此可见，测量点E\-i及其m确定后，Q11和Q22也确定了，被评价系统和信号源的不确定度影响所获得的增益G和直流偏移d的不确定度也随之确定。通过WriteComm函数把测试命令以字符串的形式写到串行口，并调用ReadComm函数把数据采集模块的响应读入缓冲区。测试系统创建了一个.dat数据文件来保存模块的响应。由于每一次响应含有20个通道的数据，而当各通道所测的信号不同时，其数据位的长度也不同，为保证数据文件中的数据能正确地映射到数据表格中，需将数据文件中数据格式化，把原先的空格分隔符改为逗号分隔符，从而避免了多余空格造成的数据错位，然后调用FoxPro中的APPEND FROM命令将数据文件中的数据映射到数据表格中。另外，尤其要说明的一点是，直流增益及直流偏移评价不确定度，受被评价设备的测量不确定度影响较大，这在其它指标评价中也不例外，但却常常为人们所忽略，因此在评价指标参数时，一味追求测量标准设备的高指标，往往是得不偿失的。
　　数据表格中的实时数据还需要经过一系列综合处理，计算出每组测试数据的最大值、最小值、平均值等，为测试结果的评定做好准备。
　　测试结果的自动评定使测试人员不必记忆测试结果的上下限合格值，提高了测试的速度与准确性。当测试数据超出规定的范围时，系统会在不合格的数据旁标以醒目的标记“***”，向测试人员报警，并在数据文件的备注栏中记录下此时的故障情况，以供日后分析查询。
关键词　直流增益　直流偏移　不确定度分析　评价　校准
The Uncertainty Evaluation of DC Gain and Offset
Liang Zhiguo,Cao Yingjie
Abstract　In this paper,the evaluation course of DC gain and offset of linear measurement system using the least square method is described,the uncertainty analysis of the evaluation is discussed,and in the meantime an example of evaluation and analysis is introduced in detail.The course and results can be used in the uncertainty analysis of some measurement standard or the uncertainty analysis of gain and offset themselves.
Key words　DC gain,DC offset,Uncertainty analysis,Evaluation,Calibration
引言
　　任何一种仪器设备的性能指标，其评价结果均有不确定性，一般来说，其不确定度的大小与所使用的评价设备、评价方法、评价条件、以及被评价的设备指标均有关系。按照用户输入的查询索引，如：产品序列号、测试日期、测试人员等，对当前目录下的所有数据表格进行检索，查到的记录除了可以刷新屏幕外，还可以直接送到打印机打印。
　　　　　　　　　　　　　　　(1)
本文所用实验系统中,标准信号源的不确定度设定见表1.
表1

项目直流幅度
范围0～1100 V
最优档误差限±0.0008％读值±4 μV
标准不确定度uc
(相对于10 V)4.85×10－6
扩展不确定度U9.70×10－6

　　环境温度、湿度及其它因素变化的影响，通过限定评价环境条件来消除。
　　入库登记需要录入产品序列号、模块类型、生产日期。批量入库时，同一种模块的序列号通常是连续的，为了避免反复输入这些参数，每完成一个模块的登记，序列号自动加1，而模块类型以及生产日期保持不变。在入库时，系统自动检验产品序列号的唯一性，当所输入的序列号在成品数据库中已存在时，系统会发出警告，提示用户重新输入。
　　出库登记需要录入出厂日期及代理商。批量出库时，对于同一代理商，可以在成品数据库中用Shift＋鼠标左键进行多项选择，一起出库。
　　查询可以按模块序列号、模块类型、生产日期、出厂日期以及代理商对成品数据库进行检索，并可打印查询结果。
　　成品管理还可按年、月统计模块的生产量、销售量以及库存量，并计算出销售给每个代理商的每种模块的数量及总和，统计结果可以打印。
4　结束语
　　本系统已经过一年多的测试应用，实践证明该系统使用方便、可靠性高，较好地满足了数据采集器系统的测试要求，也为日后开发其它产品的测试系统打下了基础。
作者简介：＋26岁　女　助理工程师
作者单位：希蒙电子国际有限公司，北京市，100095
收稿日期：1998－08－03收稿
