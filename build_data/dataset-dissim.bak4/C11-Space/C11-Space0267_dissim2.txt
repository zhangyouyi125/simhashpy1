　宇航学报
JOURNAL OF ASTRONAUTICS
1999年 第20卷 第3期 vol.20 No.3 1999



　自适应两步滤波器及其在导弹
被动制导中的应用*
周　荻　慕春棣　胡恒章
　　摘　要　两步滤波器由Kalman滤波器和Gauss-Newton迭代算法所构成，它适用于一类由线性动态模型和非线性测量模型所组成的非线性系统。因此地面臂的控制方法难以直接应用于空间臂系统。最后，本文将自适应两步滤波器应用于导弹的被动制导问题，数字仿真结果证明了这种算法的有效性。如可利用Robersen-Wittenburg方法［8］，将载体质心坐标xc,yc和相对Y轴的转角θ1以及各杆的相对转角θ2，θ3构成广义坐标q：
　　　　　　　　　　　　　　　

图1　平面两杆自由浮动空间机械臂系统
列出如下形式的系统动力学方程：
　　　　　　　　　　　　　　　　　　　　　　　　(1)
其中D(q,)为5×5质量矩阵，h(q,)为包含哥氏力、离心力的5阶列阵，τ=(τ2　τ3)T为关节铰控制力矩τ2,τ3组成的2阶列阵；且对任意变量z∈h5,矩阵D、h间存在关系［3］：
　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　(2)
将对称的质量阵D(q,)写作分块形式，则方程(1)可分解为：
　　　　　　　　　　　　　　(3)
其中Dbb和Drr为3×3和2×2对称子矩阵，Dbr=DTrb为3×2子矩阵，上式左端第一式的积分表示自由浮动空间机械臂系统的动量和动量矩守恒关系。最常用的递推型非线性滤波器是推广Kalman滤波器(EKF)，应用此滤波器需要对非线性系统进行线性化处理。在有些情况下，EKF有较大的估计误差，甚至会发散。本文介绍一种适用于一类特定非线性系统的两步滤波器［1～2］。Walker等［4］讨论了载体位置无控，姿态受控条件下空间臂的自适应控制问题。所谓的两步滤波器是指，首先采用一组新的状态量(它是系统真实状态的非线性函数)，使得系统被量测量是这组新状态量的线性函数。在第一步滤波中，应用Kalman滤波器得到新状态的最优估计值。在第二步滤波中，把新状态的估计值作为被量测量，并应用Gauss-Newton迭代算法求出系统真实状态的最优解。在许多实际情况下，测量噪声统计特性是时变的，无法验前已知，这时应用噪声统计估值器可以在线地确定测量噪声的均值和方差。通过仿真运算，证实了方法的有效性。
　　2　自适应两步滤波器
　　考虑非线性系统
　　　　　　　　　　　　　　　　　　　　　　　　　　(1)
　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　(2)
其中F　(　.　，　.　)代表一个非线性向量函数；wk和vk均为高斯白噪声，而且E［wk］=0,E［wk wTk］=Qk,E［vk］=rk,E［vk vTk］=Rk,E［wk vTk］=0。
　　设性能指标函数为
　　　　　　　　　　　　　　　　　　(3)
我们引进一个新的状态向量yk，令测量向量zk为关于yk的线性函数，即
　　　　　　　　　　　　　　　　　　　　　　　　(4)
其中yk=fk(xk,tk)，一般可取yk=［xTk　FT(xk,tk)］T。这样，我们取第一步滤波时的性能指标函数为
　　　　　　　　　　　　　　　　　　　　(5)
为使Jy达到最小值，可以用Kalman滤波器求出yk的估计值，即进行第一步滤波，
　　　　　　　　　　　　　(6)
　　　　　　　　　　　　　　　　　　　　　　　　　　(7)
其中,。
　　将(11)式确定的控制力矩代入系统动力学方程(10)，得到
　　　　　　　　　　　(12)
矩阵WΦ定义为：,,其中ξ、分别为从真实模型D、h及参考模型中分离出的待估计参数值和可调的参数值，W为q、的不含待估计参数的函数矩阵。由于现在求解的是一个线性状态估计问题，所以可以用线性时变测量噪声统计估值器［3］对rk和Rk进行实时估计，即
　　　　　　　　　　　　　　　　　　　　　　　(8)
　　　　　　　　　(9)
其中dk=(1-b)/(1-bk+1),0＜b＜1，b代表遗忘因子；,εk代表新息向量；Kk=PykHTkR-1k。上述算法完成了第一步滤波的测量修正功能。
*国家自然科学基金资助项目(19872032)及航空基金自选课题资助项目
作者单位：陈　力：福州大学机械工程系.福州.350002
　　　　　刘延柱：上海交通大学工程力学系.上海.200030
参考文献
　　1　Papadopoulos E G,Dubwsky S.On the Nature of Control Algorithms for Free-Floating Space Manipulators.IEEE Transactions on Robotics and Automation,1991,7(6):750-758
　　2　Vava Z,Dubowsky S.On the Dynamics of Space Manipulators Using the Virtual Manipulator,with Applications to Path Planning.Journal of the Astronautical Science,1990,38(4):441-472
　　3　Slotin J E,Li W P.On the Adaptive Control of Robot Manipulators.Journal of the Robotics Reserach,1987,6(3):49-59
　　4　Michael W,Walker.Adaptive Control of Space-Based Robot Manipulators.IEEE Transactions on Robotics and Automation,1992,7(6):828-835
　　5　Gu Y L,Xu Y S.A Normal Form Augmentation Approach to Adaptive Control of Space Robot Systems.Journal of the Dynamics and Control,1995,5:275-294
　　6　刘延柱，顾晓勤.空间机械臂逆动力学的Lyapunov方法.力学学报，1996，28(6)
　　7　陈力，戈新生，刘延柱.自由浮动空间机械臂系统运动规划的最优控制方法.全国第七届空间及运动体控制技术学术年会论文集，1996：47-51
　　8　刘延柱，洪嘉振，杨海兴.多刚体系统动力学.北京：高等教育出版社，1989
收稿日期:1997年8月18日,修回日期:1998年7月30日
。取第二步滤波时的性能指标函数为
　　　　　　　　　　　　　　　　　　　　　(11)
显然，求解xk使Jk达到最小值这一问题是一个非线性估计问题，我们用Gauss-Newton迭代法求最优解，即令
　　　　　　　　　　　　　　　　　　　　　　　　　　　　(12)
其中i代表迭代次数，，。忽略f的二阶导数和高阶导数可以保证Lk,i的正定性，即
　　　　　　　　　　　　　　　　　　(13)
应用(13)式，(12)式成为
　　　　　　　　　　　　　　　　　　　　　　　　　　　　(14)
其中。e1=YD-Y为实际轨迹与期望轨迹之间的误差，则X与XD之间的增广输出误差向量e为：e=XD-X=［0T　eT1］T。
　　定义状态xk的估计误差协方差阵为，可以证明［1］
　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　　(15)
利用(14)式可以完成第二步滤波的测量修正功能。
　　显然，系统状态xk的一步预报值及预报误差协方差阵可以由下列算法求得：
　　　　　　　　　　　　　　　　　(16)
　　　　　　　　　　　　　　　　　　　　　　　　　(17)
(16)式和(17)式完成了第二步滤波的时间修正功能。因此空间机械臂系统的动力学和控制问题远较地面固定机械臂复杂，并成为人们研究的热点［1，2，6，7］。
　　对以上各推导步骤进行总结，可得如下结论：把(6)～(9)式，(14)式、(16)式、(17)式，(19)式、(21)式按照所给定的顺序执行运算，即可以构成自适应两步滤波器。
　　3　自适应两步滤波器在导弹被动制导中的应用
　　假设目标加速度可以用一阶Gauss-Markov随机过程描述，那么，在直角坐标系中目标和导弹相对运动关系可以用线性离散形式的动态方程描述，见文献［6］。被动制导条件下，非线性的测量方程也如文献［6］所述。我们把自适应两步滤波器应用于这一问题，并通过计算机仿真来验证滤波器的有效性。仿真计算结果表明控制方法的有效性。其它数据与文献［6］中仿真数据相同，导弹制导指令由线性二次型导引律［4］确定，且利用系统状态的真实值来实现。
　　经过100次Monte-Carlo仿真，得到了自适应两步滤波器(ATSF)对相对距离、相对速度及目标加速度的估计误差，分别见图1～图3。图1～图3说明，在同样的仿真条件下，这一滤波器的性能明显优于推广Kalman滤波器(EKF)，也优于作者在文献［6］中所提出的自适应推广Kalman滤波器(AEKF)。

图1　相对距离估计误差

图2　相对速度估计误差

图3　目标加速度估计误差
　
　　4　结论
　　本文提出了一种自适应两步滤波器，它适用于一类由线性动态模型和非线性测量模型所组成的非线性系统，而且系统测量噪声统计特性可以是验前未知的。本文将自适应两步滤波器应用于导弹被动制导问题，仿真结果表明这种非线性滤波器具有优良的性能。
　　在实际的空间机械臂系统中，系统参数有时并非都是未知的，如其抓取的载荷的参数可能是未知的，但有关机械臂的参数并非完全不确定，可能只是难以精确确定